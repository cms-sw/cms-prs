{"additions": 9, "auther_ref": "cms/master/c6882f4", "auther_sha": "507fc6786e46c54ce678114caa4478284cbb94a7", "author": "gartung", "body": "This fixes the issue with Igprof undercounting the time spent in routine when using TBB resumable tasks.\r\nThe problem seems to occur when the start routine of a thread exits. Igprof disable the profiling timer on the thread, merges and then deletes the trace buffer for the thread. With debugging enable this Igprof trace gave a hint to the problem\r\n```\r\n2021-04-30 16:48:39.289244: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 3600000000 Hz\r\n*** IgProf(15948, 1619794119.368): captured thread id 0x7f4affdfd700 for profiling (0x7f4c61810540(0x7f4bb525d300))\r\n*** IgProf(15948, 1619794119.368): leaving thread id 0x7f4affdfd700 from profiling (0x7f4c61810540(0x7f4bb525d300))\r\n*** IgProf(15948, 1619794119.368): merging profile buffer 0x7f4aff000000 to master buffer 0x7f4ca4dc6660\r\n```", "branch": "cms/master/c6882f4", "changed_files": 2, "closed_at": "1620043438", "comments": 8, "commits": 1, "created_at": "1619809092", "deletions": 6, "labels": ["externals-pending", "orp-pending", "pending-signatures", "tests-approved"], "merge_commit_sha": "6cc73b59d83ed6c9d73b455dc40857e700ef6ee4", "merged_at": "1620043438", "merged_by": "gartung", "number": 2, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Don't disable the profiling timer and don't delete the trace buffer when the start routine for the thread exits.", "updated_at": "1620043438", "user": "gartung"}