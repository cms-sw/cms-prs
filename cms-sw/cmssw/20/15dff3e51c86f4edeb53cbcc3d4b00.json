{"additions": 2335, "auther_ref": "MiniAOD2017V2_940", "auther_sha": "5b96b061234aa0b829a91e885cd6cf2c730a5116", "author": "Sam-Harper", "body": "Dear All,\r\n\r\nThis is the miniAOD V2 PR in a 9_4_X flavour.  For more details please see https://github.com/cms-sw/cmssw/pull/22308\r\n\r\nIt mostly involves adapting the Energy Scale & Smearing code to be able to put it into the pat::Electron. I freely admit, the design is not the best, I had to work with what I had. \r\n\r\nThis PR does two things\r\n1) enables 2016/2017 IDs in the miniAOD and also stores the bit maps of the cuts for the cut based IDs, everything is embeded in pat::Electron,pat::Photon as well as removing all old IDs. This is the more or less trival bit\r\n2) enables scale and smearing to the miniAOD\r\n\r\nThis PR will not compile until  https://github.com/cms-sw/cmssw/pull/22302, https://github.com/cms-sw/cmssw/pull/22303 are merged as it depends on them. \r\n\r\nThis PR will not run until I figure out how to get data files in EgammaAnalysis/ElectronTools/data. There is no repo for this in cms-data, who do I contact to deal with that.  The files are at https://github.com/ECALELFS/ScalesSmearings for reference. \r\n\r\nI'm now going to run a large scale test of this. I've been testing with\r\n`cmsDriver.py miniAOD-prodData -s PAT --eventcontent MINIAOD --runUnscheduled --data  --filein file:/opt/ppd/month/harper/dataFiles/DoubleEG_Run2017E_AOD_304144_LS90to91_LS629to631_LS961to963_A479BAD3-69D3-E711-AE6D-FA163E41AF41.root --conditions  --era Run2_2017  --nThreads 8 --scenario pp --conditions 94X_dataRun2_ReReco17_forValidation --no_exec -n -1 `\r\nand things look fine.\r\n\r\n```\r\nvariables stored for electrons:\r\negammaDebug: ele event 303948 1006994834 798  E/pt/eta/phi 51.7546 0.143284 5.9708 -1.5708 \r\n   userFloats: \r\n          ElectronMVAEstimatorRun2Fall17IsoV1Values 0.905862\r\n          ElectronMVAEstimatorRun2Fall17NoIsoV1Values 0.944877\r\n          ElectronMVAEstimatorRun2Spring16GeneralPurposeV1Values 0.972428\r\n          ElectronMVAEstimatorRun2Spring16HZZV1Values 0.953926\r\n          energyEcalErrPreCorr 1.48862\r\n          energyEcalPreCorr 51.6299\r\n          energyEcalTrkErrPostCorr 1.64622\r\n          energyEcalTrkErrPreCorr 1.47872\r\n          energyEcalTrkPostCorr 51.7546\r\n          energyEcalTrkPreCorr 51.9184\r\n          energyScaleDown 51.7086\r\n          energyScaleGainDown 51.7546\r\n          energyScaleGainUp 51.7546\r\n          energyScaleStatDown 51.7546\r\n          energyScaleStatUp 51.7546\r\n          energyScaleSystDown 51.7086\r\n          energyScaleSystUp 51.7946\r\n          energyScaleUp 51.7946\r\n          energyScaleValue 0.9962\r\n          energySmearDown 51.7552\r\n          energySmearNrSigma -1.34543\r\n          energySmearPhiDown 51.7552\r\n          energySmearPhiUp 51.7552\r\n          energySmearRhoDown 51.7545\r\n          energySmearRhoUp 51.7548\r\n          energySmearUp 51.7552\r\n          energySmearValue 0.013819\r\n   userInts: \r\n          ElectronMVAEstimatorRun2Fall17IsoV1Categories 0\r\n          ElectronMVAEstimatorRun2Fall17NoIsoV1Categories 0\r\n          ElectronMVAEstimatorRun2Spring16GeneralPurposeV1Categories 0\r\n          ElectronMVAEstimatorRun2Spring16HZZV1Categories 0\r\n          cutBasedElectronID-Fall17-94X-V1-loose 894\r\n          cutBasedElectronID-Fall17-94X-V1-medium 894\r\n          cutBasedElectronID-Fall17-94X-V1-tight 894\r\n          cutBasedElectronID-Fall17-94X-V1-veto 894\r\n          cutBasedElectronID-Summer16-80X-V1-loose 1022\r\n          cutBasedElectronID-Summer16-80X-V1-medium 1022\r\n          cutBasedElectronID-Summer16-80X-V1-tight 1022\r\n          cutBasedElectronID-Summer16-80X-V1-veto 1022\r\n          heepElectronID-HEEPV70 4094\r\n   electronIDs: \r\n          cutBasedElectronID-Fall17-94X-V1-loose 0\r\n          cutBasedElectronID-Fall17-94X-V1-medium 0\r\n          cutBasedElectronID-Fall17-94X-V1-tight 0\r\n          cutBasedElectronID-Fall17-94X-V1-veto 0\r\n          cutBasedElectronID-Summer16-80X-V1-loose 0\r\n          cutBasedElectronID-Summer16-80X-V1-medium 0\r\n          cutBasedElectronID-Summer16-80X-V1-tight 0\r\n          cutBasedElectronID-Summer16-80X-V1-veto 0\r\n          heepElectronID-HEEPV70 0\r\n          mvaEleID-Fall17-iso-V1-wp80 1\r\n          mvaEleID-Fall17-iso-V1-wp90 1\r\n          mvaEleID-Fall17-iso-V1-wpLoose 1\r\n          mvaEleID-Fall17-noIso-V1-wp80 1\r\n          mvaEleID-Fall17-noIso-V1-wp90 1\r\n          mvaEleID-Fall17-noIso-V1-wpLoose 1\r\n          mvaEleID-Spring16-GeneralPurpose-V1-wp80 1\r\n          mvaEleID-Spring16-GeneralPurpose-V1-wp90 1\r\n          mvaEleID-Spring16-HZZ-V1-wpLoose 1\r\n\r\nvariables stored for photons:\r\negammaDebug: pho event 303948 1006994834 798  E/pt/eta/phi 51.2695 43.0262 0.60953 -3.11557 \r\n   userFloats: \r\n          PhotonMVAEstimatorRun2Spring16NonTrigV1Values -0.0581985\r\n          PhotonMVAEstimatorRunIIFall17v1Values 0.145245\r\n          PhotonMVAEstimatorRunIIFall17v1p1Values 0.134052\r\n          energyEcalErrPreCorr 1.46594\r\n          energyEcalPreCorr 51.465\r\n          energyScaleDown 51.2283\r\n          energyScaleGainDown 51.2695\r\n          energyScaleGainUp 51.2695\r\n          energyScaleStatDown 51.2695\r\n          energyScaleStatUp 51.2695\r\n          energyScaleSystDown 51.2283\r\n          energyScaleSystUp 51.3106\r\n          energyScaleUp 51.3106\r\n          energyScaleValue 0.9962\r\n          energySmearDown 51.2695\r\n          energySmearNrSigma -1.34543\r\n          energySmearPhiDown 51.2695\r\n          energySmearPhiUp 51.2695\r\n          energySmearRhoDown 51.2695\r\n          energySmearRhoUp 51.2695\r\n          energySmearUp 51.2695\r\n          energySmearValue 0.013819\r\n          phoChargedIsolation 0\r\n          phoNeutralHadronIsolation 0\r\n          phoPhotonIsolation 4.97939\r\n          phoWorstChargedIsolation 1.47137\r\n   userInts: \r\n          PhotonMVAEstimatorRun2Spring16NonTrigV1Categories 0\r\n          PhotonMVAEstimatorRunIIFall17v1Categories 0\r\n          PhotonMVAEstimatorRunIIFall17v1p1Categories 0\r\n          cutBasedPhotonID-Fall17-94X-V1-loose 127\r\n          cutBasedPhotonID-Fall17-94X-V1-medium 127\r\n          cutBasedPhotonID-Fall17-94X-V1-tight 127\r\n          cutBasedPhotonID-Spring16-V2p2-loose 127\r\n          cutBasedPhotonID-Spring16-V2p2-medium 127\r\n          cutBasedPhotonID-Spring16-V2p2-tight 127\r\n   photonIDs: \r\n          cutBasedPhotonID-Fall17-94X-V1-loose 1\r\n          cutBasedPhotonID-Fall17-94X-V1-medium 1\r\n          cutBasedPhotonID-Fall17-94X-V1-tight 1\r\n          cutBasedPhotonID-Spring16-V2p2-loose 1\r\n          cutBasedPhotonID-Spring16-V2p2-medium 1\r\n          cutBasedPhotonID-Spring16-V2p2-tight 1\r\n          mvaPhoID-RunIIFall17-v1-wp80 0\r\n          mvaPhoID-RunIIFall17-v1-wp90 0\r\n          mvaPhoID-RunIIFall17-v1p1-wp80 0\r\n          mvaPhoID-RunIIFall17-v1p1-wp90 0\r\n          mvaPhoID-Spring16-nonTrig-V1-wp80 0\r\n          mvaPhoID-Spring16-nonTrig-V1-wp90 0\r\n```\r\n\r\n\r\n@lsoffi @varuns23 @jainshilpi @shervin86 ", "branch": "CMSSW_9_4_MAOD_X", "changed_files": 40, "closed_at": "1520785974", "comments": 6, "commits": 13, "created_at": "1519320106", "deletions": 710, "labels": ["analysis-pending", "comparison-pending", "orp-pending", "pending-signatures", "reconstruction-rejected", "tests-pending"], "milestone": "CMSSW_9_4_MAOD_X", "number": 22309, "release-notes": [], "review_comments": 0, "state": "closed", "title": "EGMiniAODV2 : 9_4_X", "updated_at": "1520785974", "user": "Sam-Harper"}