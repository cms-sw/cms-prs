{"additions": 8, "auther_ref": "make_auto_phase2_realistic_key_usable", "auther_sha": "5fefea515da3a4f565bc53d4dd4e36e94b569aa1", "author": "mmusich", "body": "#### PR description:\r\n\r\nSeveral users have by now complained about the fact that the autoCond key `phase2_realistic` is not usable.\r\nThis is caused by the fact that it contains a funny mix of Phase-1 and Phase-2 pixel tags:\r\n```\r\n$ conddb list 113X_mcRun4_realistic_v4 | grep SiPixel\r\n[2021-03-02 16:19:07,970] INFO: Connecting to pro [frontier://PromptProd/CMS_CONDITIONS]\r\nDQMXMLFileRcd                                           SiPixelDQMQTests                                                   DQMXMLFile_SiPixelDQM_v1_mc                                                  \r\nSiPixelDetVOffRcd                                       -                                                                  SiPixelDetVOff_Ideal_RunBased_31X_v2_hlt                                     \r\nSiPixelDynamicInefficiencyRcd                           -                                                                  SiPixelDynamicInefficiency_13TeV_v3_mc                                       \r\nSiPixelFedCablingMapRcd                                 -                                                                  SiPixelFedCablingMap_mc                                                      \r\nSiPixelGainCalibrationForHLTRcd                         -                                                                  SiPixelGainCalibrationForHLT_split_smeared_mc                                \r\nSiPixelGainCalibrationOfflineRcd                        -                                                                  SiPixelGainCalibration_split_smeared_mc                                      \r\nSiPixelGenErrorDBObjectRcd                              -                                                                  SiPixelGenErrorDBObject_phase1_38T_2017_rereco_v9                            \r\nSiPixelLorentzAngleRcd                                  -                                                                  SiPixelLorentzAngle_phase2_T15_v0_mc                                         \r\nSiPixelLorentzAngleRcd                                  forWidth                                                           SiPixelLorentzAngle_phase2_forWidth_T15_v0_mc                                \r\nSiPixelLorentzAngleRcd                                  fromAlignment                                                      SiPixelLorentzAngle_fromAlignment_v1_mc[cms_orcon_prod/CMS_COND_31X_PIXEL]   \r\nSiPixelLorentzAngleSimRcd                               -                                                                  SiPixelSimLorentzAngle_phase2_T15_v0_mc                                      \r\nSiPixelQualityFromDbRcd                                 -                                                                  SiPixelQuality_phase2_ideal                                                  \r\nSiPixelTemplateDBObjectRcd                              -                                                                  SiPixelTemplateDBObject_phase1_38T_2017_rereco_v9                            \r\nSiPixelTemplateDBObjectRcd                              0T                                                                 SiPixelTemplateDBObject_0T_v3_mc                                             \r\nSiPixelTemplateDBObjectRcd                              2T                                                                 SiPixelTemplateDBObject_2T_v3_mc                                             \r\nSiPixelTemplateDBObjectRcd                              35T                                                                SiPixelTemplateDBObject_35T_v3_mc                                            \r\nSiPixelTemplateDBObjectRcd                              3T                                                                 SiPixelTemplateDBObject_3T_v3_mc                                             \r\nSiPixelTemplateDBObjectRcd                              4T                                                                 SiPixelTemplateDBObject_4T_v3_mc      \r\n```\r\nThis per se is not a big issue as in a regular job (like relval or production jobs) it picks up the correct GT string from the upgrade matrix (`runTheMatrix.py`) or by imposing a physical GT by hand. \r\nOn the other hand `auto:phase2_realistic` key is by now totally bogus and cannot be used as it is.\r\nI propose to remedy this situation by:\r\n-  make `auto:phase2_realistic` key to point to a GT which contains *only* phase-2 IT tags. As we support multiple geometries I have chosen the ones used in the more conservative baseline (25x100 um2 pixel cells in the inner Tracker), such as T15 - used in D49 (HLT TDR) or T21-used in D76 (which has to become the new baseline for RelVals after PR https://github.com/cms-sw/cmssw/pull/33007 is merged). \r\n   * A new GT has been created: `113X_mcRun4_realistic_v5`: as expected, it differs from the previous version (v4) only for the SiPixel tags ([link to DB Browser](https://cms-conddb.cern.ch/cmsDbBrowser/diff/Prod/gts/113X_mcRun4_realistic_v4/113X_mcRun4_realistic_v5))\r\n\r\n- make the framework emit a warning in case this \"naked\" key is used as one size cannot fit all. Users should be warned that if they are not expecting to use the baseline geometry they need to look up the correct key in the dictionary.\r\n\r\n#### PR validation:\r\n\r\nChanging one `runTheMatrix` workflow with:\r\n\r\n` runTheMatrix.py --what upgrade -l 34606.0 --command='--conditions auto:phase2_realitic'`\r\n\r\nruns fine and in the logs I find the following warning (as expected):\r\n\r\n```\r\n************************************************************************************************************************\r\n\t\t\t\t\t\t WARNING!\r\n The key phase2_realistic now points to 113X_mcRun4_realistic_Candidate_2021_03_02_13_27_45.\r\n Usage of this key is discretionary and users are cautioned to use it at their own risk!\r\n This Global Tag contains tags suited for an Inner Tracker layout with rectangular (25x100um2) pixel cells (T15,T21).\r\n If this is not the geometry you are expecting to use, please consult:\r\n https://github.com/cms-sw/cmssw/blob/master/Configuration/AlCa/python/autoCondPhase2.py to retrieve the right key.\r\n************************************************************************************************************************\r\n```\r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\n\r\nNot a backport, no backport needed.\r\n\r\ncc:\r\n@veszpv ", "branch": "master", "changed_files": 2, "closed_at": "1614937639", "comments": 18, "commits": 2, "created_at": "1614697594", "deletions": 1, "labels": ["alca-approved", "code-checks-approved", "fully-signed", "orp-approved", "tests-approved"], "merge_commit_sha": "49111a20f8f81c36aa3c4f249ac56c7a31ffc789", "merged_at": "1614937639", "merged_by": "cmsbuild", "milestone": "CMSSW_11_3_X", "number": 33036, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Make auto:phase2_realistic key usable", "updated_at": "1614937639", "user": "mmusich"}