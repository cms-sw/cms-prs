{"additions": 1611, "auther_ref": "GraphSC_CMSSW_12_3_0_pre5", "auther_sha": "0f3583f5d7237f0f121ec3166e2a951d9b5f01f8", "author": "valsdav", "body": "#### PR description:\r\n\r\nThe PR introduces the implementation of the DeepSC algorithm in the ECAL SuperCluster reconstruction sequence. \r\nThe algorithm is based on graph NNs and it is evaluated through the vanilla CMSSW Tensorflow interface.\r\n\r\nThree modules have been implemented to handle the ECAL PFClusters as a graph and to encapsulate the evaluation of the DeepSC algo.\r\n- **EcalClustersGraph**:  utility class exposing the DeepSC algorithm to the PFECALSuperClusterAlgo\r\n- **DeepSCGraphEvalution**:  encapsulates the tensorflow interface and inputs handling\r\n- **GraphMap**:  utility class to extract sub-graphs as the final SuperClusters candidates after the model evaluation\r\n\r\nA separate PR (https://github.com/cms-data/RecoEcal-EgammaClusterProducers/pull/2) has been created for the model data. \r\n\r\nA summary of the features implemented in the PR and the relative validation can be found at:   \r\nhttps://indico.cern.ch/event/1129736/#5-dnn-superclustering\r\n\r\nThe algorithm is intended to replace the Mustache (not in the short term) and it is **OFF by default** in the PR.  It can be switched ON by the run3_ecalclustering process modifier. \r\n\r\nThe DeepSC algorithm has been presented in ECAL, PF and ML group meetings. More documentation and details can be find in the links below.\r\n\r\n##### Recent talks and documentation:\r\n- ACAT2021 proceeding: https://cms.cern.ch/iCMS/user/noteinfo?cmsnoteid=CMS%20CR-2022/031\r\n- DPS note approved for ACAT2021: https://cds.cern.ch/record/2792321\r\n- PF meeting:  https://indico.cern.ch/event/1102164/#1-ml-based-ecal-clustering\r\n- ML Townhall meeting 2021: https://indico.cern.ch/event/1045606/timetable/#20210726.detailed\r\n\r\n\r\n#### PR validation:\r\n\r\nNo changes are expected in any standard workflow. The DeepSC model is only activated by the run3_ecalclustering process modifier.   A summary of the features implemented in the PR and the relative validation can be found at:   \r\nhttps://indico.cern.ch/event/1129736/#5-dnn-superclustering\r\n\r\nAdded runTheMatrix workflow 11846.19 on Zee_14TeV. \r\n\r\n##### Profiling \r\n\r\n11846 workflow: 2021PU+ZEE_14TeV_TuneCP5_GenSim+DigiPU+RecoNanoPU+HARVESTNanoPU\r\n\r\n11846.0  standard reco:\r\n- CPU  https://dvalsecc.web.cern.ch/cgi-bin/igprof-navigator/DeepSC/step3_igprofCPU_w11846.0\r\n- MEM https://dvalsecc.web.cern.ch/cgi-bin/igprof-navigator/DeepSC/step3_igprofMEM99_w11846.0\r\n\r\ncomment: I am not able to find a reference to the PFECALSuperCluster producer in the profiler output, probably given the small footprint of the standard Mustache.\r\n\r\n11846.19 DeepSC SuperClusters \r\n- CPU https://dvalsecc.web.cern.ch/cgi-bin/igprof-navigator/DeepSC/step3_igprofCPU_w11846.19\r\n- MEM   https://dvalsecc.web.cern.ch/cgi-bin/igprof-navigator/DeepSC/step3_igprofMEM99_w11846.19\r\n\r\ncomment:  evaluate the DeepSC takes 3.8% of the CPU time (https://dvalsecc.web.cern.ch/cgi-bin/igprof-navigator/DeepSC/step3_igprofCPU_w11846.19/100)  , whereas the memory footprint is rather small 0.46% (https://dvalsecc.web.cern.ch/cgi-bin/igprof-navigator/DeepSC/step3_igprofMEM99_w11846.19/809).\r\n\r\n\r\n\r\n", "branch": "master", "changed_files": 18, "comments": 29, "commits": 6, "created_at": "1646202336", "deletions": 102, "labels": ["reconstruction-pending", "pending-signatures", "tests-approved", "orp-pending", "pdmv-pending", "upgrade-pending", "requires-external", "code-checks-approved"], "milestone": "CMSSW_12_4_X", "number": 37115, "release-notes": [], "review_comments": 28, "state": "open", "title": "DeepSC algorithm for ECAL SuperClusters", "updated_at": "1647428620", "user": "valsdav"}