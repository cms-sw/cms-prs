{"additions": 13, "auther_ref": "PhotonDataCertification", "auther_sha": "a4267cae8769b146b0a88bbcd8f7c8ca2e764730", "author": "guitargeek", "body": "In ROOT master, RooFit doesn't want to fit empty histograms anymore.\r\n\r\nI have to think about a little bit about how I want to deal with this in ROOT master, because such fits are often user logic errors. Also, in the case of the `PhotonDataCertification::invMassZtest()`:\r\n\r\n```c++\r\n  RooMsgService::instance().setGlobalKillBelow(RooFit::WARNING);\r\n  ...\r\n  BreitWigner.fitTo(test, RooFit::Range(80, 100), RooFit::PrintLevel(-1000));\r\n\r\n  if (std::abs(mRes.getValV() - ZMass) < ZWidth) {\r\n    return 1.0;\r\n  } else if (std::abs(mRes.getValV() - ZMass) < gamma.getValV()) {\r\n    return 0.9;\r\n  } else {\r\n    return 0.0;\r\n  }\r\n```\r\n\r\nSo far, RooFit just silently didn't do any fit if the `test` data was empty. This results in the `mRes` value not being changed from the default nominal `ZMass`, and then the function returns a summary value of `1.0`, indicating that the peak was within the Z width. Does that really make sense for an empty histogram?\r\n\r\nThat is maybe something to think about for the DQM experts. For now, this commit simply keeps the old behavior, it just makes the `if (sumEntries() > 0.)` check explicit. Like this, it will continue working with ROOT `master`.\r\n\r\nThis PR was made in response to https://github.com/cms-sw/cmsdist/pull/9025#issuecomment-1960008624.", "branch": "master", "changed_files": 1, "closed_at": "1708832726", "comments": 8, "commits": 1, "created_at": "1708655507", "deletions": 2, "labels": ["dqm-pending", "pending-signatures", "tests-pending", "orp-pending", "code-checks-approved"], "milestone": "CMSSW_14_1_X", "number": 44064, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Avoid fitting empy histograms in PhotonDataCertification", "updated_at": "1708832727", "user": "guitargeek"}