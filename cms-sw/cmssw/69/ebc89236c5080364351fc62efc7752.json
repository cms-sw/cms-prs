{"additions": 286, "auther_ref": "dev_SiPixelFEDChannelContainerMapWeigthed", "auther_sha": "db7d86ed502b1a2189ee66819b3381eabd646944", "author": "mmusich", "body": "#### PR description:\r\n\r\nThe main goal of this PR is to add the class `SiPixelFEDChannelContainerMapWeigthed` to `SiPixelFEDChannelContainer` Payload Inspector plugin (this is done in commit  b03913c32ada263af5d113c8d2dd7c4babb2b6b1).\r\nThis class displays an aggregate map of the masked components for all scenarios included in the examined payload, weighted on the probability per PU unit from a `SiPixelQualityProbabilities` payload (assuming a flat PU profile in the range encoded in  `SiPixelQualityProbabilities`).\r\nThe `SiPixelQualityProbabilities` tag comes from user input and is retrieved via a local `cond::persistency::Session` opened in the production database.\r\nThis is useful, because without combining the information from both `SiPixelStatusScenariosRcd` and `SiPixelStatusScenarioProbabilityRcd` it is not possible *a priori* to determine the fraction of events in which a given ROC will be masked when the [bad FED channel simulation](https://indico.cern.ch/event/823473/contributions/3444523/attachments/1851561/3039790/trackerDPG_27052019.pdf) is used (as it will be in the 2022 and 2023 physics MC).\r\nAdditionally I add a standalone testing script (in commit db7d86ed502b1a2189ee66819b3381eabd646944) and add this class to the pre-existing unit test script of this package (in commit f06968ca5a81f4f6c43075a8fc0e17a3dd1751a9).\r\nA possible extension to supply provision for a user-input list of PU weights (to make it even more adherent to actual full simulation process) is envisaged, but let for a follow-up PR.\r\n\r\n#### PR validation:\r\n\r\nThis PR passes unit tests of the involved package: `scram b runtests`\r\nAdditionally I tested the code with this command:\r\n\r\n```bash\r\ngetPayloadData.py \\\r\n    --plugin pluginSiPixelFEDChannelContainer_PayloadInspector \\\r\n    --plot plot_SiPixelBPixFEDChannelContainerWeightedMap \\\r\n    --tag SiPixelStatusScenarios_StuckTBMandOther_2023_v2_mc \\\r\n    --input_params '{\"SiPixelQualityProbabilitiesTag\": \"SiPixelQualityProbabilities_2023_v2_mc\"}' \\\r\n    --time_type Run \\\r\n    --iovs '{\"start_iov\": \"1\", \"end_iov\": \"1\"}' \\\r\n    --db Prod \\\r\n    --test ;\r\n```\r\n\r\nand obtained the following plot:\r\n\r\n![image](https://github.com/cms-sw/cmssw/assets/5082376/6cd536af-29c1-43f0-834f-61a0e8644e72)\r\n\r\n#### If this PR is a backport please specify the original PR and why you need to backport that PR. If this PR will be backported please specify to which release cycle the backport is meant for:\r\n\r\nN/A\r\n\r\nCc: @tsusa ", "branch": "master", "changed_files": 3, "comments": 0, "commits": 3, "created_at": "1697293558", "deletions": 0, "labels": ["db-pending", "pending-signatures", "tests-pending", "orp-pending", "code-checks-pending", "trk"], "milestone": "CMSSW_13_3_X", "number": 43020, "release-notes": [], "review_comments": 0, "state": "open", "title": "SiPixel Payload Inspector: introduce utility to display probability-weighted `SiPixelFEDChannelContainer` contents", "updated_at": "1697293582", "user": "mmusich"}