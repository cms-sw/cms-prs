{"additions": 26, "auther_ref": "thread-limit-mss", "auther_sha": "4bb1cc611ab4358e4b6cbe803e923c3b517d3238", "author": "smorovic", "body": "### PR description:\r\nBugfix:\r\nwith `numberOfThreads = 1` it seems that there are multiple TBB threads used by the framework. In  this case, using out of bounds write is possible to vectors in `FastMonitoringService`. This patch adds check against vector size, which fixes the issue.\r\n\r\n#### PR validation:\r\n\r\nTested with HLT menu (instructions from @mmusich):\r\n```\r\nhttps_proxy=http://cmsproxy.cms:3128 hltConfigFromDB --runNumber 380466 > hlt_run380466.py\r\ncat <<@EOF >> hlt_run380466.py\r\nfrom EventFilter.Utilities.EvFDaqDirector_cfi import EvFDaqDirector as _EvFDaqDirector\r\nprocess.EvFDaqDirector = _EvFDaqDirector.clone(\r\n    buBaseDir = '/eos/cms/store/group/tsg/FOG/error_stream/',\r\n    runNumber = 380466\r\n)\r\nfrom EventFilter.Utilities.FedRawDataInputSource_cfi import source as _source\r\nprocess.source = _source.clone(\r\n    fileListMode = True,\r\n    fileNames = (\r\n    '/eos/cms/store/group/tsg/FOG/error_stream/run380466/run380466_ls0276_index000212_fu-c2b03-09-01_pid672001.raw',\r\n    #'/eos/cms/store/group/tsg/FOG/error_stream/run380466/run380466_ls0276_index000232_fu-c2b03-09-01_pid672001.raw',\r\n    #'/eos/cms/store/group/tsg/FOG/error_stream/run380466/run380466_ls0276_index000246_fu-c2b03-09-01_pid672001.raw'\r\n    )\r\n)\r\nprocess.options.wantSummary = True\r\n\r\nprocess.options.numberOfThreads = 1\r\nprocess.options.numberOfStreams = 0\r\n@EOF\r\n\r\nmkdir run380466\r\ncmsRun hlt_run380466.py &> crash_run380466.log\r\n```\r\n#### If this PR is a backport please specify the original PR and why you need to backport that PR. If this PR will be backported please specify to which release cycle the backport is meant for:\r\n\r\nBackport of #44938\r\nReason for backport: bugfix of HLT workflow (affecting at least 1-thread jobs used for testing).", "branch": "CMSSW_14_0_X", "changed_files": 1, "comments": 4, "commits": 1, "created_at": "1715195778", "deletions": 8, "labels": ["daq-pending", "pending-signatures", "tests-approved", "orp-pending"], "milestone": "CMSSW_14_0_X", "number": 44939, "release-notes": [], "review_comments": 0, "state": "open", "title": "[DAQ] range check for microstate (140X) [backport]", "updated_at": "1715206937", "user": "smorovic"}