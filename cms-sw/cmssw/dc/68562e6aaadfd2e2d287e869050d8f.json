{"additions": 99, "auther_ref": "flagAllPSWeights_from-CMSSW_11_2_0_pre5", "auther_sha": "e89c4d0592b5bdc18c66d86b288754de2ad18808", "author": "swertz", "body": "#### PR description:\r\n\r\n- Add a flag (default false) to keep all the available PS weights instead of the regular 4 (ISR/FSR x up/down), as asked by JME for their custom ntuple production. If set to true, the whole PS weight array is kept, apart from the first two entries (these correspond to either `[XWGTUP * PSweight * match_eff, XWGTUP * PSweight]` or `[PSweight * match_eff, PSweight]`, so they'll be equal to 1 most of the time after normalizing the weights by the second entry, see https://github.com/cms-nanoAOD/cmssw/pull/506). \r\n\r\n- The flag is set to true for the nanoGEN format\r\n\r\n- Add the PS weights to nanoDQM\r\n\r\n- Fix the PS weight normalization in the case where the weights are parsed according to the lumi header (see https://github.com/cms-nanoAOD/cmssw/pull/441): the PS weights should be normalized by the `Baseline` weight (assumed to be the first PS weight seen).\r\n\r\n- Add a protection for the case of empty weight arrays - fixes https://github.com/cms-nanoAOD/cmssw/issues/538\r\n\r\nNote: was originally https://github.com/cms-nanoAOD/cmssw/pull/542\r\nFYI  @camclean @alefisico\r\n\r\n#### PR validation:\r\n\r\nTested in 106X: produced nanoAOD files for TTToSemiLeptonic (2016 and 2018) and for one of the parameter scan files mentioned in https://github.com/cms-nanoAOD/cmssw/pull/441 [1].\r\n\r\n[1] /store/mc/RunIIAutumn18MiniAOD/SMS-TChiWZ_ZToLL_mZMin-0p1_mC1-325to1000_TuneCP2_13TeV-madgraphMLM-pythia8/MINIAODSIM/GridpackScan_102X_upgrade2018_realistic_v15-v1/70000/FFE78E85-6F7A-9441-8963-980A38403D1F.root", "branch": "master", "changed_files": 4, "closed_at": "1600812624", "comments": 78, "commits": 7, "created_at": "1598602637", "deletions": 56, "labels": ["analysis-approved", "code-checks-approved", "comparison-available", "fully-signed", "generators-approved", "orp-approved", "tests-approved", "xpog-approved"], "merge_commit_sha": "5cfc0ce2220fce60e031f304788d43142593e047", "merged_at": "1600812624", "merged_by": "qliphy", "milestone": "CMSSW_11_2_X", "number": 31276, "release-notes": [], "review_comments": 0, "state": "closed", "title": "NanoAOD: add flag to keep all PS weights", "updated_at": "1600956662", "user": "swertz"}