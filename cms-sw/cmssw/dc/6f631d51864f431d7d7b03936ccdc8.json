{"additions": 79, "auther_ref": "addGlobalCacheDeepFlavorJetTagsProducer", "auther_sha": "292f7ac7cea4b2941db662094c5792720eea727a", "author": "wddgit", "body": "ormance\r\n\r\nigprof profiles showed this module was taking significant\r\ntime at startup, mostly as it reads the configuration file\r\nused to initialize its neural network (lots of memory\r\nchurn also, around 150 MB per stream). Without the\r\nGlobalCache, the startup time is proportional to the number\r\nof streams. This change moves the LightweightNeuralNetwork\r\ninto the global cache so there is only one and the initialization\r\ntime is no longer proportional to the number of streams.\r\nLightweightNeuralNetwork is supposed to be thread safe\r\nto use in this manner.\r\n\r\nSome other minor cleanup also.\r\n\r\nThe intent is that after merging this PR the module will give\r\nidentical results as before. I tested simply by putting in print\r\nstatements for the output of the neural network and also all\r\nthe parameter values I moved around. Then I compared the\r\noutput before and after in a runTheMatrix test that runs it (25.0).\r\nAll was identical. I also ran under igprof and verified the initialization\r\ntime is now constant and not proportional to the number of streams.\r\n\r\n", "branch": "master", "changed_files": 1, "comments": 10, "commits": 1, "created_at": "1523039019", "deletions": 53, "labels": ["code-checks-approved", "comparison-available", "fully-signed", "orp-pending", "reconstruction-approved", "tests-approved"], "milestone": "CMSSW_10_2_X", "number": 22886, "release-notes": [], "review_comments": 0, "state": "open", "title": "Add GlobalCache to DeepFlavourJetTagsProducer to improve startup perf", "updated_at": "1523058850", "user": "wddgit"}