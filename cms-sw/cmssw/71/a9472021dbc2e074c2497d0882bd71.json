{"additions": 106, "auther_ref": "SpeedConvForHLT", "auther_sha": "7d901a96c555924b5865f673edbfe2d446fecc47", "author": "VinInn", "body": "Pixel Digi and Cluster conversion to legacy is the most time consuming part of Patatrack workflow.\r\nPIxel Digis are not consumed by any reco producer: only validation and DQM.\r\n\r\nHere we introduce the ability to not produce Digis collections\r\n\r\nsetting\r\n```\r\nprocess.siPixelDigisClustersPreSplitting.produceDigis = False\r\n```\r\nwill not produce the digi collection\r\nsetting\r\n```\r\nprocess.siPixelDigisClustersPreSplitting.storeDigis = False\r\n```\r\nwill produce an empty digi collection\r\n\r\n\r\nperformance\r\n\r\nrelease\r\n```\r\nTimeReport   0.016412     0.016412     0.016412  siPixelDigisClustersPreSplitting\r\n```\r\n\r\nthis PR with ```storeDigis = False```\r\n```\r\nTimeReport   0.012385     0.012385     0.012385  siPixelDigisClustersPreSplitting\r\n```\r\n\r\ncorresponding to a global 15% increase in throughput.\r\n\r\nat the moment the option \r\n```\r\nprocess.siPixelDigisClustersPreSplitting.produceDigis = False\r\n```\r\ndoes not work out of the box as it is not \"Heterogeneous compatible\"\r\n(on CPU we run the legacy localreco)\r\nand will produce the error\r\n\r\n```\r\n----- Begin Fatal Exception 26-Jun-2021 17:48:54 CEST-----------------------\r\nAn exception of category 'Configuration' occurred while\r\n   [0] Constructing the EventProcessor\r\nException Message:\r\nEDAlias parameter set mismatch\r\nThere are no products of type 'PixelDigiedmDetSetVector'\r\nwith module label 'siPixelDigisClustersPreSplitting'.\r\n----- End Fatal Exception -------------------------------------------------\r\n```\r\n\r\ntook the opportunity to improve performances in few other places.\r\n\r\n\r\nPurely technical, no regression expected. (option is off by default)\r\n\r\n\r\n\r\n", "branch": "master", "changed_files": 7, "closed_at": "1625055606", "comments": 22, "commits": 9, "created_at": "1624715808", "deletions": 56, "labels": ["code-checks-approved", "core-approved", "fully-signed", "orp-approved", "reconstruction-approved", "tests-rejected"], "merge_commit_sha": "b14673a5016d68681cdd7b731e20885ac829fc74", "merged_at": "1625055606", "merged_by": "cmsbuild", "milestone": "CMSSW_12_0_X", "number": 34259, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Make PixelDigi conversion to legacy optional", "updated_at": "1625056258", "user": "VinInn"}