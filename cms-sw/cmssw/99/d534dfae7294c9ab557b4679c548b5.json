{"additions": 860, "auther_ref": "CMSSW_14_0_X_httNanoAddons", "auther_sha": "bef9e1715774942f3d91e891cb34921d2e3d14a8", "author": "mbluj", "body": "#### PR description:\r\n\r\nThis PR adds a customization to add lepton time-life related information to NanoAOD. The information contains:\r\n* (refitted) secondary vertex for 3-prong taus (with covariance matrix),\r\n* impact parameter vector (with significance) of the electron, muon and tau tracks wrt PV fitted with beam-spot constraint,\r\n* parameters of electron, muon and tau tracks (with covariance matrix),\r\n* primary vertex with beam-spot constraint (position and covariance matrix).\r\n\r\nAll those variables are used in the measurement of CP structure of the Higgs-tau Yukawa coupling and related analyses, e.g. measurement of polarization of Z in decays to taus.\r\n\r\nTechnically all lepton time-life variables are stored in a newly introduced data-format `TrackTimeLifeInfo` produced by a new producer `PATLeptonTimeLifeInfoProducer`  (a template class instantiated for `pat::Electron`, `pat::Muon` and `pat::Tau`) and then added by an instance of simple table producer. The PV with BS information is stored with a new instance (for `reco::Vertex`) of a simple table producer.\r\nIn the case of Run-2 input samples the PV with the BS constraint is produced with a custom producer (`PATRefitVertexProducer`) with miniAOD inputs (a new `reco::Vertex` collection with one item) as vertices with BS are not available in those samples.\r\n\r\nIn case a given new variable is not computed, e.g. SV for 1-prong taus or variables for a lepton is not passing selection, zeros are stored which are then effectively compressed in an output file.\r\n\r\n\r\n#### PR validation:\r\n\r\nValidated using 2022 and 2018 TTbar samples with customized default NanoAOD workflow obtained as follows:\r\n```\r\ncmsDriver.py --python_filename NanoAOD_lifeTimeCustom_cfg.py --eventcontent NANOAODSIM --customise_commands=\"process.add_(cms.Service('InitRootHandlers',EnableIMT = cms.untracked.bool(False)));process.MessageLogger.cerr.FwkReport.reportEvery=1000\" --datatier NANOAODSIM --fileout file:NanoAOD_lifeTimeCustom.root --conditions auto:phase1_2018_realistic --step NANO:@LepTimeLife --filein file:some_ttbar2018file.root --era Run2_2018,run2_nanoAOD_106Xv2 --no_exec --mc -n -1\r\n```\r\nAdded variables increase size of NanoAOD by ~8.5% (wrt 14_0_0_pre1 default) which is distributed between taus (~3%), electrons and muons (~2% each) and PV with BS (~1%)\r\nIn the current setup the variables are added to default workflow with `LepTimeLife` customization defining extended NANO step like this ` --step NANO:@LepTimeLife`.\r\n\r\nPresentation at the XPOG meeting: [link](https://indico.cern.ch/event/1352781/#10-lepton-life-time-in-nano)\r\n\r\n#### If this PR is a backport please specify the original PR and why you need to backport that PR. If this PR will be backported please specify to which release cycle the backport is meant for:\r\n\r\n<!-- Please replace this text with any link to the master PR, or the intended backport release cycle numbers -->\r\n\r\nIt is foreseen to backport to 14_0_X. \r\n", "branch": "master", "changed_files": 12, "comments": 36, "commits": 7, "created_at": "1702032832", "deletions": 10, "labels": ["reconstruction-approved", "pending-signatures", "tests-approved", "orp-pending", "code-checks-approved", "xpog-pending", "tracking"], "milestone": "CMSSW_14_1_X", "number": 43525, "release-notes": [], "review_comments": 48, "state": "open", "title": "Lepton time-life info for NanoAOD", "updated_at": "1708493514", "user": "mbluj"}