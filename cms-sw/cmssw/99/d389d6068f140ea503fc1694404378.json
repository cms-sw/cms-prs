{"additions": 4, "auther_ref": "egRun3SavedHcalHitsFix_1100pre13", "auther_sha": "6dfe29fa50e5c57b726f8654e94c7ec744d98d2c", "author": "Sam-Harper", "body": "#### PR description:\r\n\r\nThis bug fix for Run3 MC / data enables the proper saving of HCAL rec-hits for the barrel. The current threshold is 0.8 GeV which is not appropriate for the phaseI HB.   This adjusts the rec-hits e/gamma saves to have a minimum energy of 0.1 for phaseI HB workflows.  Thanks to @swagata87 for raising the issue!\r\n\r\nThis fix would be needed for the upcoming Run3 production, the samples will be sigificantly less useful for e/gamma without it as it wouldnt allow us to develop Hcal depth based variables in the barrel. \r\n\r\n#### PR validation:\r\n\r\nThis will increase the AOD and miniAOD sizes for workflows with the phaseI HB detector. \r\n\r\nThis was done with 200 TTbar events with standard pileup. \r\n\r\nsample: /RelValTTbar_14TeV/CMSSW_11_0_0_pre13-PU_110X_mcRun3_2023_realistic_v6-v1/GEN-SIM-DIGI-RAW\r\nreco config cmsDriver: \r\n```\r\ncmsDriver.py step3 --conditions auto:phase1_2021_realistic -n 10 --era Run3 --eventcontent RECOSIM,AODSIM,MINIAODSIM --runUnscheduled -s RAW2DIGI,L1Reco,RECO,RECOSIM,EI,PAT --datatier GEN-SIM-RECO,AODSIM,MINIAODSIM --geometry DB:Extended --io RecoFull_2021.io --python RecoFull_2021.py --conditions=110X_mcRun3_2023_realistic_v6 --no_exec --filein /store/relval/CMSSW_11_0_0_pre13/RelValTTbar_14TeV/GEN-SIM-DIGI-RAW/PU_110X_mcRun3_2023_realistic_v6-v1/20000/C27EA1AE-ADDB-3149-9867-6ABE5F653A97.root --fileout file:ttbar.root --nThreads 8\r\n```\r\n\r\nsize increases (via ls) for 200 events:\r\nAOD: 138061572 -> 138231541 (0.1% increase)\r\nMiniAOD: 20615277 -> 20496350. (0.6% increase)\r\n\r\nIn miniAOD:\r\nHBHERecHitsSorted_reducedEgamma_reducedHBHEHits_RECO  compressed size 1236 -> 1830 (50% increase)\r\n\r\nSome of this size increase could be reduced (probably by 1/3) by properly applying the depth specific thresholds of 0.1,0.2,0.3,0.3 but this needs c++ changes to do so. \r\n\r\nred is energy of rec-hits saved before fix, blue is after, behaves as expected.\r\n\r\n![image](https://user-images.githubusercontent.com/5021403/72083147-9968fd80-3301-11ea-87f7-519948370a4e.png)\r\n", "branch": "master", "changed_files": 1, "closed_at": "1578904717", "comments": 15, "commits": 1, "created_at": "1578582080", "deletions": 0, "labels": ["code-checks-approved", "comparison-available", "fully-signed", "orp-approved", "reconstruction-approved", "tests-approved"], "merge_commit_sha": "5d2511d75762a8ee25d6be8466f4f70900c65e4d", "merged_at": "1578904717", "merged_by": "cmsbuild", "milestone": "CMSSW_11_1_X", "number": 28723, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Fixing HB thresholds E/gamma saved rec-hits for run3 ", "updated_at": "1578904718", "user": "Sam-Harper"}