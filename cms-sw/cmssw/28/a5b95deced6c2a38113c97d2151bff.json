{"additions": 21, "auther_ref": "sistripcalcosmics_NANOEDMAOD", "auther_sha": "f35446221bffb8ad3b6c5cd6eb4fd18f52a6e819", "author": "pieterdavid", "body": "#### PR description:\r\n\r\nAfter the first attempt https://github.com/cms-sw/cmssw/pull/34985 failed at the merging step in the CMSSW_12_1_0_pre3 relvals ([hypernews](https://hypernews.cern.ch/HyperNews/CMS/get/relval/15942.html), [log](https://cms-unified.web.cern.ch/cms-unified/report/pdmvserv_RVCMSSW_12_1_0_pre3RunCosmics2021__RelVal_2021GR5_210921_144932_6110)) we learned (see also discussion with the Tier0 [CMSTZ-937](https://its.cern.ch/jira/browse/CMSTZ-937) and [dmwm](https://mattermost.web.cern.ch/cms-o-and-c/channels/dmwm) teams) that the workflow should produce NANOEDMAOD (nanoaod::FlatTable etc.), and the conversion to flat trees for NANOAOD is done in the merging step in the production system.\r\nHence this PR reverts the changes to ConfigBuilder from https://github.com/cms-sw/cmssw/pull/34985 (which changed the output module for ALCARECO skims with NANOAOD data tier), since this is not needed (to facilitate local testing I added a customise method, such that cmsDriver with `--customise=CalibTracker/SiStripCommon/customiseAlCaNano.flatSiStripCalCosmicsNano` directly produces the flat trees, as before).\r\nThis should at least stop the failing merge of the outputs in the relvals, although the conversion to flat trees when merging may need some more changes in the production system (I left `dataTier=\"NANOAOD\"` in the [FilteredStream config](https://github.com/cms-sw/cmssw/blob/e99fe4b3b8919db12e17fb76ad7f12f34bbbb64a/Configuration/StandardSequences/python/AlCaRecoStreams_cff.py#L452-L459), anticipating that the same mechanism may be used as for physics skims, which seems to get the dataTier from the CMSSW config in [dmwm.DMCore.StdBase.determineOutputModules](https://github.com/dmwm/WMCore/blob/c05f7999c2c1345b61f29202d3d45e701e76f248/src/python/WMCore/WMSpec/StdSpecs/StdBase.py#L204-L234)).\r\n\r\n#### PR validation:\r\n\r\nTested one of the runTheMatrix workflows that contain this (138.1), and converted to flat tree with the config from `Configuration/DataProcessing/test/RunMerge.py --input-files file:SiStripCalCosmicsNano.root --mergeNANO`\r\n\r\nCC: @mmusich @FlorianBury @mdelcourt @robervalwalsh @tsusa @connorpa @tvami @malbouis @mariadalfonso @gouskos @davidlange6 @amaltaro", "branch": "master", "changed_files": 2, "closed_at": "1633039617", "comments": 13, "commits": 1, "created_at": "1632987261", "deletions": 9, "labels": ["alca-approved", "operations-approved", "fully-signed", "tests-approved", "orp-approved", "code-checks-approved"], "merge_commit_sha": "9479fb632a43ab91551dde5e96a4a223e284c16f", "merged_at": "1633039617", "merged_by": "cmsbuild", "milestone": "CMSSW_12_1_X", "number": 35483, "release-notes": [], "review_comments": 0, "state": "closed", "title": "SiStripCalCosmicsNano ALCANANO: produce NANOEDMAOD", "updated_at": "1633039617", "user": "pieterdavid"}