{"additions": 30, "auther_ref": "HcalDQM-fixZDCinOfflineDQM", "auther_sha": "83c82f283f29e73eabcd7ea904591b569d3ce4eb", "author": "lwang046", "body": "#### PR description:\r\n\r\nFix the issue raised [here](https://cms-talk.web.cern.ch/t/fast-track-validation-hlt-express-new-hcal-electronicsmap-condition/29957/6) due to PR #42895  \r\n\r\nIn the [HCAL offline DQM monitoring](https://tinyurl.com/yklptro9) we have a special set of plots that monitors per crate information. The monitoring elements can be different for HB/HE/HO/HF, thus for each crate we try to determine its HcalDetId component from [here](https://github.com/cms-sw/cmssw/blob/master/DQM/HcalTasks/src/DigiRunSummary.cc#L153-L154). This leads to issue without HcalDetId protection when including ZDC crates from the new emap. \r\n\r\nFor now the ZDC crate is protected against. The future developers could add its monitoring (will take way to much time for this fix).\r\n\r\n#### PR validation:\r\n\r\nrunTheMatrix.py didn't reveal this problem before. And the previous DQM validations only involve online DQM clients. I manually tested the bug and the fix running over the problem revealing file: \"root://eoscms.cern.ch//eos/cms/tier0/store/express/HIRun2023A/StreamExpressCosmics/DQMIO/Express-v1/000/374/579/00000/1BAA5049-8AA5-49AF-AEC6-2BFED4B05269.root\"\r\n\r\nOffline DQM validation tests should be done to test this PR.\r\n\r\n```c++\r\nfrom Configuration.AlCa.GlobalTag import GlobalTag\r\nprocess.GlobalTag.globaltag = '132X_dataRun3_Express_RecoverHcalEmap_v1'\r\n\r\nprocess.GlobalTag.toGet = cms.VPSet(\r\n  cms.PSet(record = cms.string(\"HcalElectronicsMapRcd\"),\r\n           tag = cms.string(\"HcalElectronicsMap_2023_v1.0_data\"),\r\n           connect = cms.string(\"frontier://FrontierProd/CMS_CONDITIONS\")\r\n          )\r\n)\r\n\r\n# Path and EndPath definitions\r\nprocess.dqmsave_step = cms.Path(process.DQMSaver)\r\n\r\n# Schedule definition\r\nprocess.schedule = cms.Schedule(process.dqmHarvesting,process.dqmsave_step)\r\n``` \r\n", "branch": "master", "changed_files": 3, "closed_at": "1696187376", "comments": 10, "commits": 1, "created_at": "1696160956", "deletions": 0, "labels": ["dqm-approved", "fully-signed", "tests-approved", "orp-approved", "urgent", "code-checks-approved", "hcal"], "merge_commit_sha": "bff1812a780db0c72a1134cc2f91e15f716324dd", "merged_at": "1696187376", "merged_by": "cmsbuild", "milestone": "CMSSW_13_3_X", "number": 42919, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Hcal DQM: Fix the ZDC illegal cast in HCAL offline DQM", "updated_at": "1696187376", "user": "lwang046"}