{"additions": 350, "auther_ref": "AlignmentTracksFromVertexSelector_v2", "auther_sha": "dca3267bd7267d8ff5374a9fe5857757f6020eeb", "author": "mmusich", "body": "#### PR description:\r\n\r\nThis is a follow-up of PR https://github.com/cms-sw/cmssw/pull/33709.\r\nIn order to perform the checks discussed [here](https://indico.cern.ch/event/992964/contributions/4340538/) and [here](https://indico.cern.ch/event/1025492/contributions/4343121/attachments/2235708/3789275/mm_ZMMVertex_PPDGeneral_29Apr2021.pdf), it has been necessary to use `RECO` data-tier to have the necessary event products to be able to refit at the same time the di-lepton tracks and the tracks making up the primary vertex.\r\nGiven the relative scarcity of `RECO` files to perform these kind of checks as a mandatory step during the Tracker Alignment procedure we devise here a new ALCARECO flavor called `ALCARECOTkAlDiMuonAndVertex` which saves into its event content both the two inner tracks of a muon building a Z candidate (`ALCARECOTkAlDiMuon`) and the tracks used to be build the hardest Primary Vertex in the event (along with the pixel and strip clusters associated to them to be able to run the track refit, `ALCARECOTkAlDiMuonVertexTracks`).\r\nThis is achieved by using a new `ObjectSelectorStream` called `AlignmentTracksFromVertexSelector` capable of selecting the tracks associated to a given PV (its order in the list can be passed as configuration parameter) or by automatically finding the closest one in 3D distance to the transient vertex built with the di-muon tracks.\r\nThis selector could be used in principle in future also to save tracks from peripheral events (@connorpa).\r\n\r\n#### PR validation:\r\n\r\nPrivate tests with the following command.\r\n\r\n```bash\r\n cmsDriver.py -s RAW2DIGI,RECO,ALCA:TkAlDiMuonAndVertex \\\r\n    --conditions auto:run2_data \\\r\n    --eventcontent=ALCARECO \\\r\n    --datatier ALCARECO \\\r\n    -n 1000 \\\r\n    --era Run2_2018 \\\r\n    --python_filename=TkAlDiMuonAndVertex_2018B.py \\ \r\n    --filein=root://cms-xrd-global.cern.ch//store/data/Run2018B/DoubleMuon/RAW/v1/000/318/816/00000/3E73C278-597A-E811-8717-FA163E16A836.root \\\r\n    --nThreads=8\r\n```\r\nThe event content is as follows:\r\n\r\n```bash\r\nFile TkAlDiMuonAndVertex.root Events 110\r\nBranch Name | Average Uncompressed Size (Bytes/Event) | Average Compressed Size (Bytes/Event) \r\nrecoTrackExtras_ALCARECOTkAlDiMuonVertexTracks__RECO. 6291.6 5025.35\r\nrecoVertexs_offlinePrimaryVertices__RECO. 23379.5 4396.91\r\nTrackingRecHitsOwned_ALCARECOTkAlDiMuonVertexTracks__RECO. 25440.5 3447.66\r\nrecoTracks_ALCARECOTkAlDiMuonVertexTracks__RECO. 8630.86 3343.08\r\nSiStripClusteredmNewDetSetVector_ALCARECOTkAlDiMuonVertexTracks__RECO. 6872.22 3021\r\nSiPixelClusteredmNewDetSetVector_ALCARECOTkAlDiMuonVertexTracks__RECO. 3951.76 1712.9\r\nEventProductProvenance 4019.22 1595.84\r\nrecoVertexsedmAssociation_offlinePrimaryVertices__RECO. 3054.23 936.5\r\nrecoTrackExtras_ALCARECOTkAlDiMuon__RECO. 798.1 650.655\r\nrecoTracks_ALCARECOTkAlDiMuon__RECO. 975.818 539.791\r\nSiStripClusteredmNewDetSetVector_ALCARECOTkAlDiMuon__RECO. 838.036 441.891\r\nSiPixelClusteredmNewDetSetVector_ALCARECOTkAlDiMuon__RECO. 577.909 388.164\r\nTrackingRecHitsOwned_ALCARECOTkAlDiMuon__RECO. 2304.71 358.964\r\nintedmValueMap_offlinePrimaryVertices__RECO. 2883.53 272.082\r\nfloatedmValueMap_offlinePrimaryVertices__RECO. 240.891 183.155\r\nDcsStatuss_scalersRawToDigi__RECO. 195.282 129.391\r\nL1AcceptBunchCrossings_scalersRawToDigi__RECO. 210.173 90.0909\r\nedmTriggerResults_TriggerResults__HLT. 1435.2 88.8\r\nEventAuxiliary 139.427 39.6091\r\nL1GlobalTriggerReadoutRecord_gtDigis__RECO. 95.3273 26.0091\r\nedmTriggerResults_TriggerResults__RECO. 101.491 25.5\r\nEventSelections 78.6455 4.77273\r\nBranchListIndexes 27.7364 3.71818\r\n```\r\nOn 1000 event of input taken from 2018B RAW data, the output size is measured to be of about 41kB / event.\r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\n\r\nNot a backport, no backport needed.\r\ncc:\r\n@vbotta @antoniovagnerini ", "branch": "master", "changed_files": 13, "closed_at": "1622118697", "comments": 13, "commits": 2, "created_at": "1621350939", "deletions": 31, "labels": ["alca-approved", "code-checks-approved", "fully-signed", "operations-approved", "orp-approved", "pdmv-approved", "tests-approved", "upgrade-approved"], "merge_commit_sha": "cfbe41337d7eb1acb1aa032038770bb5862751f3", "merged_at": "1622118697", "merged_by": "cmsbuild", "milestone": "CMSSW_12_0_X", "number": 33770, "release-notes": [], "review_comments": 0, "state": "closed", "title": "[Tracker Alignment] Introduce ALCARECOTkAlDiMuonAndVertex", "updated_at": "1622118697", "user": "mmusich"}