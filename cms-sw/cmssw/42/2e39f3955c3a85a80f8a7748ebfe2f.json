{"additions": 14, "auther_ref": "from-CMSSW_12_0_X_2021-07-26-1100-CSC-trigger-partial-speedup", "auther_sha": "3b79b284909bd8d9d777f1af87185bf3ed950adf", "author": "dildick", "body": "#### PR description:\r\n\r\nIssue #34633 reports a significant slowdown in cmsRun calls in recent IBs, pointing to the startup of the CSC trigger emulator code. A large number of LUTs need to be loaded. A solution is being considered at the moment. In the mean time, I will hide certain LUTs behind if statements. LUTs are then only loaded when an expert flag is set. This should prevent these LUTs from being loaded for now:\r\n```\r\n   2160 L1Trigger/CSCTriggerPrimitives/data/CCLUT/CSCComparatorCodePatternConversionLUT_pat0_v1.txt\r\n   2161 L1Trigger/CSCTriggerPrimitives/data/CCLUT/CSCComparatorCodePatternConversionLUT_pat1_v1.txt\r\n   2160 L1Trigger/CSCTriggerPrimitives/data/CCLUT/CSCComparatorCodePatternConversionLUT_pat2_v1.txt\r\n   2160 L1Trigger/CSCTriggerPrimitives/data/CCLUT/CSCComparatorCodePatternConversionLUT_pat3_v1.txt\r\n   2160 L1Trigger/CSCTriggerPrimitives/data/CCLUT/CSCComparatorCodePatternConversionLUT_pat4_v1.txt\r\n   2160 L1Trigger/CSCTriggerPrimitives/data/CCLUT/CSCComparatorCodePosOffsetLUT_pat0_v1.txt\r\n   2161 L1Trigger/CSCTriggerPrimitives/data/CCLUT/CSCComparatorCodePosOffsetLUT_pat1_v1.txt\r\n   2160 L1Trigger/CSCTriggerPrimitives/data/CCLUT/CSCComparatorCodePosOffsetLUT_pat2_v1.txt\r\n   2160 L1Trigger/CSCTriggerPrimitives/data/CCLUT/CSCComparatorCodePosOffsetLUT_pat3_v1.txt\r\n   2160 L1Trigger/CSCTriggerPrimitives/data/CCLUT/CSCComparatorCodePosOffsetLUT_pat4_v1.txt\r\n   2161 L1Trigger/CSCTriggerPrimitives/data/CCLUT/CSCComparatorCodeSlopeLUT_pat0_v1.txt\r\n   2161 L1Trigger/CSCTriggerPrimitives/data/CCLUT/CSCComparatorCodeSlopeLUT_pat1_v1.txt\r\n   2161 L1Trigger/CSCTriggerPrimitives/data/CCLUT/CSCComparatorCodeSlopeLUT_pat2_v1.txt\r\n   2160 L1Trigger/CSCTriggerPrimitives/data/CCLUT/CSCComparatorCodeSlopeLUT_pat3_v1.txt\r\n   2162 L1Trigger/CSCTriggerPrimitives/data/CCLUT/CSCComparatorCodeSlopeLUT_pat4_v1.txt\r\n   2160 L1Trigger/CSCTriggerPrimitives/data/LCTCode/CSCLUT_code_to_bestLCT.txt\r\n   2161 L1Trigger/CSCTriggerPrimitives/data/LCTCode/CSCLUT_code_to_secondLCT.txt\r\n   2160 L1Trigger/CSCTriggerPrimitives/data/ME11/CSCLUT_wg_max_hs_ME1a.txt\r\n   2161 L1Trigger/CSCTriggerPrimitives/data/ME11/CSCLUT_wg_max_hs_ME1a_ganged.txt\r\n   2160 L1Trigger/CSCTriggerPrimitives/data/ME11/CSCLUT_wg_max_hs_ME1b.txt\r\n   2160 L1Trigger/CSCTriggerPrimitives/data/ME11/CSCLUT_wg_min_hs_ME1a.txt\r\n   2160 L1Trigger/CSCTriggerPrimitives/data/ME11/CSCLUT_wg_min_hs_ME1a_ganged.txt\r\n   2162 L1Trigger/CSCTriggerPrimitives/data/ME11/CSCLUT_wg_min_hs_ME1b.txt\r\n```\r\n\r\nGEM-CSC LUTs in folder L1Trigger/CSCTriggerPrimitives/data/GEMCSC/ are unfortunately still being loaded for each ME1/1 chamber. Other than turning off the GEM-CSC trigger itself, I don't have a prompt solution.\r\n \r\nA longer term solution may be the introduction of ESProducer and ESProduct objects for CSC lookup tables. To be discussed with CSC DPG.\r\n\r\n#### PR validation:\r\n\r\nCode compiles.\r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\n\r\n<!-- Please replace this text with any link to  -->\r\n\r\nBefore submitting your pull requests, make sure you followed this checklist:\r\n- verify that the PR is really intended for the chosen branch\r\n- verify that changes follow [CMS Naming, Coding, And Style Rules](http://cms-sw.github.io/cms_coding_rules.html)\r\n- verify that the PR passes the basic test procedure suggested in the [CMSSW PR instructions](https://cms-sw.github.io/PRWorkflow.html)\r\n", "branch": "master", "changed_files": 2, "closed_at": "1627373488", "comments": 9, "commits": 1, "created_at": "1627333378", "deletions": 18, "labels": ["code-checks-approved", "fully-signed", "l1-approved", "orp-approved", "tests-approved", "urgent"], "merge_commit_sha": "aac3a2f16caac129d34a0ad961c61c2e3250c756", "merged_at": "1627373487", "merged_by": "cmsbuild", "milestone": "CMSSW_12_0_X", "number": 34638, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Speed up the CSC trigger emulator for Run-3 and Phase-2", "updated_at": "1627373488", "user": "dildick"}