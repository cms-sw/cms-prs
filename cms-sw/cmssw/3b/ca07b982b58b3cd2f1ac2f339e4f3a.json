{"additions": 11, "auther_ref": "UpdateMigrationToDD4HepForCSCandRPCdbLoader", "auther_sha": "aab9a408e3d1eaff46753bef3101f92cf5e01232", "author": "slomeo", "body": "**PR description:**\r\n\r\nThis PR (only for CSC and RPC) is an update what I did in the PRs #32102 #32001. \r\n\r\n**PR validation:**\r\n\r\nValidation by using a dump scripts (for DDD and DD4HEP) related to CSC and RPC, not included in this PR (because they use local .mb files). Details are present in [*] at the end of this PR description.\r\n\r\nThe command used is \"cmsRun dumpCSCGeometry_DB_cfg.py\" (the same for RPC).\r\n\r\n// DDD (CSC)\r\n\r\n(0) CSCGeometryESModule  - DB recreateGeometry=true \r\nCSCGeometry found with 612 chambers\r\n\r\nChamber 0:2:ME1/b: (E:1 S:1 R:1 C:1 L:0) with 6 layers \r\n\r\nLayer 0:CSC: (E:1 S:1 R:1 C:1 L:1)\r\n\r\nLayer 1:CSC: (E:1 S:1 R:1 C:1 L:2)\r\n\r\nLayer 2:CSC: (E:1 S:1 R:1 C:1 L:3)\r\n\r\nLayer 3:CSC: (E:1 S:1 R:1 C:1 L:4)\r\n\r\nLayer 4:CSC: (E:1 S:1 R:1 C:1 L:5)\r\n\r\nLayer 5:CSC: (E:1 S:1 R:1 C:1 L:6)\r\n\r\nand so on.\r\n\r\n// DD4HEP (CSC)\r\n\r\n(0) CSCGeometryESModule  - DB recreateGeometry=true \r\nCSCGeometry found with 612 chambers\r\n\r\nChamber 0:2:ME1/b: (E:1 S:1 R:1 C:1 L:0) with 6 layers \r\n\r\nLayer 0:CSC: (E:1 S:1 R:1 C:1 L:1)\r\n\r\nLayer 1:CSC: (E:1 S:1 R:1 C:1 L:2)\r\n\r\nLayer 2:CSC: (E:1 S:1 R:1 C:1 L:3)\r\n\r\nLayer 3:CSC: (E:1 S:1 R:1 C:1 L:4)\r\n\r\nLayer 4:CSC: (E:1 S:1 R:1 C:1 L:5)\r\n\r\nLayer 5:CSC: (E:1 S:1 R:1 C:1 L:6)\r\n\r\nand so on.\r\n\r\n// DDD (RPC)\r\n\r\n(0) RPCGeometryESModule  - DB \r\nRPCGeometry found with 1056 chambers\r\n\r\nChamber 0: Re -1 Ri 2 St 1 Se 1 La 1 Su 1 Ro 0 Tr 0  with 3 rolls\r\n\r\nRoll 0: Re -1 Ri 2 St 1 Se 1 La 1 Su 1 Ro 1 Tr 0  Barrel|Endcap 0:1:0 with 32 of pitch 2.37878\r\n\r\nRoll 1: Re -1 Ri 2 St 1 Se 1 La 1 Su 1 Ro 2 Tr 0  Barrel|Endcap 0:1:0 with 32 of pitch 2.09312\r\n\r\nRoll 2: Re -1 Ri 2 St 1 Se 1 La 1 Su 1 Ro 3 Tr 0  Barrel|Endcap 0:1:0 with 32 of pitch 1.73672\r\n\r\nand so on.\r\n\r\n// DD4Hep (RPC)\r\n\r\n(0) RPCGeometryESModule  - DB \r\nRPCGeometry found with 1056 chambers\r\n\r\nChamber 0: Re -1 Ri 2 St 1 Se 1 La 1 Su 1 Ro 0 Tr 0  with 3 rolls\r\n\r\nRoll 0: Re -1 Ri 2 St 1 Se 1 La 1 Su 1 Ro 1 Tr 0  Barrel|Endcap 0:1:0 with 32 of pitch 2.37878\r\n\r\nRoll 1: Re -1 Ri 2 St 1 Se 1 La 1 Su 1 Ro 2 Tr 0  Barrel|Endcap 0:1:0 with 32 of pitch 2.09312\r\n\r\nRoll 2: Re -1 Ri 2 St 1 Se 1 La 1 Su 1 Ro 3 Tr 0  Barrel|Endcap 0:1:0 with 32 of pitch 1.73672\r\n\r\nand so on.\r\n\r\n**if this PR is a backport please specify the original PR and why you need to backport that PR:**\r\n\r\nnothing special\r\n\r\n[*]\r\n\r\nIn CMSSW_11_3_X_2021-02-15-1100 (for DDD) and CMSSW_11_3_X_2021-02-15-2300 (for DD4Hep)\r\n\r\na) In /condTools/Geom/test \r\ncp writehelp/* .\r\n\r\nb) ./createExtended2021Payload.sh 113YV8 (for DDD and 113YV9 for DD4Hep)\r\n\r\nThen I created a\r\nscript called \"dumpCSCGeometry_DB_cfg.py\" (the same for RPC) and the lines are:\r\n+++++++\r\nimport FWCore.ParameterSet.Config as cms\r\n\r\nprocess = cms.Process('DUMP')\r\n\r\nprocess.load(\"CondCore.CondDB.CondDB_cfi\")\r\nprocess.load(\"Configuration.StandardSequences.FrontierConditions_GlobalTag_cff\")\r\nprocess.load(\"FWCore.MessageLogger.MessageLogger_cfi\")\r\nprocess.load(\"Geometry.MuonNumbering.muonGeometryConstants_cff\")\r\nprocess.load(\"Geometry.CSCGeometryBuilder.cscGeometryDB_cfi\")\r\nprocess.load(\"Geometry.CSCGeometryBuilder.cscGeometryDump_cfi\")\r\n\r\nprocess.MessageLogger = cms.Service(\"MessageLogger\",\r\n    destinations = cms.untracked.vstring('myLogCSC'),\r\n    myLogCSC = cms.untracked.PSet(\r\n        threshold = cms.untracked.string('INFO'),\r\n    )\r\n)\r\n\r\nprocess.muonGeometryConstants.fromDD4Hep = True\r\nprocess.CSCGeometryESModule.applyAlignment = False \r\n\r\nfrom Configuration.AlCa.autoCond import autoCond\r\nprocess.GlobalTag.globaltag = autoCond['mc']\r\nprocess.GlobalTag.toGet = cms.VPSet(cms.PSet(record = cms.string('CSCRecoGeometryRcd'),\r\ntag = cms.string('CSCRECO_Geometry_113YV9'),\r\nconnect = cms.string(\"sqlite_file:/afs/cern.ch/user/s/slomeo/CMSSW_11_3_X_2021-02-15-1100/src/CondTools/Geometry/test/myfile.db\")))\r\n\r\nprocess.source = cms.Source('EmptySource')\r\n\r\nprocess.maxEvents = cms.untracked.PSet(\r\n    input = cms.untracked.int32(1)\r\n)\r\n\r\nprocess.p = cms.Path(process.gemGeometryDump)\r\n++++++++++++\r\n", "branch": "master", "changed_files": 3, "closed_at": "1614338818", "comments": 9, "commits": 2, "created_at": "1614232672", "deletions": 3, "labels": ["code-checks-approved", "db-approved", "fully-signed", "geometry-approved", "orp-approved", "tests-approved"], "merge_commit_sha": "7302906b9477f80aa3ce6907335f0e7451791155", "merged_at": "1614338818", "merged_by": "cmsbuild", "milestone": "CMSSW_11_3_X", "number": 32992, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Update Migration to DD4Hep for CSC and RPC db Loader", "updated_at": "1614338818", "user": "slomeo"}