{"additions": 61, "auther_ref": "pr-to-master", "auther_sha": "025526651c751359fd46c1900c0b7277cadb1900", "author": "haozturk", "body": "#### PR description:\r\n\r\nThis PR updates the REPACK process such that it is able to generate two new data tiers: `HLTSCOUT` and `L1SCOUT` in addition to `RAW`. I've updated the event content of `HLTSCOUT` and `L1SCOUT` such that they inherit their output commands from `HLTriggerRAW` and `L1TriggerRAW` respectively. Additionally, I've included the output commands of L1SCOUT and HLTSCOUT in the output module of the Repack process.\r\n\r\nI've coordinated with @drkovalskyi @germanfgv @dynamic-entropy on this work.\r\n\r\nRelated tickets: \r\n\r\n- https://its.cern.ch/jira/browse/CMSTZ-1069\r\n- https://its.cern.ch/jira/browse/CMSTRANSF-829\r\n\r\n#### PR validation:\r\n\r\nNote that I've performed these changes by using \"CMSSW_14_0_1\" as a base and I've tested them on the same release. The original branch is in [this PR](https://github.com/cms-sw/cmssw/pull/44380). I wanted to rebase my changes into upstream master and re-test, however there has been conflicts during this rebase in files that I haven't changed and don't know how to resolve. The tests I performed and showed below were done in the version that the backport PR uses as source. If anybody can show me how I can test this version, I'm happy to do so. You can find the details of the testing I've performed in the backport PR below:\r\n\r\nI used `Configuration/DataProcessing/test/RunRepack.py` for testing. I added a new option to this script\r\n\r\n```\r\n\r\n$ python3 DataProcessing/test/RunRepack.py --lfn /store/t0streamer/Data/PhysicsCommissioning/000/377/350/run377350_ls0001_streamPhysicsCommissioning_StorageManager.dat --data-tier RAW\r\nNow do:\r\ncmsRun -e RunRepackCfg.py\r\n[haozturk@lxplus802 Configuration]$ cmsRun -e RunRepackCfg.py\r\n08-Mar-2024 15:55:15 CET  Initiating request to open file root://eoscms.cern.ch//eos/cms/store/t0streamer/Data/PhysicsCommissioning/000/377/350/run377350_ls0001_streamPhysicsCommissioning_StorageManager.dat\r\n08-Mar-2024 15:55:17 CET  Successfully opened file root://eoscms.cern.ch//eos/cms/store/t0streamer/Data/PhysicsCommissioning/000/377/350/run377350_ls0001_streamPhysicsCommissioning_StorageManager.dat\r\nBegin processing the 1st record. Run 377350, Event 172727, LumiSection 1 on stream 0 at 08-Mar-2024 15:55:20.650 CET\r\nBegin processing the 2nd record. Run 377350, Event 255073, LumiSection 1 on stream 0 at 08-Mar-2024 15:55:20.739 CET\r\nBegin processing the 3rd record. Run 377350, Event 495959, LumiSection 1 on stream 0 at 08-Mar-2024 15:55:20.825 CET\r\nBegin processing the 4th record. Run 377350, Event 5487, LumiSection 1 on stream 0 at 08-Mar-2024 15:55:20.907 CET\r\nBegin processing the 5th record. Run 377350, Event 5498, LumiSection 1 on stream 0 at 08-Mar-2024 15:55:20.990 CET\r\nBegin processing the 6th record. Run 377350, Event 4244, LumiSection 1 on stream 0 at 08-Mar-2024 15:55:21.075 CET\r\nBegin processing the 7th record. Run 377350, Event 5482, LumiSection 1 on stream 0 at 08-Mar-2024 15:55:21.164 CET\r\nBegin processing the 8th record. Run 377350, Event 4232, LumiSection 1 on stream 0 at 08-Mar-2024 15:55:21.250 CET\r\nBegin processing the 9th record. Run 377350, Event 4252, LumiSection 1 on stream 0 at 08-Mar-2024 15:55:21.329 CET\r\nBegin processing the 10th record. Run 377350, Event 5499, LumiSection 1 on stream 0 at 08-Mar-2024 15:55:21.419 CET\r\n08-Mar-2024 15:55:21 CET  Closed file root://eoscms.cern.ch//eos/cms/store/t0streamer/Data/PhysicsCommissioning/000/377/350/run377350_ls0001_streamPhysicsCommissioning_StorageManager.dat\r\n[haozturk@lxplus802 Configuration]$ python3 DataProcessing/test/RunRepack.py --lfn /store/t0streamer/Data/PhysicsCommissioning/000/377/350/run377350_ls0001_streamPhysicsCommissioning_StorageManager.dat --data-tier L1SCOUT\r\nNow do:\r\ncmsRun -e RunRepackCfg.py\r\n[haozturk@lxplus802 Configuration]$ cmsRun -e RunRepackCfg.py\r\n08-Mar-2024 15:55:38 CET  Initiating request to open file root://eoscms.cern.ch//eos/cms/store/t0streamer/Data/PhysicsCommissioning/000/377/350/run377350_ls0001_streamPhysicsCommissioning_StorageManager.dat\r\n08-Mar-2024 15:55:40 CET  Successfully opened file root://eoscms.cern.ch//eos/cms/store/t0streamer/Data/PhysicsCommissioning/000/377/350/run377350_ls0001_streamPhysicsCommissioning_StorageManager.dat\r\nBegin processing the 1st record. Run 377350, Event 172727, LumiSection 1 on stream 0 at 08-Mar-2024 15:55:41.687 CET\r\nBegin processing the 2nd record. Run 377350, Event 255073, LumiSection 1 on stream 0 at 08-Mar-2024 15:55:41.760 CET\r\nBegin processing the 3rd record. Run 377350, Event 495959, LumiSection 1 on stream 0 at 08-Mar-2024 15:55:41.837 CET\r\nBegin processing the 4th record. Run 377350, Event 5487, LumiSection 1 on stream 0 at 08-Mar-2024 15:55:41.905 CET\r\nBegin processing the 5th record. Run 377350, Event 5498, LumiSection 1 on stream 0 at 08-Mar-2024 15:55:41.973 CET\r\nBegin processing the 6th record. Run 377350, Event 4244, LumiSection 1 on stream 0 at 08-Mar-2024 15:55:42.041 CET\r\nBegin processing the 7th record. Run 377350, Event 5482, LumiSection 1 on stream 0 at 08-Mar-2024 15:55:42.108 CET\r\nBegin processing the 8th record. Run 377350, Event 4232, LumiSection 1 on stream 0 at 08-Mar-2024 15:55:42.174 CET\r\nBegin processing the 9th record. Run 377350, Event 4252, LumiSection 1 on stream 0 at 08-Mar-2024 15:55:42.238 CET\r\nBegin processing the 10th record. Run 377350, Event 5499, LumiSection 1 on stream 0 at 08-Mar-2024 15:55:42.305 CET\r\n08-Mar-2024 15:55:42 CET  Closed file root://eoscms.cern.ch//eos/cms/store/t0streamer/Data/PhysicsCommissioning/000/377/350/run377350_ls0001_streamPhysicsCommissioning_StorageManager.dat\r\n[haozturk@lxplus802 Configuration]$ \r\n[haozturk@lxplus802 Configuration]$ \r\n[haozturk@lxplus802 Configuration]$ python3 DataProcessing/test/RunRepack.py --lfn /store/t0streamer/Data/PhysicsCommissioning/000/377/350/run377350_ls0001_streamPhysicsCommissioning_StorageManager.dat --data-tier HLTSCOUT\r\nNow do:\r\ncmsRun -e RunRepackCfg.py\r\n[haozturk@lxplus802 Configuration]$ cmsRun -e RunRepackCfg.py\r\n08-Mar-2024 15:56:00 CET  Initiating request to open file root://eoscms.cern.ch//eos/cms/store/t0streamer/Data/PhysicsCommissioning/000/377/350/run377350_ls0001_streamPhysicsCommissioning_StorageManager.dat\r\n08-Mar-2024 15:56:02 CET  Successfully opened file root://eoscms.cern.ch//eos/cms/store/t0streamer/Data/PhysicsCommissioning/000/377/350/run377350_ls0001_streamPhysicsCommissioning_StorageManager.dat\r\nBegin processing the 1st record. Run 377350, Event 172727, LumiSection 1 on stream 0 at 08-Mar-2024 15:56:03.414 CET\r\nBegin processing the 2nd record. Run 377350, Event 255073, LumiSection 1 on stream 0 at 08-Mar-2024 15:56:03.495 CET\r\nBegin processing the 3rd record. Run 377350, Event 495959, LumiSection 1 on stream 0 at 08-Mar-2024 15:56:03.577 CET\r\nBegin processing the 4th record. Run 377350, Event 5487, LumiSection 1 on stream 0 at 08-Mar-2024 15:56:03.656 CET\r\nBegin processing the 5th record. Run 377350, Event 5498, LumiSection 1 on stream 0 at 08-Mar-2024 15:56:03.737 CET\r\nBegin processing the 6th record. Run 377350, Event 4244, LumiSection 1 on stream 0 at 08-Mar-2024 15:56:03.818 CET\r\nBegin processing the 7th record. Run 377350, Event 5482, LumiSection 1 on stream 0 at 08-Mar-2024 15:56:03.903 CET\r\nBegin processing the 8th record. Run 377350, Event 4232, LumiSection 1 on stream 0 at 08-Mar-2024 15:56:03.984 CET\r\nBegin processing the 9th record. Run 377350, Event 4252, LumiSection 1 on stream 0 at 08-Mar-2024 15:56:04.071 CET\r\nBegin processing the 10th record. Run 377350, Event 5499, LumiSection 1 on stream 0 at 08-Mar-2024 15:56:04.160 CET\r\n08-Mar-2024 15:56:04 CET  Closed file root://eoscms.cern.ch//eos/cms/store/t0streamer/Data/PhysicsCommissioning/000/377/350/run377350_ls0001_streamPhysicsCommissioning_StorageManager.dat\r\n[haozturk@lxplus802 Configuration]$ \r\n[haozturk@lxplus802 Configuration]$ ls -l\r\ntotal 3195\r\ndrwxr-xr-x. 2 haozturk zp   4096 Mar  8 15:51 DataProcessing\r\ndrwxr-xr-x. 2 haozturk zp   4096 Mar  8 15:51 EventContent\r\n-rw-r--r--. 1 haozturk zp  14137 Mar  8 15:56 FrameworkJobReport.xml\r\n-rw-r--r--. 1 haozturk zp   8411 Mar  8 15:55 RunRepackCfg.py\r\n-rw-r--r--. 1 haozturk zp 561807 Mar  8 15:56 write_PrimDS1_HLTSCOUT.root\r\n-rw-r--r--. 1 haozturk zp 495347 Mar  8 15:55 write_PrimDS1_L1SCOUT.root\r\n-rw-r--r--. 1 haozturk zp 562065 Mar  8 15:55 write_PrimDS1_RAW.root\r\n-rw-r--r--. 1 haozturk zp 561807 Mar  8 15:56 write_PrimDS2_HLTSCOUT.root\r\n-rw-r--r--. 1 haozturk zp 495347 Mar  8 15:55 write_PrimDS2_L1SCOUT.root\r\n-rw-r--r--. 1 haozturk zp 562065 Mar  8 15:55 write_PrimDS2_RAW.root\r\n[haozturk@lxplus802 Configuration]$ edmDumpEventContent write_PrimDS1_RAW.root \r\nType                      Module                   Label     Process   \r\n-----------------------------------------------------------------------\r\nGlobalObjectMapRecord     \"hltGtStage2ObjectMap\"   \"\"        \"HLT\"     \r\nedm::TriggerResults       \"TriggerResults\"         \"\"        \"HLT\"     \r\ntrigger::TriggerEvent     \"hltTriggerSummaryAOD\"   \"\"        \"HLT\"     \r\nFEDRawDataCollection      \"rawDataCollector\"       \"\"        \"LHC\"     \r\n[haozturk@lxplus802 Configuration]$ edmDumpEventContent write_PrimDS1_L1SCOUT.root \r\nType                     Module               Label     Process   \r\n------------------------------------------------------------------\r\nFEDRawDataCollection     \"rawDataCollector\"   \"\"        \"LHC\"     \r\n[haozturk@lxplus802 Configuration]$ edmDumpEventContent write_PrimDS1_HLTSCOUT.root \r\nType                      Module                   Label     Process   \r\n-----------------------------------------------------------------------\r\nGlobalObjectMapRecord     \"hltGtStage2ObjectMap\"   \"\"        \"HLT\"     \r\nedm::TriggerResults       \"TriggerResults\"         \"\"        \"HLT\"     \r\ntrigger::TriggerEvent     \"hltTriggerSummaryAOD\"   \"\"        \"HLT\"     \r\nFEDRawDataCollection      \"rawDataCollector\"       \"\"        \"LHC\"  \r\n```\r\n\r\n#### If this PR is a backport please specify the original PR and why you need to backport that PR. If this PR will be backported please specify to which release cycle the backport is meant for:\r\n\r\nBackport is https://github.com/cms-sw/cmssw/pull/44380 ", "branch": "master", "changed_files": 3, "comments": 38, "commits": 2, "created_at": "1710260094", "deletions": 8, "labels": ["operations-pending", "pending-signatures", "tests-approved", "orp-pending", "urgent", "code-checks-approved"], "milestone": "CMSSW_14_1_X", "number": 44381, "release-notes": [], "review_comments": 9, "state": "open", "title": "Make repack process be able to generate new data tiers: L1SCOUT, HLTSCOUT", "updated_at": "1710427685", "user": "haozturk"}