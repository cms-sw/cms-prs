{"additions": 224, "auther_ref": "portFrom131XTo130X_btv_puppiValueMapForMini", "auther_sha": "caf3ca4c115e7f240fe1eaedd436f3e89688b34a", "author": "nurfikri89", "body": "Backport from #40803 \r\n\r\nOriginal PR description:\r\n\r\nThe main goal of this PR is to modify several BTV Deep taggers info producers, which are used to retrieve the features of each jet , to retrieve the puppi weight for each PF candidate from a `ValueMap<float>` produced by `PuppiProducer`. The (fallback) puppi weight value is set to be `1.0` before accessing the weight from the ValueMap. If users do not set the `fallback_puppi_weight` flag to be `true` and does not specify a source for `puppi_value_map`, an exception is thrown. A new optional flag `is_weighted_jet` is introduced so that users can make specify to apply the puppi weights on the PF constituents' four-vector. The flag should be set to `true` for Puppi jets.\r\n\r\nA new function, `setupPackedPuppi()`, is defined in `PhysicsTools/PatAlgos/python/tools/jetTools.py` that can be called to setup a `PuppiProducer` instance and provides a common puppi weight ValueMap for any module which requires one.\r\n\r\n#### PR validation:\r\n- Validation plots comparing the input variables before and after the fix can be found in this JMAR meeting virtual [contribution](https://indico.cern.ch/event/1254328/#4-virtual-puppi-valuemap-compa). \r\n- passes the usual runTheMatrix test: `runTheMatrix.py -l limited -i all --ibeos`\r\n- passes JMENanoAOD workflows: `runTheMatrix.py -i all --ibeos -l 10224.15,11024.15,25202.15,11634.15`\r\n- passes reMiniAOD and reNanoAOD workflows: `runTheMatrix.py -i all --ibeos -l 1325.518,2500.312`\r\n", "branch": "CMSSW_13_0_X", "changed_files": 8, "comments": 5, "commits": 8, "created_at": "1680009204", "deletions": 51, "labels": ["reconstruction-pending", "pending-signatures", "tests-approved", "orp-pending", "xpog-pending"], "milestone": "CMSSW_13_0_X", "number": 41210, "release-notes": [], "review_comments": 0, "state": "open", "title": "[BTV] Backport of #40803 (PUPPI ValueMap-compatible Deep taggers info producers)", "updated_at": "1680020586", "user": "nurfikri89"}