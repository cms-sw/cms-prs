{"additions": 47, "auther_ref": "xrootd-openhandler-lifetime", "auther_sha": "24ff78e439602ab52e30000456e632176cfc29b7", "author": "bbockelm", "body": "Previously, the XrdFile close would not finish until the OpenHandler returned.\n\nAccordingly - if there was a random probe for new sources occurring which was taking a long amount of time (timeout is 180 seconds by default), then the XrdFile::close() call would take up to 180 seconds.  This was especially irritating as we would just throw away the results of the OpenHandler.\n\nWith this, when XrdRequestManager's destructor fires, we pass ownership of the OpenHandler object to itself.  Then, when the callback fires, the object will delete itself.\n\nNote the use of shared_ptr in XrdRequestManager::OpenHandler::GiftSelf to prevent the deletion of the object while GiftSelf is running (if the callback fires concurrently).\n\nThis allows the OpenHandler to be destroyed completely asynchronously from the XrdRequestManager, making shutdown much faster.\n", "branch": "CMSSW_7_3_DEVEL_X", "changed_files": 2, "closed_at": "1415559058", "comments": 6, "commits": 3, "created_at": "1415265903", "deletions": 15, "labels": ["comparison-pending", "core-approved", "fully-signed", "tests-pending"], "merge_commit_sha": "73e3aaf28ae1b751f2c1710fa7ede66ab1001bad", "merged_at": "1415559058", "merged_by": "nclopezo", "number": 6235, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Allow the XrdFile to close quickly", "updated_at": "1415559058", "user": "bbockelm"}