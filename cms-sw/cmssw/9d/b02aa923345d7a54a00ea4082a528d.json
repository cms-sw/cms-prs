{"additions": 108, "auther_ref": "alca-alcaBeamMonitorFix_lumiCache", "auther_sha": "d351d2483eef505816ef39fb8196b0261f720f9a", "author": "francescobrivio", "body": "#### PR description:\r\nTriggered by [this CMSTalk post](https://cms-talk.web.cern.ch/t/issues-with-alcabeammonitor-in-offline-dqm/23945) and as a follow-up of https://github.com/cms-sw/cmssw/issues/37163 and https://github.com/cms-sw/cmssw/issues/39973, @gennai and I implemented the changes suggested by @makortel in https://github.com/cms-sw/cmssw/issues/37163#issuecomment-1061301312.\r\nThe changes include:\r\n - In AlcaBeamMonitor:\r\n    - redefine (and use) the `LuminosityBlockCache`\r\n    - rename the histogram titles from \"Scalers\" to \"Online\"\r\n    - Fixed the `Event::getByToken()` try/catch block as suggested by Matti\r\n    - remove the unused `numberOfProcessedLumis_` variable\r\n    - moved the filling of `processedLumis_` to `globalEndLuminosityBlock()` and removed the obsolete `mutable` declaration\r\n- In OnlineBeamMonitor:\r\n   - redefine (and use) the `LuminosityBlockCache`\r\n    - remove the unused `numberOfProcessedLumis_` variable\r\n    - moved the filling of `processedLumis_` to `globalEndLuminosityBlock()` and removed the obsolete `mutable` declaration\r\n\r\n@makortel @mmusich please let us know what you think of these changes.\r\n\r\n#### PR validation:\r\n~We tested this with wf `138.5` which runs the full `ALCA` reco sequence in step3, using events from multiple lumisections.\r\nI'm not sure if this is the correct way to do it or if some other trick is needed to properly test this, suggestions are welcome.~\r\nSee below the discussion about testing this PR properly\r\n\r\n#### Backport:\r\nNot a backport - possible backports might be discussed later on.", "branch": "master", "changed_files": 4, "comments": 30, "commits": 2, "created_at": "1684251784", "deletions": 96, "labels": ["dqm-pending", "db-pending", "pending-signatures", "tests-pending", "orp-pending", "code-checks-approved", "tracking"], "milestone": "CMSSW_13_2_X", "number": 41700, "release-notes": [], "review_comments": 6, "state": "open", "title": "[RFC] Fix LumiCache in AlcaBeamMonitor", "updated_at": "1684391171", "user": "francescobrivio"}