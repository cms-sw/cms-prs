{"additions": 21, "auther_ref": "bugFixConsumes106X", "auther_sha": "115caeaf7273326d161a5fad9dac939710923c7f", "author": "wddgit", "body": "#### PR description:\r\n\r\nFixes 2 bugs. One causes an assert failure and the other an out\r\nof bounds read. These bugs were only introduced recently and\r\nonly in 10_6_X.  The assert occurs for ESProducers that after a\r\ncall to setWhatProduced for multiple products call setWhatProduced\r\nanother time. The out of bounds read failure occurs when\r\nesConsumes is called for multiple types of transitions (event,\r\nbeginRun, ...) in the same producer, filter, or analyzer.\r\n\r\nI am not aware of any existing code in CMSSW that actually\r\nhits these corner cases. As far as I know this will not affect the output\r\nof any existing tests.\r\n\r\n#### PR validation:\r\n\r\nModifies existing unit tests so the assert bug would now fail\r\na unit test. Modified another test to hit the out of bounds read,\r\nalthough you need valgrind to actually see it with this test, but\r\nthere is a new and more complex test coming soon in the PR\r\nthat implements concurrent IOVs that fails when the out of bounds\r\nread bug is hit. These bugs were noticed while testing the concurrent\r\nIOV PR.\r\n", "branch": "master", "changed_files": 6, "closed_at": "1556345731", "comments": 12, "commits": 1, "created_at": "1556296392", "deletions": 9, "labels": ["code-checks-approved", "comparison-available", "core-approved", "fully-signed", "orp-approved", "tests-approved"], "merge_commit_sha": "e94318b5ac44e3df84fadd5ef1dc6f7a80f60db2", "merged_at": "1556345731", "merged_by": "cmsbuild", "milestone": "CMSSW_10_6_X", "number": 26550, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Bug fixes for EventSetup consumes corner cases", "updated_at": "1556345731", "user": "wddgit"}