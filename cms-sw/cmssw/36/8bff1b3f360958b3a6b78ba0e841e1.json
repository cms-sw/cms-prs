{"additions": 14, "auther_ref": "from-CMSSW_12_0_X_2021-04-19-2300", "auther_sha": "3f2f8ceb34da1388b327743c8e13a2a7e0588347", "author": "rmanzoni", "body": "#### PR description:\r\n\r\nIn this PR we address a design problem of `PythiaFilterMultiAncestor.cc`, where charge conjugation is implicitly assumed by default for the particle under investigation\r\nhttps://github.com/cms-sw/cmssw/blob/master/GeneratorInterface/GenFilters/plugins/PythiaFilterMultiAncestor.cc#L147\r\nfor its ancestor\r\nhttps://github.com/cms-sw/cmssw/blob/master/GeneratorInterface/GenFilters/plugins/PythiaFilterMultiAncestor.cc#L122\r\n, but it is not for its daughters.\r\nhttps://github.com/cms-sw/cmssw/blob/master/GeneratorInterface/GenFilters/plugins/PythiaFilterMultiAncestor.cc#L190\r\n\r\nThe problem was noticed in some private tests and should not affect any samples produced so far using this filter (which in fact is just a limited number of samples for a specific analysis and they are not affected because in that case it was based on a Jpsi->mumu decay).\r\nHowever, a backport to 10_6 (and 11?) would be good to avoid having production releases where the filter behaves in an unintended way.\r\n\r\n\r\n#### PR validation:\r\n\r\nThe problem was noticed when using the filter to enforce D0->K-pi+ decay. \r\n```\r\nD0ToKpiFromDstFilter = cms.EDFilter(\r\n    \"PythiaFilterMultiAncestor\",\r\n    DaughterIDs     = cms.untracked.vint32 ( -321,   211), # K-, pion+ \r\n    DaughterMaxEtas = cms.untracked.vdouble( 1.e9,  1.e9),\r\n    DaughterMaxPts  = cms.untracked.vdouble( 1.e9,  1.e9),\r\n    DaughterMinEtas = cms.untracked.vdouble(-1.e9, -1.e9),\r\n    DaughterMinPts  = cms.untracked.vdouble(-1.0 , -1.0 ),\r\n    MaxEta          = cms.untracked.double ( 99.0),\r\n    MinEta          = cms.untracked.double (-99.0),\r\n    MinPt           = cms.untracked.double (-1.0),\r\n    MotherIDs       = cms.untracked.vint32 (413), # D*+\r\n    ParticleID      = cms.untracked.int32  (421) # D0\r\n)\r\n```\r\nOnly one charge combination was present, but not the cc. The fix proposed here implements the correct behaviour.\r\n\r\n\r\n", "branch": "master", "changed_files": 1, "closed_at": "1619488394", "comments": 9, "commits": 2, "created_at": "1619010594", "deletions": 1, "labels": ["code-checks-approved", "fully-signed", "generators-approved", "orp-approved", "tests-approved"], "merge_commit_sha": "c635404e7652d4581ff1dc9731e6917cf7003a91", "merged_at": "1619488394", "merged_by": "cmsbuild", "milestone": "CMSSW_12_0_X", "number": 33491, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Consider charge conjugation in decay products in PythiaFilterMultiAncestor", "updated_at": "1619488394", "user": "rmanzoni"}