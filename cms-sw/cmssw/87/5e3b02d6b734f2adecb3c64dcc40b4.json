{"additions": 31, "auther_ref": "CMSSW_12_1_0_pre5/sign1128/hcalSum", "auther_sha": "f33bdaa8be9c4aa4a3f336dbf23501b059a8988b", "author": "slava77", "body": "costs of computing HCAL isolation in egamma has increased significantly after #33666\r\n- [12_0_0_pre3](https://cms-reco-profiling.web.cern.ch/cms-reco-profiling/cgi-bin/igprof-navigator/releases/CMSSW_12_0_0_pre3/11834.21/step3/cpu_endjob/1108) has \\~0.14% of reco time in isolation\r\n- [12_0_0_pre4](https://cms-reco-profiling.web.cern.ch/cms-reco-profiling/cgi-bin/igprof-navigator/releases/CMSSW_12_0_0_pre5/11834.21/step3/cpu_endjob/27) has 8.9%\r\n    - [12_1_0_pre4](https://cms-reco-profiling.web.cern.ch/cms-reco-profiling/cgi-bin/igprof-navigator/releases/CMSSW_12_1_0_pre4/11834.21/step3/cpu_endjob/28) has a similar fraction\r\n\r\nThis PR mitigates the situation by reordering the calls.\r\n\r\nHowever, a better refactoring of the code should be considered in near future. Some options are\r\n- accumulate all needed isolation types in one loop over rechits\r\n- precompute (,) of rechits in a separate producer in a `ValueMap` and use it when dR computations are needed\r\n@wrtabb @SohamBhattacharya \r\n", "branch": "master", "changed_files": 2, "closed_at": "1635949434", "comments": 16, "commits": 2, "created_at": "1635861474", "deletions": 20, "labels": ["reconstruction-approved", "fully-signed", "tests-approved", "orp-approved", "code-checks-approved"], "merge_commit_sha": "69ae98cab3e30642841a98274e2dffd708b50d43", "merged_at": "1635949434", "merged_by": "cmsbuild", "milestone": "CMSSW_12_2_X", "number": 35955, "release-notes": [], "review_comments": 0, "state": "closed", "title": "mitigate high CPU cost of HBHE hit position calculation in EgammaHcalIsolation", "updated_at": "1635949434", "user": "slava77"}