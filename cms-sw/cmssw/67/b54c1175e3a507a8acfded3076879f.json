{"additions": 6, "auther_ref": "inactive_DOHM_carriers", "auther_sha": "dd3e05d7b7861a059fb3512be6d2e2803d3b4627", "author": "ghugo83", "body": "This is to smoothen the number of volumes between DDD and DD4hep.\r\n\r\nThis removes **unnecessary extra logical volumes (DOHM carriers)**, created with DD4hep for **TIB inactive materials parts**. \r\nThis also fixes **the children physical volumes (DOHM prim / aux)**.\r\n\r\nThe extra logical volumes with DD4hep were stemming down from internal implementation of **DNamespace::addVolumeNS, which just returns the logical volume provided as argument** ( https://github.com/cms-sw/cmssw/blob/master/DetectorDescription/DDCMS/src/DDNamespace.cc#L161 ).\r\nInstead, **DDNamespace::volume binds any duplicate logical volume to the already existing one** (https://github.com/cms-sw/cmssw/blob/master/DetectorDescription/DDCMS/src/DDNamespace.cc#L208 ). \r\nHence, in DD4hep, whenever a logical volume already exists, **DDNamespace::volume should be used.**\r\n\r\nInstead, the way duplicated logical volumes are avoided in DDD is as follows.\r\nThe logical volumes are always created once only, as nodes of a graph. Whenever any existing logical volume is used for a new placement: an extra edge to the already existing logical volumes nodes is simply added, containing the placement information: https://github.com/cms-sw/cmssw/blob/master/DetectorDescription/Core/src/DDCompactViewImpl.cc#L40\r\n\r\n@civanch @cvuosalo @ianna\r\n", "branch": "master", "changed_files": 1, "closed_at": "1614222432", "comments": 8, "commits": 3, "created_at": "1614112377", "deletions": 1, "labels": ["code-checks-approved", "fully-signed", "geometry-approved", "orp-approved", "tests-approved"], "merge_commit_sha": "065a8c5b36bf9d1406767924a8624e1756d2813b", "merged_at": "1614222432", "merged_by": "cmsbuild", "milestone": "CMSSW_11_3_X", "number": 32981, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Fix Inactive DOHM carriers with DD4hep", "updated_at": "1614222432", "user": "ghugo83"}