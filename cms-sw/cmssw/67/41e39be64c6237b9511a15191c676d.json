{"additions": 23, "auther_ref": "CMSSW_11_2_X_2020-11-04-1100/sign1111/EnergyScaleCorrection", "auther_sha": "373d3267e2b2f151bc384072c6a62c1e77e5ba1c", "author": "slava77", "body": "the technical regression became more obvious after a recent update in the scale/smearing introduced in #31936. E.g. the start time of a 2018 UL re-miniAOD workflow 136.88811 went up to about 10 mins.\r\n\r\nApparently the EnergyScaleCorrection used an equivalent of a std::map implemented via a vector with repeated calls to sort during insertion, which lead to the startup time explosion\r\n\r\njob start time for wf a 2018 UL re-miniAOD workflow 136.88811 went down by about a factor of 10\r\nfrom https://slava77sk.web.cern.ch/slava77sk/reco/cgi-bin/igprof-navigator/CMSSW_11_2_X_2020-11-04-1100-orig.136.88811.step2.1.pp/9\r\nto https://slava77sk.web.cern.ch/slava77sk/reco/cgi-bin/igprof-navigator/CMSSW_11_2_X_2020-11-04-1100-sign1111.136.88811.step2.1.pp/26\r\n(the profile links are for 1 event processed).\r\n\r\nthe time cost of calling `EnergyScaleCorrection::addScale` went down by almost 4 orders of magnitude\r\nhttps://slava77sk.web.cern.ch/slava77sk/reco/cgi-bin/igprof-navigator/CMSSW_11_2_X_2020-11-04-1100-orig.136.88811.step2.1.pp/21 => \r\nhttps://slava77sk.web.cern.ch/slava77sk/reco/cgi-bin/igprof-navigator/CMSSW_11_2_X_2020-11-04-1100-sign1111.136.88811.step2.1.pp/1011\r\n", "branch": "master", "changed_files": 2, "closed_at": "1604733939", "comments": 12, "commits": 1, "created_at": "1604701896", "deletions": 42, "labels": ["code-checks-approved", "comparison-available", "fully-signed", "orp-approved", "reconstruction-approved", "tests-approved"], "merge_commit_sha": "0e39160a55766e0bb287a620e1f87af3c795a465", "merged_at": "1604733939", "merged_by": "cmsbuild", "milestone": "CMSSW_11_2_X", "number": 32053, "release-notes": [], "review_comments": 0, "state": "closed", "title": "speedup: switch EgammaTools EnergyScaleCorrection scales and smearings to use std::map", "updated_at": "1604733940", "user": "slava77"}