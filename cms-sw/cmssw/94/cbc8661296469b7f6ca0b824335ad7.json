{"additions": 283, "auther_ref": "conddb_cli_update", "auther_sha": "a72206fb4116b55f9d1cf3ae56cf0807663e1e46", "author": "mmusich", "body": "#### PR description:\r\n\r\nThe purpose of this PR is to add few useful functionalities to the `conddb` command line interface I used over the years and IMHO are missing from the current tool. \r\nThey used to live as separate scripts in this repo (https://github.com/cms-AlCaDB/AlCaTools), but I think it would be more beneficial to distribute them via `cmssw` for wider usage.\r\n\r\nTwo new commands are added:\r\n   -  `conddb listParentTags`: allows to list all tags that contain a given payload hash. Takes the payload hash as argument;\r\n   -  `conddb diffGlobalTagsAtRun` : allows to compile the difference in terms of payloads for a pair of Global Tags, but comparing it **at a given run-number** (so eliminating all the spurious difference due to different tag names, but having actual same palyoads on a given IoV, etc.). This in my opinion is particularly useful when performing release validation and / or data certification, because the end-user - very frequently -would like to know what are the differences in terms of conditions between two Global Tags in data, but only for the run which is currently under examination.\r\n  \r\n#### PR validation:\r\n\r\nAfter compiling and `env`-ing the environment, I've run successfully the new commands, e.g.:\r\n\r\n```\r\n$ conddb listParentTags 475738753d337409cc87e5f1cbf93b2f21be59f3\r\n[2021-02-02 18:50:40,952] INFO: Connecting to pro [frontier://PromptProd/CMS_CONDITIONS]\r\n+------------------------------------------+--------+-----------------------------------------------+------------+---------------------+\r\n|                   hash                   | since  |                      tag                      |   synch    |    insertion time   |\r\n+------------------------------------------+--------+-----------------------------------------------+------------+---------------------+\r\n| 475738753d337409cc87e5f1cbf93b2f21be59f3 | 324063 |    SiStripApvGain_FromParticles_GR10_v1_hlt   |    hlt     | 2018-10-04 15:35:47 |\r\n| 475738753d337409cc87e5f1cbf93b2f21be59f3 | 324063 |  SiStripApvGain_FromParticles_GR10_v1_express |  express   | 2018-10-04 15:35:47 |\r\n| 475738753d337409cc87e5f1cbf93b2f21be59f3 |   1    |        SiStripApvGain2_v1_hltvalidation       | validation | 2018-10-04 12:00:20 |\r\n| 475738753d337409cc87e5f1cbf93b2f21be59f3 | 323790 | SiStripApvGain_FromParticles_GR10_v11_offline |  offline   | 2019-09-19 12:44:10 |\r\n| 475738753d337409cc87e5f1cbf93b2f21be59f3 | 323790 | SiStripApvGain_FromParticles_GR10_v12_offline |  offline   | 2019-10-25 16:37:43 |\r\n+------------------------------------------+--------+-----------------------------------------------+------------+---------------------+\r\n```\r\n\r\n```\r\n$ conddb diffGlobalTagsAtRun -R 106X_dataRun2_v24 -T 106X_dataRun2_v26 --run 324077\r\n[2021-02-02 14:18:12,466] INFO: Connecting to pro [frontier://PromptProd/CMS_CONDITIONS]\r\nRun 324077  |Start time 2018-10-04 21:59:31.619000  |End time 2018-10-05 02:56:29.293000 .\r\nreference GT ( 106X_dataRun2_v24 ) snapshot:  2019-09-23 13:27:29  | target GT ( 106X_dataRun2_v26 ) snapshot 2020-01-13 16:24:57\r\n+---------------------------+--------+----------------------------------------------+------------------------------------------+\r\n|             /             |        |              106X_dataRun2_v24               |            106X_dataRun2_v26             |\r\n+---------------------------+--------+----------------------------------------------+------------------------------------------+\r\n|           Record          | label  |                Reference Tag                 |                Target Tag                |\r\n+---------------------------+--------+----------------------------------------------+------------------------------------------+\r\n| EcalTimeCalibConstantsRcd |   -    | EcalTimeCalibConstants_Run1_Run2_v02_offline |  EcalTimeCalibConstants_UL_Run1_Run2_v1  |\r\n|                           |        |   3b4a9f66b6f04a012f1a05a936d2b7f3fde55e7a   | 2b2757b28dc60c778cd2ccb493f5caf65a74a392 |\r\n+---------------------------+--------+----------------------------------------------+------------------------------------------+\r\n|      HcalRespCorrsRcd     | bugged |          HcalRespCorrs_v6.3_offline          |                                          |\r\n|                           |        |   04fb1bac77722d2b1a7d9761796854dfbc36877d   |                                          |\r\n+---------------------------+--------+----------------------------------------------+------------------------------------------+\r\n```\r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\n\r\nNot a backport, no backport needed.\r\n\r\nI am tagging also AlCa conveners as these tools might (or might not) be useful in their everyday work (especially when compiling differences of Global Tags for Relvals for PdmV):\r\ncc:\r\n@christopheralanwest @tlampen @francescobrivio \r\n", "branch": "master", "changed_files": 1, "closed_at": "1612423263", "comments": 26, "commits": 1, "created_at": "1612285293", "deletions": 0, "labels": ["code-checks-approved", "db-approved", "fully-signed", "orp-approved", "tests-approved"], "merge_commit_sha": "ea40acbd40ce9a3a1cb7fad36656a4366e0afc3d", "merged_at": "1612423263", "merged_by": "cmsbuild", "milestone": "CMSSW_11_3_X", "number": 32795, "release-notes": [], "review_comments": 1, "state": "closed", "title": "Some additions to the conddb command line interface", "updated_at": "1612423263", "user": "mmusich"}