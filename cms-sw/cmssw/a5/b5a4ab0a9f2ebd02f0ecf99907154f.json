{"additions": 1, "auther_ref": "120X-fix-ls-assert", "auther_sha": "60bebb8110c348cfaccca3d5febb375a6c67c19f", "author": "smorovic", "body": "#### PR description:\r\n\r\nFix a crash caused by the missing luminosityBlockAuxiliary object, seen in rare instances at the start of run in production DAQ/HLT.\r\n\r\nA race can happen because the local file lock is unlocked before lsToStart is determined.\r\nSince this check involves stat calls for marker files locally, another competing process can in parallel create\r\nthe EoL marker file being checked (and cause lsToStart to be increased\r\nabove LS of the newly opened file).\r\n\r\nIn case lsToStart is larger than ls, source would skip opening a lumisection\r\nbefore ending up processing events and this results in the lumi block\r\nrelated assertion.\r\n\r\n\r\n#### PR validation:\r\n\r\nTested in DAQ filterfarm test system (Openstack VMs). A special test mode was constructed to emulate conditions of crash and find a fix.\r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\n\r\nBackport of: #35682\r\n", "branch": "CMSSW_12_0_X", "changed_files": 1, "comments": 3, "commits": 1, "created_at": "1634248552", "deletions": 1, "labels": ["reconstruction-pending", "daq-pending", "pending-signatures", "tests-approved", "orp-pending"], "milestone": "CMSSW_12_0_X", "number": 35683, "release-notes": [], "review_comments": 0, "state": "open", "title": "DAQ fix spurious luminosityBlockAuxiliary assertion in HLT (12_0_X)", "updated_at": "1634260688", "user": "smorovic"}