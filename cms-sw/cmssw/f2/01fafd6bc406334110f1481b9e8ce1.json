{"additions": 127, "auther_ref": "pps_DQMUpdatePlots_lg", "auther_sha": "fad0cf1125eec842ab7eeddfa7ca6b68c3ef1e3a", "author": "CTPPS", "body": "#### PR description:\r\n\r\nThis PR provides fix for the wrongly produced plot of correlation between tracks in PPS timing detectors (for 220cyl and 220nr_hr). Fixed plot looks like this:\r\n![image](https://github.com/cms-sw/cmssw/assets/7374733/9a3ba509-5e67-482b-8974-0acab23abe38)\r\n\r\nPrevious code contained bug related to assignment of a track to given pot.\r\n\r\nThe code as well includes several cosmetic adjustment of the plot binning and titles.\r\n\r\nMoreover leading and trailing edge plots were added to \"per place\" plot group.\r\n\r\n#### PR validation:\r\n\r\nManually running script which produced DQM plot from the PromptReco ZeroBias files sample `/store/data/Run2024B/ZeroBias/AOD/PromptReco-v1` for run for run 379154 :\r\n\r\n```python\r\nfrom Configuration.Eras.Era_Run3_cff import Run3\r\n\r\nprocess = cms.Process('RECODQM', Run3)\r\n\r\n# command  line options\r\nimport FWCore.ParameterSet.VarParsing as VarParsing\r\noptions = VarParsing.VarParsing ('analysis')\r\noptions.inputFiles= 'file:input.root'\r\noptions.maxEvents = -1 \r\noptions.parseArguments()\r\n\r\nprocess.maxEvents = cms.untracked.PSet(\r\n    input = cms.untracked.int32(options.maxEvents)\r\n)\r\n\r\nprocess.verbosity = cms.untracked.PSet( input = cms.untracked.int32(-1) )\r\n\r\n# minimum of logs\r\nprocess.MessageLogger = cms.Service(\"MessageLogger\",\r\n    cerr = cms.untracked.PSet(\r\n        threshold = cms.untracked.string('INFO')\r\n    )\r\n)\r\n\r\n# import of standard configurations\r\nprocess.load('Configuration.StandardSequences.Services_cff')\r\nprocess.load('FWCore.MessageService.MessageLogger_cfi')\r\nprocess.load('Configuration.EventContent.EventContent_cff')\r\nprocess.load('Configuration.StandardSequences.FrontierConditions_GlobalTag_cff')\r\n\r\n# load DQM framework\r\nprocess.load(\"DQM.Integration.config.environment_cfi\")\r\nprocess.dqmEnv.subSystemFolder = \"CTPPS\"\r\nprocess.dqmEnv.eventInfoFolder = \"EventInfo\"\r\nprocess.dqmSaver.path = \"\"\r\nprocess.dqmSaver.tag = \"CTPPS\"\r\n\r\n# raw data source\r\nprocess.source = cms.Source(\"PoolSource\",\r\n    fileNames = cms.untracked.vstring(cms.untracked.vstring(options.inputFiles)),\r\n)\r\n\r\nfrom Configuration.AlCa.GlobalTag import GlobalTag\r\nprocess.GlobalTag = GlobalTag(process.GlobalTag, 'auto:run3_data', '')\r\n\r\n# local RP reconstruction chain with standard settings\r\nprocess.load(\"RecoPPS.Configuration.recoCTPPS_cff\")\r\n\r\nprocess.load(\"DQM.Integration.config.FrontierCondition_GT_cfi\")\r\n\r\n# CTPPS DQM modules\r\nprocess.load(\"DQM.CTPPS.ctppsDQM_cff\")\r\nprocess.ctppsDiamondDQMSource.excludeMultipleHits = cms.bool(True)\r\nprocess.ctppsDiamondDQMSource.plotOnline = cms.untracked.bool(True)\r\nprocess.ctppsDiamondDQMSource.plotOffline = cms.untracked.bool(True)\r\nprocess.path = cms.Path(\r\n    process.ctppsDQMCalibrationSource*\r\n    process.ctppsDQMCalibrationHarvest\r\n)\r\n\r\nprocess.end_path = cms.EndPath(\r\n    process.dqmEnv +\r\n    process.dqmSaver\r\n)\r\n\r\nprocess.schedule = cms.Schedule(\r\n    process.path,\r\n    process.end_path\r\n)\r\n```\r\n\r\n", "branch": "master", "changed_files": 1, "closed_at": "1714747162", "comments": 13, "commits": 5, "created_at": "1713954955", "deletions": 59, "labels": ["dqm-approved", "fully-signed", "tests-approved", "bug-fix", "orp-approved", "code-checks-approved", "ctpps"], "merge_commit_sha": "919ae75c27e8ded862c92d04f7c68fe5fe0b4aaf", "merged_at": "1714747162", "merged_by": "cmsbuild", "milestone": "CMSSW_14_1_X", "number": 44835, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Update and fix of DQM plots for PPS timing detectors", "updated_at": "1715075119", "user": "grzanka"}