{"additions": 1305, "auther_ref": "CMSSW_10_6_X_tau-pog_DeepTau2017v2", "auther_sha": "77ac4c5d2980269e5f2d1d5a5a1b607fc19a5e79", "author": "cms-tau-pog", "body": "#### PR description:\r\n\r\nThis PR updates DeepTauID to version 2017v2. The new version, thanks to revised structure of used DNN, fixes issues of version 2017v1 that is a size of training files and memory consumption are greatly reduced. Possibility to run previous version is maintained.\r\n\r\nDeepTauID (2017v2) is added to the tau sequence in the standard MiniAOD workflow.\r\n\r\nPerformance with 1k ttbar events:\r\n* size of three training files: 2.9+0.85+0.85=4.6MiB (was 21MiB in 2017v1);\r\n* memory consumption: on top of DeepJet: 6.4MiB or 21.5 MiB standalone. The difference between the two comes mainly from executing `pat::PackedCandidate::dzError()` method which triggers unpacking of track covariance matrix and at smaller extend from initialization of TensorFlow. Full information on memory usage from IGProf can be accessed at this link: http://mdidomen.web.cern.ch/mdidomen/cgi-bin/igprof-navigator/changes_PR_126/DeepTau_memory_usage/;\r\n* CPU timing: \r\n   * Full timing of a simple test workflow is 0.11s/event with DeepTauId::getPredictions 0.088s/event; details at at http://mdidomen.web.cern.ch/mdidomen/cgi-bin/igprof-navigator/changes_PR_126/DeepTauCPU_TT;\r\n    * Full timing of miniAOD workflow is 1.06s/event with DeepTauId::getPredictions 0.082s/event; details at http://mdidomen.web.cern.ch/mdidomen/cgi-bin/igprof-navigator/changes_PR_126/DeepTau_MiniAOD.\r\n\r\nIn addition the new v2 training overperforms (physics-result-wise) old v1 one as well as other TauIDs, details in slides:\r\n* https://indico.cern.ch/event/816162/contributions/3408556/attachments/1835352/3007877/2019-04-29_DeepTau_ID_v2_developments.pdf\r\n* https://indico.cern.ch/event/818643/contributions/3422014/attachments/1839253/3014630/2019-05-06_DeepTau_ID_v2_WP.pdf\r\n\r\n**Note 1:** this PR is meant to be backported to 10_6_X for UL processing and to 10_2_X for using with current Run-2 samples.\r\n**Note 2:** this PR is completed by PR to cms-data https://github.com/cms-data/RecoTauTag-TrainingFiles/pull/3 which needs to be propagated to cms-dist.\r\n**Note 3:** DeepTau 2017v2 is added to MiniAOD workflow with 11_0_X and 10_6_X (UL), while not in the backport to 10_2_X.\r\n\r\n#### PR validation:\r\n\r\nValidated with matrix tests; requires https://github.com/cms-data/RecoTauTag-TrainingFiles/pull/3 for unit tests\r\n\r\n#### if this PR is a backport please specify the original PR:\r\n\r\nN/A", "branch": "master", "changed_files": 8, "closed_at": "1560096182", "comments": 120, "commits": 59, "created_at": "1557992884", "deletions": 125, "labels": ["analysis-approved", "code-checks-approved", "comparison-available", "fully-signed", "orp-approved", "reconstruction-approved", "requires-external", "simulation-approved", "tests-approved"], "merge_commit_sha": "bddb9ab2f390c701ad9e78808bf590d14976245f", "merged_at": "1560096182", "merged_by": "cmsbuild", "milestone": "CMSSW_11_0_X", "number": 26796, "release-notes": [], "review_comments": 15, "state": "closed", "title": "Update of DeepTauID to ver. 2017v2", "updated_at": "1560096182", "user": "mbluj"}