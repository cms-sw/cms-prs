{"additions": 20, "auther_ref": "PFIso_NanCheck", "auther_sha": "20aa664f26437a1ae65550f64d08361490598aae", "author": "swagata87", "body": "#### PR description:\r\n\r\nThis PR proposes to add a NaN-check on PF candidate's pT, before accepting that candidate for photon's isolation calculation. \r\n\r\nIt was found, as discussed in this github issue (https://github.com/cms-sw/cmssw/issues/39110), that in some rare cases, PF candidate's pT/eta/phi is `-nan`, and this leads to photon's PF-based isolation to be `-nan` as well. The patch provided in this PR will bypass that problem for photons, and photon's isolation sum will return a meaningful value. \r\n\r\nIn recent data (`2022C`, `EGamma` dataset) in Run `355872`, Event `546279379`, LumiSection `508`, \r\nwithout this PR: photon's `chargedHadronIso=-nan`\r\nwith this PR: photon's `chargedHadronIso=0.683148`\r\nThis is checked with these files:\r\nminiAOD: `/store/data/Run2022C/EGamma/MINIAOD/PromptReco-v1/000/355/872/00000/035b7e72-7f0d-42c8-98c7-d0a5100211fe.root`\r\nRAW: `/store/data/Run2022C/EGamma/RAW/v1/000/355/872/00000/3b478527-d206-4b8e-8004-08e9aff7758b.root`\r\nand, `eventsToProcess = cms.untracked.VEventRange('355872:546279379-355872:546279379')`\r\n\r\nIt was checked that similar `nan` issues in MC, discussed in the github issue (https://github.com/cms-sw/cmssw/issues/39110), are also fixed with this patch, as expected.\r\n\r\nNote: we have not found any instance of electron's PFChargedHadIso being nan. Until now, the issue happened only for photons.\r\n\r\n#### PR validation:\r\n`runTheMatrix.py -l 11834.0`\r\n\r\nThis PR is not a backport.\r\nSince the issue seem to be happening also in prompt reco data, a backport to current data-taking release cycle (12_4_X) might be helpful, to have meaningful PF isolation values of reconstructed photons, in all events. \r\n", "branch": "master", "changed_files": 1, "closed_at": "1661431030", "comments": 26, "commits": 6, "created_at": "1660985372", "deletions": 10, "labels": ["reconstruction-approved", "fully-signed", "tests-approved", "orp-approved", "code-checks-approved", "egamma"], "merge_commit_sha": "8ac417db512adda0095f8f85bf630297b6428a19", "merged_at": "1661431030", "merged_by": "cmsbuild", "milestone": "CMSSW_12_5_X", "number": 39120, "release-notes": [], "review_comments": 10, "state": "closed", "title": "Do NaN-check before accepting a PF candidate for computing photon's isolation", "updated_at": "1661431031", "user": "swagata87"}