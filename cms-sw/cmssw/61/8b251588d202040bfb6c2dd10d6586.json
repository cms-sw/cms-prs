{"additions": 3077, "auther_ref": "MPI_updates", "auther_sha": "bb50fbd64f96bea589bdac6966b15393cc051ea1", "author": "fwyzard", "body": "The PR description needs to be updated to reflect the recent developments.\r\n\r\n#### PR description:\r\n\r\nLet multiple CMSSW processes on the same or different machines coordinate event processing and transfer data products over MPI.\r\n\r\nThe implementation is based on four CMSSW modules.\r\nTwo are responsible for setting up the communication channels and coordinate the event processing:\r\n  - a \"remote controller\" called `MPIController`\r\n  - a \"remote source\" called `MPISource`\r\n\r\nand two are responsible for the transfer of data products:\r\n  - a \"sender\" called `MPISender`\r\n  - a \"receiver\" called `MPIReceiver`\r\n\r\n.\r\n\r\n![image](https://github.com/user-attachments/assets/ee8a8b7c-67a9-425f-ba88-1053bcd80a73)\r\n\r\nThe `MPIController` is an `EDProducer` running in a regular CMSSW process. After setting up the communication with an `MPISource`, it transmits to it all EDM run, lumi and event transitions, and instructs the `MPISource` to replicate them in the second process.\r\n\r\nThe `MPISource` is a `Source` controlling the execution of a second CMSSW process. After setting up the communication with an `MPIController`, it listens for EDM run, lumi and event transitions, and replicates them in its process.\r\n\r\nBoth `MPIController` and `MPISource` produce an `MPIToken`, a special data product that encapsulates the information about the MPI communication channel.\r\n\r\nThe `MPISender` is an `EDProducer` that can read one or more collections from the Event, serialise them using their ROOT dictionaries, and send them over the MPI communication channel.\r\n\r\nThe `MPIReceiver` is an `EDProducer` that can receive a set number of collections over the MPI communication channel, deserialise them using their ROOT dictionaries, and put them in the Event with a configurable instance label.\r\n\r\nIn principle any non-transient collection with a ROOT dictionary can be transmitted. Any transient information is lost during the transfer, and needs to be recreated by the receiving side.\r\n\r\nEach `MPISender` and `MPIReceiver` is configured with an instance value that is used to match one `MPISender` in one process to one `MPIReceiver` in another process. Using different instance values allows the use of multiple `MPISenders`/`MPIReceivers` in a process.\r\n\r\nBoth `MPISender` and `MPIReceiver` obtain the MPI communication channel reading an `MPIToken` from the event. They also produce a copy of the `MPIToken`, so other modules can consume it to declare a dependency on the previous modules.\r\n\r\nA few unit tests are included in the `test/` directory.\r\n\r\n\r\n#### PR validation:\r\n\r\nThese development have been extensively validated using the Run 3 HLT menu as a test case, and the results have been presented: https://indico.cern.ch/event/1557810/contributions/6560443/. \r\n\r\nThe new unit tests pass.\r\n\r\n\r\n#### Backport\r\n\r\nTo be backported to 16.0.x for testing online in parallel to the 2026 data taking.", "branch": "master", "changed_files": 30, "closed_at": "1769244377", "comments": 213, "commits": 1, "created_at": "1610412286", "deletions": 0, "labels": ["fully-signed", "tests-approved", "orp-approved", "code-checks-approved", "heterogeneous-approved", "changes-dataformats", "ngt"], "merge_commit_sha": "e9b86c631d4acfeede3ed1890337ba3b73ca30af", "merged_at": "1769244377", "merged_by": "cmsbuild", "milestone": "CMSSW_16_1_X", "number": 32632, "release-notes": [], "review_comments": 11, "state": "closed", "title": "Extend CMSSW to a distributed application over MPI", "updated_at": "1769244378", "user": "fwyzard"}