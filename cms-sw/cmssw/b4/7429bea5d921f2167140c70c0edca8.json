{"additions": 506, "auther_ref": "Phase1-DbHardcode1", "auther_sha": "e13eead16402f6ddc933fc358d01436dba81bc2b", "author": "kpedro88", "body": "This PR modifies HcalHardcodeConditions and HcalDbHardcode to make basic parameters configurable using Python. This change is intended to aid reconstruction development for the 2017 HF and HE upgrades, respectively: dual anode readout with QIE10 and SiPMs with QIE11 and increased depth segmentation.\n\n**NB**: Nothing should change in existing workflows, because the hardcode conditions are only used for development.\n\nElements of this PR:\n1. New class HcalHardcodeParameters (modeled after HcalSimParameters), currently contains pedestal, pedestal width, gain, gain width, QIE type, QIE offsets (range 0-3), QIE slopes (range 0-3)\n2. HcalDbHardcode now a class (instead of a namespace)\n3. Fixed any HcalDbHardcode dependencies accordingly (or removed unnecessary includes, in one case deleted an unused piece of code after [discussion on HCAL CMSSW hypernews](https://hypernews.cern.ch/HyperNews/CMS/get/hcal-cmssw/175.html))\n4. Hcal_Conditions_forGlobalTag_cff has PSets for:HB, HE, HF, HO, HB upgrade, HE upgrade, HF upgrade\n5. Each subdetector can be set to Run1 or upgrade independently (testHFQIE10 mixed case still available)\n6. Run1 parameters based on dump of DB conditions from 7_6_3 (GT auto:run2_mc) + HcalQIEData_NormalMode_v7.05_mc for QIEData (newer tag)\n7. SiPM lumi offset and pedestal width lumi dependence parameters also now configurable (may be supplanted by new noise & raddam models in the future)\n8. Added a customization function customise_HcalPhase0p5 (\"Phase 0.5\"). Currently this enables QIE10 digitization for all HF cells, but keeps Run1 conditions for HE (SiPM + QIE11 not ready yet).\n\nI've tested the 2017 mode in CMSSW_8_1_X_2016-03-29-2300 with customise_HcalPhase0p5 and the Extended2017dev geometry, which has HF depths 3/4 and HE depths up to 7. I used the following script:\n\n```\n#!/bin/bash\n\n cmsDriver.py SinglePiE50HCAL_pythia8_cfi  --conditions auto:phase1_2017_design -n 10 --era Run2_2017 --geometry \"Configuration.Geometry.GeometryExtended2017dev_cff,Configuration.Geometry.GeometryExtended2017devReco_cff\" --eventcontent FEVTDEBUG -s GEN,SIM --datatier GEN-SIM --beamspot Realistic50ns13TeVCollision --fileout file:step1.root --customise SLHCUpgradeSimulations/Configuration/HCalCustoms.customise_HcalPhase0p5 > step1_SinglePiE50_UP15+SinglePiE50_UP15+DIGIUP15+RECOUP15+HARVESTUP15.log  2>&1\n\n\n cmsDriver.py step2  --conditions auto:phase1_2017_design -s DIGI:pdigi_valid,L1,DIGI2RAW,HLT:@relval25ns --datatier GEN-SIM-DIGI-RAW-HLTDEBUG -n 10 --era Run2_2017 --geometry \"Configuration.Geometry.GeometryExtended2017dev_cff,Configuration.Geometry.GeometryExtended2017devReco_cff\" --eventcontent FEVTDEBUGHLT --filein file:step1.root  --fileout file:step2.root --customise SLHCUpgradeSimulations/Configuration/HCalCustoms.customise_HcalPhase0p5 > step2_SinglePiE50_UP15+SinglePiE50_UP15+DIGIUP15+RECOUP15+HARVESTUP15.log  2>&1\n\n\n cmsDriver.py step3  --runUnscheduled  --conditions auto:phase1_2017_design -s RAW2DIGI,L1Reco,RECO,EI,PAT --datatier GEN-SIM-RECO,MINIAODSIM -n 10 --era Run2_2017 --geometry \"Configuration.Geometry.GeometryExtended2017dev_cff,Configuration.Geometry.GeometryExtended2017devReco_cff\" --eventcontent RECOSIM,MINIAODSIM --filein file:step2.root  --fileout file:step3.root --customise SLHCUpgradeSimulations/Configuration/HCalCustoms.customise_HcalPhase0p5 > step3_SinglePiE50_UP15+SinglePiE50_UP15+DIGIUP15+RECOUP15+HARVESTUP15.log  2>&1\n\n\n cmsDriver.py step4  --runUnscheduled  --conditions auto:phase1_2017_design -s VALIDATION:@standardValidation+@miniAODValidation,DQM:@standardDQM+@miniAODDQM --datatier GEN-SIM-RECO,MINIAODSIM,DQMIO -n 10 --era Run2_2017 --geometry \"Configuration.Geometry.GeometryExtended2017dev_cff,Configuration.Geometry.GeometryExtended2017devReco_cff\" --eventcontent RECOSIM,MINIAODSIM,DQM --filein file:step3.root  --fileout file:step4.root --customise SLHCUpgradeSimulations/Configuration/HCalCustoms.customise_HcalPhase0p5 > step4_SinglePiE50_UP15+SinglePiE50_UP15+DIGIUP15+RECOUP15+HARVESTUP15.log  2>&1\n```\n\nThe DIGI and RECO steps both actually succeed, though with some errors that need to be resolved. Validation/DQM fail, which is why I moved them to a separate step.\n", "branch": "CMSSW_8_1_X", "changed_files": 13, "closed_at": "1460548315", "comments": 47, "commits": 9, "created_at": "1459288988", "deletions": 886, "labels": ["alca-approved", "comparison-available", "db-approved", "fully-signed", "orp-approved", "simulation-approved", "tests-approved"], "merge_commit_sha": "f9c8c0dbe574310e66f5deb983b6dc303c4ae1b1", "merged_at": "1460548315", "merged_by": "cmsbuild", "milestone": "Next CMSSW_8_1_X", "number": 13861, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Configurable hardcode conditions for HCAL", "updated_at": "1460548316", "user": "kpedro88"}