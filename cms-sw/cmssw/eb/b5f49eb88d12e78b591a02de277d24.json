{"additions": 1451, "auther_ref": "tensorflow2", "auther_sha": "a0fd1e20d4e5c702098ab952692f67394575ae63", "author": "riga", "body": "This PR provides changes to the PhysicsTools/TensorFlow interface to support TensorFlow 2.1.\r\n\r\nIt should be tested with ~https://github.com/cms-sw/cmsdist/pull/5427~  https://github.com/cms-sw/cmsdist/pull/5525.\r\n\r\nAs documented in https://github.com/cms-sw/cmsdist/pull/5427#issuecomment-567589830 , one of the tests (AOT compilation) currently fails. It requires a change to the`--entry_point` argument in the [cmssw-config/SCRAM/GMake/Makefile.dnn](https://github.com/cms-sw/cmssw-config/blob/4d6cd0fef1e12ae9f3e4a4cd5fda0917a940e085/SCRAM/GMake/Makefile.dnn#L42) build rule, which - as far as I can see - is no longer allowed to start with two underscores as of 2.0 (@smuzaffar). The [WIP] label can be removed once this is settled. All other tests pass.\r\n\r\nThe changes solely focus on 2.0 compatibility and thus target CPU support only. GPU support is planned and will be subject to a future PR, which will also contain features to simplify device placement and working with GPU memory (in coordination with the Patatrack team).\r\n\r\nSmaller changes:\r\n- Added `PhysicsTools/TensorFlow/python/tools.py` to aid graph reading and writing.\r\n- Updated `DQMServices/Core/src/ROOTFilePB.pb.{cc,h}` for the new protobuf version (via ``protoc --cpp_out=`pwd` ROOTFilePB.proto``).\r\n\r\nEdit: Performance comparison of the DeepJet model (from https://github.com/cms-sw/cmssw/pull/28711#issuecomment-581931722 below, using [testDeepJetPerformance.cc](https://gist.github.com/riga/5cb64ff74bc1c051b0be77c29df9daab)):\r\n\r\n![TF vs. ONNX](https://www.dropbox.com/s/2yhyywqg4jfrkpv/deepjet_perf_log_div.png?raw=1)\r\n\r\n", "branch": "master", "changed_files": 31, "closed_at": "1582705181", "comments": 127, "commits": 14, "created_at": "1578303082", "deletions": 4251, "labels": ["analysis-approved", "code-checks-approved", "comparison-available", "dqm-approved", "fully-signed", "orp-approved", "reconstruction-approved", "requires-external", "tests-approved"], "merge_commit_sha": "2c13f14b9b55153ebdcfe26435d0bc6e7c107361", "merged_at": "1582705181", "merged_by": "cmsbuild", "milestone": "CMSSW_11_1_X", "number": 28711, "release-notes": [], "review_comments": 6, "state": "closed", "title": "Support for TensorFlow 2.1", "updated_at": "1582705182", "user": "riga"}