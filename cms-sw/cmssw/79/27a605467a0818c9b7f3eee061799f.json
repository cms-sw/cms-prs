{"additions": 1, "auther_ref": "120_fixIsData", "auther_sha": "44b7e47e5ac782c9ac7404f3bfd4034e47ef4ed6", "author": "srimanob", "body": "#### PR description:\r\nWhen neither `--data` nor `--mc` is used, cmsDriver will consider if the job should be data or MC using\r\nhttps://github.com/cms-sw/cmssw/blob/CMSSW_12_0_0_pre3/Configuration/Applications/python/cmsDriverOptions.py#L214-L235\r\nand then print out.\r\n\r\nHowever, when it considers a job as data, `options.isData` is not set. Some config, i.e. NanoAOD,\r\nhttps://github.com/cms-sw/cmssw/blob/CMSSW_12_0_0_pre3/Configuration/Applications/python/ConfigBuilder.py#L1705\r\nwill need `options.isData` to be defined. If not MC customization will be picked.\r\n\r\nThis bug was shown in the NanoV9 pilot sample,\r\nhttps://cms-unified.web.cern.ch/cms-unified/report/pdmvserv_Run2018C_JetHT_UL2018_MiniAODv2_NanoAODv9_pilot_210617_171408_1560\r\nwith a config file in\r\nhttps://cmsweb.cern.ch/couchdb/reqmgr_config_cache/5dabb3c8610cca5485ccc25118fc5c8c/configFile\r\nshows\r\n`from PhysicsTools.NanoAOD.nano_cff import nanoAOD_customizeMC ` \r\nis used, instead of data.\r\n\r\n#### PR validation:\r\nRun cmsDriver without --mc, --data, and see if it picks up the proper NanoAOD:\r\n`cmsDriver.py RECO --conditions 106X_dataRun2_v35 --customise Configuration/DataProcessing/Utils.addMonitoring --datatier NANOAOD --era Run2_2018,run2_nanoAOD_106Xv2 --eventcontent NANOEDMAOD --filein placeholder.root --fileout file:ReReco-Run2018C-JetHT-UL2018_MiniAODv2_NanoAODv9_pilot-00001.root --nThreads 2 --no_exec --python_filename ReReco-Run2018C-JetHT-UL2018_MiniAODv2_NanoAODv9_pilot-00001_0_cfg.py --scenario pp --step NANO`\r\nwill give\r\n```\r\nWe have determined that this is real data (if not, rerun cmsDriver.py with --mc)\r\n....\r\ncustomising the process with nanoAOD_customizeData from PhysicsTools/NanoAOD/nano_cff\r\n```\r\nThis is correct. Before, it picked up MC customization.\r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\nBackport to 10_6\r\n", "branch": "master", "changed_files": 1, "closed_at": "1625817830", "comments": 11, "commits": 1, "created_at": "1625155744", "deletions": 0, "labels": ["bug-fix", "code-checks-approved", "operations-approved", "orp-approved", "pending-signatures", "tests-approved", "xpog-pending"], "merge_commit_sha": "91b871c8035018e2e89a24143d19f3ed3812dd85", "merged_at": "1625817830", "merged_by": "cmsbuild", "milestone": "CMSSW_12_0_X", "number": 34302, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Fix isData when neither --data nor --mc is used", "updated_at": "1625817830", "user": "srimanob"}