{"additions": 38, "auther_ref": "better_kernel_error_message", "auther_sha": "836572211a31b933b311685f6e7ca379ad60dabc", "author": "fwyzard", "body": "#### PR description:\r\n\r\nIf somebody tries to launch an alpaka kernel from a .cc file the error message is hard to understand, _e.g._:\r\n```\r\n/data/user/fwyzard/alpaka-test/CMSSW_13_3_0_pre4/src/HeterogeneousCore/AlpakaTest/plugins/alpaka/TestAlgo.cc:55:24:   required from here\r\n/data/cmssw/el8_amd64_gcc12/external/alpaka/develop-20230621-328794fca9695cfc66a84565d03106ee/include/alpaka/acc/AccGpuUniformCudaHipRt.hpp:277:24: error: invalid use of incomplete type 'class alpaka::TaskKernelGpuUniformCudaHipRt<alpaka::ApiCudaRt, alpaka::AccGpuUniformCudaHipRt<alpaka::ApiCudaRt, std::integral_constant<long unsigned int, 1>, unsigned int>, std::integral_constant<long unsigned int, 1>, unsigned int, alpaka_cuda_async::TestAlgoKernel, portabletest::TestSoALayout<>::ViewTemplateFreeParams<128, false, true, false>&, int, double&>'\r\n  277 |                 return TaskKernelGpuUniformCudaHipRt<\r\n      |                        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n  278 |                     TApi,\r\n      |                     ~~~~~\r\n  279 |                     AccGpuUniformCudaHipRt<TApi, TDim, TIdx>,\r\n      |                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n  280 |                     TDim,\r\n      |                     ~~~~~\r\n  281 |                     TIdx,\r\n      |                     ~~~~~\r\n  282 |                     TKernelFnObj,\r\n      |                     ~~~~~~~~~~~~~\r\n  283 |                     TArgs...>(workDiv, kernelFnObj, std::forward<TArgs>(args)...);\r\n      |                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n/data/cmssw/el8_amd64_gcc12/external/alpaka/develop-20230621-328794fca9695cfc66a84565d03106ee/include/alpaka/acc/AccGpuUniformCudaHipRt.hpp:43:11: note: declaration of 'class alpaka::TaskKernelGpuUniformCudaHipRt<alpaka::ApiCudaRt, alpaka::AccGpuUniformCudaHipRt<alpaka::ApiCudaRt, std::integral_constant<long unsigned int, 1>, unsigned int>, std::integral_constant<long unsigned int, 1>, unsigned int, alpaka_cuda_async::TestAlgoKernel, portabletest::TestSoALayout<>::ViewTemplateFreeParams<128, false, true, false>&, int, double&>'\r\n   43 |     class TaskKernelGpuUniformCudaHipRt;\r\n      |           ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n```\r\n\r\nThese changes make a more understandable error message appear instead:\r\n```\r\n/data/user/fwyzard/alpaka-test/CMSSW_13_3_0_pre4/src/HeterogeneousCore/AlpakaTest/plugins/alpaka/TestAlgo.cc:55:24:   required from here\r\n/data/user/fwyzard/alpaka-test/CMSSW_13_3_0_pre4/src/HeterogeneousCore/AlpakaInterface/interface/config.h:64:63: error: static assertion failed: You should move this files to a .dev.cc file under the alpaka/ subdirectory.\r\n   64 |     static_assert(std::is_same_v<TApi, alpaka::ApiCudaRt> and BOOST_LANG_CUDA,\r\n      |                                                               ^~~~~~~~~~~~~~~\r\n```\r\n\r\n#### PR validation:\r\n\r\nUnit tests pass (are not affected)", "branch": "master", "changed_files": 1, "comments": 7, "commits": 1, "created_at": "1698854540", "deletions": 0, "labels": ["pending-signatures", "orp-pending", "tests-started", "code-checks-approved", "heterogeneous-pending"], "milestone": "CMSSW_13_3_X", "number": 43163, "release-notes": [], "review_comments": 0, "state": "open", "title": "Improve the error message when trying to call a kernel from a .cc file", "updated_at": "1698862484", "user": "fwyzard"}