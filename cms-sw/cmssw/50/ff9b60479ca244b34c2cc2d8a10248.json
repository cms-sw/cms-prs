{"additions": 13, "auther_ref": "mm_dev_fix_phase2_alcareco_muon_selection", "auther_sha": "175abbad1a9584d0e630e06c1dee648d451f39a2", "author": "mmusich", "body": "#### PR description:\r\n\r\nWhile studying the Phase2 TkAl ALCARECO events produced in the `Phase2Fall22DRMiniAOD` campaign, a peculiar feature was noticed in the  distribution of the tracks from Z   decays selected from alignment (see [here](https://indico.cern.ch/event/1363142/contributions/5787810/attachments/2789909/4865144/cmsal_240130.pdf#page=12) for more details).\r\nUpon dedicated check at the level of ALCARECO sample, it was observed that the feature was already present in the tracks persisted in the input sample, but also in the muon tracks from W   decays . Additionally the pseudo-rapidity of tracks from muons was limited to around 2.5 while in the upgrade detector the acceptance should be extended to higher values.\r\nThese features were not observed in the tracks from MinimumBias selection:\r\n| Track   | Track   |\r\n| --- | ----------- |\r\n|  ![image](https://github.com/cms-sw/cmssw/assets/5082376/c2ac84e2-e877-4a64-8e7b-802c6583c30d) | ![image](https://github.com/cms-sw/cmssw/assets/5082376/ac32db93-31b0-4088-b74b-201be295837e) |\r\n\r\nChecking on the input muons, the reason of the -dependent inefficiency was spotted in an abnormal distribution of the muon electromagnetic relative isolation distribution as a function of the muon azimuth. This quantity is used together with the tracker and hadronic relative isolation to select the muons entering the alignment samples. For more details look at https://github.com/cms-sw/cmssw/issues/43858.\r\n\r\n https://github.com/cms-sw/cmssw/blob/f2ffd7b3c9b926a2db457de7749d4fca2183ba53/Alignment/CommonAlignmentProducer/python/TkAlMuonSelectors_cfi.py#L16\r\n\r\nAdditionally it was found that no Global Muons were available above 2.5. This is expected as a to created global muon a standalone muon fit and this is not possible with only one station. Also the number of matches in that region is nearly always 0.\r\n\r\n| Muon EG isolation | IsGlobal Muon | Muon Number of matches |   \r\n | --- | ----------- |------|\r\n | ![canvas_hIsoEmEtOverPt](https://github.com/cms-sw/cmssw/assets/5082376/8a95e826-5b72-415a-bf9f-d039dee25184) | ![canvas_hIsGlobalMuon](https://github.com/cms-sw/cmssw/assets/5082376/bdb49b82-6244-4d95-8a05-c4cd65c77e1a)  | ![canvas_hNumberOfMatches](https://github.com/cms-sw/cmssw/assets/5082376/b886920b-fd6c-4ed2-8df3-d037eef38024) |\r\n\r\nThe selections are therefore adjusted in the Phase-2 case in order to recover in efficiency, by adding a dedicated selection for the high rapidity region and to apply only the tracker relative isolation. \r\n\r\n#### PR validation:\r\n\r\nI have re-run the ALCARECO production out of the sample [*] via the following command:\r\n```bash\r\ncmsDriver.py step5 \\\r\n    -s ALCA:TkAlMuonIsolated \\\r\n    --conditions auto:phase2_realistic_T25 \\\r\n    --datatier ALCARECO \\\r\n    -n -1 \\\r\n    --eventcontent ALCARECO \\\r\n    --geometry Extended2026D98 \\\r\n    --era Phase2C17I13M9 \\\r\n    --fileout file:step5.root \\\r\n    --nThreads 4 \\\r\n    --dasquery='file dataset=/RelValSingleMuFlatPt2To100/CMSSW_14_0_0_pre2-133X_mcRun4_realistic_v1_STD_2026D98_noPU_RV229-v1/GEN-SIM-RECO'\r\n```\r\nwith and without these changes and I have obtained the [following results](http://musich.web.cern.ch/musich/display/checkPhase2AlCaRecoSamples/RECOvsALCA_fix/).\r\nIn particular the track   and tack  distributions look as expected after the fix:\r\n\r\n| Track   | Track   |\r\n| --- | ----------- |\r\n| ![image](https://github.com/cms-sw/cmssw/assets/5082376/892bd757-548a-4537-9ffa-d31bdaf158fa) |  ![image](https://github.com/cms-sw/cmssw/assets/5082376/48292e72-4dd2-423f-b019-c3a4e6581008) |\r\n\r\nAdditionally I have re-run the sequence also on a recent `RelValZMM_14` sample [*] and haven't observed adverse effects (see [link](http://musich.web.cern.ch/musich/display/checkPhase2AlCaRecoSamples/RECOvsALCA_fix_ZMuMu/).  \r\n\r\n[*] \r\n`/RelValSingleMuFlatPt2To100/CMSSW_14_0_0_pre2-133X_mcRun4_realistic_v1_STD_2026D98_noPU_RV229-v1/GEN-SIM-RECO `\r\n\r\n[**] \r\n```\r\ncmsDriver.yp stepTkAlZMuMu -s ALCA:TkAlZMuMu --conditions auto:phase2_realistic_T25 --datatier ALCARECO -n -1 --eventcontent ALCARECO --geometry Extended2026D98 --era Phase2C17I13M9 -n -1\r\n --fileout file:step5.root --nThreads 4 --dasquery=file dataset=/RelValZMM_14/CMSSW_14_0_0_pre2-133X_mcRun4_realistic_v1_STD_2026D98_noPU-v2/GEN-SIM-RECO'\r\n```\r\n\r\n#### If this PR is a backport please specify the original PR and why you need to backport that PR. If this PR will be backported please specify to which release cycle the backport is meant for:\r\n\r\nN/A", "branch": "master", "changed_files": 1, "comments": 13, "commits": 1, "created_at": "1706979579", "deletions": 0, "labels": ["alca-approved", "fully-signed", "tests-approved", "orp-pending", "code-checks-approved"], "milestone": "CMSSW_14_1_X", "number": 43859, "release-notes": [], "review_comments": 0, "state": "open", "title": "add phase2 customizations to `TkAlMuonSelectors` to increase selection efficiency", "updated_at": "1707219652", "user": "mmusich"}