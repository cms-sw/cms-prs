{"additions": 361, "auther_ref": "devel_fixUBInHLTMuonPlotter_130X", "auther_sha": "0e1ce07486b2485bfead9655bbf692e94bad86ea", "author": "missirol", "body": "backport of #40753\r\n\r\n#### PR description:\r\n\r\nFrom the description of #40753:\r\n\r\n>This PR aims to improve the plugin `HLTMuonValidator`, and its utility `HLTMuonPlotter`.\r\n>\r\n>This update was triggered by https://github.com/cms-sw/cmssw/pull/40708#issuecomment-1426337736, where it was noticed that `HLTMuonPlotter` has a bug that can lead to undefined behaviour [1].\r\n>\r\n>Further checks showed other shortcomings of `HLTMuonValidator`/`HLTMuonPlotter` (see review comments for more details); these shortcomings can lead to the DQM outputs of `HLTMuonValidator` being filled incorrectly in the current implementation. This PR tries to fix this (on top of fixing the original UB issue).\r\n>\r\n>`LogTrace` calls are added to ease debugging. In addition, technical changes to modernise both classes are applied (e.g. `const` correctness).\r\n>\r\n>Expect changes in the DQM outputs of `HLTMuonValidator` (and nowhere else).\r\n>\r\n>[1]\r\n>The value of `hltStep` becomes `(size_t) -1` when `step == 2` and `nSteps == 6`, leading to undefined behaviour in\r\n>https://github.com/cms-sw/cmssw/blob/6f5b833d1b878aa570c87d4237e638362684a7a6/HLTriggerOffline/Muon/src/HLTMuonPlotter.cc#L221\r\n>This was originally reported in #12056, but apparently not fixed back then.\r\n\r\n#### PR validation:\r\n\r\nNone beyond the checks done for #40753.\r\n\r\n#### If this PR is a backport, please specify the original PR and why you need to backport that PR. If this PR will be backported, please specify to which release cycle the backport is meant for:\r\n\r\n#40753\r\n\r\nFix to HLT offline DQM in release cycle for 2023 pp data-taking.\r\n", "branch": "CMSSW_13_0_X", "changed_files": 5, "closed_at": "1677485604", "comments": 7, "commits": 1, "created_at": "1677224525", "deletions": 294, "labels": ["dqm-approved", "fully-signed", "tests-approved", "bug-fix", "orp-approved", "backport-ok"], "merge_commit_sha": "f6406659ecf562b57dec5250f1b7d53e7e450d6e", "merged_at": "1677485604", "merged_by": "cmsbuild", "milestone": "CMSSW_13_0_X", "number": 40871, "release-notes": [], "review_comments": 0, "state": "closed", "title": "improve `HLTMuonValidator` and `HLTMuonPlotter` (no UB, consider only `HLTFilter` modules) [`13_0_X`]", "updated_at": "1677485604", "user": "missirol"}