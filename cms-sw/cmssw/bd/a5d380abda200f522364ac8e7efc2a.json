{"additions": 76, "auther_ref": "miniaodbph113X", "auther_sha": "1e8d6775481f7d148b68b7341695abee442b5d38", "author": "AdrianoDee", "body": "#### PR description:\r\n\r\n##### Look Up Table Approach for _legacy_ miniAODs\r\n\r\nThis PR introduce the possibility to extract covariance elements from a Look Up Table for packedCandidates which do not have it stored. This is done through the `fallBackTrack()` method once the `setLut (int covV)` method is used on any of the packedCandidates in the collection.\r\n\r\nThe fallBackTrack() method works similarly to bestTrack() and returns a reco::Track pointer when available. When the PackedCandidate contains the track details (covariance matrix and number of hits) this method will be exacty the same as bestTrack(). When there are no track details inside the PackedCandidate (low pt candidates in legacy miniAODs for example), this method will use a look up table to estimate the covariance matrix elements based on the candidate pt, eta and number of total and pixel hits. Since the number of total and pixel hits are not stored for candidates with no track details, they are passed as arguments of fallBackTrack(). This method will return nullptr when no track was associated at production time (e.g. candidates with no track even in AOD).\r\n\r\nBefore using fallBackTrack for the first time the static method PackedCandidate::setLut(desired_version) should be called. This method will enable the use of the LUT and force the covariance packing method version for all candidates (default is to initialize it lazily at the first candidate). The fallBackTrack method will throw if this method is not called before.\r\nIt is important that the setLut method is called with the correct version for the miniAOD we are running (what is stored in PackedCandidates with track details). \r\n\r\n@elusian\r\n\r\nThis PR is completed by and depends on cms-data/DataFormats-PatCandidates#2 which adds a new schema, called 523, which always returns the plain LUT value.\r\n\r\n#### PR Validation and Further references\r\n\r\nBPH Jamboree December 2020 [here](https://indico.cern.ch/event/979184/contributions/4148171/attachments/2163278/3650677/MiniAOD_Run3_Adriano_JamboreeDic2020.pdf)\r\n\r\nxPOG Meeting February 2021 [here](https://indico.cern.ch/event/994581/contributions/4181429/attachments/2196037/3712976/xPOG%20Run3%20MiniAOD%20BPH%20Feb2021.pdf)\r\n\r\nFurther reference [here](https://github.com/AdrianoDee/miniaodstudies/blob/main/README.md)\r\n\r\nFor a complete documentation, trk4bph meetings: [1](https://indico.cern.ch/event/983890/), [2](https://indico.cern.ch/event/975219/), [3](https://indico.cern.ch/event/968995/) , [4](https://indico.cern.ch/event/964780/), [5](https://indico.cern.ch/event/963424/), [6](https://indico.cern.ch/event/955820/)\r\n\r\n", "branch": "master", "changed_files": 2, "closed_at": "1626099062", "comments": 36, "commits": 5, "created_at": "1620142044", "deletions": 23, "labels": ["code-checks-approved", "orp-pending", "pending-signatures", "reconstruction-pending", "requires-external", "tests-approved", "xpog-pending"], "milestone": "CMSSW_12_0_X", "number": 33622, "release-notes": [], "review_comments": 3, "state": "closed", "title": "Look Up Table Approach for miniAOD packedCandidates", "updated_at": "1626099062", "user": "AdrianoDee"}