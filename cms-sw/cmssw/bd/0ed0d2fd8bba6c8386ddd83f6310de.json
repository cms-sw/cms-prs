{"additions": 390, "auther_ref": "refactorThinning", "auther_sha": "9632de8ff53675983728e878698d669fc3014041", "author": "makortel", "body": "#### PR description:\r\n\r\nThis PR is a preparatory step to introduce (constrained) support for slimming objects when performing thinning of collections, as outlined in the discussion of #30544. More specifically, this PR\r\n* Renames `ThinningProducer::fillDescription()` to `ThinningProducer::fillPSetDescription()` to follow a naming convention established elsewhere, and calls `ConfigurationDescriptions::addWithDefaultLabel()` to also generate the cfi (by @bendavid)\r\n* Changes ThinnedAssociationsHelper::vThinnedAssociationBranches_` to be always sorted instead of sorting once at the end\r\n  * When introducing the support for slimming, I'm planning to check after each insertion if the constraints for slimmed collections are still met in the hope of being able to provide easier-to-interpret error messages. This check will be more efficient if `vThinnedAssociationBranches_` is always sorted.\r\n  * The overall worst-case complexity of the insertions+sort does increase from O(n log n) to O(n^2)\r\n* Add class version for `ThinnedAssociationBranches`\r\n  * Will add a new member in a subsequent PR\r\n* Abstract the implementations of `getThinnedProduct()` and `getThinnedProducts()` in `EventPrincipal`, `DataGetterHelper`, and `BareRootProductGetter` into single functions\r\n  * Having only one implementation for each  will simplify the slimming development\r\n* Change the interface of `getThinnedProduct()` to return `WrapperBase const*` and the key to thinned collection via `std::optional` instead of the mixture of return value and output argument in the hope of making the calling code easier to understand\r\n   * makes it clear by reading the code alone when the key to thinned collection is used and when not\r\n\r\n\r\n#### PR validation:\r\n\r\nFramework unit tests pass.", "branch": "master", "changed_files": 37, "closed_at": "1596780426", "comments": 51, "commits": 11, "created_at": "1595617552", "deletions": 447, "labels": ["code-checks-approved", "comparison-available", "core-approved", "fully-signed", "orp-approved", "tests-approved"], "merge_commit_sha": "670fb4de206d15165be4a9bc18e72e3018afbd72", "merged_at": "1596780426", "merged_by": "cmsbuild", "milestone": "CMSSW_11_2_X", "number": 30906, "release-notes": [], "review_comments": 12, "state": "closed", "title": "Refactor parts of the thinning code", "updated_at": "1596780426", "user": "makortel"}