{"additions": 615, "auther_ref": "nanoaod_dev_collection_14_2_0_pre3", "auther_sha": "4245ed3bbb14c68c2f5ea1d26ee8e8224c724cd5", "author": "patinkaew", "body": "#### PR description:\r\n\r\nAdd support for adding variable-size attributes (std::vector) within objects for NanoAOD. Presented at [XPOG meeting on 13.11.2024](https://indico.cern.ch/event/1478217/#3-support-for-variable-size-va). In addition, after the presentation, lazy evaluation functionality has been added.\r\n\r\nTested mainly in context of ScoutingNano, but this functionality is generic and can be useful for any custom NanoAOD. Hence, we decided to make this PR with only variable-size attributes support in NanoAOD. For usage in ScoutingNano, we will prepare another PR later after discussion with scouting group.\r\n\r\n#### PR validation:\r\n\r\nTested with ScoutingNano (for ScoutingMuon and ScoutingElectron) with workflow 2500.227(RelValTTbar/2024/MINIAODSIM) and 2500.237 (ScoutingPFRun3/2024D/HLTSCOUT) as presented in the slide.\r\n\r\nFor lazy evaluation, test with workflow 2500.237 by setting ScoutingMuon's hitPattern variable with ```lazyEval=True```. The output step2.root looks the same as output step2.root when setting ```lazyEval=False```.\r\n\r\nPass all tests when running: ```scram b runtests use-ibeos```\r\n```\r\nPass    0s ... CommonTools/Utils/ExprEvalPopen_t\r\nPass   12s ... CommonTools/Utils/ExpressionEvaluatorUnitTest\r\nPass    7s ... CommonTools/Utils/testCommonToolsUtil\r\nPass    3s ... CommonTools/Utils/testCommonToolsUtilThreaded\r\nPass    0s ... CommonTools/Utils/testDynArray\r\nPass   17s ... CommonTools/Utils/testExpressionEvaluator\r\nPass   15s ... PhysicsTools/NanoAOD/testPhysicsToolsNanoAODTP\r\n>> Test sequence completed for CMSSW CMSSW_14_2_0_pre3\r\n```\r\n\r\nWhen running ```runTheMatrix.py -l limited -i all --ibeos```, some workflows failed due to file open errors. Tested 3 times and got the similar file open errors.\r\n```\r\n45 41 39 35 17 1 1 1 1 1 1 tests passed, 1 3 0 0 0 0 0 0 0 0 0 failed\r\n```\r\nFailed workflows are:\r\n- failed at step-0: ```312.0``` \r\n- failed at step-1: ```25202.0, 14234.0, 250202.181```\r\nwhich are all due to file open errors.\r\n\r\n#### If this PR is a backport please specify the original PR and why you need to backport that PR. If this PR will be backported please specify to which release cycle the backport is meant for:\r\n\r\nThis is not a backport and there is no plan for a backport.\r\n", "branch": "master", "changed_files": 8, "comments": 33, "commits": 4, "created_at": "1731599170", "deletions": 0, "labels": ["reconstruction-approved", "pending-signatures", "tests-approved", "orp-pending", "code-checks-approved", "xpog-pending"], "milestone": "CMSSW_15_0_X", "number": 46702, "release-notes": [], "review_comments": 2, "state": "open", "title": "Add support for adding variable-size attributes (std::vector) within objects for NanoAOD", "updated_at": "1734625431", "user": "patinkaew"}