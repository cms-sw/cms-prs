{"additions": 2003, "auther_ref": "DQMStore-set2map", "auther_sha": "091c53ea6fc9c05ce9cb6ee369e125398afa35ae", "author": "knoepfel", "body": "This PR includes many changes to the `DQMStore`, built off of PR #22614 .  I have made the following changes:\r\n\r\n- `DQMStore` no longer has global `run_` and `moduleId_` data members.  The run and module-ID numbers are now owned by the `IBooker` transactional object.\r\n- Any per-run/module histograms are booked via the `IBooker`.   To retain backwards compatibility, **I have made the assumption that all direct uses of the `DQMStore::book*` functions are intended to book global histograms.  If this assumption is incorrect, please show me the counterexamples.**\r\n- The container for storing `MonitorElement`s is no longer an `std::set` but an `std::map`.  To allow for concurrent booking, this will need to change to a concurrent unordered map.  That will be the next stage.\r\n- The duplication of `std::string const&/char const*` booking-function overloads has been replaced by a single set of functions that takes a `char_string const&` argument.  The `char_string` class has implicit constructors allowing the conversions from `char const*`, `std::string`, and `TString` types.  This cuts down drastically on the overload set.  Ideally, in C++17, we could use `std::string_view` instead--but that may be a change for another time.\r\n\r\nWith all of the above changes, and given the assumption I make about raw usage of `DQMStore::book*`, I believe there are no breaking changes.  At least, none of my local builds (including many dependent packages) have exposed any.\r\n\r\nThe next phase for concurrent booking will involve removing the global `DQMStore::pwd_` data member and introducing a proxy class to ensure synchronization of the directory between `IBooker` and `IGetter` instances.", "branch": "master", "changed_files": 6, "closed_at": "1527666427", "comments": 11, "commits": 6, "created_at": "1523561007", "deletions": 2150, "labels": ["code-checks-rejected", "comparison-pending", "dqm-pending", "orp-pending", "pending-signatures", "tests-pending"], "milestone": "CMSSW_10_2_X", "number": 22949, "release-notes": [], "review_comments": 0, "state": "closed", "title": "DQMStore preparations for concurrent booking - phase 2", "updated_at": "1527666428", "user": "knoepfel"}