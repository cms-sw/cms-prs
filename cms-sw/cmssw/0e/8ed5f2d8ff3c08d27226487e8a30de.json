{"additions": 69, "auther_ref": "charge_migration_fixes", "auther_sha": "a1a2810ea7bc57f76782144f895ccb41a1e19d3c", "author": "claralasa", "body": "#### PR description:\r\n\r\nBefore this fix, more than half of the carriers were migrated due to diffusion. This made the residuals to change their sign in the region enabled for charge migration. In addition, a factor in the evaluation of migrated charge was missing.\r\n\r\nNevertheless, these fixes are barely noticeable due to the small allowed charge migration region (0.4 um) and so **no changes in the plots are expected**. In order to visualize the effect, such a region has been tested increasing up to 5 um. Just used for this study, **the value in the code stays as 0.4 um**. In the plot below, the charge per digi is shown. As can be observed, it does not change after the fix with the baseline of 0.4um.\r\n\r\n![FixedBugs_2](https://user-images.githubusercontent.com/42370661/113015670-10481b80-917e-11eb-8e0e-abdcb9c524a2.png)\r\n\r\nThere are also some changes in the provisional validator used to cross-check the digitizer (which is not included within the validation framework).\r\n\r\nThis PR only concerns Upgrade (@duartej , @emiglior , @skinnari )\r\n\r\n#### PR validation:\r\n\r\n- Passed the runTheMatrix.py -l limited -i all --ibeos tests, don't know if they are relevant because I'm not sure if they were tested against 2026D65 geometry (or the current geometry with 3D pixels in barrel).\r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\n\r\nNo.", "branch": "master", "changed_files": 4, "closed_at": "1618905672", "comments": 22, "commits": 12, "created_at": "1617112253", "deletions": 49, "labels": ["code-checks-approved", "fully-signed", "orp-approved", "simulation-approved", "tests-approved", "upgrade-approved"], "merge_commit_sha": "dafb55d2ee66014caabcfc36104dba18240388e9", "merged_at": "1618905672", "merged_by": "cmsbuild", "milestone": "CMSSW_12_0_X", "number": 33300, "release-notes": [], "review_comments": 1, "state": "closed", "title": "[Upgrade Phase-2 Pixel 3D Digitizer] Fix misevaluation of charge when migrating due to diffusion", "updated_at": "1618905672", "user": "claralasa"}