{"additions": 1383, "auther_ref": "91X_ChannelGainThreadSafety", "auther_sha": "5b0515fa561c715cf8645eea3fdd94ec0db242ad", "author": "mmusich", "body": "The aim of this Pull Request is to streamline and make more maintainable the SiStrip G2 Gains calibration workflow chain, by splitting the codes of `CalibTracker/SiStripChannelGain/plugins/SiStripGainFromCalibTree.cc` in to two modules:\r\n   * `SiStripGainsPCLWorker` inheriting from a `DQMEDAnalyzer`, meant to fill the 2D charge vs APVId distributions needed for the cluster charge calibration by channel;\r\n   * `SiStripGainsPCLHarvester` inheriting from a `DQMEDHarvester`, meant to retrieve the distributions from the previous step, fit the cluster charge MPV values for each Strip APV and (when fulfilling sanity criteria) compute the particle level (a.k.a. G2) gains and finally store it on DB. \r\n\r\nAs a bonus, the whole chain avoids now direct thread-unsafe calls to `DQMStore` and looses inheritance on the externally maintained `CommonTools/ConditionDBWriter/` package.\r\n\r\nThe configurations of the PCL AlCaSkimming and AlCaHarvesting processes in \r\n`Calibration/TkAlCaRecoProducers/` are adjusted accordingly.\r\n\r\nThe class`SiStripGainFromCalibTree.cc` (which still makes thread unsafe calls to `DQMStore`) is therefore decommissioned from the PCL workflow and will be stripped of its unnecessary parts in a follow-up Pull Request. We foresee to maintain its calibration capabilities from calibration Trees inputs as a backup in case of failure of the central workflow.\r\n\r\nattn: @dimattia @boudoul \r\n\r\n ", "branch": "master", "changed_files": 15, "closed_at": "1493093908", "comments": 48, "commits": 10, "created_at": "1492166209", "deletions": 87, "labels": ["alca-approved", "comparison-available", "fully-signed", "orp-pending", "tests-approved"], "merge_commit_sha": "18ebae95f36863e72b016e6ec408c7a04628add1", "merged_at": "1493093908", "merged_by": "davidlange6", "milestone": "CMSSW_9_1_X", "number": 18363, "release-notes": [], "review_comments": 12, "state": "closed", "title": "[91X] Re-factoring of SiStripApvGain Prompt Calibration Loop modules", "updated_at": "1494598291", "user": "mmusich"}