{"additions": 3, "auther_ref": "fixTrendPlottingIssuePayloadInspector", "auther_sha": "e78d46e68ce820ddfda52ccb507219ae4da4bd1a", "author": "mmusich", "body": "#### PR description:\r\n\r\nIn PR https://github.com/cms-sw/cmssw/pull/32404 I introduced a modification to `CondCore/Utilities/interface/PayloadInspector.h ` in order to be able retrieve the list of dead modules in JSON format from the `SiStripDetVOff` DB record.\r\nThe setting of  `precision(0)` was meant to strip off the decimal place from the `DetId` number (stored as double), but it turns out that applying this change indiscriminately kills all the trend plotting for quantities stored as `double` and with non vanishing decimal parts. See e.g.  [this example](https://cms-conddb.cern.ch/cmsDbBrowser/payload_inspector/Prod/CMSSW_11_3_0_pre1/eyJwbG90cyI6MSwicGxvdDEiOnsidGFnIjoiQmVhbVNwb3RPYmplY3RzXzIwMDlfTHVtaUJhc2VkX1NpZ21hWl92MzBfb2ZmbGluZSIsInBsb3QiOiJwbG90X0JlYW1TcG90X0hpc3RvcnlYIiwicGx1Z2luIjoicGx1Z2luQmVhbVNwb3RfUGF5bG9hZEluc3BlY3RvciIsInR5cGUiOiJIaXN0b3J5IiwiaW5wdXRfcGFyYW1zIjp7fSwiaW92cyI6eyJzdGFydF9pb3YiOiI0Mjk0OTY3Mjk3IiwiZW5kX2lvdiI6IjU2OTUwNDA3MzUxNTA1NCJ9fX0=):\r\n\r\n![image](https://user-images.githubusercontent.com/5082376/107805211-516aa480-6d65-11eb-834a-5ffe5f9d4901.png)\r\n\r\nI fix the issue by imposing that the setting of the precision is applied only when the number to display has no decimal part to start with.\r\n\r\n#### PR validation:\r\n\r\nRun the following command:\r\n```python\r\ngetPayloadData.py --plugin pluginBeamSpotOnline_PayloadInspector --plot plot_BeamSpotOnline_HistoryX --tag BeamSpotOnlineTestHLT --time_type Lumi --iovs '{\"start_iov\": \"1458480699408457\", \"end_iov\": \"1458480699408459\"}' --db Prod --test ;\r\n```\r\nwith this branch and got:\r\n\r\n```json\r\n{\r\n    \"version\": \"1.0\", \r\n    \"data\": [\r\n        {\r\n            \"y\": -0.070925, \r\n            \"x\": 1458480699408457, \r\n            \"y_err\": 0\r\n        }, \r\n        {\r\n            \"y\": 0.140151, \r\n            \"x\": 1458480699408458, \r\n            \"y_err\": 0\r\n        }, \r\n        {\r\n            \"y\": -0.04356, \r\n            \"x\": 1458480699408459, \r\n            \"y_err\": 0\r\n        }\r\n    ], \r\n    \"annotations\": {\r\n        \"x_label\": \"iov_since\", \r\n        \"y_label\": \"X\", \r\n        \"type\": \"History\", \r\n        \"payload_type\": \"BeamSpotOnlineObjects\", \r\n        \"title\": \"X vs run number\"\r\n    }\r\n}\r\n```\r\n\r\nwhile in vanila `CMSSW_11_3_X_2021-02-12-1100` I get \r\n\r\n```json\r\n{\r\n    \"version\": \"1.0\", \r\n    \"data\": [\r\n        {\r\n            \"y\": 0, \r\n            \"x\": 1458480699408457, \r\n            \"y_err\": 0\r\n        }, \r\n        {\r\n            \"y\": 0, \r\n            \"x\": 1458480699408458, \r\n            \"y_err\": 0\r\n        }, \r\n        {\r\n            \"y\": 0, \r\n            \"x\": 1458480699408459, \r\n            \"y_err\": 0\r\n        }\r\n    ], \r\n    \"annotations\": {\r\n        \"x_label\": \"iov_since\", \r\n        \"y_label\": \"X\", \r\n        \"type\": \"History\", \r\n        \"payload_type\": \"BeamSpotOnlineObjects\", \r\n        \"title\": \"X vs run number\"\r\n    }\r\n}\r\n```\r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\n\r\n\r\n", "branch": "master", "changed_files": 1, "closed_at": "1613471945", "comments": 8, "commits": 1, "created_at": "1613149628", "deletions": 1, "labels": ["bug-fix", "code-checks-approved", "db-approved", "fully-signed", "orp-approved", "tests-approved"], "merge_commit_sha": "ccbc18008b437829a59dc5d8ec6d3cf5c66df3a4", "merged_at": "1613471945", "merged_by": "cmsbuild", "milestone": "CMSSW_11_3_X", "number": 32902, "release-notes": [], "review_comments": 0, "state": "closed", "title": "fix issue with trend-plotting in payload inspector", "updated_at": "1613471945", "user": "mmusich"}