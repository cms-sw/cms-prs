{"additions": 344, "auther_ref": "ngt-hackaton-TID-extension", "auther_sha": "d14ceefb4049f6b37aca8fcc3ffc3bbbb07eb3c5", "author": "cms-ngt-hlt", "body": "#### PR description:\r\n\r\nThis PR was co-developed by: @Parsifal-2045, @JanGerritSchulz, @rovere, and @mmusich \r\n\r\nThis work builds upon the **Phase-2 CA Extension** (#48921) for `PixelTracks`, which enabled the Cellular Automaton (CA) algorithm to use `recHits`  from the first three layers of the Outer Tracker barrel (TOB) in addition to the pixel `recHits` in the Inner Tracker (IT). \r\nWith this PR, we further extend the CA to include `recHits`  from the **pixel side of the modules** in the first ten layers of the **Outer Tracker disks (TID)**. \r\n\r\nAs part of this work: \r\n\r\n- 18 more connections have been added, bringing the total number of layer pairs to **91** \r\n- Compatibility cuts have been added and re-tuned. \r\n\r\n# Main Developments:\r\n\r\nTo support the extension, we modified the following modules:\r\n\r\n1. Extension of geometry and configuration\r\nTo increase the number of modules, layers, layer-pairs and to define the corresponding compatibility cuts:\r\n    - [ClusteringConstants.h](https://github.com/cms-sw/cmssw/compare/master...cms-ngt-hlt:cmssw:ngt-hackaton-TID-extension?expand=1#diff-828ec049313dd42908b41063c917bc9c31639f40a56de21373ff1b3d853f172b) \r\n    - [SimplePixelTopology.h](https://github.com/cms-sw/cmssw/compare/master...cms-ngt-hlt:cmssw:ngt-hackaton-TID-extension?expand=1#diff-410ff88ea4b374b0f2760c72bf8faf437ca02d653b173fd00d9305b99e8fcec0)\r\n    - [hltPhase2PixelTracksSoA_cfi.py](https://github.com/cms-sw/cmssw/compare/master...cms-ngt-hlt:cmssw:ngt-hackaton-TID-extension?expand=1#diff-e6e0f5454636b9c314a17e30bb357ac90b6bacf22701dbfd3500d445d6723352)\r\n\r\n2. Inclusion of TID P-module hits\r\nTo load the `recHits` belonging to the P-side modules of the TID:\r\n    -  [Phase2OTRecHitsSoAConverter.cc](https://github.com/cms-sw/cmssw/compare/master...cms-ngt-hlt:cmssw:ngt-hackaton-TID-extension?expand=1#diff-59d7bcc28f19322fd0cc0ca126f9c8d578ceafc2d3bffb0f212b035b15f398b0) which converts the `recHits` on the P modules of the TOB and TID layers into SoA format.\r\n   \r\n3. CA algorithm extension and SoA conversion:    \r\nTo extend the CA algorithm and handle the new `PixelTracks`:    \r\n    -   [CAHitNtuplet.cc](https://github.com/cms-sw/cmssw/compare/master...cms-ngt-hlt:cmssw:ngt-hackaton-TID-extension?expand=1#diff-5bd719d753293efd6fe93e029cc59f80aa3987aaf18cc68001540fee5329f2a6) implementation of the CA algorithm  \r\n    -   [PixelTrackProducerFromSoAAlpaka.cc](https://github.com/cms-sw/cmssw/compare/master...cms-ngt-hlt:cmssw:ngt-hackaton-TID-extension?expand=1#diff-0398df2151c8f29d44c4d6f2fa050fc3ad83119ef1fc9483c444c16bb75593ff) conversion of `PixelTracks` from SoA format to legacy.\r\n\r\nIn the last three modules, the main updates include:\r\n\r\n- Introduction of the `isPinPSinOTDisk` function to identify P-side `recHits` in the TID;\r\n- Implementation of a two-for-loops logic to ensure correct layer ordering, since the CA algorithm requires the TOB layers to have smaller IDs than the TID ones.\r\n\r\nFurthermore, in [PixelTrackProducerFromSoAAlpaka.cc](https://github.com/cms-sw/cmssw/compare/master...cms-ngt-hlt:cmssw:ngt-hackaton-TID-extension?expand=1#diff-0398df2151c8f29d44c4d6f2fa050fc3ad83119ef1fc9483c444c16bb75593ff) the logic used to count the number of skipped layers has been adjusted to **retain all the tracks containing at least one TID hit**.\r\n\r\n# Physics performance\r\n\r\nPerformance has been evaluated on a **TTbar sample with 200 PU (D110 geometry)**.\r\nThe TID extension maintains the **same level of tracking efficiency**, with only a **modest increase in fake rate**, remaining below 0.1 across the entire  range.\r\nThanks to the additional hits at || ~ 2, the increased sagitta leads to an **improvement in p<sub>T</sub> resolution of up to 25%**. \r\n\r\n\r\n<table> <tr> <td align=\"center\" width=\"50%\"> <img src=\"https://github.com/user-attachments/assets/0f73d04a-b939-48d0-98f7-6d182fbbc8d7\" alt=\"Efficiency\" width=\"100%\"/> <br><b>Tracking Efficiency</b> </td> <td align=\"center\" width=\"50%\"> <img src=\"https://github.com/user-attachments/assets/6c4a5063-3d78-4a8f-8148-192497350db3\" alt=\"Fake Rate\" width=\"100%\"/> <br><b>Fake Rate</b> </td> </tr> <tr> <td align=\"center\" width=\"50%\"> <img src=\"https://github.com/user-attachments/assets/dc1cec72-b9b6-4ff5-bcc0-e9316bb26c70\" alt=\"Hits vs \" width=\"100%\"/> <br><b>Number of Hits vs </b> </td> <td align=\"center\" width=\"50%\"> <img src=\"https://github.com/user-attachments/assets/dc67b951-2b1a-4b43-8db6-8c2f1e01f191\" alt=\"pT Resolution vs \" width=\"100%\"/> <br><b>p<sub>T</sub> Resolution vs  ()</b> </td> </tr> </table>\r\n\r\n# Timing\r\n\r\n# Memory usage\r\n\r\nThe TID extension comes practically for free in terms of memory usage, as it does not require any increase in container sizes. ", "branch": "master", "changed_files": 8, "comments": 2, "commits": 12, "created_at": "1762531617", "deletions": 104, "labels": ["reconstruction-pending", "hlt-pending", "generators-pending", "geometry-pending", "pending-signatures", "tests-pending", "orp-pending", "code-checks-pending", "heterogeneous-pending", "tracking", "trk", "ngt"], "milestone": "CMSSW_16_0_X", "number": 49346, "release-notes": [], "review_comments": 0, "state": "open", "title": "[NGT] Extension of CA Pixel Tracking to Phase-2 Outer Tracker Disks (TID)", "updated_at": "1762531727", "user": "EmanueleCoradin"}