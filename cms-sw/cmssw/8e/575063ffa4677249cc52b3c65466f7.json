{"additions": 16, "auther_ref": "eol_cfg_fix", "auther_sha": "84fa5fb5aecab094cf5f932415228d9df65e3cee", "author": "PFCal-dev", "body": " of default parameters for HGCal\r\n\r\n#### PR description:\r\n\r\nThe HFnose and HGCal Si section share analogous digitization code and configuration files.\r\nIn both cases the parameters used to model the realistic detector/noise are read from a refToPSet which has been kept common up to this PR.\r\nIn recent releases, when the aging of HFNose was introduced, we have overlooked the fact that in the configuration it ends up overwriting the a crucial parameter which sets the dose/fluence map to be used. This parameter is firstly set to the default HGCAL but immediately changed afterwards to the HFnose one, which is is not suitable for HGCAL. \r\nThis happens when the following customisation is made\r\n\r\n--customise SLHCUpgradeSimulations/Configuration/aging.customise_aging_3000\r\n\r\nAs a result the HGCAL part of the simulation turns out to be incorrect in workflows where aging has been enabled.\r\nThis PR fixes this by introducing a separate PSet for HFNose. Initially it is made as a clone of the HGCAL_noise_fC PSet and when the customise is called it sets the proper values for HFnose, namely the doseMap.\r\n\r\n\r\n#### PR validation:\r\n\r\nWe have checked with\r\n\r\n```\r\nrunTheMatrix.py -w upgrade -l 23234.103\r\n```\r\n\r\nthat the final configuration is correct and that the events obtained after the DIGI step are consistent with the ones we had in 11_2_X. For illustration two plots comparing the before and after on a handful of events.\r\n\r\n![wrong dose map](https://user-images.githubusercontent.com/4624574/119809332-4a673c80-bee5-11eb-95ad-6e6341e21034.png)\r\n![correct dose map](https://user-images.githubusercontent.com/4624574/119809838-cb263880-bee5-11eb-8cdb-db576115bc5f.png)\r\n\r\n@ttrk \r\n@mariadalfonso  can you check the proposed changes are ok from the HFnose point of view\r\n@franzoni  this is probably one of the last PRs you're required to follow in CMS? \r\n", "branch": "master", "changed_files": 2, "closed_at": "1622355372", "comments": 8, "commits": 1, "created_at": "1622103762", "deletions": 3, "labels": ["code-checks-approved", "fully-signed", "orp-approved", "simulation-approved", "tests-approved", "upgrade-approved"], "merge_commit_sha": "37b7ed666f2fce17984e15b3752893b9055e88bc", "merged_at": "1622355372", "merged_by": "cmsbuild", "milestone": "CMSSW_12_0_X", "number": 33861, "release-notes": [], "review_comments": 0, "state": "closed", "title": "adding a specified HFNose_noise_fC parameter set to avoid overwriting", "updated_at": "1622355372", "user": "pfs"}