{"additions": 966, "auther_ref": "ConversionFinder_1", "auther_sha": "350e91e1b618958648db8460517beddf8617eee2", "author": "guitargeek", "body": "#### PR description:\r\n\r\nOptimization of `egammaTools::getConversionInfos`.\r\n\r\nI wrote this code a month ago when I submitted https://github.com/cms-sw/cmssw/pull/30209 but then abandoned it for the time being (lack of time). Now that a corresponding issue has been opened (https://github.com/cms-sw/cmssw/issues/30954), it might be a good time to open the PR.\r\n\r\nI combined the optimization with a quite heavy refactor of the `ConversionFinder` class and only realized later that it was not the smartest decision to do it at once.  Maybe we can run the bot tests to see if I made any mistakes and than continue from there? Hopefully there are no differences. Then we just need to profile and reshuffle the SoA stuff a little bit, because I'm not happy with how I added functionality to `CommonTools/Utils`.\r\n\r\n#### PR profiling:\r\n\r\n*Note that all these profiles are made in different environments, so absolute times are not comparable. The point is just to show that `getConversionInfo` decreases drastically in relative % in both Phase II and Run 2.*\r\n\r\n* **Phase II** representative workflow **23434.21 step3** [before](https://slava77sk.web.cern.ch/slava77sk/reco/cgi-bin/igprof-navigator/CMSSW_11_2_X_2020-07-21-2300-sign1106.376a0992c5d.23434.21.step3.50.pp/131) and [after](https://rembserj.web.cern.ch/rembserj/cgi-bin/igprof-navigator/30956_23434.21_with_PR_igreport_perf_v2/415) this PR\r\n* **Run 2** representative workflow **10224.0 step3** [before](https://rembserj.web.cern.ch/rembserj/cgi-bin/igprof-navigator/30956_10224.0_without_PR_igreport_perf/5656) and [after](https://rembserj.web.cern.ch/rembserj/cgi-bin/igprof-navigator/30956_10224.0_with_PR_igreport_perf_v2/5207) this PR\r\n* For each profiling 50 events were processed.\r\n\r\nNote: the relevant `egammaTools::getConversionInfo` got renamed to `egamma::conv::findConversion`.\r\n\r\n#### PR validation:\r\n\r\nCMSSW compiles and local matrix tests pass.\r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\n\r\nNo backport intended.", "branch": "master", "changed_files": 34, "closed_at": "1598684061", "comments": 156, "commits": 16, "created_at": "1595969660", "deletions": 912, "labels": ["analysis-approved", "code-checks-approved", "comparison-available", "core-approved", "fully-signed", "hlt-approved", "orp-approved", "reconstruction-approved", "tests-approved"], "merge_commit_sha": "982e118258b7b309e704db527ef183a66d48c20a", "merged_at": "1598684061", "merged_by": "cmsbuild", "milestone": "CMSSW_11_2_X", "number": 30956, "release-notes": [], "review_comments": 82, "state": "closed", "title": "phase-2 reco CPU hotspot: egammaTools::getConversionInfos", "updated_at": "1598684061", "user": "guitargeek"}