{"additions": 276, "auther_ref": "raw_to_digi_updates", "auther_sha": "37fcb54f471e8642779930ff8df0473cb0363b74", "author": "CTPPS", "body": "#### PR description:\r\n\r\nThis PR is a next step in a way to resolve an issue from [#40765](https://github.com/cms-sw/cmssw/pull/40765) - Transfer of all PPS detectors' mappings from XML to CondDB.\r\n\r\nIn this PR:\r\n\r\n- Updates of [TotemVFATRawToDigi.cc](https://github.com/CTPPS/cmssw/blob/6105ec09f9adba0ecaa36a6ab1ac23f249a67c6f/EventFilter/CTPPSRawToDigi/plugins/TotemVFATRawToDigi.cc)\r\n    - add use of new TotemAnalysisMaskRcd separated from TotemReadoutRcd and introduced in **#42471**;\r\n    - handle retrieving objects from records using `EventSetup::getHandle()`\r\n    \r\n- Changes in [ctppsRawToDigi_cff.py](https://github.com/cms-sw/cmssw/compare/master...CTPPS:cmssw:raw_to_digi_updates#diff-1eb4c964687bc0dbea0102fa7d717cc7f42908aa1979fbc22cde1db187b8e3fa):\r\n    - remove imports of XML files containing mappings - now mappings will be taken from a GT\r\n- New config fragment: [ctppsRawToDigi_xml_cff.py](https://github.com/cms-sw/cmssw/compare/master...CTPPS:cmssw:raw_to_digi_updates#diff-ca62e8d0446df10a4cd189d5eabaecbaf40ca005968588089ab54e075954ad6a) which is an old [ctppsRawToDigi_cff.py](https://github.com/cms-sw/cmssw/compare/master...CTPPS:cmssw:raw_to_digi_updates#diff-1eb4c964687bc0dbea0102fa7d717cc7f42908aa1979fbc22cde1db187b8e3fa) - it imports XML files with mappings\r\n- New config ([strip_dqm_test_xml_cfg.py](https://github.com/cms-sw/cmssw/compare/master...CTPPS:cmssw:raw_to_digi_updates#diff-59e872634532ac0d26ee88ec4b59dd48d6ddca7dc15965feeb025016c3a7d278)) to read mappings from XML instead of GT (just for test and internal use)\r\n\r\n\r\n#### PR validation:\r\n\r\nWe have created Tags containing records with mappings for each detector. Created Tags:\r\n\r\nTAG | Record\r\n-- | --\r\nPPSDAQMapping_TrackingStrip_test_v1 | TotemReadoutRcd\r\nPPSDAQMapping_TimingDiamond_test_v1 | TotemReadoutRcd\r\nPPSDAQMapping_TotemTiming_test_v1 | TotemReadoutRcd\r\nPPSDAQMapping_TotemT2_test_v1 | TotemReadoutRcd\r\nPPSAnalysisMask_test_v1 | TotemAnalysisMaskRcd\r\n\r\n\r\nTo validate changes in TotemVFATRawToDigi I ran the rawToDigi and the reconstruction (`process.ctppsRawToDigi` and `process.recoCTPPS` in config's `process.path`) with the use of Tags and then with the use of XML files. Because TotemAnalysisMaskRcd cannot be taken from XML in both cases it was loaded from a Tag - but it shouldn't make any difference since this record contains empty object and no data.\r\n\r\nThen I compared plots generated with the use of Tags with plots generated with the use of XMLs. They looked the same.\r\n\r\nThis test has been done for all detectors (TimingDiamond, TrackingStrips, TotemT2, TotemTiming) and here are the resulting plots: https://cernbox.cern.ch/s/jQ1ofbYnBNbiCOs \r\n\r\n---\r\n[@vavati](https://github.com/vavati) [@grzanka](https://github.com/grzanka) for your attention\r\n", "branch": "master", "changed_files": 10, "comments": 41, "commits": 3, "created_at": "1693838153", "deletions": 139, "labels": ["reconstruction-pending", "dqm-pending", "alca-pending", "pending-signatures", "tests-rejected", "orp-pending", "code-checks-approved", "ctpps"], "milestone": "CMSSW_13_3_X", "number": 42711, "release-notes": [], "review_comments": 17, "state": "open", "title": "PPS - RawToDigi update to handle mappings from CondDB", "updated_at": "1698759018", "user": "brzozia"}