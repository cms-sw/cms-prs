{"additions": 85, "auther_ref": "premixingDropRaw", "auther_sha": "dfce32df365e10d7ea11dcd68f6bc4c965ef1b7c", "author": "makortel", "body": "The premixing for phase2 is already using (sim) DIGI as the premixing library format, because it allows simplicity (no need to pack+unpack) with only tiny cost in the file size. As outlined in the spring O&C week\r\nhttps://indico.cern.ch/event/711343/contributions/2964389/attachments/1631761/2601778/slides_premix_20180412.pdf\r\nthis PR does the same for the run2 premixing. In addition\r\n* L1 is removed as unnecessary from the stage1 workflow (=produces the premixing library)\r\n* PREMIX event content definitions are distributed to the corresponding packages\r\n  * I hope this to be yet another step for others to become better aware of what happens in premixing\r\n\r\nSince the packing+unpacking are (or can be) lossy, there will be small changes in run2 FullSim and FastSim. However, the changes should be towards the classical mixing (as the workflow becomes more similar), and this is what I see e.g. for CSC digis.\r\n\r\nHere are links (to my private DQM GUI; black is the release and blue this PR) to 100-event comparison of 250202.181 (2018 ttbar+PU FullSim)\r\nhttp://127.0.0.1:8081/dqm/relval/start?runnr=1;dataset=/RelValTTbar_13/CMSSW_10_2_0-PU50_2018_premixing_100ev_orig_v1-v1/DQMIO;sampletype=offline_relval;filter=all;referencepos=ratiooverlay;referenceshow=all;referencenorm=True;referenceobj1=other%3A%3A/RelValTTbar_13/CMSSW_10_2_0-PU50_2018_premixing_100ev_dev_v1-v1/DQMIO%3A;referenceobj2=none;referenceobj3=none;referenceobj4=none;search=;striptype=object;stripruns=;stripaxis=run;stripomit=none;workspace=Everything;size=M;root=;focus=;zoom=no;\r\n\r\n10-event for 250202.171 (2017)\r\nhttp://127.0.0.1:8081/dqm/relval/start?runnr=1;dataset=/RelValTTbar_13/CMSSW_10_2_0-PU35_2017_premixing_10ev_orig_v1-v1/DQMIO;sampletype=offline_relval;filter=all;referencepos=ratiooverlay;referenceshow=all;referencenorm=True;referenceobj1=other%3A%3A/RelValTTbar_13/CMSSW_10_2_0-PU35_2017_premixing_10ev_dev_v1-v1/DQMIO%3A;referenceobj2=none;referenceobj3=none;referenceobj4=none;search=;striptype=object;stripruns=;stripaxis=run;stripomit=none;workspace=Everything;size=M;root=;focus=;zoom=no;\r\n\r\n250202.1 (2016)\r\nhttp://127.0.0.1:8081/dqm/relval/start?runnr=1;dataset=/RelValTTbar_13/CMSSW_10_2_0-PU35_2016_premixing_10ev_orig_v1-v1/DQMIO;sampletype=offline_relval;filter=all;referencepos=ratiooverlay;referenceshow=all;referencenorm=True;referenceobj1=other%3A%3A/RelValTTbar_13/CMSSW_10_2_0-PU35_2016_premixing_10ev_dev_v1-v1/DQMIO%3A;referenceobj2=none;referenceobj3=none;referenceobj4=none;search=;striptype=object;stripruns=;stripaxis=run;stripomit=none;workspace=Everything;size=M;root=;focus=;zoom=no;\r\n\r\nand 250402.1 (2016 FastSim, added in #24149)\r\nhttp://127.0.0.1:8081/dqm/relval/start?runnr=1;dataset=/RelValTTbar_13/CMSSW_10_2_0-PU35_FS2016_premixing_10ev_orig_v1-v1/DQMIO;sampletype=offline_relval;filter=all;referencepos=ratiooverlay;referenceshow=all;referencenorm=True;referenceobj1=other%3A%3A/RelValTTbar_13/CMSSW_10_2_0-PU35_FS2016_premixing_10ev_dev_v1-v1/DQMIO%3A;referenceobj2=none;referenceobj3=none;referenceobj4=none;search=;striptype=object;stripruns=;stripaxis=run;stripomit=none;workspace=Everything;size=M;root=;focus=;zoom=no;\r\n\r\nwith the following SSH tunnel recipe\r\n```\r\nssh -L8081:mkdev.cern.ch:8081 lxplus.cern.ch\r\nhttp://127.0.0.1:8081/dqm/relval/\r\n```\r\n\r\nTested in 10_2_0 (rebased on top of ~CMSSW_10_3_X_2018-08-29-2300~ CMSSW_10_3_X_2018-09-04-1100), expecting small changes in run2 FullSim and FastSim premixing, but no changes in phase2 (FullSim) premixing. Because the premixing library format changes, this PR breaks all stage2-only premixing workflows.\r\n\r\n@kpedro88 @mdhildreth ", "branch": "master", "changed_files": 12, "closed_at": "1537857226", "comments": 87, "commits": 8, "created_at": "1533277463", "deletions": 186, "labels": ["code-checks-approved", "comparison-available", "daq-pending", "l1-approved", "operations-approved", "orp-approved", "pdmv-approved", "pending-signatures", "reconstruction-approved", "simulation-approved", "tests-approved", "upgrade-approved"], "merge_commit_sha": "84f052374d4a0b4d44f2b7744d75dffb9ef2e41e", "merged_at": "1537857226", "merged_by": "cmsbuild", "milestone": "CMSSW_10_3_X", "number": 24184, "release-notes": [], "review_comments": 17, "state": "closed", "title": "Change premixing library format from RAW to DIGI", "updated_at": "1537857226", "user": "makortel"}