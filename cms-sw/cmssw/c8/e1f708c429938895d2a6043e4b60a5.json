{"additions": 22, "auther_ref": "fixDBG_ASAS_RAWprime_13_2_X", "auther_sha": "99b82cdb9d9bda2f1544027672d6c1c2690b3b66", "author": "mmusich", "body": "backport of https://github.com/cms-sw/cmssw/pull/42486\r\n\r\n#### PR description:\r\n\r\nThe goal of this PR is to solve the issues https://github.com/cms-sw/cmssw/issues/42131 and https://github.com/cms-sw/cmssw/issues/42132. \r\nThose issues are caused because there is a condition (`SiStripNoises`) which is read off its domain from this call:\r\n\r\nhttps://github.com/cms-sw/cmssw/blob/fe01c0ef7402cf507d76755af115cbbcb590b707/RecoTracker/PixelLowPtUtilities/interface/SlidingPeakFinder.h#L72\r\n\r\nwhen it looks for the noise of strip n. 768 for Detid 369120277. \r\nHaving established at https://github.com/cms-sw/cmssw/issues/42162#issuecomment-1663600451 that for this detId (and similar modules), the strip range is from 0 to 767 (also independently), thus excluding possible issues with conditions, and following the line of thought that (see https://github.com/cms-sw/cmssw/issues/42162#issuecomment-1664035106) a very similar code was already used in https://github.com/cms-sw/cmssw/blob/c2e865adc2671fa7d91832fbdab21b90db967572/RecoTracker/PixelLowPtUtilities/src/StripSubClusterShapeTrajectoryFilter.cc#L84  which I think it has been used since ever for the Strip seeded iterations, it begs the question on why this was not spotted before in `StripSubClusterShapeTrajectoryFilter`.\r\nI propose in this PR to follow (almost) the same prescription used in that file before running the filter, namely using the output of `ClusterShapeHitFilter::getSizes` \r\n \r\nhttps://github.com/cms-sw/cmssw/blob/c2e865adc2671fa7d91832fbdab21b90db967572/RecoTracker/PixelLowPtUtilities/src/StripSubClusterShapeTrajectoryFilter.cc#L258-L259\r\n \r\nand the check on the measured (and predicted) cluster widths\r\n \r\nhttps://github.com/cms-sw/cmssw/blob/c2e865adc2671fa7d91832fbdab21b90db967572/RecoTracker/PixelLowPtUtilities/src/StripSubClusterShapeTrajectoryFilter.cc#L265-L267\r\n \r\nSince `ClusterShapeHitFilter::getSizes` is not called with the measured trajectory direction, but rather with an approximated direction (the line joining the BeamSpot to the cluster) I enlarge the window to encompass 2 cluster pitches rather than 1.5.\r\n \r\n#### PR validation:\r\n\r\nIn `CMSSW_13_3_DBG_X_2023-08-01-2300` run successfully `runTheMatrix.py -l 140.58 --ibeos`\r\n\r\n#### If this PR is a backport please specify the original PR and why you need to backport that PR. If this PR will be backported please specify to which release cycle the backport is meant for:\r\n\r\nVerbatim backport of https://github.com/cms-sw/cmssw/pull/42486", "branch": "CMSSW_13_2_X", "changed_files": 1, "comments": 5, "commits": 1, "created_at": "1691558058", "deletions": 16, "labels": ["reconstruction-pending", "pending-signatures", "tests-approved", "orp-pending", "bug-fix", "backport-ok", "trk"], "milestone": "CMSSW_13_2_X", "number": 42516, "release-notes": [], "review_comments": 0, "state": "open", "title": "[13.2.X] `SiStripClusters2ApproxClusters`: run `peakFilter` only if cluster is usable", "updated_at": "1691567700", "user": "mmusich"}