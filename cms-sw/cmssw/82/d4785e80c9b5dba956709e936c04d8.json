{"additions": 907, "auther_ref": "event-setup-consumes", "auther_sha": "12bd19b88c35011d21524ce0ad74d2cebd284c38", "author": "knoepfel", "body": "This PR introduces an interface that mirrors the consumes system for modules.  It provides the `edm::ESGetTokenT<MyESProduct>` token, which can be used for retrieving event-setup products.\r\n\r\n**N.B.** This PR does include quite a few whitespace changes, primarily from using nested namespaces.  Although clicking on the individual commit and specifying a trailing \"?w=1\" in the URL should be sufficient to suppress them, please let me know if you'd prefer me to revert.\r\n\r\n**Module interface**\r\n\r\n    class MyModule : public ... {\r\n      edm::ESInputTag esTag_;\r\n      edm::ESGetTokenT<ESProduct> token_;\r\n      edm::ESGetTokenT<OtherESProduct> otherToken_;\r\n      ...\r\n    public:\r\n      MyModule(ParameterSet const&) : \r\n        esTag_{...},\r\n        // Indication to consume the ESProduct during the event\r\n        token_{esConsumes<ESProduct, ESRecord>(esTag_)},\r\n        // Tell system to consume at begin SubRun\r\n        otherToken_{esConsumes<OtherESProduct, OtherESRecord, edm::Transition::BeginSubRun>(esTag_)}\r\n      {}\r\n    };\r\n\r\n**ESProducer interface**\r\n\r\n    class MyESProducer: public edm::ESProducer {\r\n    public:\r\n      MyESProducer() {\r\n        edm::ESConsumesCollector cc = setWhatProduced(this);\r\n        edm::ESGetTokenT<Foos> foos = cc.consumes<Foos>(); // gets from same record\r\n        edm::ESGetTokenT<Bars> bars = cc.consumes<Bars, BarRecord, edm::Transition::EndSubRun>();\r\n      }\r\n    };\r\n\r\n**Additional comments**\r\n\r\n- The `edm::EventRecord::get()` calls now return `bool` instead of `void`.  A return value of `true` implies that the event-record retrieval was successful, and the handle can be safely dereferenced.\r\n- The `edm::ESInputTag` constructor overload set has been expanded to better match user expectations for constructions via single strings (representing data labels) and those via encoded representations, which require an additional `edm::ESInputTag::Encoded` constructor argument.", "branch": "master", "changed_files": 22, "comments": 8, "commits": 6, "created_at": "1538492873", "deletions": 761, "labels": ["code-checks-approved", "comparison-pending", "core-pending", "orp-pending", "pending-signatures", "tests-started"], "milestone": "CMSSW_10_3_X", "number": 24791, "release-notes": [], "review_comments": 17, "state": "open", "title": "EventSetup consumes interface", "updated_at": "1538589931", "user": "knoepfel"}