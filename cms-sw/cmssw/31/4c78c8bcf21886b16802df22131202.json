{"additions": 9, "auther_ref": "chooseDeviceException", "auther_sha": "00f2cdd861fc242562785008338b69114b8be45f", "author": "makortel", "body": "#### PR description:\r\n\r\nIt was noticed in https://github.com/cms-sw/cmssw/pull/31719#issuecomment-727072323 that there is a viable call path in modules using CUDA that leads to a crash instead of an exception when run on a machine without a GPU. This PR changes `cms::cuda::chooseDevice()` to require that `CUDAService` is enabled, and throw an explanatory exception if it is disabled.\r\n\r\n#### PR validation:\r\n\r\nEdited `HeterogeneousCore/CUDATest/test/testCUDASwitch_cfg.py` to force CUDA being enabled to see the exception is being thrown on a machine without GPU.", "branch": "master", "changed_files": 1, "closed_at": "1605654965", "comments": 10, "commits": 1, "created_at": "1605550319", "deletions": 0, "labels": ["code-checks-approved", "comparison-available", "fully-signed", "heterogeneous-approved", "orp-approved", "tests-approved"], "merge_commit_sha": "c3488411b01cb9f6c505be767e05c318d0fc7a6f", "merged_at": "1605654965", "merged_by": "cmsbuild", "milestone": "CMSSW_11_2_X", "number": 32155, "release-notes": [], "review_comments": 2, "state": "closed", "title": "Throw an exception in cms::cuda::chooseDevice() if CUDAService is disabled", "updated_at": "1615224670", "user": "makortel"}