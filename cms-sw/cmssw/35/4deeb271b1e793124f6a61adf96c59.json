{"additions": 36, "auther_ref": "fixFillDetParamsViaGeomDetType", "auther_sha": "92c174dca9127b644c1cd94a74b5be24fd5b7961", "author": "mmusich", "body": "#### PR description:\r\n\r\nWhile trying to move the reading of the Lorentz Angle for the phase-2 Inner Tracker detector to DataBase, we noticed that when not providing the LA value for all the `DetId`s (even OuterTracker ones), the ` SiPixelRecHitConverter` was complaining with errors of the type:\r\n\r\n```\r\n%MSG-e SiPixelLorentzAngle: SiPixelRecHitConverter:siPixelRecHits 04-Jul-2019 18:56:11 CEST Run: 1 Event: 3\r\nSiPixelLorentzAngle for DetID 419697669 is not stored\r\n%MSG\r\n```\r\nwhile not effectively crashing or giving bogus results.\r\nWe traced back the issue to the logic implemented in the `fillDetParams` method of `PixelCPEBase` which looks for the first not-Inner Tracker `DetUnit` to determine the size of the DetUnit list to loop over.\r\nCurrently the list is stopped at the first not Strip `DetUnit` via the method `GeomDetEnumerators::isTrackerStrip`. \r\nThis unfortunately doesn't work in the case of the Phase-2 detector as the `GeomDetEnumerators::isTrackerStrip` takes into account only the current Strip Subdetectors.\r\nWe solved this inconvenience by add new methods:\r\n  * `isInnerTracker`\r\n  * `isOuterTracker`\r\n\r\nin `GeomDetEnumerators` and `GeomDetType` and use them to fix the logic to hold also for Phase-2.\r\nThese methods seem to be quite handy, therefore I am wondering if there is a specific reason why they were not implemented before?\r\nThe reason why the current setup is not producing these error messages is because the Lorentz Angle used in the reconstruction comes from a Fake conditions ESProducer: [SiPixelFakeLorentzAngleESSource](https://github.com/cms-sw/cmssw/blob/master/CalibTracker/SiPixelESProducers/plugins/SiPixelFakeLorentzAngleESSource.cc) which produces a value for all the DetId list from Skimmed Geometry [external file](https://github.com/cms-data/SLHCUpgradeSimulations-Geometry/tree/master/PhaseII/Tilted) (so **all** of them).\r\nSome more information about this can be found in this presentation at the [Tracker Phase-2 simulation,modeling and performance meeting ](https://indico.cern.ch/event/809436/#2-impelentation-on-innertracke).\r\n\r\nI profit of this PR to make two other light fixes:\r\n   * apply the same logic fix also the `PixelCPEClusterRepair::fill2DTemplIDs()` method (72cee37)\r\n   * purely technical change, use `MagneticField::nominalValue()` as suggested [here](https://github.com/cms-sw/cmssw/pull/27043#pullrequestreview-248117632) (59ee713)\r\n\r\n#### PR validation:\r\n\r\nCode proposes passes all tests of:\r\n```\r\nrunTheMatrix.py -l limited -t 4 -j 8\r\n```\r\n#### if this PR is a backport please specify the original PR:\r\n\r\nThis is not a backport.\r\n\r\ncc:\r\n@tsusa, @pmaksim1, @OzAmram, @cmantill, @emiglior ", "branch": "master", "changed_files": 6, "closed_at": "1562770812", "comments": 35, "commits": 4, "created_at": "1562337545", "deletions": 12, "labels": ["code-checks-approved", "comparison-available", "fully-signed", "geometry-approved", "orp-approved", "reconstruction-approved", "tests-approved"], "merge_commit_sha": "9feff99d063b2663f4a91e13d45db39be72996a2", "merged_at": "1562770811", "merged_by": "cmsbuild", "milestone": "CMSSW_11_0_X", "number": 27448, "release-notes": [], "review_comments": 1, "state": "closed", "title": "Fix PixelCPEBase::fillDetParams() for Phase-2 IT, using new GeomDetEnumerators methods", "updated_at": "1562770812", "user": "mmusich"}