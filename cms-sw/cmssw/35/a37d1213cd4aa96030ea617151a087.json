{"additions": 36, "auther_ref": "vertexValidationFixes", "auther_sha": "b8061fb5457626488820cd79ddd9652f39a50fff", "author": "makortel", "body": "This PR contains the following fixes to vertex validation:\n1. Whenever a sim/reco vertex is matched to multiple reco/sim vertices, use the best match as defined by the associator (currently the one with largest number of shared tracks)\n   - Old behaviour was to pick the one with smallest event ID\n2. Do not reset `num_matched_reco_tracks` and `average_match_quality` members of `simPrimaryVertex` when switching reco vertex collections, since these two do not depend on sim-reco vertex association\n3. Fix calculation of z distance to closest vertex (for both reco and sim vertices)\n\nTested in CMSSW_7_5_X_2015-06-06-2300, following differences in the histograms are expected (examples from 1000 TTbar+25ns PU events; black is old and red is new):\n- Small changes in all `*MatchedMerged_*` histograms (caused by 1.), e.g.\n  ![image](https://cloud.githubusercontent.com/assets/33993/8054525/a661a1a4-0e99-11e5-84c2-f21408d665c1.png)\n- Smal.l changes in all `*MultiMatchedGen_*` histograms (caused by 1.), e.g.\n  ![image](https://cloud.githubusercontent.com/assets/33993/8054659/a82509ee-0e9a-11e5-931a-b9e83f9fe3f0.png)\n  and therefore in duplicate rates, e.g.\n  ![image](https://cloud.githubusercontent.com/assets/33993/8054717/ec1abe6e-0e9a-11e5-94a6-e4cd59c9cae7.png)\n- `*_SharedTrackFractionSimMatched` histograms get filled (caused by 2.), e.g.\n  ![image](https://cloud.githubusercontent.com/assets/33993/8054586/25357f1e-0e9a-11e5-911b-8ee390801508.png)\n- Values of `*_ClosestDistanceZ` decrease (caused by 3.), e.g.\n  ![image](https://cloud.githubusercontent.com/assets/33993/8052946/84e29cca-0e8c-11e5-9409-b962b82b6948.png)\n\n@rovere @VinInn \n", "branch": "CMSSW_7_5_X", "changed_files": 1, "closed_at": "1433928863", "comments": 17, "commits": 4, "created_at": "1433835353", "deletions": 41, "labels": ["comparison-available", "dqm-approved", "fully-signed", "tests-approved"], "merge_commit_sha": "e126bbfca6725ef1db5a0418da74b5ee147aa14b", "merged_at": "1433928863", "merged_by": "cmsbuild", "milestone": "CMSSW_7_5_X", "number": 9519, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Fixes to vertex validation", "updated_at": "1476956359", "user": "makortel"}