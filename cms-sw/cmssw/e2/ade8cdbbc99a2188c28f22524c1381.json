{"additions": 361, "auther_ref": "devel_fixUBInHLTMuonPlotter", "auther_sha": "323bc9a8487a3dc4e42d4db7434f3e744beb75e9", "author": "missirol", "body": "#### PR description:\r\n\r\nThis PR aims to improve the plugin `HLTMuonValidator`, and its utility `HLTMuonPlotter`.\r\n\r\nThis update was triggered by https://github.com/cms-sw/cmssw/pull/40708#issuecomment-1426337736, where it was noticed that `HLTMuonPlotter` has a bug that can lead to undefined behaviour [1].\r\n\r\nFurther checks showed other shortcomings of `HLTMuonValidator`/`HLTMuonPlotter` (see review comments for more details); these shortcomings can lead to the DQM outputs of `HLTMuonValidator` being filled incorrectly in the current implementation. This PR tries to fix this (on top of fixing the original UB issue).\r\n\r\n`LogTrace` calls are added to ease debugging. In addition, technical changes to modernise both classes are applied (e.g. `const` correctness).\r\n\r\nExpect changes in the DQM outputs of `HLTMuonValidator` (and nowhere else).\r\n\r\n[1]\r\nThe value of `hltStep` becomes `(size_t) -1` when `step == 2` and `nSteps == 6`, leading to undefined behaviour in\r\nhttps://github.com/cms-sw/cmssw/blob/6f5b833d1b878aa570c87d4237e638362684a7a6/HLTriggerOffline/Muon/src/HLTMuonPlotter.cc#L221\r\nThis was originally reported in #12056, but apparently not fixed back then.\r\n\r\n#### PR validation:\r\n\r\nPrivate tests.\r\n\r\n#### If this PR is a backport, please specify the original PR and why you need to backport that PR. If this PR will be backported, please specify to which release cycle the backport is meant for:\r\n\r\nTo be backported to `CMSSW_13_0_X` if merged.\r\n", "branch": "master", "changed_files": 5, "comments": 11, "commits": 1, "created_at": "1676292430", "deletions": 294, "labels": ["dqm-pending", "pending-signatures", "tests-approved", "orp-pending", "bug-fix", "code-checks-approved"], "milestone": "CMSSW_13_1_X", "number": 40753, "release-notes": [], "review_comments": 6, "state": "open", "title": "improve `HLTMuonValidator` and `HLTMuonPlotter` (no UB, consider only `HLTFilter` modules)", "updated_at": "1677162437", "user": "missirol"}