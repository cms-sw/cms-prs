{"additions": 205, "auther_ref": "alpakaSynchronize", "auther_sha": "5469807b8457e539c648017430cbd5c2dcf88471", "author": "makortel", "body": "#### PR description:\r\n\r\nMany developers of Alpaka modules add `synchronize` parameter to call `alpaka::wait()` at the end of `acquire()` / `produce()`. Having such parameter centrally would allow\r\n* repeating some lines of boilerplate code\r\n* have such a setting globally set in `ProcessAcceleratorAlpaka` (similarly to `backend`)\r\n* `EDMetadata` would know at the Event insertion time all async work has finished\r\n\r\nThis change requires the Alpaka EDModules to pass the `edm::ParameterSet` to their base classes (this pattern is already required for Alpaka ESProducers). I think the number of Alpaka EDModules is small enough for this change to be feasible, but large enough to not to be done in this PR. Instead this PR allows a migration path (EDModules implicitly calling the default constructor of the base class have their `alpaka.synchronize` parameter treated as `False`).\r\n\r\nThe `alpaka.synchronize` parameter applies to Alpaka ESProducers as well. I reminded myself that the Alpaka ESProducers are presently still synchronous, so as a follow-up step I'm going to make them asynchronous by default (after which the `alpaka.synchronize` parameter would have an effect).\r\n\r\nThe second commit adds an exception with a clear error message if `alpaka` PSet is tracked. The commit is not strictly related to this PR, but I made the mistake myself while extending the tests.\r\n\r\nResolves https://github.com/cms-sw/framework-team/issues/1115\r\n\r\n#### PR validation:\r\n\r\nUnit tests pass.\r\n", "branch": "master", "changed_files": 27, "comments": 8, "commits": 2, "created_at": "1735327992", "deletions": 92, "labels": ["fully-signed", "tests-approved", "orp-pending", "code-checks-approved", "heterogeneous-approved"], "milestone": "CMSSW_15_0_X", "number": 47028, "release-notes": [], "review_comments": 0, "state": "open", "title": "Add central `synchronize` configuration parameter to Alpaka modules", "updated_at": "1735459973", "user": "makortel"}