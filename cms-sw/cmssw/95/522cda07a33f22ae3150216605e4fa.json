{"additions": 55, "auther_ref": "fc-rtopo_index", "auther_sha": "8f5a6750fc34d470af72702d4b9293477f8bf4a7", "author": "fabiocos", "body": "#### PR description:\r\n\r\nThis PR proposes a solution to the issue https://github.com/cms-sw/cmssw/issues/43942 , or at least to the MTD-related part of it. The recent update of ETL digitization in #43762 utilizes also hits outside the active part of the pixel area, and therefore needs the computation of pixel indices also for points very close to the geometrical border of the volume. Due to numerical accuracy, they can exceed the maximum allowed value, producing a chain of problems in the downstream code.\r\n\r\nThis PR introduces a ```pixelIndex``` method in ```RectangularMTDTopology``` to correctly compute the indices based on the position in the module, introducing a safety check for border situations. The geometry test is instrumented to possibly catch problems, and this new method is used in the rest of the MTD code where applicable.\r\n\r\n#### PR validation:\r\n\r\nThe code appears to solve the reproducible crash in recent ASAN builds within the MTD clustering algorithm, and allows the unit test of ```Geometry/MTDGeometryBuilder``` to pass smoothly.", "branch": "master", "changed_files": 7, "comments": 7, "commits": 3, "created_at": "1708552140", "deletions": 10, "labels": ["simulation-pending", "geometry-pending", "pending-signatures", "tests-approved", "orp-pending", "bug-fix", "urgent", "upgrade-pending", "code-checks-approved"], "milestone": "CMSSW_14_1_X", "number": 44051, "release-notes": [], "review_comments": 0, "state": "open", "title": "MTD geometry: update pixel index definition from RectangularMTDTopology", "updated_at": "1708571101", "user": "fabiocos"}