{"additions": 41, "auther_ref": "MF_issue38669", "auther_sha": "934053141d54ac50da35f570d577e4853141ec09", "author": "namapane", "body": "#### PR description:\r\n\r\nAdded a protection to check that the MF geometry cache introduced in #38640 is still valid.\r\nAddresses item 1) in issue #38669.\r\n\r\nAlso added a test to siumlate a job spanning over several runs with different magnet currents, triggering the cache in different conditions. It can be run with:\r\n\r\n`MagneticField/Engine/test/regression.py producerType=fromDB_DD4hep current=-1`\r\n\r\nAs expected, the cache works when switching among maps with the same geometry (3, 3.5 and 3.8 T; or 0 and 2 T).\r\nWhen switching between 3 and 2 T, the geometry needs to be redone, which as expected leads to a crash in dd4hep.\r\nThis can only be fixed upstream; however, this is a very exotic use case (ie job spanning different runs taken while the magnet was ramping). In any case, the test can be used to keep track of this potential issue.\r\n", "branch": "master", "changed_files": 2, "closed_at": "1658919126", "comments": 11, "commits": 1, "created_at": "1657792057", "deletions": 24, "labels": ["reconstruction-approved", "fully-signed", "tests-approved", "orp-approved", "code-checks-approved"], "merge_commit_sha": "94b2eb180db4f20a4ca28ebf81cf33d33fae660d", "merged_at": "1658919126", "merged_by": "cmsbuild", "milestone": "CMSSW_12_5_X", "number": 38737, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Improve caching of MF geometry across runs", "updated_at": "1658919126", "user": "namapane"}