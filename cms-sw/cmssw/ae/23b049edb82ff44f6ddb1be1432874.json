{"additions": 13, "auther_ref": "check-const-def", "auther_sha": "31a741c46905e0fb9b6aca3938186bbb48981ab7", "author": "cvuosalo", "body": "When DD4hep simulation is run, these harmless warning messages appear:\r\n```\r\nEvaluator        WARN  +++ Overwriting variable: name=world_x value=101*m  Evaluator::Object : existing variable [setVariable error]\r\nEvaluator        WARN  +++ Overwriting variable: name=world_y value=101*m  Evaluator::Object : existing variable [setVariable error]\r\nEvaluator        WARN  +++ Overwriting variable: name=world_z value=450*m  Evaluator::Object : existing variable [setVariable error]\r\n```\r\nThey are caused because two instances of a DD4hep `Detector` are created, one for the magnetic field and one for the CMS detector, and these three numeric variables are set for both. The DD4hep `Evaluator` is shared among all instances, so when the constants are defined a second time, these harmless warning messages are issued by DD4hep.\r\n\r\nThe fix is to check for the existence of a constant before adding it to the shared DD4hep dictionary. With this PR, constants that already exist are not added again, and the warning message is prevented. Note that the constants are still defined separately inside each `Detector` instance.\r\n\r\nThis PR resolves CMS issue #33712 and part of DD4hep issue https://github.com/AIDASoft/DD4hep/issues/844.\r\n\r\n\r\n#### PR validation:\r\n\r\nWhen DD4hep simulation is run with this PR, the warning messages do not appear, and simulation completes successfully.\r\n\r\nNo backport is necessary. Since the warning messages are harmless, it is OK to leave them in 12_0.\r\n", "branch": "master", "changed_files": 1, "closed_at": "1633936044", "comments": 9, "commits": 1, "created_at": "1633722794", "deletions": 1, "labels": ["geometry-approved", "fully-signed", "tests-approved", "orp-approved", "code-checks-approved"], "merge_commit_sha": "c70b8cf244e808122ff49f2e5482305e53eadd84", "merged_at": "1633936044", "merged_by": "cmsbuild", "milestone": "CMSSW_12_1_X", "number": 35594, "release-notes": [], "review_comments": 0, "state": "closed", "title": "[DD4hep] Add check for existing constant to prevent unneeded warning message", "updated_at": "1633936044", "user": "cvuosalo"}