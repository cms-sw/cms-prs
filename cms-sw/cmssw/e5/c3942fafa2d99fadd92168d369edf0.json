{"additions": 2461, "auther_ref": "upt-invariant-mass_l1t_11_2_0", "auther_sha": "f67895d494ce3c518a7b136ac707aac08ea2e652", "author": "cavana", "body": "#### PR description:\r\n\r\n<!-- Please replace this text with a description of the feature proposed or problem addressed, specifying:\r\n  - what changes are expected in the output if any, \r\n  - what other PRs or externals it depends upon if any,\r\n  - link to any additional material useful to provide a documentation for this PR (slides, JIRA tickets, related pull requestes, hypernews, TWiki or Indico pages)  -->\r\n\r\nThis is a bug-fix to the uGT emulator for the unconstrained pT (UPT) invariant mass correlation condition; the calculation in the original PR (#897) incorrectly used the nominal pT, rather than the UPT.   The bug-fix to the emulator is somewhat extensive and required code changes in several locations:  \r\n(1) TriggerMenuParser(.h, .cc), GlobalScales.(h, .cc) all had to be modified to correctly parse, set, and get the LUT scales for UPT.  \r\n(2) CorrCondition.cc had to be modified to correctly get and apply the LUT scales for UPT to enable the correct calculation of the invariant mass for UPT using integer arithmetic based on the LUT scales for UPT.  \r\n(3) TriggerMenuParser.cc also had to be modified to correctly parse the UPT and DXY (impact parameter) cuts for muon correlation conditions.  \r\n(4) the print function in MuonTemplate.cc now includes displaced muon information, for debugging purposes. \r\n\r\n#### PR validation:\r\n\r\n<!-- Please replace this text with a description of which tests have been performed to verify the correctness of the PR, including the eventual addition of new code for testing like unit tests, test configurations, additions or updates to the runTheMatrix test workflows -->\r\n\r\nThis PR has been validated by the following:\r\n(1) confirming that all code changes compile correctly using l1t-integration-CMSSW_11_2_0 with tag l1t-integration-v105.3\r\n(2) confirming that all code changes execute properly by producing test vectors\r\n(3) confirming that the bug-fix is correct by comparing the emulator results in the test vectors with the uGT firmware.  \r\n\r\nNote that the VHDL firmware independently had the same bug, which caused earlier test vector comparisons between the emulator and the firmware to (incorrectly) agree.   These new validation tests now demonstrate (correct) agreement between the bug-fixed emulator with the bug-fixed firmware.\r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\n\r\nThis PR is needed for the April MWGR and is based on l1t-integration-CMSSW_11_2_0 with tag l1t-integration-v105.3.  Since the L1T Integration Branch was a posteriori rebased to 11_3_X, a backport might be needed -- but I do not know for sure.\r\n\r\n<!-- Please replace this text with any link to  -->\r\n\r\nBefore submitting your pull requests, make sure you followed this checklist:\r\n- verify that the PR is really intended for the chosen branch\r\n- verify that changes follow [CMS Naming, Coding, And Style Rules](http://cms-sw.github.io/cms_coding_rules.html)\r\n- verify that the PR passes the basic test procedure suggested in the [CMSSW PR instructions](https://cms-sw.github.io/PRWorkflow.html)\r\n", "branch": "master", "changed_files": 92, "closed_at": "1617363570", "comments": 1, "commits": 58, "created_at": "1617363485", "deletions": 791, "labels": ["alca-pending", "code-checks-rejected", "daq-pending", "dqm-pending", "geometry-pending", "hlt-pending", "l1-pending", "orp-pending", "pdmv-pending", "pending-signatures", "reconstruction-pending", "simulation-pending", "tests-pending", "upgrade-pending"], "milestone": "CMSSW_11_3_X", "number": 33328, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Bug-fix for upt invariant mass l1t 11 2 0", "updated_at": "1617365009", "user": "cavana"}