{"additions": 4, "auther_ref": "mm_allowDQMinHLTstep", "auther_sha": "3cf8e8d365e087fc7725325ba6e808f5d1a06bf8", "author": "mmusich", "body": "#### PR description:\r\n\r\nTitle says it all, achieved by means of renaming the `hltSiPixelClusterShapeCache` instance used on offline DQM to `hltSiPixelClusterShapeCacheForDQM` to avoid collisions with the hlt ESProducer\r\n\r\n#### PR validation:\r\n\r\nThe following command\r\n\r\n```bash\r\ncmsDriver.py step2 -s L1P2GT,HLT:NGTScouting,DQM:trackingMonitorHLT,VALIDATION:@hltValidation \\\r\n\t     --conditions auto:phase2_realistic_T33 \\\r\n\t     --datatier GEN-SIM-DIGI-RAW,DQMIO \\\r\n\t     -n 1000 \\\r\n\t     --eventcontent FEVTDEBUGHLT,DQMIO \\\r\n\t     --geometry ExtendedRun4D110 \\\r\n\t     --era Phase2C17I13M9 \\\r\n\t     --procModifier alpaka \\\r\n\t     --filein file:/eos/cms/store/relval/CMSSW_15_1_0_pre2/RelValTTbar_14TeV/GEN-SIM-DIGI-RAW/PU_150X_mcRun4_realistic_v1_STD_Run4D110_PU-v1/2580000/0346563c-5dd4-4344-8595-159ee2ba6cd4.root  \\\r\n\t     --fileout file:step2.root \\\r\n\t     --nThreads 24 \\\r\n\t     --process HLTX \\\r\n\t     --inputCommands='keep *, drop *_hlt*_*_HLT, drop triggerTriggerFilterObjectWithRefs_l1t*_*_HLT' \\\r\n\t     > step2.log  2>&1\r\n```\r\n\r\nused to crash at runtime with :\r\n\r\n```\r\nStep: HLT Spec: ['NGTScouting']\r\nStep: DQM Spec: ['trackingMonitorHLT']\r\nTraceback (most recent call last):\r\n  File \"/cvmfs/cms-ib.cern.ch/sw/x86_64/week1/el9_amd64_gcc12/cms/cmssw/CMSSW_15_1_X_2025-05-27-2300/bin/el9_amd64_gcc12/cmsDriver.py\", line 40, in <module>\r\n    run()\r\n  File \"/cvmfs/cms-ib.cern.ch/sw/x86_64/week1/el9_amd64_gcc12/cms/cmssw/CMSSW_15_1_X_2025-05-27-2300/bin/el9_amd64_gcc12/cmsDriver.py\", line 16, in run\r\n    configBuilder.prepare()\r\n  File \"/cvmfs/cms-ib.cern.ch/sw/x86_64/nweek-02891/el9_amd64_gcc12/cms/cmssw/CMSSW_15_1_X_2025-05-27-2300/src/Configuration/Applications/python/ConfigBuilder.py\", line 2340, in prepare\r\n    self.addStandardSequences()\r\n  File \"/cvmfs/cms-ib.cern.ch/sw/x86_64/nweek-02891/el9_amd64_gcc12/cms/cmssw/CMSSW_15_1_X_2025-05-27-2300/src/Configuration/Applications/python/ConfigBuilder.py\", line 859, in addStandardSequences\r\n    getattr(self,\"prepare_\"+stepName)(stepSpec = '+'.join(stepSpec))\r\n  File \"/cvmfs/cms-ib.cern.ch/sw/x86_64/nweek-02891/el9_amd64_gcc12/cms/cmssw/CMSSW_15_1_X_2025-05-27-2300/src/Configuration/Applications/python/ConfigBuilder.py\", line 2149, in prepare_DQM\r\n    _,_dqmSeq,_ = self.loadDefaultOrSpecifiedCFF(stepSpec,self.DQMOFFLINEDefaultCFF)\r\n  File \"/cvmfs/cms-ib.cern.ch/sw/x86_64/nweek-02891/el9_amd64_gcc12/cms/cmssw/CMSSW_15_1_X_2025-05-27-2300/src/Configuration/Applications/python/ConfigBuilder.py\", line 1327, in loadDefaultOrSpecifiedCFF\r\n    l=self.loadAndRemember(_cff)\r\n  File \"/cvmfs/cms-ib.cern.ch/sw/x86_64/nweek-02891/el9_amd64_gcc12/cms/cmssw/CMSSW_15_1_X_2025-05-27-2300/src/Configuration/Applications/python/ConfigBuilder.py\", line 364, in loadAndRemember\r\n    self.process.load(includeFile)\r\n  File \"/cvmfs/cms-ib.cern.ch/sw/x86_64/nweek-02891/el9_amd64_gcc12/cms/cmssw/CMSSW_15_1_X_2025-05-27-2300/src/FWCore/ParameterSet/python/Config.py\", line 734, in load\r\n    self.extend(sys.modules[moduleName])\r\n  File \"/cvmfs/cms-ib.cern.ch/sw/x86_64/nweek-02891/el9_amd64_gcc12/cms/cmssw/CMSSW_15_1_X_2025-05-27-2300/src/FWCore/ParameterSet/python/Config.py\", line 757, in extend\r\n    self.__setattr__(name,item)\r\n  File \"/cvmfs/cms-ib.cern.ch/sw/x86_64/nweek-02891/el9_amd64_gcc12/cms/cmssw/CMSSW_15_1_X_2025-05-27-2300/src/FWCore/ParameterSet/python/Config.py\", line 506, in __setattr__\r\n    raise ValueError(msg1+\"sequence \"+s.label_()+msg2)\r\nValueError: Trying to override definition of hltSiPixelClusterShapeCache while it is used by the sequence HLTDoLocalPixelSequence\r\n new object defined in: /cvmfs/cms-ib.cern.ch/sw/x86_64/nweek-02891/el9_amd64_gcc12/cms/cmssw/CMSSW_15_1_X_2025-05-27-2300/src/DQMOffline/Trigger/python/SiPixel_OfflineMonitoring_cff.py\r\n existing object defined in: /cvmfs/cms-ib.cern.ch/sw/x86_64/nweek-02891/el9_amd64_gcc12/cms/cmssw/CMSSW_15_1_X_2025-05-27-2300/src/HLTrigger/Configuration/python/HLT_75e33/modules/hltSiPixelClusterShapeCache_cfi.py\r\n```\r\n\r\nwhile with this branch it runs to completion.\r\n\r\n#### If this PR is a backport please specify the original PR and why you need to backport that PR. If this PR will be backported please specify to which release cycle the backport is meant for:\r\n\r\nNot a backport, might be backported.", "branch": "master", "changed_files": 2, "closed_at": "1748682035", "comments": 10, "commits": 1, "created_at": "1748443685", "deletions": 4, "labels": ["dqm-approved", "fully-signed", "tests-approved", "orp-approved", "code-checks-approved"], "merge_commit_sha": "e96df7d40c7afb4ca6b1f831427e55c9b13b7c73", "merged_at": "1748682035", "merged_by": "cmsbuild", "milestone": "CMSSW_15_1_X", "number": 48198, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Allow running `trackingMonitorHLT` DQM sequence in the same step as HLT", "updated_at": "1748682037", "user": "mmusich"}