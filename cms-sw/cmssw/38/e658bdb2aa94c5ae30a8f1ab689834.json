{"additions": 496, "auther_ref": "conddbV2-remove-V1-deps-6_rebased", "auther_sha": "00aaa82f33006fb65178de3dd306cac257857b28", "author": "diguida", "body": "This is the next step of cleanup and improvement for condition access:\n- Revision of the configuration initialisation and fragments for Condition \n  access:\n  - Added `CondCore/ESSources/python/CondDBESSources_condDBv2_cfi.py` in order to keep compatibility with the explicit or implicit usage of the condition software version;\n  - Added `Configuration/StandardSequences/python/AdditionalConditions_cff.py`: this fragment is used in order to load conditions not provided by Global Tag and/or Condition records;\n  - Dropped `Configuration/StandardSequences/python/FrontierConditions_GlobalTag_cfi.py` and `Configuration/StandardSequences/python/FrontierConditions_GlobalTag_condDBv2_cfi.py`: they are not needed, as the initialisation of the `ESSource` for loading conditions is done in the proper package;\n  - Dropped references to `Configuration/StandardSequences/python/FrontierConditions_GlobalTag_cfi.py`in client code.\n  - Improved deprecation message for modules `CondCore/DBCommon/python/CondDBCommon_cfi.py` and `CondCore/DBCommon/python/CondDBSetup_cfi.py`.\n- Define the default connection string after checking the cluster where the job is run: if in GPN or WAN, use the usual one, if in the online network, fetch conditions from the squid running on localhost.\n- Revision of Condition access in Online DQM:\n  - Cleanup of `DQM/Integration/python/config/FrontierCondition_GT_cfi.py` and `DQM/Integration/python/config/FrontierCondition_GT_autoExpress_cfi.py`: the connection string is established centrally;\n  - Dropped `DQM/Integration/python/config/FrontierCondition_GT_Offline_cfi.py`;\n  - Correspondent changes in client applications, where the GT customisation is enabled.\n- Clean-up some `BuildFile` from dependencies upon removed packages.\n- Improved test configuration file.\n- Cleaned up spurious includes of `CondDBSetup_cfi` and `CondDBCommon_cfi` in `CondTools/DQM/python/DQMReferenceHistogramRootFileEventSetupAnalyzer_OrcoffOnly_cfi.py`, \n  `CondTools/DQM/python/DQMReferenceHistogramRootFileEventSetupAnalyzer_SQLiteOnly_cfi.py`, `CondTools/DQM/python/DQMReferenceHistogramRootFileEventSetupAnalyzer_cfi.py`, `Configuration/StandardSequences/python/RawToDigi_cff.py`, and `SimCalorimetry/HcalSimProducers/python/hcalUnsuppressedDigis_cfi.py`.\n\nThese are the fixes in order to run online DQM with 80X:\n- Migration to consumes in `DPGAnalysis/Skims/interface/PhysDecl.h`, `DQM/TrigXMonitor/interface/L1Scalers.h`, `DQM/TrigXMonitor/interface/L1TScalersSCAL.h`, `EventFilter/L1GlobalTriggerRawToDigi/interface/L1GlobalTriggerRecordProducer.h`;\n- Use latest HLT and express Global Tags;\n- Load RECO geometry from GT in `DQM/Integration/python/clients/ecal_dqm_sourceclient-live_cfg.py`, `DQM/Integration/python/clients/ecalcalib_dqm_sourceclient-live_cfg.py`, `DQM/Integration/python/clients/hcal_dqm_sourceclient-live_cfg.py`\n- Fixes in `DQM/Integration/python/clients/l1tstage2_dqm_sourceclient-live_cfg.py`\n- Fixes in `DQM/DTMonitorModule/python/dt_dqm_sourceclient_common_cff.py` and `DQM/Integration/python/clients/dt_dqm_sourceclient-live_cfg.py` for loading correctly DT `TwinMux` sequence.\n\nOriginally in #13399 \n\nUnit tests ran OK on `CMSSW_8_0_0`\n\n```\n$ git cms-ckeckdeps -a\n$ scram b -r -j 4 runtests\n```\n\nShort matrix tests passed, and, as expected, no CondDB python `cfi` deprecation warning is seen on `CMSSW_8_0_0`\n\n```\n4.22_RunCosmics2011A+RunCosmics2011A+RECOCOSD+ALCACOSD+SKIMCOSD+HARVESTDC Step0-PASSED Step1-PASSED Step2-PASSED Step3-PASSED Step4-PASSED  - time date Tue Feb  2 15:16:58 2016-date Tue Feb  2 15:12:56 2016; exit: 0 0 0 0 0\n5.1_TTbar+TTbarFS+HARVESTFS Step0-PASSED Step1-PASSED  - time date Tue Feb  2 15:18:48 2016-date Tue Feb  2 15:12:57 2016; exit: 0 0\n8.0_BeamHalo+BeamHaloINPUT+DIGICOS+RECOCOS+ALCABH+HARVESTCOS Step0-PASSED Step1-PASSED Step2-PASSED Step3-PASSED Step4-PASSED  - time date Tue Feb  2 15:17:01 2016-date Tue Feb  2 15:13:00 2016; exit: 0 0 0 0 0\n25.0_TTbar+TTbarINPUT+DIGI+RECOAlCaCalo+HARVEST+ALCATT Step0-PASSED Step1-PASSED Step2-PASSED Step3-PASSED Step4-PASSED  - time date Tue Feb  2 15:20:38 2016-date Tue Feb  2 15:13:04 2016; exit: 0 0 0 0 0\n134.911_RunSinglePh2015D+RunSinglePh2015D+HLTDR2_25ns+RECODR2_25nsreHLT+HARVESTDR2_25nsreHLT Step0-PASSED Step1-PASSED Step2-PASSED Step3-PASSED  - time date Tue Feb  2 15:26:21 2016-date Tue Feb  2 15:16:59 2016; exit: 0 0 0 0\n135.4_ZEE_13+ZEEFS_13+HARVESTUP15FS+MINIAODMCUP15FS Step0-PASSED Step1-PASSED Step2-PASSED  - time date Tue Feb  2 15:29:02 2016-date Tue Feb  2 15:17:11 2016; exit: 0 0 0\n140.53_RunHI2011+RunHI2011+RECOHID11+HARVESTDHI Step0-PASSED Step1-PASSED Step2-PASSED  - time date Tue Feb  2 15:22:55 2016-date Tue Feb  2 15:18:55 2016; exit: 0 0 0\n1330.0_ZMM_13+ZMM_13INPUT+DIGIUP15+RECOUP15+HARVESTUP15 Step0-PASSED Step1-PASSED Step2-PASSED Step3-PASSED  - time date Tue Feb  2 15:31:50 2016-date Tue Feb  2 15:20:46 2016; exit: 0 0 0 0\n1000.0_RunMinBias2011A+RunMinBias2011A+TIER0+SKIMD+HARVESTDfst2+ALCASPLIT Step0-PASSED Step1-PASSED Step2-PASSED Step3-PASSED Step4-PASSED  - time date Tue Feb  2 15:30:41 2016-date Tue Feb  2 15:22:57 2016; exit: 0 0 0 0 0\n1001.0_RunMinBias2011A+RunMinBias2011A+TIER0EXP+ALCAEXP+ALCAHARVD1+ALCAHARVD2+ALCAHARVD3+ALCAHARVD4 Step0-PASSED Step1-PASSED Step2-PASSED Step3-PASSED Step4-PASSED Step5-PASSED Step6-PASSED  - time date Tue Feb  2 15:33:40 2016-date Tue Feb  2 15:26:31 2016; exit: 0 0 0 0 0 0 0\n10 10 9 7 5 1 1 tests passed, 0 0 0 0 0 0 0 failed\n```\n\nFull matrix test running on `CMSSW_8_0_0`.\n\nNo regressions expected.\n", "branch": "CMSSW_8_0_X", "changed_files": 75, "closed_at": "1469027191", "comments": 128, "commits": 17, "created_at": "1454488851", "deletions": 513, "labels": ["alca-approved", "comparison-available", "db-approved", "dqm-approved", "geometry-approved", "hlt-approved", "l1-approved", "operations-pending", "orp-pending", "pdmv-approved", "pending-signatures", "simulation-approved", "tests-approved"], "milestone": "CMSSW_8_0_X", "number": 13170, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Further cleanup of Condition access in AlCaDB, online DQM, Geometry, HLT, Simulation, and standard configuration; Further fixes for online DQM", "updated_at": "1469027191", "user": "diguida"}