{"additions": 39, "auther_ref": "fc-basenumber", "auther_sha": "d8c73e1880c6fdb83cec91c5b72b23ad809ea16c", "author": "fabiocos", "body": "#### PR description:\r\n\r\nFollowing recent discussions triggered by simulation performance reports, this PR update the ```MTDBaseNumber``` class, moving it from the use of ```string``` to the use of ```string_view```. This is possible since the object is just used locally to build a ```DetId``` and the underlying source of strings (geometry volume names) is always available to the code while being invoked. \r\n\r\nAll the classes using this tool are updated accordingly. \r\n\r\n#### PR validation:\r\n\r\nUnit tests pass, and the workflow 34634.0 runs successfully without any change in DQM output.\r\nAn igprof test on the GEN-SIM part of the workflow (10 events) show a reduction of the rank of the ```getBaseNumber``` method used inside ```MtdSD``` (already a minor contribution anyway):\r\n\r\n Original\r\n```\r\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \r\n            0.0  .........       0.10 / 0.10         MtdSD::setDetUnitId(G4Step const*) [1743]\r\n[1748]      0.0       0.10       0.00 / 0.10       MtdSD::getBaseNumber(G4Step const*)\r\n            0.0  .........       0.08 / 0.08         MTDBaseNumber::addLevel(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) [1882]\r\n            0.0  .........       0.02 / 0.02         MTDBaseNumber::reset() [2969]\r\n```\r\n\r\nUpdated\r\n```\r\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \r\n            0.0  .........       0.04 / 0.06         MtdSD::setDetUnitId(G4Step const*) [2020]\r\n[2294]      0.0       0.04       0.00 / 0.04       MtdSD::getBaseNumber(G4Step const*)\r\n            0.0  .........       0.02 / 0.02         MTDBaseNumber::reset() [2988]\r\n            0.0  .........       0.01 / 12.08        G4TouchableHistory::GetVolume(int) const [112]\r\n            0.0  .........       0.01 / 9.97         _init [122]\r\n```\r\n\r\nA similar approach could be used for ```EcalBaseNumber```, which has a much higher impact on the GEN-SIM step performances.\r\n", "branch": "master", "changed_files": 8, "closed_at": "1637568547", "comments": 13, "commits": 3, "created_at": "1636732615", "deletions": 45, "labels": ["geometry-approved", "fully-signed", "tests-approved", "orp-approved", "upgrade-approved", "code-checks-approved"], "merge_commit_sha": "9792a42041d95ba1e1a8573e14cbc3fa878c5d93", "merged_at": "1637568547", "merged_by": "cmsbuild", "milestone": "CMSSW_12_2_X", "number": 36106, "release-notes": [], "review_comments": 7, "state": "closed", "title": "MTD geometry: replace string with string_view in MTDBaseNumber ", "updated_at": "1637568547", "user": "fabiocos"}