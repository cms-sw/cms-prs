{"additions": 4, "auther_ref": "ecalPedestalChanges_15_1_X", "auther_sha": "c747a087b3490172cf645be320f6d3b41dc89811", "author": "jprendi", "body": "backport of https://github.com/cms-sw/cmssw/pull/49076\r\n\r\n#### PR description:\r\n\r\nThe plots regarding the EcalPedestals on CondDB do not work as intended. Only the EB plots get populated, while EE remains empty (see plot_EcalPedestalsDiffTwoTags example [here](https://cern.ch/uaxgh)). Then, for plots comparing  two IOVs of the same tag, it is not possible to choose a second IOV in the first place, so one can only compare against the exact same IOV within a tag.. (see example [here](https://cern.ch/izowx)\r\n\r\nIn this PR, I fixed the if-statement logic that accidentally skipped over filling the EE plots, fixed the for loop that mistook nIOVs as number for IOVs (while nIOVs does not actually refer to the number of IOVs but to the IOVMultiplicity defined [here](https://github.com/cms-sw/cmssw/blob/c81b8a1e7d73b37220b4f0d406151d69dc9aaa4d/CondCore/Utilities/interface/PayloadInspector.h#L299)) and finally changed the logic from `SINGLE_IOV` to `MULTI_IOV`  for `EcalPedestalsDiffOneTag` and `EcalPedestalsRatioOneTag`, as they will require multiple IOVs from the same tag and not just a single tag. \r\n\r\n\r\n#### PR validation:\r\n\r\nI set up the environment as follows:\r\n```\r\ncmsrel CMSSW_15_1_X_2025-10-05-0000\r\ncd CMSSW_15_1_X_2025-10-05-0000/src\r\ncmsenv\r\ngit cms-addpkg CondCore/EcalPlugins\r\nscram b\r\nscram b code-checks\r\nscram b code-format\r\nscram b\r\n```\r\nfurthermore, running: `git cms-checkdeps -a -A ` shows: no dependencies.\r\n\r\nThe validation was performed on the workflows `plot_EcalPedestalsDiffTwoTags` and `plot_EcalPedestalsDiffOneTag`, namely by running:\r\n```\r\ngetPayloadData.py --plugin pluginEcalPedestals_PayloadInspector --plot plot_EcalPedestalsDiffTwoTags --tag EcalPedestals_2016  --input_params \"{}\" --tagtwo EcalPedestals_2009runs_hlt --time_type Run --iovs '{\"start_iov\": \"273931\", \"end_iov\": \"273931\"}'  --iovstwo '{\"start_iov\": \"72686\", \"end_iov\": \"72686\"}' --db Prod --test\r\n\r\n```\r\nwhich produces the plots that also populate the EE parts:\r\n<img width=\"1596\" height=\"2572\" alt=\"0ad16109-80b7-4ac1-b4db-ad865fca7dc1\" src=\"https://github.com/user-attachments/assets/2ea0f7cf-d2eb-4cb4-8feb-5c1429259a6d\" />\r\n\r\nand\r\n\r\n```\r\n getPayloadData.py --plugin pluginEcalPedestals_PayloadInspector --plot plot_EcalPedestalsDiffOneTag --tag EcalPedestals_2016  --input_params \"{}\" --time_type Run --iovs '{\"start_iov\": \"271837\", \"end_iov\": \"271948\"}' --db Prod --test\r\n\r\n```\r\nwhich also now enables to choose a second IOV for the same tag comparisons (as well as populating the EE part):\r\n<img width=\"1596\" height=\"2572\" alt=\"EcalPedestals 2016, IOV 271948 - 271837\" src=\"https://github.com/user-attachments/assets/4d2ea6ab-d949-4bad-a4cf-4f958a4ec130\" />\r\n\r\nAs a consequence, `plot_EcalPedestalsRatioOneTag` and `plot_EcalPedestalsRatioTwoTags` should be fixed with this PR as well.\r\n\r\ncc: @mmusich \r\n\r\n#### If this PR is a backport please specify the original PR and why you need to backport that PR. If this PR will be backported please specify to which release cycle the backport is meant for:\r\n\r\nBackport of https://github.com/cms-sw/cmssw/pull/49076 to 15_1_X\r\n", "branch": "CMSSW_15_1_X", "changed_files": 1, "comments": 7, "commits": 1, "created_at": "1759816249", "deletions": 4, "labels": ["db-pending", "pending-signatures", "tests-approved", "orp-pending", "bug-fix", "backport", "ngt"], "milestone": "CMSSW_15_1_X", "number": 49077, "release-notes": [], "review_comments": 0, "state": "open", "title": "Fixing EcalPedestal plots for CondDB [15_1_X]", "updated_at": "1759825292", "user": "jprendi"}