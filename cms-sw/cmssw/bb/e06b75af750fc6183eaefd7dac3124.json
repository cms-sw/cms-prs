{"additions": 11, "auther_ref": "SiPixelAli_vetoDBupload_10_1_X", "auther_sha": "fbd742e2aaac5bfa54ecd04a8185711971b14281", "author": "mmusich", "body": "backport of #23697 \r\n\r\nGreetings, \r\nthis PR solves two bugs in the SiPixelAli PCL alignment DQM monitoring, that were uncovered in the discussion of [this e-mail thread](https://hypernews.cern.ch/HyperNews/CMS/get/calibrations/3738.html):\r\n   * the previous logic of the SiPixelAli DQM harvester forced to break from a while loop on the coordinates if there is a movement exceeding thresholds. This in turn entailed that if there was a movement exceeding the thresholds the DQM monitoring was crippled (all the other alignable parts were not plotted). I introduce a new boolean to decide whether to veto the upload, still not breaking the loop (so that all parts are plotted)\r\n   * a bug in `MillePedeDQMModule.cc` causing the thresholds on several parameters for `theta_Z` alignable to be taken instead from the `theta_Y`. \r\n\r\nTested with \r\n```bash\r\ncmsDriver.py pedeStep --data --conditions 101X_dataRun2_Express_v8 --scenario pp -s ALCAHARVEST:SiPixelAli --dasquery='file dataset=/StreamExpress/Run2018B-PromptCalibProdSiPixelAli-Express-v1/ALCAPROMPT run=318622' -n -1\r\n```\r\nThe situation before the fix:\r\n\r\n![image](https://user-images.githubusercontent.com/5082376/41982380-95f65c82-7a2b-11e8-9879-da23e2502154.png)\r\n\r\nbecomes after the fixes:\r\n\r\n![image](https://user-images.githubusercontent.com/5082376/41982202-190af49e-7a2b-11e8-819d-5a63416b34e3.png)\r\n\r\n***N.B.: no change in behavior for the actual payload creation is intended here, the changes shall affect only the monitoring***\r\n", "branch": "CMSSW_10_1_X", "changed_files": 3, "closed_at": "1530787296", "comments": 10, "commits": 2, "created_at": "1530184266", "deletions": 9, "labels": ["alca-approved", "backport-ok", "bug-fix", "comparison-available", "fully-signed", "orp-approved", "tests-approved"], "merge_commit_sha": "37d791c98b01d7ef5451d6c5186ad6d7013ea7f2", "merged_at": "1530787296", "merged_by": "cmsbuild", "milestone": "CMSSW_10_1_X", "number": 23711, "release-notes": [], "review_comments": 0, "state": "closed", "title": "[10.1.X] add a veto DB update boolean in the SiPixelAli harvesting to decide to block the payload creation", "updated_at": "1530787297", "user": "mmusich"}