{"additions": 10, "auther_ref": "no-std-clamp", "auther_sha": "9291eee3fae8cee0cfdad5ad8bc7214945c5ce41", "author": "iarspider", "body": "#### PR description:\r\n\r\nWhen testing CMSSW with gcc14, the following error is emitted:\r\n\r\n```\r\n/cvmfs/cms-ib.cern.ch/sw/x86_64/nweek-02874/el8_amd64_gcc14/external/gcc/14.2.1-60e8d7f953e2e96ab45420ba74bbf3ae/lib/gcc/x86_64-redhat-linux-gnu/14.2.1/../../../../include/c++/14.2.1/bits/stl_algo.h:3626:7: error: reference to __host__ function '__glibcxx_assert_fail' in __host__ __device__ function\r\n 3626 |       __glibcxx_assert(!(__hi < __lo));\r\n      |       ^\r\n/cvmfs/cms-ib.cern.ch/sw/x86_64/nweek-02874/el8_amd64_gcc14/external/gcc/14.2.1-60e8d7f953e2e96ab45420ba74bbf3ae/lib/gcc/x86_64-redhat-linux-gnu/14.2.1/../../../../include/c++/14.2.1/x86_64-redhat-linux-gnu/bits/c++config.h:614:12: note: expanded from macro '__glibcxx_assert'\r\n  614 |       std::__glibcxx_assert_fail();                                     \\\r\n      |            ^\r\nsrc/RecoVertex/PixelVertexFinding/plugins/alpaka/clusterTracksByDensity.h:79:17: note: called by 'clusterTracksByDensity'\r\n   79 |       iz = std::clamp(iz, INT8_MIN, INT8_MAX);\r\n      |                 ^\r\n```\r\n\r\nThis issue was reported to [LLVM](https://github.com/llvm/llvm-project/issues/95183) and [GCC](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=115740). Fix inspired by [pytorch's fix](https://github.com/lamikr/rocm_sdk_builder/commit/c9f6a0057c354bd5032287fdd2d6d0d9ee83a6cc#diff-7e7718ec4f2da71ae727c3f24784e81b54a205177da5c2bbbe5a7ee1213d6700) of the same problem.\r\n\r\n#### PR validation:\r\n\r\nBot tests", "branch": "master", "changed_files": 2, "closed_at": "1738777661", "comments": 18, "commits": 2, "created_at": "1738746433", "deletions": 2, "labels": ["reconstruction-approved", "fully-signed", "tests-approved", "orp-approved", "code-checks-approved", "tracking", "trk"], "merge_commit_sha": "1cd573e55238332773ca34986aabbf0df81734d9", "merged_at": "1738777661", "merged_by": "cmsbuild", "milestone": "CMSSW_15_0_X", "number": 47266, "release-notes": [], "review_comments": 7, "state": "closed", "title": "[GCC14] Avoid std::clamp in device code", "updated_at": "1738777662", "user": "iarspider"}