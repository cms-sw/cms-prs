{"additions": 10, "auther_ref": "fix-saturationontail", "auther_sha": "0c8ec927af3f703795b9f32b98024a3c99ba7247", "author": "emanueledimarco", "body": "This PR fixes the handling of cases where the saturation was happening in the tail of the pulse shape, instead of the neighbours of the max sample.\r\nIn these cases, due to a wrong behavior of [EcalDataFrame.lastUnsaturatedSample()](https://github.com/cms-sw/cmssw/blob/CMSSW_9_2_X/DataFormats/EcalDigi/src/EcalDataFrame.cc#L3-L14), if the saturation happened in the last samples of the tail:\r\n- the rechit was not flagged as \"kSaturated\" (so propagated to clusters)\r\n- the multifit reconstruction was used \r\n- the multifit had internally a protection against this, throwing a warning and setting the amplitude of the sample to the maximum value, but still attempting to fit\r\nWith this PR the multifit is not called if *any* of the sample is saturated, and the last saturated sample is set to the one before the first happening of the saturation. \r\n\r\nThis fixes the occurrences of the warnings seen by @gennai at HLT. \r\nIn the meanwhile we investigate within ECAL about the implementation of EcalDataFrame.lastUnsaturatedSample() and eventually will fix it (or remove, since it is not used elsewhere in CMSSW).\r\n\r\n@bendavid @amassiro @crovelli @paramatti ", "branch": "CMSSW_9_2_X", "changed_files": 1, "closed_at": "1503293807", "comments": 13, "commits": 1, "created_at": "1501853886", "deletions": 3, "labels": ["comparison-available", "orp-pending", "pending-signatures", "reconstruction-rejected", "tests-approved"], "milestone": "CMSSW_9_2_X", "number": 20059, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Fix for ECAL saturation in the tail of the pulse", "updated_at": "1503293816", "user": "emanueledimarco"}