{"additions": 361, "auther_ref": "intrusiveAllocMonitorNesting", "auther_sha": "a6cb2674d1d1d06d1e5b5628be807a58beebe69d", "author": "makortel", "body": "#### PR description:\r\n\r\nThis PR makes the `IntrusiveAllocMonitor` re-entrant (within one thread). This change allows the `IntrusiveAllocMonitor` measurements to be done in nested scopes such that the counters do not interfere with each other. The counters from the outer measurement scope do not include the numbers from the inner measurement scope.\r\n\r\nWhen the inner scope measurement starts, the state of the counters are stored in the guard object of that scope (as `std::any`), and restored via the guard's destructor. The allocations of the `std::any` and the MessageLogger message are excluded from the measurements (the unit test verifies this behavior now). The message of the inner scope measurement includes the descriptions of all the outer scopes as well, so the measurement stack is clearly visible in the output.\r\n\r\nResolves https://github.com/cms-sw/framework-team/issues/1851\r\n\r\n#### PR validation:\r\n\r\nUnit test succeeds. Private tests with an RNTuple copy job.", "branch": "master", "changed_files": 8, "comments": 3, "commits": 4, "created_at": "1769805184", "deletions": 21, "labels": ["core-pending", "pending-signatures", "tests-pending", "orp-pending", "code-checks-approved"], "milestone": "CMSSW_16_1_X", "number": 49992, "release-notes": [], "review_comments": 0, "state": "open", "title": "Make `IntrusiveAllocMonitor` re-entrant", "updated_at": "1769805331", "user": "makortel"}