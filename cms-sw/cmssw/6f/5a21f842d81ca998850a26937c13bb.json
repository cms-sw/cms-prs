{"additions": 44, "auther_ref": "dqm-fix-deadlock-in-setbinlabel", "auther_sha": "6d3777a78109980c9eaa4c7015314a58921fa926", "author": "schneiml", "body": "#### PR description:\r\n\r\nFixes the IB test failure in 136.8861 (and maybe others). The deadlock was triggered by `LogMessageMonitor:ClusterizerLogMessageMonCommon` in `bookHistograms`. Reported in #28622.\r\n\r\nThis one only triggers in the error path, because getFullname tries to\r\ntake a lock that we already hold.\r\n\r\nHowever, there is another opportunity for a deadlock via edm::Log*\r\n(which probably takes a lock), and the per ME-locks which could be taken\r\nbefore or after edm::Log* is called. I reviewed all usages of edm::Log*\r\nin DQMServices/Core and did not see anything problematic.\r\n\r\nNote that this is the only usage of edm::Log* in MonitorElement, and it\r\nnow avoids taking multiple locks at the same time, so there should not\r\nbe any more problems of this type.\r\n\r\nThis PR now also includes some commits from #28813 related to `Sumw2`, to fix a completely unrelated problem with 250202.183 which happens after the previous deadlock.\r\n\r\n#### PR validation:\r\n Runs 136.8861 without deadlock.", "branch": "master", "changed_files": 4, "closed_at": "1581497111", "comments": 27, "commits": 4, "created_at": "1581415841", "deletions": 88, "labels": ["code-checks-approved", "comparison-available", "dqm-approved", "generators-pending", "orp-approved", "pending-signatures", "tests-approved", "urgent"], "merge_commit_sha": "5ebc55721d19ed8c5e436aa610cc8cd38b5efa62", "merged_at": "1581497111", "merged_by": "cmsbuild", "milestone": "CMSSW_11_1_X", "number": 28916, "release-notes": [], "review_comments": 0, "state": "closed", "title": "DQM: Fix potential deadlock in setBinLabel.", "updated_at": "1581497111", "user": "schneiml"}