{"additions": 34, "auther_ref": "FGbits_TDCpack_index", "auther_sha": "c7a29f31a1d9af8c2d6a4119eec2cc9a1ba66435", "author": "gk199", "body": "#### PR description:\r\n\r\n`HcalFinegrainBit.cc` is run in cases where HB TDC is compressed and uncompressed. This PR handles both cases. In `HcalTriggerPrimitiveAlgo.cc`, `frame.flavor()` is used to define `is_compressed` which is passed to `HcalFinegrainBit.cc`. This determines if the input TDC values are uncompressed (`flavor=0, is_compressed=0`) or compressed (`flavor=3, is_compressed=1`). Depending on the TDC packing, either a comparison to `tdc_boundary` is made (uncompressed), or a direct comparison to TDC 0, 1, 2 is made. \r\n\r\nAdditional edits in `HcalTriggerPrimitiveAlgo.cc` are made to handle the matching of TP SOI and digi SOI in a more robust way. This ensures that with changes in conditions or filterPresamples, the TDC from the QIE11 dataframe SOI is selected for the fine grain bit algorithm SOI (ensuring ibin = 2 corresponds to idx = 5). \r\n\r\n#### PR validation:\r\n\r\n`runTheMatrix.py` passed. Tested in CMSSW_12_4_X_2022-03-31-1100.\r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\n\r\nWill be backported to 12_3_X, as the L1 LLP trigger emulator was merged in 123X (PR #36919) and relies upon the fine grain bits. \r\n", "branch": "master", "changed_files": 3, "comments": 3, "commits": 2, "created_at": "1648859604", "deletions": 11, "labels": ["l1-pending", "pending-signatures", "tests-pending", "orp-pending", "code-checks-approved"], "milestone": "CMSSW_12_4_X", "number": 37438, "release-notes": [], "review_comments": 0, "state": "open", "title": "HCAL finegrain bit fix to account for TDC packing, and SOI alignment", "updated_at": "1648860578", "user": "gk199"}