{"additions": 30, "auther_ref": "bugFixESUpdateLookup", "auther_sha": "126bf82c3a51652245e3b1d7ca63357c7932d7ec", "author": "wddgit", "body": "#### PR description:\r\n\r\nThis is a bug fix that should only affect jobs using SubProcess. For ESProducers, the updateLookup function was being called too early. For SubProcesses, there is a late step where sharing of ESProducers is checked and new ESProducers might be created at that point. We have been calling ESProducer::updateLookup just before that so ESProducers constructed at that late time would have missed the call to updateLookup.\r\n\r\nThis only affects jobs with SubProcess and none of the CMS production jobs use that feature. It is also somewhat of an unusual corner case even in a job with SubProcess. As far as I know, the Core unit tests are the only tests using SubProcess. \r\n\r\n#### PR validation:\r\n\r\nExisting unit tests pass.\r\n\r\nI noticed this while developing a separate PR. I will submit the other PR in the near future and it contains code modifications that cause existing unit tests to fail because of this bug (that is how I noticed the bug in the first place, it has been lurking there for years).\r\n", "branch": "master", "changed_files": 6, "comments": 13, "commits": 1, "created_at": "1733350894", "deletions": 7, "labels": ["core-pending", "pending-signatures", "orp-pending", "tests-started", "code-checks-approved"], "milestone": "CMSSW_15_0_X", "number": 46871, "release-notes": [], "review_comments": 0, "state": "open", "title": "SubProcess bug fix, updateLookup called too early", "updated_at": "1733772167", "user": "wddgit"}