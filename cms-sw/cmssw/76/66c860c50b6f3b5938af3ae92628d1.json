{"additions": 216, "auther_ref": "update_SimBeamSpotObjects", "auther_sha": "a77360836b8cdd2ca93029505e73ffd883468feb", "author": "francescobrivio", "body": "#### PR description:\r\nThis PR aims at improving the `SimBeamSpotObjects` CondFormat in the context of https://github.com/cms-AlCaDB/AlCaTools/issues/86.\r\n\r\nFollowing the discussion in the same issue the decision is to:\r\n - Adapt the current `SimBeamSpotObjects` to be able to handle both Betafunc- and Gauss-EvtVtxGenerators, which are the two generators used up to Run 3 (for realistic and ideal BS conditions, respectively). This is done in commit b9a4b4c799b8f85e81022f2d16ac5ed2b94b29ee, specifically in this commit I have:\r\n   - Adapted the `SimBeamSpotObjects.h`CondFormat\r\n   - Updated the read and write tools in CondTools/BeamSpot (and relative unitTests)\r\n   - Updated the PayloadInspector class (and relative unitTests)\r\n   - Added to the `GaussEvtVtxGenerator.h` the possibility to read the VtxSmearing parameters from the DB\r\n   - Created and uploaded all the new `SimBeamSpotObjects` single-IOV tags to the [Prep CondDB](https://cms-conddb.cern.ch/cmsDbBrowser/logs/condition_uploader_logs/Prep/2023-10-31/2023-10-31/None/fbrivio/None/None/None/None/any)\r\n\r\nThe next step is to introduce a new CondFormat (and relative utility scripts) to handle the HL-LHC BeamSpot case, this is why I'm opening this PR as draft for the moment. \r\nTo do:\r\n- [ ] Add new CondFormat for HL-LHC BeamSpot\r\n- [ ] Add write and read scripts with relative unitTests\r\n- [ ] Add PayloadInspector class\r\n- [ ] Update the `HLLHCEvtVtxGenerator`\r\n\r\nFor this second step it would be very helpful to receive feedback on the discussion at https://github.com/cms-AlCaDB/AlCaTools/issues/86#issuecomment-1781503058 from the original authors of the HLLHCEvtVtxGenerator module (FYI @lgray).\r\n\r\n#### PR validation:\r\nThe first commit was validated by:\r\n - running (successfully) all the unitTests involved\r\n - geenrating PayloadInspector plots with:\r\n ```\r\ngetPayloadData.py \\\r\n\t--plugin pluginSimBeamSpot_PayloadInspector \\\r\n\t--plot plot_SimBeamSpotParameters \\\r\n\t--tag SimBeamSpot_Realistic25ns13p6TeVEOY2022CollisionVtxSmearingParameters_v1_mc \\\r\n\t--time_type Run \\\r\n\t--iovs '{\"start_iov\": \"1\", \"end_iov\": \"1\"}' \\\r\n\t--db Prep \\\r\n\t--test\r\n\r\ngetPayloadData.py \\\r\n\t--plugin pluginSimBeamSpot_PayloadInspector \\\r\n\t--plot plot_SimBeamSpotParameters \\\r\n\t--tag SimBeamSpot_GaussVtxSigmaZ4cmSmearingParameters_v1_mc \\\r\n\t--time_type Run \\\r\n\t--iovs '{\"start_iov\": \"1\", \"end_iov\": \"1\"}' \\\r\n\t--db Prep \\\r\n\t--test\r\n\r\ngetPayloadData.py \\\r\n\t--plugin pluginSimBeamSpot_PayloadInspector \\\r\n\t--plot plot_SimBeamSpotParametersDiffTwoTags \\\r\n\t--tag SimBeamSpot_Realistic25ns13p6TeVEOY2022CollisionVtxSmearingParameters_v1_mc \\\r\n\t--time_type Run \\\r\n\t--iovs '{\"start_iov\": \"1\", \"end_iov\": \"1\"}' \\\r\n\t--tagtwo SimBeamSpot_GaussVtxSigmaZ4cmSmearingParameters_v1_mc \\\r\n\t--iovstwo '{\"start_iov\": \"1\", \"end_iov\": \"1\"}' \\\r\n\t--db Prep \\\r\n\t--test\r\n ```\r\nWhich result in the following plots:\r\n<img src=\"https://github.com/cms-sw/cmssw/assets/7822641/e2ed7c1d-05b9-4652-97d1-051952365023\" width=\"260\" height=\"260\"> <img src=\"https://github.com/cms-sw/cmssw/assets/7822641/5e9454e1-d033-4fbc-b38f-7e4ca8e39568\" width=\"260\" height=\"260\"> <img src=\"https://github.com/cms-sw/cmssw/assets/7822641/cf3f46e9-f8a0-48fc-b93b-6b6b49e3c969\" width=\"260\" height=\"260\">\r\n\r\n#### Backport:\r\nNot a backport, no backport is foreseen for the moment.\r\n\r\n\r\nFYI @mmusich  @dzuolo @lguzzi @gennai ", "branch": "master", "changed_files": 13, "comments": 4, "commits": 2, "created_at": "1698772585", "deletions": 65, "labels": ["simulation-pending", "alca-pending", "db-pending", "pending-signatures", "tests-pending", "orp-pending", "code-checks-pending", "tracking"], "milestone": "CMSSW_13_3_X", "number": 43160, "release-notes": [], "review_comments": 3, "state": "open", "title": "Update SimBeamSpotObjects to handle different EvtVtxGenerators", "updated_at": "1698834434", "user": "francescobrivio"}