{"additions": 6, "auther_ref": "releaseProcessDesc", "auther_sha": "92652cc9c3c779110fd52262cbd72523d58b67d5", "author": "makortel", "body": "#### PR description:\r\n\r\nProfiling the live memory of https://github.com/cms-sw/cmssw/issues/40437#issuecomment-1630699980 showed that the `edm::ProcessDesc` was taking about 40 MB\r\nhttps://mkortela.web.cern.ch/mkortela/cgi-bin/navigator/issue40437/reco_07.5_live/496\r\n\r\nThe `ProcessDesc` is not really needed in `main()` after the `EventProcessor` is constructed, so this PR releases the ownership of `ProcessDesc` in `main()`, so that the object will be destructed in the `EventProcessor` constructor.\r\n\r\nThis change implies that the modules may no longer hold the `edm::ParameterSet`, that is given to their constructor, by reference/pointer (while testing the change I came across with https://github.com/cms-sw/cmssw/pull/42502, but there may be more).\r\n\r\nResolves https://github.com/makortel/framework/issues/616\r\n\r\n#### PR validation:\r\n\r\nWorkflow 11834.21 reco step runs with https://github.com/cms-sw/cmssw/pull/42502\r\n\r\nThe IgProf MEM_LIVE in 11834.21 reco step in 13_2_0_pre3\r\n* without this PR: https://mkortela.web.cern.ch/mkortela/cgi-bin/navigator/1320pre3/11834.21/step3_reco_07.5_live/598\r\n* with this PR https://mkortela.web.cern.ch/mkortela/cgi-bin/navigator/1320pre3/11834.21/step3_reco_17.5_live/1551\r\n\r\nThere is residual ~1.7 MB contribution from `PyBind11ProcessDesc` that look like memory leaks in python itself(?).", "branch": "master", "changed_files": 1, "comments": 25, "commits": 1, "created_at": "1691435119", "deletions": 0, "labels": ["core-pending", "pending-signatures", "tests-approved", "orp-pending", "code-checks-approved"], "milestone": "CMSSW_13_3_X", "number": 42503, "release-notes": [], "review_comments": 3, "state": "open", "title": "Release ProcessDesc in main() to release some memory", "updated_at": "1695822367", "user": "makortel"}