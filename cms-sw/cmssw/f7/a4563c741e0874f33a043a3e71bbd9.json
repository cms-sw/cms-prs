{"additions": 1, "auther_ref": "muonBTT_15X", "auther_sha": "291ee2d9809798fb2f6aee153b86e1102fb13bf6", "author": "namapane", "body": "#### PR description:\r\nThis PR adds the `muonBestTrackType()` as an int8 value to NanoAODs.\r\n\r\nThe reason for this is to enable analyzers to detect occurrences of muons that are `isGlobal` and/or `isTracker`, but whose default parameters are taken from the standalone muon fit. These are marked as `muonBestTrackType()==2` in miniAODs, but in nanoAODs there is currently no way of knowing - they may appear as perfectly good global and tracker muon that may even pass cut-based IDs and IP cuts, but in realty their momentum and impact parameters are very poorly measured.\r\nThis issue has been known since more than 10 years, and some analyses like H->4l have been rejecting these muons in Run2.  \r\nSome examples of such muons in 2022 data are listed below.\r\n\r\nThe reason why the addition of this variable in nanoAODs was not proposed earlier was the belief that this behavior was pathological, and that the right solution would have been to fit it upstream. \r\nUpon some investigation with @ferrico and @bellan, it turns out that the choice of the STA track as the best track happens in the PF post-cleaning step, with a logic that was specifically crafted in the PF development, which involves the MET assignment. PF conveners thus pointed out that changing this logic may have unwanted side effects and that from their perspective it is much safer to let concerned analyzers handle these cases if they wish. \r\nWe thus propose the addition of this variable in v15. The impact on nanoAOD size is negligible and there's no possible side effect.\r\n\r\n#### PR validation:\r\nTested on a DYJetsToLL sample in 15_0_0_pre1; the size increase is 0.8 b/item.\r\n\r\n#### Some examples of GLB/TK Muons with bestTrackType==2\r\nSome examples, in case anybody is interested, taken from` /store/data/Run2022F/Muon/MINIAOD/22Sep2023-v2/2550000/086c7233-8352-473a-9def-3cca7b470cc7.root`\r\n(dataset: [/Muon/Run2022F-22Sep2023-v2/MINIAOD](https://cmsweb.cern.ch/das/request?input=dataset%3D%2FMuon%2FRun2022F-22Sep2023-v2%2FMINIAOD&instance=prod/global)):\r\n\r\n**In 361303:2183:4542134810**\r\npt= 74.1754 eta= 0.223418 phi= -2.30594\r\npass: isGlobal, isTracker, isLooseMuon, isMediumMuon\r\nTracker: pt,eta,phi: 33.1955 0.222571 -2.26291; validFraction: 1 normalizedChi2:  0.608714\r\nGLB: pt,eta,phi: 33.1846 0.222568 -2.26291 validFraction: 1 normalizedChi2 0.762897\r\n\r\n**In 361303:2184:4544165596**\r\npt= 32.035 eta= -2.32739 phi= 0.388782\r\npass: isGlobal, isLooseMuon\r\nTracker: pt,eta,phi: 94.5429 -2.33026 0.403547 validFraction: 0.666667 normChi2 0.940081\r\nGLB: pt,eta,phi: 63.6122 -2.33019 0.404392 validFraction: 1 normChi2 1.8665\r\n\r\n**In 361318:139:254795536**\r\npt= 39.6768 eta= -1.23819 phi= -2.05707\r\npass: isTracker, isLooseMuon\r\nTracker: pt,eta,phi: 2.03231 -1.38233 -0.980531 validFraction: 0.714286 normChi2 9.18183\r\n\r\n**In 361318:140:255901697**\r\npt= 28.8683 eta= 0.269369 phi= -1.65092\r\npass: isGlobal, isTracker, isLooseMuon, isMediumMuon\r\nTracker: pt,eta,phi: 20.5644 0.272467 -1.60871 validFraction: 1 normChi2 0.663753\r\nGLB:  pt,eta,phi: 20.5427 0.272464 -1.6087 validFraction: 1 normChi2 0.763495", "branch": "master", "changed_files": 1, "comments": 3, "commits": 1, "created_at": "1735406218", "deletions": 0, "labels": ["pending-signatures", "tests-pending", "orp-pending", "code-checks-approved", "xpog-pending"], "milestone": "CMSSW_15_0_X", "number": 47031, "release-notes": [], "review_comments": 0, "state": "open", "title": "Add muonBestTrackType value", "updated_at": "1735406405", "user": "namapane"}