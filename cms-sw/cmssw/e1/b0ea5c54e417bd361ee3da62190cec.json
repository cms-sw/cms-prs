{"additions": 25, "auther_ref": "PFBlockAlgoUpdate_RemoveRudandantLoopOfElements", "auther_sha": "f239cfb951497e26cfe4c2e8f4e229ab6eb2d260", "author": "hatakeyamak", "body": "#### PR description:\r\n\r\nTuning the looping logic so that we can remove the redundant looping of elements for link tests in PFBlockAlgo. This simple change should make the PFBlockAlgo [one of the most timing consuming part of PF] faster by a factor up to 1.8 with no change in outputs.\r\n\r\nUsing HLT's OnLine_HLT_GRun.py on:\r\n/eos/cms/store/data/Run2018D/EphemeralHLTPhysics5/RAW/v1/000/324/897/00000/F5F13777-D664-C747-88AA-0459C1E35254.root\r\n(1000 events)\r\n**FastReport**\r\n```\r\n[Before]\r\nCPU time avg.      when run  Real time avg.      when run     Alloc. avg.      when run   Dealloc. avg.      when run  Modules\r\n        44.0 ms        44.0 ms        44.7 ms        44.7 ms       +3349 kB       +3349 kB       -2607 kB       -2607 kB    hltParticleFlowBlock\r\n         0.9 ms        44.0 ms         0.9 ms        44.4 ms         +72 kB       +3434 kB         -55 kB       -2663 kB    hltParticleFlowBlockForTaus\r\n         1.5 ms        43.0 ms         1.6 ms        45.2 ms        +112 kB       +3121 kB         -85 kB       -2381 kB    hltParticleFlowBlockReg\r\n\r\n[With this PR]\r\n        24.7 ms        24.7 ms        26.3 ms        26.3 ms       +3349 kB       +3349 kB       -2607 kB       -2607 kB    hltParticleFlowBlock\r\n         0.5 ms        25.2 ms         0.6 ms        28.7 ms         +72 kB       +3438 kB         -56 kB       -2668 kB    hltParticleFlowBlockForTaus\r\n         0.9 ms        24.5 ms         1.0 ms        27.8 ms        +112 kB       +3120 kB         -85 kB       -2382 kB    hltParticleFlowBlockReg\r\n```\r\n\r\nAnd, just for reference, if we also drop PS from PFBlockProducer for HLT as discussed in the TSG meeting, March 4th, (https://github.com/hatakeyamak/cmssw/pull/new/PFBlockProducerDropPS2)\r\n```\r\n        14.7 ms        14.7 ms        15.9 ms        15.9 ms       +1742 kB       +1742 kB       -1400 kB       -1400 kB    hltParticleFlowBlock\r\n         0.3 ms        16.2 ms         0.4 ms        17.3 ms         +36 kB       +1752 kB         -29 kB       -1399 kB    hltParticleFlowBlockForTaus\r\n         0.5 ms        12.6 ms         0.5 ms        12.9 ms         +52 kB       +1460 kB         -41 kB       -1146 kB    hltParticleFlowBlockReg\r\n```\r\n\r\n#### PR validation:\r\n\r\nCheck with 100 events from 2018 data that this change yields the identical list of PF candidates.\r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\n\r\nThis is not backport.\r\n\r\n@bendavid @jsalfeld @jpata ", "branch": "master", "changed_files": 7, "closed_at": "1584389940", "comments": 35, "commits": 3, "created_at": "1582813721", "deletions": 6, "labels": ["code-checks-approved", "comparison-available", "fully-signed", "orp-approved", "reconstruction-approved", "tests-approved"], "merge_commit_sha": "fad919f33d9865b1a9e5f7de16e4660716deeeb4", "merged_at": "1584389939", "merged_by": "cmsbuild", "milestone": "CMSSW_11_1_X", "number": 29054, "release-notes": [], "review_comments": 2, "state": "closed", "title": "Remove redundant looping of elements for link tests in PFBlockAlgo", "updated_at": "1584389940", "user": "hatakeyamak"}