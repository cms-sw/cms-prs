{"additions": 41, "auther_ref": "reduce_ECAL_HCAL_GPU_memory_usage_124x", "auther_sha": "7d941ac35b6e50e158b0b20caf0cd1ee3e266f2f", "author": "fwyzard", "body": "#### PR description:\r\n    \r\nAllocate memory buffers based on the actual number of events, instead of always allocating the maximum size.\r\n\r\nDeclare the the obsolete parameters as optional, and ignore them if they are present.\r\n\r\nReduces the total GPU memory from running the HLT with 4 jobs with 32 threads and 32 streams by about 25%:\r\n\r\nrelease | total | reserved | used | free\r\n-- | -- | -- | -- | --\r\nCMSSW_12_4_9 | 15360 MB | 449 MB | 10678 - 10090 MB | 4231 - 4819 MB\r\nwith #39580 | 15360 MB | 449 MB | 7366 - 8056 MB | 7543 - 6853 MB\r\n\r\nThanks to @VinInn for finding the issue and for the changes.\r\n\r\n\r\n#### PR validation:\r\n\r\nThe full HLT menu runs on GPU (with 12.4.9 plus #39580) without issues.\r\n\r\n\r\n#### If this PR is a backport please specify the original PR and why you need to backport that PR. If this PR will be backported please specify to which release cycle the backport is meant for:\r\n\r\nBackport of https://github.com/cms-sw/cmssw/pull/39577.", "branch": "CMSSW_12_4_X", "changed_files": 6, "comments": 11, "commits": 2, "created_at": "1664793877", "deletions": 66, "labels": ["reconstruction-pending", "pending-signatures", "tests-approved", "orp-pending"], "milestone": "CMSSW_12_4_X", "number": 39580, "release-notes": [], "review_comments": 4, "state": "open", "title": "Reduce the ECAL and HCAL GPU memory usage [12.4.x]", "updated_at": "1664965251", "user": "fwyzard"}