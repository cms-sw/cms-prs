{"additions": 589, "auther_ref": "Phase1-HE1", "auther_sha": "daccc9e310ce6df488817fb813fe4d4161cd3e73", "author": "kpedro88", "body": "This PR duplicates all QIE10 functionality for QIE11 (to be used with HE in 2017, and later with HB). Most of the changes are just a straight extension of the changes already made for QIE10. A few other notable changes:\n\n1) Removed `run2_HF_2016` sub-era: `HcalDigitizer` now automatically assigns a cell to a digi collection based on `QIEType` in the database, no other need for this sub-era.\n\n2) Cleanup: Removed some unused code in HcalDigitizer and reduced code duplication in a few classes.\n\n3) Added `run2_HE_2017` sub-era for necessary customizations for the SiPM simulation.\n\n4) Rearranged HcalCustoms slightly, following the idea that these customization functions will continue to be used for (temporary) development work with hardcode conditions. Now available: \na) `customise_Hcal2016` (turns on `testHFQIE10` option)\nb) `customise_Hcal2017` (turns on QIE10s throughout HF, uses QIE8/HPD for HE, but allows for extra depths if 2017dev geometry is used)\nc) `customise_Hcal2017Full` (as previous, but with QIE11/SiPM conditions for HE; to use this, also enable `run2_HE_2017` sub-era)\n\n5) Made some changes to the `HitFilter` classes so they are more uniform and more efficient:\na) Take a vector of subdet ids to handle HBHE case\nb) Use `std::binary_search()` instead of `std::find()` when checking a list of DetIds\n\nA few validations:\n\ni) Premixing:\n![fc_standard_vs_premix_qie11.png](http://www.kjplanet.com/pr/fc_standard_vs_premix_qie11.png)\n\nii) QIE11 digis with 2017dev geometry:\n![qie11_ieta.png](http://www.kjplanet.com/pr/qie11_ieta.png)\n![qie11_depth.png](http://www.kjplanet.com/pr/qie11_depth.png)\n\nScript for testing with 2017dev geometry:\n\n```\n#!/bin/bash\n\n cmsDriver.py SinglePiE50HCAL_pythia8_cfi  --conditions auto:phase1_2017_design -n 10 --era Run2_2017 --geometry \"Configuration.Geometry.GeometryExtended2017dev_cff,Configuration.Geometry.GeometryExtended2017devReco_cff\" --eventcontent FEVTDEBUG -s GEN,SIM --datatier GEN-SIM --beamspot Realistic50ns13TeVCollision --fileout file:step1.root --customise SLHCUpgradeSimulations/Configuration/HCalCustoms.customise_Hcal2017Full > step1_SinglePiE50_UP15+SinglePiE50_UP15+DIGIUP15+RECOUP15+HARVESTUP15.log  2>&1\n\n\n cmsDriver.py step2  --conditions auto:phase1_2017_design -s DIGI:pdigi_valid,L1,DIGI2RAW,HLT:@relval25ns --datatier GEN-SIM-DIGI-RAW-HLTDEBUG -n 10 --era Run2_2017 --geometry \"Configuration.Geometry.GeometryExtended2017dev_cff,Configuration.Geometry.GeometryExtended2017devReco_cff\" --eventcontent FEVTDEBUGHLT --filein file:step1.root  --fileout file:step2.root --customise SLHCUpgradeSimulations/Configuration/HCalCustoms.customise_Hcal2017Full > step2_SinglePiE50_UP15+SinglePiE50_UP15+DIGIUP15+RECOUP15+HARVESTUP15.log  2>&1\n\n\n cmsDriver.py step3  --runUnscheduled  --conditions auto:phase1_2017_design -s RAW2DIGI,L1Reco,RECO,EI,PAT --datatier GEN-SIM-RECO,MINIAODSIM -n 10 --era Run2_2017 --geometry \"Configuration.Geometry.GeometryExtended2017dev_cff,Configuration.Geometry.GeometryExtended2017devReco_cff\" --eventcontent RECOSIM,MINIAODSIM --filein file:step2.root  --fileout file:step3.root --customise SLHCUpgradeSimulations/Configuration/HCalCustoms.customise_Hcal2017Full > step3_SinglePiE50_UP15+SinglePiE50_UP15+DIGIUP15+RECOUP15+HARVESTUP15.log  2>&1\n```\n", "branch": "CMSSW_8_1_X", "changed_files": 49, "closed_at": "1463493050", "comments": 9, "commits": 1, "created_at": "1463071130", "deletions": 384, "labels": ["alca-approved", "comparison-available", "geometry-approved", "operations-pending", "orp-pending", "pending-signatures", "simulation-approved", "tests-approved"], "merge_commit_sha": "90717ffb2251dae53eb3f4494c11cbdd43d744ee", "merged_at": "1463493050", "merged_by": "davidlange6", "milestone": "Next CMSSW_8_1_X", "number": 14482, "release-notes": [], "review_comments": 0, "state": "closed", "title": "add QIE11 support in hcal digitization", "updated_at": "1463493050", "user": "kpedro88"}