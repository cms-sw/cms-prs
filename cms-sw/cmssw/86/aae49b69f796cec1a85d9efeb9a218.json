{"additions": 4, "auther_ref": "ubsan-ReduceMantissaToNbitsRounding-suppress-shift", "auther_sha": "cd9abc78088ce1cb2f2e12cf4a9933312f90e324", "author": "smuzaffar", "body": "This PR suggests to suppress the `-ve shift exponent` runtime error from DataFormats/Math/interface/libminifloat.h [a] . \r\nThere is discussion at https://github.com/cms-sw/cmssw/issues/29564 to improve `ReduceMantissaToNbitsRounding` so may be if we follow that direction then change in this PR is not needed.\r\n\r\n[a] https://cmssdt.cern.ch/SDT/cgi-bin/buildlogs/raw/el8_amd64_gcc12/CMSSW_14_2_UBSAN_X_2024-10-25-2300/pyRelValMatrixLogs/run/139.005_AlCaPhiSym2021/step3_AlCaPhiSym2021.log\r\n```\r\nsrc/DataFormats/Math/interface/libminifloat.h:61:78: runtime error: shift exponent -1 is negative\r\n    #0 0x7fc173925d59 in MiniFloatConverter::ReduceMantissaToNbitsRounding::ReduceMantissaToNbitsRounding(int) src/DataFormats/Math/interface/libminifloat.h:61\r\n    #1 0x7fc1739cfe6d in void MiniFloatConverter::reduceMantissaToNbitsRounding<__gnu_cxx::__normal_iterator<float*, std::vector<float, std::allocator<float> > >, __gnu_cxx::__normal_iterator<float*, std::vector<float, std::allocator<float> > > >(int, __gnu_cxx::__normal_iterator<float*, std::vector<float, std::allocator<float> > >, __gnu_cxx::__normal_iterator<float*, std::vector<float, std::allocator<float> > >, __gnu_cxx::__normal_iterator<float*, std::vector<float, std::allocator<float> > >) src/DataFormats/Math/interface/libminifloat.h:96\r\n    #2 0x7fc1739cfe6d in void nanoaod::flatTableHelper::MaybeMantissaReduce<float>::bulk<edm::Span<__gnu_cxx::__normal_iterator<float*, std::vector<float, std::allocator<float> > > > >(edm::Span<__gnu_cxx::__normal_iterator<float*, std::vector<float, std::allocator<float> > > >&&) const src/DataFormats/NanoAOD/interface/FlatTable.h:33\r\n    #3 0x7fc1739cfe6d in void nanoaod::FlatTable::addColumn<float, std::vector<float, std::allocator<float> > >(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::vector<float, std::allocator<float> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int) src/DataFormats/NanoAOD/interface/FlatTable.h:127\r\n    #4 0x7fc1739d4fb8 in FuncVariable<EcalPhiSymRecHit, StringObjectFunction<EcalPhiSymRecHit, false>, float>::fill(std::vector<EcalPhiSymRecHit const*, std::allocator<EcalPhiSymRecHit const*> >&, nanoaod::FlatTable&) const src/PhysicsTools/NanoAOD/interface/SimpleFlatTableProducer.h:68\r\n    #5 0x7fc1739b40b1 in RunSimpleFlatTableProducer<EcalPhiSymRecHit, std::vector<EcalPhiSymRecHit, std::allocator<EcalPhiSymRecHit> > >::fillTable(edm::Run const&, edm::Handle<std::vector<EcalPhiSymRecHit, std::allocator<EcalPhiSymRecHit> > > const&) const src/PhysicsTools/NanoAOD/interface/SimpleFlatTableProducer.h:862\r\n    #6 0x7fc1739e63f4 in SimpleFlatTableProducerBaseRun<EcalPhiSymRecHit, std::vector<EcalPhiSymRecHit, std::allocator<EcalPhiSymRecHit> > >::endRunProduce(edm::Run&, edm::EventSetup const&) src/PhysicsTools/NanoAOD/interface/SimpleFlatTableProducer.h:799\r\n```", "branch": "master", "changed_files": 1, "closed_at": "1730200271", "comments": 10, "commits": 1, "created_at": "1730125352", "deletions": 0, "labels": ["reconstruction-approved", "fully-signed", "tests-approved", "orp-approved", "code-checks-approved"], "merge_commit_sha": "ce5ea58c3152777d83174e8fc3dc1fe1965fca33", "merged_at": "1730200270", "merged_by": "cmsbuild", "milestone": "CMSSW_14_2_X", "number": 46535, "release-notes": [], "review_comments": 0, "state": "closed", "title": "[UBSAN]Suppess -ve shift error for ReduceMantissaToNbitsRounding", "updated_at": "1730200271", "user": "smuzaffar"}