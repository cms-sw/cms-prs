{"additions": 205, "auther_ref": "CMSSW_16_0_X_m2m_tau", "auther_sha": "af587abe2d5d50782b256dc612c7f6e4e2ffc3bb", "author": "mbluj", "body": "#### PR description:\r\n\r\nThis is a followup development to the mini-v2/v4 to mini-v6 (cms-sw/cmssw#49098), which fixes issues related to (boosted)taus.\r\nThese issue were spot when comparing the outputs of the nano-v15 produced using two different workflows: one based on the mini-v6 from the mini-v2/v4 (re-mini wf) and the other produced directly from the mini-v2/v4 (direct wf), as documented [here](https://ftorresd.web.cern.ch/ftorresd/xpog/mini2mini_2025_10_28).\r\n\r\nThere were two types of issue:\r\n* the difference in the DeepTau output affecting then the (boosted)tau selection applied at the nano step,\r\n* missing tauIDs by unified taggers (PNet & UParT).\r\n\r\nThe first issue was caused by the use of different collections of pf-candidates with different puppi tunes in the DeepTauID input: in the direct wf pf-candidates with \"original\" puppi weights were used while in the re-mini wf pf-candidates with with updated puppi were used. These two approaches lead to comparable, but not identical DeepTauID responses, the differences are especially important for jet-like tau candidates (low vsjet scores). The fix was to use pf-candidates with \"original\" puppi weights.\r\n\r\nFixing the former issue required the addition of \"hybrid\" taus, i.e. a mixture of taus reconstructed by HPS reconstruction and taus tagged by unified jet taggers. Modern deep-flavour taggers were added to the CHS AK4 jet collection (slimmedJets) to make this work. These taggers are anyway present in the \"genuine\" mini v6 with CMSSW_15_0 (Summer24 production) therefore adding them makes re-mini v6 more similar to the \"genuine\" version, although they are not necessary for nano v15 where CHS jets are not stored. \r\n\r\n**Question for BTV experts:** In the proposed setup all deep-flavour taggers are added to the CHS AK4 jets (DeepBTag, DeepFlavour, ParticleNet, RobustParTAK4, and UnifiedParTAK4). Is it fine, or should only a subset be kept? Should it be era dependent? Note that for taus only ParticleNet (central) is necessary.\r\n\r\n#### PR validation:\r\n\r\nChecked with private wfs as set [this tool](https://gist.github.com/ftorrresd/3689ec54f4a5367a757ce0b2bc83e976) and with the standard wfs 2500.0401-4 and 2500.0501-3 as follows:\r\n`runTheMatrix.py -l 2500.0401,2500.0402,2500.0403,2500.0404,2500.0501,2500.0502,2500.0503 -i all --ibeos`\r\n\r\n#### If this PR is a backport please specify the original PR and why you need to backport that PR. If this PR will be backported please specify to which release cycle the backport is meant for:\r\n\r\nTo be backported to whichever release it is needed - probably all down to 15_0. Experts please comment!\r\n", "branch": "master", "changed_files": 1, "comments": 3, "commits": 4, "created_at": "1762333670", "deletions": 1, "labels": ["reconstruction-pending", "pending-signatures", "tests-pending", "orp-pending", "code-checks-approved", "xpog-pending"], "milestone": "CMSSW_16_0_X", "number": 49318, "release-notes": [], "review_comments": 0, "state": "open", "title": "Tau fixes to mini-to-mini", "updated_at": "1762333780", "user": "mbluj"}