{"additions": 8549, "auther_ref": "patatrack_integration_10_N_pixel_tracks", "auther_sha": "16e7fdbac0421964904e27710ba79314cab614cd", "author": "cms-patatrack", "body": "#### PR description:\r\n\r\nData formats and algorithms for the Pixel track reconstruction running on GPU.\r\nImplements building the pixel pairs, running the CA, applying the Fishbone cleaning, and performing either Riemann or Broken Line fit to produce tracks made by triplets and/or ntuplets.\r\n\r\nIncludes changes to \"MTV\" for the validation of pixel-only tracks.\r\n\r\n#### PR validation:\r\n\r\nChanges in use in the Patatrack releases.\r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\n\r\nIncludes changes from:\r\n  - cms-patatrack#23: Add a DQM sequence for pixel-only tracking\r\n  - cms-patatrack#31: Use the `gpu` modifier to read the pixel clusters from the unpacker\r\n  - cms-patatrack#34: Implement Riemann fit for pixel tracks\r\n  - cms-patatrack#60: Port the Riemann fit to CUDA\r\n  - cms-patatrack#62: Implement a Heterogeneous version of Raw2Cluster and RecHit\r\n  - cms-patatrack#83: Clean up `CAHitNtupletHeterogeneousEDProducer`\r\n  - cms-patatrack#100: Next prototype of the framework integration\r\n  - cms-patatrack#105: Heterogeneous ClusterTPAssociation\r\n  - cms-patatrack#106: Customize function to provide a minimal configuration for profiling\r\n  - cms-patatrack#111: Fix Cluster-to-TrackingParticle matching for pixel tracking CPU workflow\r\n  - cms-patatrack#118: Pixel doublets on GPU\r\n  - cms-patatrack#122: Cleanup defines, includes, file names, and debug messages\r\n  - cms-patatrack#123: Move all CUDA code to the plugins/ directory\r\n  - cms-patatrack#126: Remove GPU-CellularAutomaton dependence on CPU doublets\r\n  - cms-patatrack#132: Add optional flags to disable SOA->legacy conversion and GPU->CPU transfer\r\n  - cms-patatrack#134: Cleanup after merging with CMSSW 10.2.2\r\n  - cms-patatrack#143: Reformat the Riemann fit code\r\n  - cms-patatrack#148: Clean up and bugfixes for the Riemann fit\r\n  - cms-patatrack#156: Add MTV instance for pixel tracks from PV\r\n  - cms-patatrack#158: Tune and speed up doublet algo\r\n  - cms-patatrack#159: Reduce CA memory need\r\n  - cms-patatrack#167: Optimise gpuPixelDoublets::doubletsFromHisto() kernel\r\n  - cms-patatrack#169: Add Rieman fit to the CA\r\n  - cms-patatrack#171: Introduce Cluster Charge Cut, optimize Histogram (bucket sorting)\r\n  - cms-patatrack#174: Riemann fit multiple scattering\r\n  - cms-patatrack#178: Clean up Riemann fit in CA \r\n  - cms-patatrack#186: Suppress asserts in the GPU code, unless GPU_DEBUG is defined\r\n  - cms-patatrack#190: Recover pre-10.4.x Riemann fit rework\r\n  - cms-patatrack#190: Riemann fit rework\r\n  - cms-patatrack#199: Fix MTV validation of initialStepPreSplitting tracks and add B-hadron MTV variation to pixel track validation sequence\r\n  - cms-patatrack#202: Migrate tracker local reconstruction and pixel tracking to Tasks (backport #25163)\r\n  - cms-patatrack#203: Address code style and quality issues\r\n  - cms-patatrack#216: Full workflow from raw data to pixel tracks and vertices on GPUs\r\n  - cms-patatrack#249: Remove unnecessary pragmas\r\n  - cms-patatrack#252: Skip CUDA-related tests if no GPU is present\r\n  - cms-patatrack#260: Speed up the doublet finder\r\n  - cms-patatrack#285: Various updates to pixel track/vertex DQM and MTV\r\n  - cms-patatrack#338: Clean up by clang-format\r\n  - cms-patatrack#338: Improve pixel doublets and CA, and extend debugging functionality\r\n  - cms-patatrack#338: Migrate the pixel rechits producer and CA to the new heterogeneous framework\r\n  - cms-patatrack#338: Rework the Riemann fit and broken line fit\r\n  - cms-patatrack#340: Implementation of the broken line fit\r\n  - cms-patatrack#347: Make GPU CellularAutomaton configurable\r\n  - cms-patatrack#347: Make doClusterCut, doZCut, doPhiCut configurable\r\n  - cms-patatrack#364: Move event and stream caches, and caching allocators out from CUDAService\r\n  - cms-patatrack#365: Build seeds directly from cpu product\r\n  - cms-patatrack#382: Implement triplets in the pixel ntuplet producer\r\n  - cms-patatrack#383: fix bug in (and extend) cluster shape cut\r\n  - cms-patatrack#384: Port the whole pixel workflow to new heterogeneous framework\r\n  - cms-patatrack#385: Implement full Pixel SoA workflow on CPU\r\n  - cms-patatrack#387: Fix clang warnings\r\n  - cms-patatrack#389: Replace use of API wrapper stream and event with plain CUDA, part 1\r\n  - cms-patatrack#391: Synchronize event in the CUDAProductBase destructor\r\n  - cms-patatrack#395: Replace CUDA API wrapper memory operations with native CUDA calls\r\n  - cms-patatrack#409: Migrate cluster track associator\r\n  - cms-patatrack#411: Optimize doublet reconstruction and cuts\r\n  - cms-patatrack#416: Drop obsolete heterogenous framework\r\n  - cms-patatrack#417: Remove last references to CUDA API Wrappers\r\n  - cms-patatrack#423: Rename exitSansCUDADevices to requireCUDADevices\r\n  - cms-patatrack#429: Implement changes from the CUDA framework review\r\n  - cms-patatrack#441: Apply feedback from upstream PR\r\n  - cms-patatrack#442: Integrate the comments from the upstream PRs\r\n  - cms-patatrack#446: Fix use of namespaces\r\n  - cms-patatrack#447: Replace cub prefix scan with home-brewed one\r\n  - cms-patatrack#456: Use std::isnan\r\n  - cms-patatrack#509: Reduce GPU memory usage\r\n  - cms-patatrack#544: Protect CAHitNtupletCUDA ctor/dtor when CUDA is not available\r\n  - cms-patatrack#549: Update the RelVal workflows and the CPU customisation\r\n  - cms-patatrack#553: Add customisations for profiling the Pixel-only workflow\r\n  - cms-patatrack#556: Further clean up after merging CMSSW_11_2_0_pre7\r\n  - cms-patatrack#560: Move the siPixelClusters.payloadType to the SoA-on-CPU customisation\r\n  - cms-patatrack#583: Move hit indexes to 32 bits\r\n  - cms-patatrack#593: Clean up the pixel local reconstruction code\r\n  - cms-patatrack#602: Clean up the pixel local reconstruction code\r\n  - cms-patatrack#606: Clean up the pixel track reconstruction code\r\n  - cms-patatrack#610: Further clean up the CA ntuplet generator\r\n  - cms-patatrack#611: Minor fixes and clean up for the pixel track reconstruction code", "branch": "master", "changed_files": 75, "closed_at": "1617273465", "comments": 149, "commits": 103, "created_at": "1602187257", "deletions": 142, "labels": ["code-checks-approved", "dqm-approved", "fully-signed", "heterogeneous-approved", "orp-approved", "reconstruction-approved", "tests-approved"], "merge_commit_sha": "d37323e825aeec39912cd78d10ce70dadd64ee26", "merged_at": "1617273465", "merged_by": "cmsbuild", "milestone": "CMSSW_11_3_X", "number": 31722, "release-notes": [], "review_comments": 227, "state": "closed", "title": "Patatrack integration - Pixel track reconstruction (10/N)", "updated_at": "1617273466", "user": "fwyzard"}