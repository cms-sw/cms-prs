{"additions": 13, "auther_ref": "pps_sector_fixes", "auther_sha": "cb09b43eb8ce11079c25426228cbd194d9e8b1a3", "author": "CTPPS", "body": "#### PR description:\r\n\r\nThis PR contains fixes to two rare problems related to ``ForwardProton::LHCSector``.\r\n\r\n1) In ProtonReconstructionAlgorithm.cc: rarely, it may happen that the scattering angles (th_x or th_y) are reconstructed large (mis-reconstruction). In this case, an argument to sqrt becomes negative and consequently proton's momentum z component is assigned NAN. The (undefined) sign of p.z is used in the method ``ForwardProton::lhcSector()`` which in turn returns an invalid value. This PR fixes this problem by checking the sqrt argument and if negative using a realistic value for p.z, yielding correct LHC sector identification.\r\n\r\n2) In CTPPSProtonReconstructionSimulationValidator.cc: explicitly check whether proton was reconstructed in LHC sector 56 - protons with invalid sector do no longer pass to the \"sector 56\" category.\r\n\r\nThe above problems were spotted in the \"direct\" simulation with an occurrence O(1 in million events). Therefore the impact of these fixes is expected negligible.\r\n\r\n#### PR validation:\r\n\r\nThe following plots compare results before this PR (blue) and after the PR (red dashed). The top one is for \"direct\" simulation, the bottom is for Run2 data reconstruction. No differences are observed - compatible with the rare nature of the problems being fixed.\r\n\r\nFor the few failing events isolated in the \"direct\" simulation, it has been checked that the proposed PR fixes the problem.\r\n\r\n![dirsim_cmp](https://user-images.githubusercontent.com/17830858/94370126-58628480-00ee-11eb-80ac-93f4660aae2a.png)\r\n![reco_cmp](https://user-images.githubusercontent.com/17830858/94370127-58fb1b00-00ee-11eb-8ab6-05f57ada6af5.png)\r\n\r\n\r\n", "branch": "master", "changed_files": 2, "closed_at": "1601404766", "comments": 30, "commits": 5, "created_at": "1601216766", "deletions": 8, "labels": ["code-checks-approved", "comparison-available", "dqm-approved", "fully-signed", "orp-approved", "reconstruction-approved", "tests-approved"], "merge_commit_sha": "6e11af16f0d69ec46e60cf8bd40051c7495ccc49", "merged_at": "1601404766", "merged_by": "cmsbuild", "milestone": "CMSSW_11_2_X", "number": 31599, "release-notes": [], "review_comments": 2, "state": "closed", "title": "PPS: fixes related to ForwardProton::LHCSector", "updated_at": "1601404766", "user": "jan-kaspar"}