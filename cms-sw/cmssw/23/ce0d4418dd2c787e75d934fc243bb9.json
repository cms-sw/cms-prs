{"additions": 57, "auther_ref": "mm_fix_gpVertexAnalyzer_15_0_X", "auther_sha": "373067b2b8a25d1d4a4a7e5539cf1c13e3ca9f56", "author": "mmusich", "body": "backport of https://github.com/cms-sw/cmssw/pull/48074\r\n\r\n#### PR description:\r\n\r\nIt was noticed that the results of the `GenericV` validation introduced at https://github.com/cms-sw/cmssw/pull/47055 was not providing results for the transverse impact parameter w.r.t. the PV (see e.g. [here](https://tkello2.web.cern.ch/gallery_13p6TeV_Offline_Generic_391698_v4.html)). \r\nThis was traced in a wrong set of configuration parameters in which minimum and maximum of axis range was swapped, see:\r\n\r\nhttps://github.com/cms-sw/cmssw/blob/12e5a7e8dfef4fd31862ff6a3cfe36bdb440f552/Alignment/OfflineValidation/python/TkAlAllInOneTool/GenericV_cfg.py#L185-L186\r\n\r\nThe goal of this PR is to fix the bug and improve the code structure of the validation module.\r\nI also provide a check to avoid giving meaningless axis boundaries in 12658504d7f17ed2521a3b5bcecfc3c75d6055bf.\r\nFinally in commit https://github.com/cms-sw/cmssw/pull/48075/commits/795e7342bc598cf4c0fe2a016885ee5677c7a6a6 I profit to fix another typo in an equivalent module that is run as part of the offline DQM.\r\n\r\n#### PR validation:\r\n\r\nRun with the following cmssw configuration file \r\n\r\n<details>\r\n\r\n<summary> Click to get configuration file </summary>\r\n\r\n### testGeneralPurposeVertexAnalyzer_cfg.py\r\n\r\n```python\r\nimport FWCore.ParameterSet.Config as cms\r\nfrom Alignment.OfflineValidation.TkAlAllInOneTool.defaultInputFiles_cff import filesDefaultMC_TTBarPU\r\n\r\nfrom Configuration.Eras.Era_Run3_cff import Run3\r\nprocess = cms.Process(\"Demo\", Run3)\r\n\r\nprocess.source = cms.Source(\"PoolSource\",\r\n                            fileNames = filesDefaultMC_TTBarPU,\r\n                            duplicateCheckMode = cms.untracked.string('checkAllFilesOpened'))\r\n\r\nprocess.maxEvents = cms.untracked.PSet( input = cms.untracked.int32(-1) )\r\n\r\n####################################################################\r\n# Get the GlogalTag\r\n####################################################################\r\nprocess.load(\"Configuration.StandardSequences.FrontierConditions_GlobalTag_cff\")\r\nfrom Configuration.AlCa.GlobalTag import GlobalTag\r\nprocess.GlobalTag = GlobalTag(process.GlobalTag, '125X_mcRun3_2022_realistic_v3', '')\r\n\r\n###################################################################\r\n# Messages\r\n###################################################################\r\nprocess.load('FWCore.MessageService.MessageLogger_cfi')   \r\nprocess.MessageLogger.cerr.enable = False\r\nprocess.MessageLogger.FilterOutLowPt=dict()  \r\nprocess.MessageLogger.cout = cms.untracked.PSet(\r\n    enable = cms.untracked.bool(True),\r\n    threshold = cms.untracked.string(\"INFO\"),\r\n    default   = cms.untracked.PSet(limit = cms.untracked.int32(0)),                       \r\n    FwkReport = cms.untracked.PSet(limit = cms.untracked.int32(-1),\r\n                                   reportEvery = cms.untracked.int32(10)),\r\n    GeneralPurposeVertexAnalyzer = cms.untracked.PSet( limit = cms.untracked.int32(-1)),\r\n    enableStatistics = cms.untracked.bool(True))\r\n\r\nprocess.vertexanalysis = cms.EDAnalyzer('GeneralPurposeVertexAnalyzer',\r\n                                        ndof = cms.int32(4),\r\n                                        vertexLabel = cms.InputTag('offlinePrimaryVertices'),\r\n                                        beamSpotLabel = cms.InputTag('offlineBeamSpot'),\r\n                                        Xpos = cms.double(0.1),\r\n                                        Ypos = cms.double(0),\r\n                                        TkSizeBin = cms.int32(100),\r\n                                        TkSizeMin = cms.double(499.5),\r\n                                        TkSizeMax = cms.double(-0.5),\r\n                                        DxyBin = cms.int32(100),\r\n                                        DxyMin = cms.double(2000),\r\n                                        DxyMax = cms.double(-2000),\r\n                                        DzBin = cms.int32(100),\r\n                                        DzMin = cms.double(-2000),\r\n                                        DzMax = cms.double(2000),\r\n                                        PhiBin = cms.int32(32),\r\n                                        PhiBin2D = cms.int32(12),\r\n                                        PhiMin = cms.double(-3.1415926535897931),\r\n                                        PhiMax = cms.double(3.1415926535897931),\r\n                                        EtaBin = cms.int32(26),\r\n                                        EtaBin2D = cms.int32(8),\r\n                                        EtaMin = cms.double(-2.7),\r\n                                        EtaMax = cms.double(2.7))\r\n\r\nprocess.TFileService = cms.Service(\"TFileService\",\r\n                                   fileName=cms.string(\"test.root\"))\r\n\r\nprocess.load(\"RecoVertex.BeamSpotProducer.BeamSpot_cff\")\r\n\r\n####################################################################\r\n# Path\r\n####################################################################\r\nprocess.p2 = cms.Path(process.offlineBeamSpot*\r\n                      process.vertexanalysis)\r\n```\r\n\r\n</details>\r\n\r\n\r\nand obtained the desired output plots.\r\n\r\n#### If this PR is a backport please specify the original PR and why you need to backport that PR. If this PR will be backported please specify to which release cycle the backport is meant for:\r\n\r\nVerbatim backport of https://github.com/cms-sw/cmssw/pull/48074 to CMSSW_15_0_X for 2025 data-taking operations.\r\n", "branch": "CMSSW_15_0_X", "changed_files": 4, "comments": 4, "commits": 4, "created_at": "1747200128", "deletions": 54, "labels": ["dqm-pending", "alca-pending", "pending-signatures", "orp-pending", "tests-started", "bug-fix", "backport", "tracking", "trk"], "milestone": "CMSSW_15_0_X", "number": 48075, "release-notes": [], "review_comments": 0, "state": "open", "title": "[15.0.X] Alignment Validation: fix `GeneralPurposeVertexAnalyzer` configuration", "updated_at": "1747208631", "user": "mmusich"}