{"additions": 50, "auther_ref": "fix_pfeg_memory", "auther_sha": "e8b895792c53a7feeb8994a0d820dbe86ef16214", "author": "lgray", "body": "Memory fixes from Lindsey.\n\nRetained memory excluding products before applying this:\n![lgray_before](https://cloud.githubusercontent.com/assets/6480160/7767962/aa09d256-006e-11e5-98ff-83027ebd3325.png)\n\nAfter applying this pull request:\n![lgray_after](https://cloud.githubusercontent.com/assets/6480160/7767968/b30e6cf4-006e-11e5-9a30-b4da9fc75450.png)\n\nNote that the yellow line (ElectronSeedProducer) was fixed in #9194, but I didn't have a \"before\" plot with that fix.  So a big saving of 40-50 Mb from PFClusterProducer.  No visible change in PFEGammaProducer, although that could be washed out from the big allocation in `beginRun`.  That's probably unavoidable from a geom service or something (though I haven't checked) - the way I count the memory, services get lumped in with the first module that calls them.\n\nSo current state (this is basically the \"after\" plot above, but not range limited to match the \"before\" and the new top 25 rather than the old top 25):\n![currentstate_retained](https://cloud.githubusercontent.com/assets/6480160/7768158/56f68742-0070-11e5-8450-f8de287ec75e.png)\nNow a lot of the big allocations are in beginRun or beginLumi, which as mentioned above I'm going to assume are unavoidable for now.  Might not be but I'll check those if and when memory becomes a problem again.\nOnly big thing left that makes the allocations in the events now is `SeedGeneratorFromRegionHitsProducer`.  I'll compare against 75X because I think Vincenzo made a lot of improvements.  Once I get that down I'll run a check of VmSize and RSS and see where we stand in the big picture.\n\n@lgray\n", "branch": "CMSSW_6_2_X_SLHC", "changed_files": 7, "closed_at": "1432293692", "comments": 11, "commits": 3, "created_at": "1432281497", "deletions": 2, "labels": ["comparison-pending", "orp-pending", "pending-signatures", "reconstruction-pending", "tests-approved"], "merge_commit_sha": "c7e2dc22377f1334ca8a9218313f39fb01374417", "merged_at": "1432293692", "merged_by": "cmsbuild", "milestone": "Next CMSSW_6_2_X_SLHC", "number": 9227, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Fix PFCluster and PFEGamma memory", "updated_at": "1432293692", "user": "mark-grimes"}