{"additions": 135, "auther_ref": "fixPythonSearch", "auther_sha": "0a444c07cd7ff11cf01bd2a1ec488a757ad0ce6e", "author": "mark-grimes", "body": "Currently the edmPythonSearch tool doesn't include modules imported with `process.load( <module> )`, which makes it almost useless.  This adds a custom override of the modulefinder opcode scanner which searches for `process.load(...)` statements, as well as the normal `import <module>` type statements.\n\nIt should work regardless of the name of the Process object, and regardless of how `FWCore.ParameterSet.Config` was imported (e.g. `import FWCore.ParameterSet.Config` or `import FWCore.ParameterSet.Config as foo`)\n\nAs an example, step3 of workflow 1306.0 (and probably all others) uses \"process.load\" to import `Configuration.StandardSequences.Services_cff`, which (as an arbitrary example) contains the comment:\n\n```\n#an \"intermediate layer\" remains, just in case somebody is using it...\n```\n\nBefore this pull request\n\n```\nedmPythonSearch \"just in case somebody\" 1306.0_SingleMuPt1_UP15+SingleMuPt1_UP15+DIGIUP15+RECOUP15+HARVESTUP15+MINIAODMCUP15/step3_RAW2DIGI_L1Reco_RECO_EI_VALIDATION_DQM.py\n```\n\nyields no results at all.\n\nAfter this pull request it gives:\n\n```\n#an \"intermediate layer\" remains, just in case somebody is using it...\nConfiguration.StandardSequences.Services_cff (line: 10)\nFrom 1306.0.step3_RAW2DIGI_L1Reco_RECO_EI_VALIDATION_DQM\n```\n\nExamples are easy to find where patterns aren't found as the code stands before this pull request.\nPretty sure this only affects the edmPythonSearch tool, I can't see how any reconstruction/simulation code would be affected.\nMost of this code was based on the modulefinder source (https://hg.python.org/cpython/file/2.7/Lib/modulefinder.py) and some useful information at http://security.coverity.com/blog/2014/Nov/understanding-python-bytecode.html.\n", "branch": "CMSSW_7_5_X", "changed_files": 1, "closed_at": "1434810999", "comments": 22, "commits": 2, "created_at": "1434490561", "deletions": 2, "labels": ["comparison-available", "core-approved", "fully-signed", "tests-approved"], "merge_commit_sha": "aaea3267b11a125e8f340c3f1ccaf4dd0069e1d1", "merged_at": "1434810999", "merged_by": "cmsbuild", "milestone": "CMSSW_7_5_X", "number": 9649, "release-notes": [], "review_comments": 1, "state": "closed", "title": "Fix edmPythonSearch to also look in modules from process.load(...) ", "updated_at": "1434953961", "user": "mark-grimes"}