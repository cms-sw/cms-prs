{"additions": 391, "auther_ref": "Material-fromGeomESProducer", "auther_sha": "9dc27b9fdd54b6989641b9e20b93e20bec9c63ae", "author": "leonardogiannini", "body": "#### PR description:\r\n\r\nThe material description for MkFit tracking was previously stored  as a look up table derived from the tracking ntuple in [MaterialEffects](https://github.com/cms-sw/cmssw/blob/master/RecoTracker/MkFitCore/src/MaterialEffects.cc). After this pull request the material is derived together with the Geometry in [MkFitGeometryESProducer](https://github.com/cms-sw/cmssw/blob/master/RecoTracker/MkFit/plugins/MkFitGeometryESProducer.cc)\r\n\r\nThe material is derived starting from the single modules (double sided modules excluded) in a r-z grid with bins of 1cm x 1cm. If more than one detector is present in a bin, a weighted average is used. The material is then expanded to the mkFit layers' boxes by filling the gaps with the material from the closest neighbor detector. \r\n\r\nIn the end we obtain a grid in r-z with bins of 1cm x 1cm, which is used in the same way as the grid derived from the look up table.\r\n\r\nThe [MaterialEffects](https://github.com/cms-sw/cmssw/blob/master/RecoTracker/MkFitCore/src/MaterialEffects.cc) files are not removed, as they are still necessary in mkFit standalone, but will be removed later.\r\n\r\nThis implementation will also allow a smooth transition to the Phase 2 tracker.\r\n\r\n#### PR validation:\r\n\r\n- old r-z material grid (radiation length)\r\n![image](https://github.com/cms-sw/cmssw/assets/7805577/53ffb8c1-9c4f-4d85-a88a-0d02071f7e46)\r\n\r\n- new r-z material grid (radiation length)\r\n![image](https://github.com/cms-sw/cmssw/assets/7805577/f6520589-45df-42f6-bd78-f4a389b3e49b)\r\n\r\n-- NB: the material is the same where modules are present, and very similar in the layers boxes. The divisions were previously done by eye, while now we choose the closest neighbor automatically.\r\n\r\n- MTV [validation](http://uaf-10.t2.ucsd.edu/~legianni/single-iter-checkmat/plots_compare_132x_1000ev/) shows compatible tracking results", "branch": "master", "changed_files": 23, "comments": 13, "commits": 10, "created_at": "1684354440", "deletions": 679, "labels": ["reconstruction-pending", "pending-signatures", "tests-pending", "orp-pending", "code-checks-pending", "tracking"], "milestone": "CMSSW_13_2_X", "number": 41714, "release-notes": [], "review_comments": 9, "state": "open", "title": "[MkFit] Material derived in GeometryESProducer ", "updated_at": "1685127110", "user": "leonardogiannini"}