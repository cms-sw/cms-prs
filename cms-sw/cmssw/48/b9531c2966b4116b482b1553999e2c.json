{"additions": 9, "auther_ref": "13_0_X-daqsource-race", "auther_sha": "73231b0da7f83b6596d741b6df16ff1ba30eace9", "author": "smorovic", "body": "#### PR description:\r\n\r\nRare, spurious crashes have been obsever in input source initialization in HLT. Analysis points to a possibility of a vector being reallocated to a different heap location while threads wait on a condition variable.\r\n(Not an urgent issue, since it causes minimal impact online and no data loss).\r\n\r\nSolution is to initialize vectors before spawning threads using them.\r\n\r\nAlso, an opportunity was taken to wrap CV variables within a unique pointer instead of having to delete them in destructor and to remove a memory synchronization point, since creation of a thread already is one.\r\n\r\n#### PR validation:\r\n\r\nTested with 13_0_6 in a DAQ test cluster for production FedRawDataInputSource . Also covered by unit tests for both sources.\r\n\r\n#### If this PR is a backport please specify the original PR and why you need to backport that PR. If this PR will be backported please specify to which release cycle the backport is meant for:\r\n\r\nBackport of #41668\r\n(only applicable code)\r\nApplies to FedRawDataInputSource and the patch is identical to master branch for this class.\r\nAnother class, DAQSource, is only found in CMSSW_13_1_X and master and will not be backported to 13_0_X.\r\n", "branch": "CMSSW_13_0_X", "changed_files": 2, "comments": 8, "commits": 1, "created_at": "1684084291", "deletions": 17, "labels": ["daq-approved", "fully-signed", "tests-approved", "orp-pending", "backport-ok"], "milestone": "CMSSW_13_0_X", "number": 41670, "release-notes": [], "review_comments": 0, "state": "open", "title": "[DAQ] fix unsafe vector handling in FedRawData input source (13_0_X)", "updated_at": "1684158803", "user": "smorovic"}