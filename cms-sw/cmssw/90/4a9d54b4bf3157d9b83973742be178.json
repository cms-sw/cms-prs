{"additions": 61, "auther_ref": "dd4hep_perf_test", "auther_sha": "0663f49e396c4d4c7b656d15b03fff6d421c7868", "author": "ghugo83", "body": "- The old legacy code in GeometricDet constructor (re-used for DD4hep) contains a block parsing information from XMLs.\r\nIf we think about it, all this info is related to sensors: hence once can obviously select these volumes only.\r\n\r\n- Use std::string iterators instead of constructing temporary string for constructing std::regex.\r\n\r\nNB: It could be that additional selections in the GeometricDet constructor will end up beneficial for Phase 2 DD4hep workflow, to be seen.\r\n\r\nSummary of performance gains for step 1 with DD4hep workflow (entire step 1 with all initializations + XML parsing + CMS geo construction, up to event generation).\r\nZMM, Run3, run on my local (forget lxplus ;p):\r\n- step1:  #32505: ~205s -> ~140s\r\n- step 2: #32511: ~140s -> ~85s\r\n- step 3: https://github.com/cms-sw/cmssw/pull/32540: ~85s -> ~80s\r\n- step 4: this PR: ~80s -> ~75s\r\n- DDD is at ~42 s\r\n\r\n@ianna @cvuosalo @civanch ", "branch": "master", "changed_files": 4, "closed_at": "1608592950", "comments": 8, "commits": 3, "created_at": "1608298551", "deletions": 46, "labels": ["code-checks-approved", "fully-signed", "geometry-approved", "orp-approved", "tests-approved"], "merge_commit_sha": "87119e3fa254b8fa7f25a3024600e712cf541889", "merged_at": "1608592950", "merged_by": "cmsbuild", "milestone": "CMSSW_11_3_X", "number": 32544, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Improve DD4hep workflow perf, step 4: Improve performance of GeometricDet construction in old DD (DDD) and DD4hep", "updated_at": "1608592950", "user": "ghugo83"}