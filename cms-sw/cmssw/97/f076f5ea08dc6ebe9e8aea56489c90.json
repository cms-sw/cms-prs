{"additions": 206, "auther_ref": "mm_dev_fixPixelCountFilter_13_2_X", "auther_sha": "3ccf67b68f0cef10b3ab4b98d933bb0e7c990586", "author": "mmusich", "body": "backport of https://github.com/cms-sw/cmssw/pull/42849\r\n\r\n#### PR description:\r\n\r\nIn [CMSHLT-2928](https://its.cern.ch/jira/browse/CMSHLT-2928), it became clear that the module `PixelCountFilter`  used in the first online 2023 HIon menu (a.k.a `v1.0`), in which there are 4 filters of this type, is \"bugged\" (it technically works, but it does not produce the intended results), see for more details this [post](https://its.cern.ch/jira/browse/CMSHLT-2928?focusedId=4944093&page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-4944093). \r\nThe issue is that the `PixelCountFilter` plugin effectively cuts on the number of `DetSet`s (or, detector modules) with pixel clusters, while the intention was to apply a cut on the total number of pixel clusters. One solution (proposed by HIN PAG in [CMSHLT-2922](https://its.cern.ch/jira/browse/CMSHLT-2922)) is to use a different type of plugin ([HLTPixelActivityFilter](https://github.com/cms-sw/cmssw/blob/CMSSW_13_2_4/HLTrigger/special/plugins/HLTPixelActivityFilter.cc)), which is what is going to be implemented for the data-taking.\r\nThis PR proposes to fix the module `PixelCountFilter` by introducing the machinery in `CommonTools/Utils{Algos}` in order to count (and cut) on the total number of entries in a `DetSetVector`. This is implemented in c8b39085aad17dcb18d56d51ca29514253be245b.\r\nIn parallel a new filter `PixelOccupancyFilter` is introduced, which allows to filter events if at least N pixel modules have M clusters, where A <=  M <= B (N, A and B are configuration parameters). This is implemented in c8b39085aad17dcb18d56d51ca29514253be245b.\r\n\r\n#### PR validation:\r\n\r\n`cmssw` compiles. Private tests were carried out with this commit https://github.com/mmusich/cmssw/commit/9d74d21abec5d7d4535273345f84ade1fd02ba3b at to test that the newly introduced filters work as expected\r\n\r\n#### If this PR is a backport please specify the original PR and why you need to backport that PR. If this PR will be backported please specify to which release cycle the backport is meant for:\r\n\r\nVerbatim backport of https://github.com/cms-sw/cmssw/pull/42849 to 13.2.X\r\n", "branch": "CMSSW_13_2_X", "changed_files": 7, "closed_at": "1696250307", "comments": 7, "commits": 2, "created_at": "1695978458", "deletions": 2, "labels": ["reconstruction-approved", "fully-signed", "tests-approved", "pdmv-approved", "orp-approved", "backport-ok"], "merge_commit_sha": "55661400c9ab54df78d5c577a1fb244e0c77844c", "merged_at": "1696250307", "merged_by": "cmsbuild", "milestone": "CMSSW_13_2_X", "number": 42912, "release-notes": [], "review_comments": 0, "state": "closed", "title": "[13.2.X] Fix `PixelCountFilter` and introduce `PixelOccupancyFilter`", "updated_at": "1696250331", "user": "mmusich"}