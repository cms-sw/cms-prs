{"additions": 687, "auther_ref": "setDirectoryFix2", "auther_sha": "a7589ed508a7dcfbe79e14d5a04f57a1590b9791", "author": "wddgit", "body": "This change should yield identical behavior\nand remove a thread safety issue.\n\nIn ROOT, when a histogram is created, a reference\nto it is automatically added to the list of in-memory\nobjects for the current file or directory.\nCalling SetDirectory with a null argument\nthen removes this reference. This creates a\nthread safety issue because multiple threads\ncould be creating histograms in the same\nTFile or directory. In this case, it is all\nunnecessary because the SetDirectory call then\nremoves this reference.\n\nAn alternative is to create a TContext object\nwith a nullptr argument. Then the link is never\ncreated in the first place. This is supposed to\nyield identical behavior without the thread\nsafety problem. It is probably insignificant, but\nit likely slightly improves performance as it\neliminates the unnecessary setting and unsetting\nof the context references. When the TContext object\ngoes out of scope the context returns to whatever\nit was before the TContext object was created.\n", "branch": "CMSSW_7_6_X", "changed_files": 22, "closed_at": "1436375505", "comments": 6, "commits": 1, "created_at": "1436285760", "deletions": 354, "labels": ["alca-pending", "analysis-pending", "comparison-pending", "dqm-pending", "fastsim-pending", "orp-pending", "pending-signatures", "reconstruction-pending", "simulation-pending", "tests-rejected", "visualization-pending"], "milestone": "CMSSW_7_6_X", "number": 10081, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Thread safety SetDirectory(0) fixes", "updated_at": "1474632197", "user": "wddgit"}