{"additions": 521, "auther_ref": "revert-29748-revert-29254-puppiNoLep_weight_in_aod", "auther_sha": "01dd1d4eaccad1b2a1b03aa4c4b5ad97f2cb4956", "author": "ahinzmann", "body": "Clone of #29254 and #29768, with a fix for MET JER uncertainties to adress issue #29744.\r\n\r\n#### PR description:\r\n\r\nThis PR computes puppiNoLep weights and puppi MET in RECO and stores the puppiNoLep weight as a value map. PUPPI MET is clustered based on standard PF candidates together with the value map of weights. A new boolean \"isWeighted\" is added to the reco::PFMet interface to indicate whether weights were applied during jet clustering. The packed candidates pick up the value map such that puppi does not need to be re-computed in MiniAOD.\r\n\r\nThe same was done for the puppi and PUPPI jets in #28936.\r\n\r\nOther changes:\r\n- Produce puppiForMET directly in PuppiProducer instead of a two step procedure puppiNoLep->puppiForMET and rename it to puppiNoLep, consistent with the name in PackedCandidates\r\n- Implement fillDescriptions for PFMetProducer\r\n- Rename PFMET_cfi to pfMet_cfi everywhere (for consistency with the module name)\r\n- Fix input jet collection of pfMetEI\r\n- Remove pfMetEI from RecoMET_EventContent (however, leave EITopPAG_EventContent_cff untouched)\r\n- Resolve issue #29264\r\n- By moving to the same input PF candidate collection for puppi MET and puppi jets (with just different weights), PUPPI MET significance and unclustered pT computation then don't rely on dR matching as implemented in #29331 anymore.\r\n- Store ref to PF candidate inside pat muons (just like done for all other PAT objects). PUPPI MET significance and unclustered pT computation then don't rely on dR matching as implemented in #29385 anymore.\r\n- Fix particle multiplicity computation in xy-correction for PUPPI MET. Previously, particles with a weight of 0 could also count in the multiplicity as a function of which the xy-corrections are computed. Since xy-correction are not needed/recommended for PUPPI MET, this fix is not backported.\r\n- For HI workflows, raise candidate pT threshold for chsMet and trkMet to 999. consistent with pfMet.\r\n\r\n#### PR validation:\r\n\r\nrunTheMatrix -l limited\r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\n\r\nNo backport foreseen.", "branch": "master", "changed_files": 65, "closed_at": "1589048867", "comments": 15, "commits": 2, "created_at": "1588888750", "deletions": 325, "labels": ["analysis-approved", "code-checks-approved", "comparison-available", "dqm-approved", "fully-signed", "orp-approved", "reconstruction-approved", "tests-approved"], "merge_commit_sha": "60e3a2a7a953d787bff64db76132db2e623359a8", "merged_at": "1589048867", "merged_by": "cmsbuild", "milestone": "CMSSW_11_1_X", "number": 29769, "release-notes": [], "review_comments": 0, "state": "closed", "title": "PUPPI MET in RECO", "updated_at": "1589135964", "user": "ahinzmann"}