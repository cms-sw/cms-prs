{"additions": 15, "auther_ref": "SmearedJetDeterministicSeed930p4", "auther_sha": "e4d33c5b19a65d6a657b24344508c78d6b1f5f17", "author": "kpedro88", "body": "While upgrade my ntuple production code to use multithreading, I noticed the output jet collections differed for MC samples. I found the cause to be the use of random numbers in `SmearedPATJetProducer`. The solution is to use a deterministic seed based on the event number (thanks to @Dr15Jones for the suggestion). I followed the approach from https://github.com/cms-sw/cmssw/blob/CMSSW_9_3_0_pre4/RecoJets/JetProducers/plugins/VirtualJetProducer.cc#L272 (in a simplified manner). This resolved the regression I observed in my ntuple code when running with multiple threads.\r\n\r\nThis PR will be backported to 80X. Questions for jet people (e.g. @rappoccio, @blinkseb, @zdemirag):\r\n1) Currently I have the `useDeterministicSeed` option disabled by default in the `fillDescriptions()`, so users would have to activate it manually. Should I enable it by default instead? This would change the default output. Edit: it was changed to be enabled by default.\r\n2) Are other backports desired? (e.g. 92X)", "branch": "master", "changed_files": 2, "closed_at": "1504675850", "comments": 47, "commits": 4, "created_at": "1503434187", "deletions": 2, "labels": ["analysis-pending", "code-checks-approved", "comparison-available", "orp-pending", "pending-signatures", "reconstruction-approved", "tests-approved"], "merge_commit_sha": "aa14a75177e9f010b3b8d0af0440598735c49311", "merged_at": "1504675850", "merged_by": "cmsbuild", "milestone": "CMSSW_9_3_X", "number": 20240, "release-notes": [], "review_comments": 8, "state": "closed", "title": "option to use deterministic event-based seed in SmearedJetProducer (for MT)", "updated_at": "1504675850", "user": "kpedro88"}