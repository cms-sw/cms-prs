{"additions": 40, "auther_ref": "DebugCaloSamples2", "auther_sha": "7e008992d3f9b94f4a227c82f216c383f75443d0", "author": "kpedro88", "body": "In #16907, I added a tool called [CaloSamplesAnalyzer](https://github.com/cms-sw/cmssw/blob/master/SimCalorimetry/HcalSimAlgos/test/CaloSamplesAnalyzer.cc) to help debug intermediate stages of the HCAL digitization simulation. This included a special \"precise\" option for the HPD simulation, to get per-nanosecond `CaloSamples` (instead of just per-timeslice=per-25ns).\r\n\r\nHowever, it was recently pointed out to me that activating this debugging option caused the output digis to change. This is because the HPD pulse shape is integrated over 25ns by the `CaloCachedShapeIntegrator` *before* it is used by the simulation - so the \"precise\" setting was effectively integrating the pulse twice. To resolve this, I made a separate map of un-integrated pulses to be used in \"precise\" mode. I also cleaned up the `HcalShapes` code, to make it more maintainable and modern.\r\n\r\nThis PR should not change any standard results. The observed problem was only seen in a special debugging mode.", "branch": "master", "changed_files": 4, "closed_at": "1497092053", "comments": 9, "commits": 2, "created_at": "1497035005", "deletions": 80, "labels": ["comparison-available", "fully-signed", "orp-approved", "simulation-approved", "tests-approved"], "merge_commit_sha": "ecba808201d4b15a552093bd028f6bad20a90b76", "merged_at": "1497092053", "merged_by": "cmsbuild", "milestone": "CMSSW_9_2_X", "number": 19184, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Fix precise setting for CaloSamplesAnalyzer with HPDs", "updated_at": "1497092053", "user": "kpedro88"}