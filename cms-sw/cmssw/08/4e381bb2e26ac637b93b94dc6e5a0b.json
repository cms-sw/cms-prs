{"additions": 42, "auther_ref": "PR_ClusterSize", "auther_sha": "34fd1de401ee5e338ee105940c4940b4287b0b33", "author": "bdanzi", "body": "#### PR description:\r\n\r\nThis PR is a **backport of #47271**.  \r\n\r\nThe PR aims to minimize the Cluster Size Cuts for the Phase 1 geometry on the B1 and B2 layers, specifically when considering B1-FPIX and B2-FPIX doublets. These doublets serve as the initial inputs for the CA. The changes have been tested on top of the Phase 1 CA-tuned parameters.\r\n\r\nThis adjustment results in about 5% relative efficiency gain in `hltIter0PFlowTrackSelectionHighPurity` and a 3% gain in `hltMerged`. Additionally, it reduces the reliance on the Doublet Recovery iteration, leading to a corresponding decrease in efficiency for `hltDoubletRecoveryPFlowTrackSelectionHighPurity`. Track resolution shows a small improvement as a function of pT.\r\n\r\n#### PR validation:\r\n\r\n600 events TTBarPU 2025 (/RelValTTbar_14TeV/CMSSW_14_2_1-PU_142X_mcRun3_2025_realistic_v4_STD_Winter25_PU-v1/GEN-SIM-DIGI-RAW):\r\nhttp://uaf-3.t2.ucsd.edu/~bdanzi/PR_2025/plots_hlt.html\r\n500 events TTBarPU EEOR3 (/RelValTTbar_14TeV/CMSSW_14_0_9-PU_140X_mcRun3_2024_realistic_EOR3_TkDPGv7_RV245_2024-v2/GEN-SIM-DIGI-RAW):\r\nhttp://uaf-3.t2.ucsd.edu/~bdanzi/PRClusterSize_EEOR3_TTBarPU/plots_hlt.html\r\n\r\n@mmasciov @mmusich \r\n<details>\r\n  <summary>Instructions on how to run </summary>\r\n\r\nTested in `CMSSW_15_0_0_pre2` at HLT step. \r\n\r\nGenerate the `.cff `file on lxplus and place it inside `HLTrigger/Configuration/python` by running:\r\n\r\n`hltGetConfiguration /dev/CMSSW_14_2_0/GRun/V10 --globaltag 140X_mcRun3_2024_realistic_EOR3_TkDPGv7  --mc --unprescale --output minimal --max-events 500 --input file:input_file.root --cff --eras Run3_2024 --l1-emulator uGT --l1 L1Menu_Collisions2024_v1_3_0_xml  --paths MC_ReducedIterativeTracking_v22  > hltMC_default_onlyTracking.py`\r\n\r\nThe `.cff` should be loaded to run the following script:\r\n\r\n```\r\nimport FWCore.ParameterSet.Config as cms\r\nfrom Configuration.Eras.Era_Run3_2024_cff import Run3_2024\r\nprocess = cms.Process( \"HLTX\", Run3_2024)\r\n\r\nprocess.load(\"Configuration.StandardSequences.Accelerators_cff\")\r\n# import of standard configurations\r\nprocess.load('Configuration.StandardSequences.Services_cff')\r\nprocess.load('SimGeneral.HepPDTESSource.pythiapdt_cfi')\r\nprocess.load('FWCore.MessageService.MessageLogger_cfi')\r\nprocess.load('Configuration.EventContent.EventContent_cff')\r\nprocess.load('SimGeneral.MixingModule.mixNoPU_cfi')\r\nprocess.load('Configuration.StandardSequences.GeometryRecoDB_cff')\r\nprocess.load('Configuration.StandardSequences.MagneticField_cff')\r\nprocess.load('HLTrigger.Configuration.hltMC_default_onlyTracking')\r\nprocess.load('Configuration.StandardSequences.Validation_cff')\r\nprocess.load('Configuration.StandardSequences.FrontierConditions_GlobalTag_cff')\r\n\r\nprocess.maxEvents = cms.untracked.PSet(\r\n    input = cms.untracked.int32(-1),\r\n    output = cms.optional.untracked.allowed(cms.int32,cms.PSet)\r\n)\r\n\r\n# Input source\r\nprocess.source = cms.Source(\"PoolSource\",\r\n    fileNames = cms.untracked.vstring(\r\n    'file:input_file.root'\r\n    ),\r\n    secondaryFileNames = cms.untracked.vstring()\r\n)\r\n\r\nprocess.options = cms.untracked.PSet(\r\n    IgnoreCompletely = cms.untracked.vstring(),\r\n    Rethrow = cms.untracked.vstring(),\r\n    TryToContinue = cms.untracked.vstring(),\r\n    accelerators = cms.untracked.vstring('*'),\r\n    allowUnscheduled = cms.obsolete.untracked.bool,\r\n    canDeleteEarly = cms.untracked.vstring(),\r\n    deleteNonConsumedUnscheduledModules = cms.untracked.bool(True),\r\n    dumpOptions = cms.untracked.bool(False),\r\n    emptyRunLumiMode = cms.obsolete.untracked.string,\r\n    eventSetup = cms.untracked.PSet(\r\n        forceNumberOfConcurrentIOVs = cms.untracked.PSet(\r\n            allowAnyLabel_=cms.required.untracked.uint32\r\n        ),\r\n        numberOfConcurrentIOVs = cms.untracked.uint32(0)\r\n    ),\r\n    fileMode = cms.untracked.string('FULLMERGE'),\r\n    forceEventSetupCacheClearOnNewRun = cms.untracked.bool(False),\r\n    holdsReferencesToDeleteEarly = cms.untracked.VPSet(),\r\n    makeTriggerResults = cms.obsolete.untracked.bool,\r\n    modulesToCallForTryToContinue = cms.untracked.vstring(),\r\n    modulesToIgnoreForDeleteEarly = cms.untracked.vstring(),\r\n    numberOfConcurrentLuminosityBlocks = cms.untracked.uint32(0),\r\n    numberOfConcurrentRuns = cms.untracked.uint32(1),\r\n    numberOfStreams = cms.untracked.uint32(0),\r\n    numberOfThreads = cms.untracked.uint32(8),\r\n    printDependencies = cms.untracked.bool(False),\r\n    sizeOfStackForThreadsInKB = cms.optional.untracked.uint32,\r\n    throwIfIllegalParameter = cms.untracked.bool(True),\r\n    wantSummary = cms.untracked.bool(False)\r\n)\r\n\r\n# Production Info\r\nprocess.configurationMetadata = cms.untracked.PSet(\r\n    annotation = cms.untracked.string('step2 nevts:10'),\r\n    name = cms.untracked.string('Applications'),\r\n    version = cms.untracked.string('$Revision: 1.19 $')\r\n)\r\n\r\n# Output definition\r\n\r\nprocess.DQMoutput = cms.OutputModule(\"DQMRootOutputModule\",\r\n    dataset = cms.untracked.PSet(\r\n        dataTier = cms.untracked.string('DQMIO'),\r\n        filterName = cms.untracked.string('')\r\n    ),\r\n    fileName = cms.untracked.string('step2_HLT_VALIDATION_paramTuned.root'),\r\n    outputCommands = process.DQMEventContent.outputCommands,\r\n    splitLevel = cms.untracked.int32(0)\r\n)\r\n\r\n# Additional output definition\r\n\r\n# Other statements\r\nfrom HLTrigger.Configuration.CustomConfigs import ProcessName\r\nprocess = ProcessName(process)\r\n\r\nfrom Configuration.Applications.ConfigBuilder import ConfigBuilder\r\nprocess.hltMultiTrackValidation.visit(ConfigBuilder.MassSearchReplaceProcessNameVisitor(\"HLT\", \"HLTX\", whitelist = (\"subSystemFolder\",), verbose = False))\r\nprocess.mix.playback = True\r\nprocess.mix.digitizers = cms.PSet()\r\nfor a in process.aliases: delattr(process, a)\r\nprocess.RandomNumberGeneratorService.restoreStateLabel=cms.untracked.string(\"randomEngineStateProducer\")\r\nfrom Configuration.AlCa.GlobalTag import GlobalTag\r\nprocess.GlobalTag = GlobalTag(process.GlobalTag, '140X_mcRun3_2024_realistic_EOR3_TkDPGv7', '')\r\nprocess.hltTrackValidator.label = [\"hltPixelTracks\", \"hltIter0PFlowCtfWithMaterialTracks\", \"hltIter0PFlowTrackSelectionHighPurity\", \"hltMergedTracks\",\"hltDoubletRecoveryPFlowTrackSelectionHighPurity\"]\r\n# Path and EndPath definitions\r\nprocess.validation_step = cms.EndPath(process.hltMultiTrackValidation)\r\nprocess.DQMoutput_step = cms.EndPath(process.DQMoutput)\r\n\r\nprocess.hltSiStripRawToClustersFacility.onDemand = cms.bool(False)\r\nprocess.hltPixelTracksSoA.CAThetaCutBarrel = cms.double(0.00111685053)\r\nprocess.hltPixelTracksSoA.CAThetaCutForward = cms.double(0.00249872683)\r\nprocess.hltPixelTracksSoA.hardCurvCut =  cms.double(0.695091509)\r\nprocess.hltPixelTracksSoA.dcaCutInnerTriplet = cms.double(0.0419242041)\r\nprocess.hltPixelTracksSoA.dcaCutOuterTriplet = cms.double(0.293522194)\r\nprocess.hltPixelTracksSoA.phiCuts = cms.vint32(\r\n    832, 379, 481, 765, 1136,\r\n    706, 656, 407, 1212, 404,\r\n    699, 470, 652, 621, 1017,\r\n    616, 450, 555, 572\r\n)\r\n# Schedule definition\r\n# process.schedule imported from cff in HLTrigger.Configuration\r\nprocess.schedule.extend([process.validation_step,process.DQMoutput_step])\r\nfrom PhysicsTools.PatAlgos.tools.helpers import associatePatAlgosToolsTask\r\nassociatePatAlgosToolsTask(process)\r\n\r\n# customisation of the process.\r\n\r\n# Automatic addition of the customisation function from HLTrigger.Configuration.customizeHLTforMC\r\nfrom HLTrigger.Configuration.customizeHLTforMC import customizeHLTforMC \r\n\r\n#call to customisation function customizeHLTforMC imported from HLTrigger.Configuration.customizeHLTforMC\r\nprocess = customizeHLTforMC(process)\r\n\r\n# Automatic addition of the customisation function from SimGeneral.MixingModule.fullMixCustomize_cff\r\nfrom SimGeneral.MixingModule.fullMixCustomize_cff import setCrossingFrameOn \r\n\r\n#call to customisation function setCrossingFrameOn imported from SimGeneral.MixingModule.fullMixCustomize_cff\r\nprocess = setCrossingFrameOn(process)\r\n```\r\n</details>", "branch": "CMSSW_15_0_X", "changed_files": 5, "comments": 9, "commits": 2, "created_at": "1738942147", "deletions": 12, "labels": ["geometry-approved", "reconstruction-approved", "fully-signed", "tests-approved", "orp-pending", "backport-ok", "tracking"], "milestone": "CMSSW_15_0_X", "number": 47296, "release-notes": [], "review_comments": 0, "state": "open", "title": "[15_0_X] Reduce minYsizeB1 and minYsizeB2 CA cuts for Phase1", "updated_at": "1739197258", "user": "bdanzi"}