{"additions": 16, "auther_ref": "fix-puppi-master", "auther_sha": "fc452b10088d484e0ee133c4d558bd73e024ee7f", "author": "hqucms", "body": "#### PR description:\r\n\r\nWhen running Puppi on MiniAOD w/ `useExistingWeights=False`, in some cases there is a discrepancy between the puppiWeight and the rescaled pT (i.e., rescaled pT != original pT * packCand->puppiWeight()). This is tracked to:\r\n\r\nhttps://github.com/cms-sw/cmssw/blob/fb7c976b0bd6784c61295852158c36675939be56/CommonTools/PileupAlgos/plugins/PuppiProducer.cc#L275-L291\r\n\r\non L281 and L283, `iPuppiMatched` should not be used to access the puppi weight from `lWeights`, as `lWeights` is 1-to-1 with `hPFProduct` -- instead `val` is the correct index. \r\n\r\nAs this only affects the puppi weights set for the new packedCandidates, this discrepancy does not affect cases when `useExistingWeights=True`, or running on RECO/AOD inputs.\r\n\r\nThis PR fixes this discrepancy and also simplifies the logic to compute the Puppi-scaled p4.\r\n\r\n@ahinzmann ", "branch": "master", "changed_files": 3, "closed_at": "1570212556", "comments": 25, "commits": 1, "created_at": "1568958747", "deletions": 51, "labels": ["analysis-approved", "code-checks-approved", "comparison-available", "fully-signed", "orp-approved", "reconstruction-approved", "tests-approved"], "merge_commit_sha": "7903ae0a69b1efb9dcd7e77f2a75a90a17a05819", "merged_at": "1570212556", "merged_by": "cmsbuild", "milestone": "CMSSW_11_0_X", "number": 28033, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Fix a discrepancy in Puppi weights when running on MiniAOD w/ useExistingWeights=False", "updated_at": "1570855412", "user": "hqucms"}