{"additions": 124, "auther_ref": "fixPullsForGemMe0InMuonSelectors", "auther_sha": "4083e75cdc482a376f93afc8d3e1d0323d0d0ace", "author": "perrotta", "body": "#### PR description:\r\n\r\nThe relevant part of this PR is the following **fix** for the computation of the pulls in the chamber matching for both GEM and ME0 :\r\n![Immagine](https://user-images.githubusercontent.com/4069749/92996154-a9c51e00-f509-11ea-9088-0928eb93a492.jpg)\r\n(see lines 599-600 and lines 613-614 of DataFormats/MuonReco/src/MuonSelectors.cc )\r\nThe pulls were previously computed by normalizing on the square root of the sum of the errors, instead than on the quadratic sum of the same errors.\r\n\r\n@ArnabPurohit @trocino could you please check and confirm that such a fix is actually needed? (The alternative is that some weird definition for those pulls was preferred on purpose instead...)\r\n\r\nWhile applying that fix, I profited for integrating also some code simplification meant to improve the performance of the same MuonSelectors:\r\n- Avoid unneeded, and sometimes repeated, computations\r\n- Avoid converting `float` inputs into `double,` and then convert back again to `float` \r\n- Replace `TMath` functions with `std` ones\r\n- Replace `fabs` with `std::abs`\r\n\r\nFurther optimizations are still possible:\r\n- Move fully to `float`, also in the methods and their arguments\r\n- Store squares of errors in the muon matches instead of the errors themselves, so that one can avoid repetedly computing square roots and squares when produced and accessed\r\n\r\nRegressions are expected:\r\n- whenever the pulls of the matches for GEM and ME0 are used\r\n- probably some very minor additional ones due to possible different rounding approximations because of the other performance related updates\r\n\r\n\r\n\r\n#### PR validation:\r\n\r\nIt builds, and a few matrix tests succeed.\r\nI didn't try to validate the output by comparing with the baseline\r\nI will try to evaluate possible changes (hopefully an improvement) in cpu performance, and I will update this description with it\r\n\r\n", "branch": "master", "changed_files": 4, "closed_at": "1600470989", "comments": 63, "commits": 9, "created_at": "1599912454", "deletions": 138, "labels": ["analysis-approved", "code-checks-approved", "comparison-available", "fully-signed", "orp-approved", "reconstruction-approved", "tests-approved"], "merge_commit_sha": "fa4f6388059df2a1898546a452a71b7ec5fc425f", "merged_at": "1600470989", "merged_by": "cmsbuild", "milestone": "CMSSW_11_2_X", "number": 31448, "release-notes": [], "review_comments": 4, "state": "closed", "title": "Fix pulls for gem/me0 in MuonSelectors (and simplify it a bit)", "updated_at": "1600470989", "user": "perrotta"}