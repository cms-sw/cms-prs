{"additions": 30, "auther_ref": "mm_dev_prefilter_L3MuonTrajChecks", "auther_sha": "daa9e9d814997f89525d01883212a792d58ad2e8", "author": "mmusich", "body": "#### PR description:\r\n\r\nTitle says it all, follows-up from suggestion at https://github.com/cms-sw/cmssw/issues/43517#issuecomment-1849455057.\r\n\r\n> One possibility to improve the implementation of `HLTMuonL3PreFilter` is to add a boolean parameter to the plugin (say, `requireL3MuonTrajectorySeed`) which, if true, would make the plugin throw an exception if [this cast](https://github.com/cms-sw/cmssw/blob/bb13ad112cad04ae2bcf5a11ec1362dda00c3fb9/HLTrigger/Muon/plugins/HLTMuonL3PreFilter.cc#L173) fails. In the constructor, one could then call consumes on `InputLinks`, `L1CandTag` and `inputMuonCollection` only if `requireL3MuonTrajectorySeed == false` ([something like this (random example)](https://github.com/cms-sw/cmssw/blob/bb13ad112cad04ae2bcf5a11ec1362dda00c3fb9/DQM/HLTEvF/plugins/LumiMonitor.cc#L98-L100)). The parameter `requireL3MuonTrajectorySeed` would be false by default, but in the case of hltL3fDimuonL1f0L2NVf16L3NoFiltersNoVtxFiltered43 (and maybe other modules), we could set it to true.\r\n\r\nThis implements the first part (which to allow disentangling the consumes when they are not needed). A customize function in `customizeHLTforCMSSW` is added such that the newly added boolean is flipped for a list of selected modules in HLT menu. \r\n\r\n#### PR validation:\r\n\r\n```bash\r\n#!/bin/bash\r\n\r\nhltGetConfiguration /dev/CMSSW_13_3_0/GRun \\\r\n   --globaltag auto:phase1_2024_realistic \\\r\n   --mc \\\r\n   --unprescale \\\r\n   --output minimal \\\r\n   --max-events 100 \\\r\n   --input /store/relval/CMSSW_13_3_0_pre4/RelValTTbar_14TeV/GEN-SIM-DIGI-RAW/133X_mcRun3_2023_realistic_v1_Standard_13_3_0_pre4-v1/2590000/4c47f6d7-9938-4c87-b795-ece3aa6d3d22.root \\\r\n   --eras Run3 --l1-emulator FullMC --l1 L1Menu_Collisions2023_v1_3_0_xml \\\r\n   > hlt.py\r\ncat <<@EOF >> hlt.py\r\nprocess.options.numberOfThreads = 1\r\nprocess.options.numberOfStreams = 0\r\n@EOF\r\ncmsRun hlt.py &> hlt.log\r\n```\r\n\r\nruns fine\r\n\r\n#### If this PR is a backport please specify the original PR and why you need to backport that PR. If this PR will be backported please specify to which release cycle the backport is meant for:\r\n\r\nNot a backport.\r\n", "branch": "master", "changed_files": 3, "comments": 4, "commits": 2, "created_at": "1702387952", "deletions": 5, "labels": ["hlt-pending", "pending-signatures", "tests-pending", "orp-pending", "code-checks-approved"], "milestone": "CMSSW_14_0_X", "number": 43549, "release-notes": [], "review_comments": 0, "state": "open", "title": "introduce `requireL3MuonTrajectorySeed` data member in `HLTMuonL3PreFilter` and use it do define whether or not to consume certain products", "updated_at": "1702394547", "user": "mmusich"}