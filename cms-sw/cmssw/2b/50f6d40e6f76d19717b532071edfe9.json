{"additions": 26, "auther_ref": "dev/nano-genWeightTable", "auther_sha": "eada7b299875e2d5cd87016768e5fe16633402f7", "author": "hqucms", "body": "#### PR description:\r\n\r\nThis PR implements a possible mitigation of the LHEScaleSumw issue, as discussed in the [PPD general meeting](https://indico.cern.ch/event/1470301/#6-xpog-remini-renano-discussio) today. Feedback is welcome!\r\n\r\nBasically a configurable option `allowedNumScaleWeights` is introduced to `GenWeightsTableProducer`, which can take a list of numbers, and the number of scale variation weights identified by parsing the `initrwgt` header of `LHERunInfoProduct` must match one of the values provided in `allowedNumScaleWeights`, otherwise a `LogicError` is thrown. The default value of `allowedNumScaleWeights` is set to 9 as it is the expected number of scale variations in the standard setup. An empty list for `allowedNumScaleWeights` means any number of scale variation weights is allowed and no check is performed.\r\n\r\nThis PR also fixes the parsing of certain MadGraph headers where it fails to pick up the central weight, as in some cases the central weight is outside any weight group. This has led to some NanoAOD samples containing only 8 (instead of 9) scale weights.\r\n\r\nRelated issue: https://github.com/cms-sw/cmssw/issues/43784\r\n\r\n#### PR validation:\r\n\r\nPasses local tests with:\r\n- [x]  a `normal` MadGraph file with the expected, 9 scale weights: \r\n     - `/store/mc/Run3Summer22EEMiniAODv4/DYGto2LG-1Jets_MLL-50_PTG-10to50_TuneCP5_13p6TeV_amcatnloFXFX-pythia8/MINIAODSIM/130X_mcRun3_2022_realistic_postEE_v6-v2/30000/0fd00136-3752-4096-8e82-4b6fcd656da4.root`\r\n- [x] a buggy MadGraph file with no PDF/scale weights and missing the`initrwgt` header : \r\n    - `/store/mc/Run3Summer22EEMiniAODv4/DYGto2LG-1Jets_MLL-50_PTG-10to50_TuneCP5_13p6TeV_amcatnloFXFX-pythia8/MINIAODSIM/130X_mcRun3_2022_realistic_postEE_v6-v2/40000/c22ada93-447e-4db9-bee9-fcb3ab3e7fa9.root`\r\n- [x] another MG file where only 8 scale weights were identified before the change:\r\n    - `/store/mc/RunIISummer20UL16MiniAODAPVv2/TTZ-ZToBB-TTTo2L_TuneCP5_13TeV-amcatnlo-pythia8/MINIAODSIM/106X_mcRun2_asymptotic_preVFP_v11-v2/2560000/02890624-0027-E345-880C-C8372B42C942.root`", "branch": "master", "changed_files": 2, "comments": 11, "commits": 1, "created_at": "1730394946", "deletions": 5, "labels": ["pending-signatures", "tests-rejected", "orp-pending", "code-checks-approved", "xpog-pending", "ppd-pending"], "milestone": "CMSSW_14_2_X", "number": 46573, "release-notes": [], "review_comments": 0, "state": "open", "title": "[RFC] [NANO] Implement a check on the number of scale variation weights in GenWeightsTableProducer", "updated_at": "1730450060", "user": "hqucms"}