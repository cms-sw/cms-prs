{"additions": 36, "auther_ref": "hcal-tp-configure-fb-tdc", "auther_sha": "f7026635eec0a388ab2e552120bdf9375c11d390", "author": "christopheralanwest", "body": "Recently the HCAL implemented cuts on TDC timing in HF trigger primitives to reduce the contribution of (out-of-time) HF noise to the L1 ETMHF rate. Currently the trigger primitive emulation applies these cuts to both the E<sub>T</sub> calculation as well as the minimum-bias feature bit. But it is desired to apply these cuts only to the E<sub>T</sub> calculation, as the contribution of HF noise is unimportant in low-PU and HI runs, where the min-bias bit is used; this is also the default behavior of the firmware.\r\n\r\nThis PR implements the ability to ignore TDC cuts when computing the min-bias feature bit in emulation. The plots below compare data versus emulation for the min-bias feature bit in HcalNZS data [1] for three cases:\r\n\r\n- the current TP emulation\r\n- the modified TP emulation, but with `useTDCInMinBiasBits` set to true; this reproduces the existing behavior\r\n- the modified TP emulation, but with `useTDCInMinBiasBits` set to the default (false), which provides perfect agreement between data and emulation\r\n\r\nCurrent |  `useTDCInMinBiasBits` = true | `useTDCInMinBiasBits` = false\r\n------------ | ------------- | -------------\r\n![fg1_emul_vs_fg1_after_fix_use_tdc_run320059](https://user-images.githubusercontent.com/6534323/43161433-bb21c974-8f4d-11e8-8817-4c4d1e3dca3c.png)|![fg1_emul_vs_fg1_before_fix_run320059](https://user-images.githubusercontent.com/6534323/43161350-7cf09aae-8f4d-11e8-8b21-ff93f9db149e.png)| ![fg1_emul_vs_fg1_after_fixrun320059](https://user-images.githubusercontent.com/6534323/43161474-d9e4ba24-8f4d-11e8-980c-0d70aabc3a22.png)\r\n\r\nIn all three cases, the E<sub>T</sub> correlation has also been verified to be perfect, as expected; this PR should not change any aspect of the E<sub>T</sub> correlation.\r\n\r\nAs the TDC cuts are not used in simulation (the relevant noise sources are not simulated) and the cuts were only introduced in run 319549, this PR should have no effect on any PR comparison test.\r\n\r\nIn addition, a unrelated change was made to some of the methods of the `HcalTriggerPrimitiveAlgo`, which had names that referenced the year in which a particular upgrade was performed. A more logical naming convention has been introduced, which is based on the type of digis that enter the algorithm.\r\n\r\nA backport PR will be generated for use in the online DQM, which monitors the correlation between data and emulated TPs.\r\n\r\n[1] /store/data/Run2018C/HcalNZS/RAW/v1/000/320/059/00000/6A727A3E-F78D-E811-8743-FA163E089CCC.root", "branch": "master", "changed_files": 4, "closed_at": "1532699046", "comments": 12, "commits": 3, "created_at": "1532454054", "deletions": 21, "labels": ["code-checks-approved", "comparison-available", "fully-signed", "l1-approved", "orp-approved", "tests-approved"], "merge_commit_sha": "0cea9b958eededd2c51022cdcdaf779a6ee0ec86", "merged_at": "1532699046", "merged_by": "cmsbuild", "milestone": "CMSSW_10_3_X", "number": 24007, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Make usage of TDC cuts on HF min-bias bits configurable", "updated_at": "1532699046", "user": "christopheralanwest"}