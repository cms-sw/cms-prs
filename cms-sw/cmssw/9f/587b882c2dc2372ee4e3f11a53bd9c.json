{"additions": 34, "auther_ref": "FGbits_TDCpack_index_123X", "auther_sha": "25a9a7d71857e621a03ea2ab174c42e839c9a1b9", "author": "gk199", "body": "#### PR description:\r\n\r\n`HcalFinegrainBit.cc` is run in cases where HB TDC is compressed and uncompressed. This PR handles both cases. In `HcalTriggerPrimitiveAlgo.cc`, `frame.flavor()` is used to define `is_compressed` which is passed to `HcalFinegrainBit.cc`. This determines if the input TDC values are uncompressed (`flavor=0, is_compressed=0`) or compressed (`flavor=3, is_compressed=1`). Depending on the TDC packing, either a comparison to `tdc_boundary` is made (uncompressed), or a direct comparison to TDC 0, 1, 2 is made. \r\n\r\nAdditional edits in `HcalTriggerPrimitiveAlgo.cc` are made to handle the matching of TP SOI and digi SOI in a more robust way. This ensures that with changes in conditions or filterPresamples, the TDC from the QIE11 dataframe SOI is selected for the fine grain bit algorithm SOI (ensuring ibin = 2 corresponds to idx = 5). \r\n\r\n#### PR validation:\r\n\r\n`runTheMatrix.py` passed.\r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\n\r\nBackport of PR #37438 to 123X, as the L1 LLP trigger emulator was merged in 123X (PR #36919) and relies upon the fine grain bits. \r\n", "branch": "CMSSW_12_3_X", "changed_files": 3, "comments": 2, "commits": 1, "created_at": "1648860679", "deletions": 11, "labels": ["l1-pending", "pending-signatures", "orp-pending", "tests-started"], "milestone": "CMSSW_12_3_X", "number": 37439, "release-notes": [], "review_comments": 0, "state": "open", "title": "[Backport of] HCAL finegrain bit fix to account for TDC packing, and SOI alignment", "updated_at": "1649058510", "user": "gk199"}