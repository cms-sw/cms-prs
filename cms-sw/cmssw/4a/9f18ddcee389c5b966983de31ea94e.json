{"additions": 106, "auther_ref": "waitingTaskWithArenaHolder", "auther_sha": "e77e887f8a1dd538fb1af3ef9e47efc168711d36", "author": "makortel", "body": "#### PR description:\r\n\r\nIn the framework the `doneWaiting()` is always called from within the main arena in the TBB thread pool, and therefore using\r\nWaitingTaskHolder is safe (`WaitingTaskWithArenaHolder` is needed only when `doneWaiting()` is called outside of the TBB arena).\r\n\r\nAvoiding `WaitingTaskWithArenaHolder` allows to avoid enqueue() operation when the `doneWaiting()` calls in the framework are the ones that decrease the task reference count to 0.\r\n\r\nResolves https://github.com/cms-sw/framework-team/issues/1125\r\n\r\n#### PR validation:\r\n\r\nChecked with gdb that a single-threaded test configuration with a module that uses `ExternalWork` (Alpaka-based module on the CPU serial backend, to be exact) where the `acquire()` does not leave any `WaitingTaskWithArenaHolder` alive (i.e. the `acquire()` does not really launch any asynchronous work) does not lead anymore to two TBB threads as a consequence of the `task_arena::enqueue()`.", "branch": "master", "changed_files": 29, "comments": 16, "commits": 1, "created_at": "1735332236", "deletions": 141, "labels": ["core-pending", "pending-signatures", "tests-pending", "orp-pending", "code-checks-pending"], "milestone": "CMSSW_15_0_X", "number": 47029, "release-notes": [], "review_comments": 8, "state": "open", "title": "Use `WaitingTaskHolder` to signal `doneWaiting()` instead of `WaitingTaskWithArenaHolder` in framework", "updated_at": "1736363895", "user": "makortel"}