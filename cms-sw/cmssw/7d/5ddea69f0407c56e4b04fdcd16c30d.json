{"additions": 229, "auther_ref": "dnn-tkCand-124X", "auther_sha": "e8ad10c044b4da947910ddd60686e2815a346619", "author": "leonardogiannini", "body": "#### PR description:\r\n\r\nIn this PR we introduce the possibility to compute the track selection DNN on a simplified set of inputs at the track candidate level\r\n\r\nA loose selection at this level allows a reduction of the fitting time. \r\n\r\nThe DNN is evaluated in batches to speed up this extra step and not increase significantly the overall tracking time.\r\n\r\nThe selection can be enabled/disabled in RecoTracker/IterativeTracking/python/**_cff.py\r\n\r\nCurrently, it is enabled only for the pixelLess and HighPtTriplet iterations.\r\n\r\nPremises and preliminary results were presented here [TK POG update 25 April](https://indico.cern.ch/event/1152032/contributions/4841692/attachments/2430728/4162233/mkFit%20-%20update-1.pdf) \r\n\r\n\r\n#### PR validation:\r\n\r\n- physics validation\r\nthe original is in blue, to be compared to red, after the cand level selection\r\nhttp://uaf-10.t2.ucsd.edu/~legianni/test-2configurations-html/\r\n\r\n- timing reduction iterations where DNN cand selection is applied\r\nthere is noticleable speed up in the fit (and selection) column and a smaller increase in the build column due to the DNN computation\r\n![image](https://user-images.githubusercontent.com/7805577/167452073-481d2767-2943-49c8-a9ae-d97fda43a860.png)\r\n![image](https://user-images.githubusercontent.com/7805577/167453073-f8d14ea1-9f92-48d4-b716-f1dfe820ceb2.png)\r\n\r\n- timing global - overall reduced\r\n![image](https://user-images.githubusercontent.com/7805577/167452360-e8434b7a-1b6c-41a4-a013-aaea46a836ce.png)\r\n\r\n\r\n\r\n- profiling with igprof\r\n\r\n- mem\r\n  before  https://legianni.web.cern.ch/legianni/cgi-bin/igprof-navigator/candDNN-batch-profiles/NODNNMEM3\r\n  after  https://legianni.web.cern.ch/legianni/cgi-bin/igprof-navigator/candDNN-batch-profiles/DNNMEM3\r\n  \r\n  in particular\r\n  (https://legianni.web.cern.ch/legianni/cgi-bin/igprof-navigator/candDNN-batch-profiles/NODNNMEM3/1028 before)\r\n  (https://legianni.web.cern.ch/legianni/cgi-bin/igprof-navigator/candDNN-batch-profiles/DNNMEM3/1087 after)\r\n\r\n- cpu\r\n  before  https://legianni.web.cern.ch/legianni/cgi-bin/igprof-navigator/candDNN-batch-profiles/NODNNCPU\r\n  after  https://legianni.web.cern.ch/legianni/cgi-bin/igprof-navigator/candDNN-batch-profiles/DNNCPU2\r\n", "branch": "master", "changed_files": 4, "closed_at": "1652364881", "comments": 24, "commits": 5, "created_at": "1652136409", "deletions": 4, "labels": ["reconstruction-approved", "fully-signed", "tests-approved", "orp-approved", "code-checks-approved", "tracking"], "merge_commit_sha": "ff97d04db62cc0ea391a5978e4f65541b73698d8", "merged_at": "1652364881", "merged_by": "cmsbuild", "milestone": "CMSSW_12_4_X", "number": 37878, "release-notes": [], "review_comments": 11, "state": "closed", "title": "Cand level DNN selection in MkFit + application to 2 iterations", "updated_at": "1652364881", "user": "leonardogiannini"}