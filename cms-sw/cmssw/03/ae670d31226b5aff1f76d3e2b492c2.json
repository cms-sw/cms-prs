{"additions": 56, "auther_ref": "Phase1-HECollapse3-101X", "auther_sha": "dc4b421cbe9474142cfb1c8f422a2608f8487686", "author": "kpedro88", "body": "#21842 unintentionally introduced some discrepancies in the 2018 \"collapsed\" workflow. The underlying problem is that `HcalTopology::withSpecialRBXHBHE()` is set by the underlying geometry, and since we use a geometry that allows collapsing for 2018, it is always true, even if the collapsing is not actually performed.\r\n\r\nInstead, from now on we will use `HcalTopology::getMergePositionFlag()`, which can be set in Python. This parameter will be set by the same modifier that puts the RecHit combiner module into the HCAL local reco sequence.\r\n\r\nThis change is propagated to all necessary areas of the code. @abdoulline has confirmed that it works as expected for CaloTowers (with thresholds removed, since sometimes there can be weird threshold effects for collapsed vs uncollapsed RecHits): https://cms-cpt-software.web.cern.ch/cms-cpt-software/General/Validation/SVSuite/HCAL/calo_scan_single_pi/10_0_0/10_0_0_2018C_fixNocuts_vs_10_0_0_2018UC_fixNocuts_SinglePi/\r\n\r\n@Martin-Grunewald for HLT, the parameter `process.HcalTopologyIdealEP.MergePosition` should be false by default, except for collapsed menus (2017 and 2018). What is the best way to specify this in the customization?\r\n\r\nThis PR will be backported to 100X.\r\n\r\nattn: @bsunanda ", "branch": "master", "changed_files": 17, "comments": 23, "commits": 5, "created_at": "1517150209", "deletions": 52, "labels": ["code-checks-approved", "comparison-available", "dqm-pending", "geometry-pending", "hlt-pending", "orp-pending", "pdmv-pending", "pending-signatures", "reconstruction-pending", "tests-approved", "upgrade-pending"], "milestone": "CMSSW_10_1_X", "number": 22001, "release-notes": [], "review_comments": 0, "state": "open", "title": "Fix collapsed status in HCAL topology", "updated_at": "1517234762", "user": "kpedro88"}