{"additions": 253, "auther_ref": "addPixelAlignmentMpas", "auther_sha": "ff2832b85a5d901beefb111c3a724fe65c9fb86b", "author": "mmusich", "body": "#### PR description:\r\n\r\nIn a quest to better understand what kind of movements are applied by the HighGranularity PCL during production (following up to [this presentation](https://indico.cern.ch/event/1271493/contributions/5530671/attachments/2698389/4683271/alignmentPCLlike_2023_08_07.pdf)), I have added a set of templated classes to display maps of pixel alignment coordinate comparisons for two IoVs within the same tag or two tags.\r\n\r\n#### PR validation:\r\n\r\nRun the following script:\r\n\r\n<details>\r\n  <summary>Click me</summary>\r\n  \r\n```bash\r\n#!/bin/bash\r\n\r\n# prepare the local comparison file \r\nconddb_import -c sqlite_file:toCompare.db -f sqlite_file:/afs/cern.ch/cms/CAF/CMSALCA/ALCA_TRACKERALIGN/MP/MPproduction/mp3710/jobData/jobm/alignments_MP.db -i Alignments -t mp3710\r\nconddb_import -c sqlite_file:toCompare.db -f sqlite_file:/afs/cern.ch/cms/CAF/CMSALCA/ALCA_TRACKERALIGN/MP/MPproduction/mp3711/jobData/jobm/alignments_MP.db -i Alignments -t mp3711\r\nconddb_import -c sqlite_file:toCompare.db -f sqlite_file:/afs/cern.ch/cms/CAF/CMSALCA/ALCA_TRACKERALIGN/MP/MPproduction/mp3712/jobData/jobm/alignments_MP.db -i Alignments -t mp3712\r\nconddb_import -c sqlite_file:toCompare.db -f frontier://FrontierProd/CMS_CONDITIONS -i TrackerAlignment_PCL_byRun_v2_express -t StartingGeometry -b 368410 -e 368410\r\n\r\n# Save current working dir so img can be outputted there later\r\nW_DIR=$(pwd);\r\n\r\ncd $W_DIR;\r\nsource /afs/cern.ch/cms/cmsset_default.sh;\r\neval `scram run -sh`;\r\n\r\n#*************************************************************************#\r\ntags=(mp3710 mp3711 mp3712)\r\nelements=(X Y Z Alpha Beta Gamma)\r\n\r\nfor j in \"${tags[@]}\"\r\ndo\r\n    echo \"Processing tag: ${j}\"\r\n    mkdir -p $W_DIR/results_alignments_${j}\r\n    for i in \"${elements[@]}\"\r\n    do\r\n    echo \"Processing: $i coordinate\"\r\n\r\n    getPayloadData.py  \\\r\n        --plugin pluginTrackerAlignment_PayloadInspector \\\r\n        --plot plot_PixelAlignmentCompareMap${i}TwoTags \\\r\n        --tag StartingGeometry \\\r\n        --tagtwo ${j} \\\r\n        --time_type Run \\\r\n        --iovs '{\"start_iov\": \"368410\", \"end_iov\": \"368410\"}' \\\r\n        --iovstwo '{\"start_iov\": \"1\", \"end_iov\": \"1\"}' \\\r\n        --db sqlite_file:toCompare.db \\\r\n        --test;\r\n\r\n    mv *.png $W_DIR/results_alignments_${j}/TrackerAlignmentCompare${i}.png\r\n    done\r\ndone\r\n```\r\n</details>\r\n\r\n\r\nand obtained the following [results](http://musich.web.cern.ch/musich/display/testPixelAlignmentComparisonMaps/).\r\nAs an example I post here one of the maps obtained in the comparisons:\r\n\r\n![image](https://github.com/cms-sw/cmssw/assets/5082376/bd6adcc9-7484-467f-be0f-25f53bb15d13)\r\n\r\n\r\n#### If this PR is a backport please specify the original PR and why you need to backport that PR. If this PR will be backported please specify to which release cycle the backport is meant for:\r\n\r\n\r\n", "branch": "master", "changed_files": 4, "comments": 0, "commits": 1, "created_at": "1692167594", "deletions": 0, "labels": ["db-pending", "pending-signatures", "tests-pending", "orp-pending", "code-checks-pending"], "milestone": "CMSSW_13_3_X", "number": 42580, "release-notes": [], "review_comments": 0, "state": "open", "title": "Tk Alignment Payload Inspector: add pixel alignment comparison maps per coordinate", "updated_at": "1692167619", "user": "mmusich"}