{"additions": 33, "auther_ref": "fix_splitVertices_140x", "auther_sha": "5408c0f28aa3926fea2647c868e4ffc4bb160ec2", "author": "fwyzard", "body": "#### PR description:\r\n\r\nAdd\r\n```c++\r\nalpaka::syncBlockThreads(acc);\r\n```\r\nat the end of the loop on the vertices to ensure that all threads are properly synchronised before resetting the shared memory.\r\n\r\nClean up the kernel to use the SoA accessors and the `cms::alpakatools` utilities.\r\n\r\n#### PR validation:\r\n\r\nRunning the HLT with `compute-sanitizer --tool=racecheck` without this PR warns about a potential race condition in `splitVertices()`.\r\nThis PR fixes the warning: see https://github.com/cms-sw/cmssw/issues/44923#issuecomment-2271803296.\r\n\r\nRunning the current online HLT menu over 20k events on top of CMSSW 14.0.13-patch2 does not result in any changes to the HLT results (see https://github.com/cms-sw/cmssw/pull/45656#issuecomment-2274337336) and performance on GPU (see https://github.com/cms-sw/cmssw/pull/45656#issuecomment-2274492410).\r\n\r\n\r\n#### If this PR is a backport please specify the original PR and why you need to backport that PR. If this PR will be backported please specify to which release cycle the backport is meant for:\r\n\r\nBackport of #45656 to 14.0.x for data taking.", "branch": "CMSSW_14_0_X", "changed_files": 1, "comments": 11, "commits": 1, "created_at": "1722961601", "deletions": 48, "labels": ["reconstruction-pending", "pending-signatures", "tests-approved", "orp-pending", "bug-fix", "backport", "tracking"], "milestone": "CMSSW_14_0_X", "number": 45655, "release-notes": [], "review_comments": 0, "state": "open", "title": "Fix a race condition in splitVertices [14.0.x]", "updated_at": "1723064854", "user": "fwyzard"}