{"additions": 15, "auther_ref": "fix_hltSiPixelRecHitSoA_121x", "auther_sha": "9d4710127a2ecf7001ada94068ec8f25abec7714", "author": "fwyzard", "body": "#### PR description:\r\n\r\nUse the hltSiPixelRecHitSoA producer for the pixel rechits in legacy and SoA format, instead of running the legacy producer.\r\n\r\n#### PR validation:\r\n\r\nSuccessfully run the GPU workflow `11634.506`.\r\n\r\nRunning the HLT over 100 TTbar events now shows less discrepancies between the CPU and GPU results.\r\nBefore:\r\n```\r\n      Events    Accepted      Gained        Lost       Other  Trigger\r\n         100          36          +2          -1           -  HLT_Mu3_PFJet40_v16\r\n         100           1          +1           -          ~1  HLT_Mu7p5_Track2_Jpsi_v11\r\n         100          36          +1           -           -  HLT_Mu3_L1SingleMu5orSingleMu7_v1\r\n         100          18           -          -1           -  HLT_Ele15_WPLoose_Gsf_v3\r\n         100          15           -          -1           -  HLT_Ele17_WPLoose_Gsf_v3\r\n         100          14           -          -1           -  HLT_Ele20_WPLoose_Gsf_v6\r\n         100          19          +1           -           -  HLT_Mu12_v3\r\n         100          96           -          -1           -  HLT_DiPFJet15_FBEta3_NoCaloMatched_v17\r\n         100          20          +3          -1           -  HLT_DiPFJet25_FBEta3_NoCaloMatched_v17\r\n         100          98           -          -1           -  HLT_DiPFJetAve40_v14\r\n         100          70          +1          -2           -  HLT_DiPFJetAve60_v14\r\n         100          42          +1           -           -  HLT_DiPFJetAve80_v13\r\n         100          95          +1          -1           -  HLT_DiPFJetAve25_HFJEC_v17\r\n         100          14           -          -3           -  HLT_DiPFJetAve60_HFJEC_v15\r\n         100           4          +1          -1           -  HLT_DiPFJetAve80_HFJEC_v16\r\n         100         100           -          -1           -  HLT_AK8PFJet15_v3\r\n         100         100           -          -1           -  HLT_AK8PFJet40_v16\r\n         100          90          +1          -3           -  HLT_AK8PFJet60_v15\r\n         100          64          +1          -1           -  HLT_AK8PFJet80_v15\r\n         100          19          +1          -3           -  HLT_AK8PFJet140_v15\r\n         100          98          +1          -1           -  HLT_PFJet40_v21\r\n         100          78           -          -1           -  HLT_PFJet60_v21\r\n         100          50          +2           -           -  HLT_PFJet80_v20\r\n         100          17           -          -1           -  HLT_PFJet140_v19\r\n         100          79          +4          -2           -  HLT_PFJetFwd25_v3\r\n         100          28          +2          -2           -  HLT_PFJetFwd40_v19\r\n         100          86          +5          -3           -  HLT_AK8PFJetFwd40_v15\r\n         100          15           -          -1           -  HLT_PFHT370_v17\r\n         100           1           -          -1           -  HLT_PFHT890_v17\r\n         100           3           -          -1           -  HLT_PFMETTypeOne130_PFMHT130_IDTight_v12\r\n         100           2           -          -1           -  HLT_PFMETTypeOne140_PFMHT140_IDTight_v11\r\n         100           6          +1          -1           -  HLT_PFMETNoMu110_PFMHTNoMu110_IDTight_v20\r\n         100           6          +1          -1           -  HLT_MonoCentralPFJet80_PFMETNoMu110_PFMHTNoMu110_IDTight_v20\r\n         100           1           -          -1           -  HLT_PFMETTypeOne200_BeamHaloCleaned_v9\r\n         100           1          +1           -           -  HLT_SingleJet30_Mu12_SinglePFJet40_v11\r\n         100           1          +1           -           -  HLT_Mu12_DoublePFJets40_CaloBTagDeepCSV_p71_v2\r\n         100          18          +1           -           -  HLT_Mu8_TrkIsoVVL_v12\r\n         100           2          +1           -           -  HLT_Mu8_TrkIsoVVL_Ele23_CaloIdL_TrackIdL_IsoVL_DZ_v13\r\n         100           2          +1           -           -  HLT_Mu8_TrkIsoVVL_Ele23_CaloIdL_TrackIdL_IsoVL_DZ_PFDiJet30_v1\r\n         100           2          +1           -           -  HLT_Mu8_TrkIsoVVL_Ele23_CaloIdL_TrackIdL_IsoVL_DZ_CaloDiJet30_v1\r\n         100           3          +1           -           -  HLT_Mu8_TrkIsoVVL_Ele23_CaloIdL_TrackIdL_IsoVL_v11\r\n         100           2          +1           -           -  HLT_Mu12_TrkIsoVVL_Ele23_CaloIdL_TrackIdL_IsoVL_v7\r\n         100           1          +1           -           -  HLT_Mu12_TrkIsoVVL_Ele23_CaloIdL_TrackIdL_IsoVL_DZ_v15\r\n         100           4          +1           -          ~1  HLT_Mu3er1p5_PFJet100er2p5_PFMET70_PFMHT70_IDTight_v2\r\n         100           3          +1           -           -  HLT_Mu3er1p5_PFJet100er2p5_PFMET80_PFMHT80_IDTight_v2\r\n         100           1          +1           -           -  HLT_Mu3er1p5_PFJet100er2p5_PFMET90_PFMHT90_IDTight_v2\r\n         100           4          +1           -          ~1  HLT_Mu3er1p5_PFJet100er2p5_PFMETNoMu70_PFMHTNoMu70_IDTight_v2\r\n         100           4          +1           -           -  HLT_Mu3er1p5_PFJet100er2p5_PFMETNoMu80_PFMHTNoMu80_IDTight_v2\r\n         100           4          +1          -1           -  HLT_Mu3er1p5_PFJet100er2p5_PFMETNoMu90_PFMHTNoMu90_IDTight_v2\r\n         100           4          +1          -1           -  HLT_Mu3er1p5_PFJet100er2p5_PFMETNoMu100_PFMHTNoMu100_IDTight_v2\r\n         100          23          +1           -           -  HLT_Mu8_v12\r\n         100          20           -          -1           -  HLT_Ele8_CaloIdL_TrackIdL_IsoVL_PFJet30_v16\r\n         100          19           -          -1           -  HLT_Ele12_CaloIdL_TrackIdL_IsoVL_PFJet30_v18\r\n         100          18           -          -1           -  HLT_Ele15_CaloIdL_TrackIdL_IsoVL_PFJet30_v3\r\n         100          13           -          -1           -  HLT_Ele23_CaloIdL_TrackIdL_IsoVL_PFJet30_v18\r\n         100          22          +1          -1           -  HLT_Ele8_CaloIdM_TrackIdM_PFJet30_v18\r\n         100          16           -          -1           -  HLT_Ele17_CaloIdM_TrackIdM_PFJet30_v16\r\n         100          14           -          -1           -  HLT_Ele23_CaloIdM_TrackIdM_PFJet30_v18\r\n         100           5           -          -1          ~1  HLT_PFHT330PT30_QuadPFJet_75_60_45_40_TriplePFBTagDeepCSV_4p5_v3\r\n         100           5           -          -1          ~1  HLT_PFHT400_SixPFJet32_DoublePFBTagDeepCSV_2p94_v8\r\n         100           6           -          -2           -  HLT_PFHT400_SixPFJet32_v8\r\n         100           5           -          -1           -  HLT_PFHT400_FivePFJet_100_100_60_30_30_v8\r\n         100           3           -          -1           -  HLT_PFHT400_FivePFJet_100_100_60_30_30_DoublePFBTagDeepCSV_4p5_v8\r\n         100           3           -          -1           -  HLT_PFHT400_FivePFJet_120_120_60_30_30_DoublePFBTagDeepCSV_4p5_v8\r\n         100          20           -          -1           -  HLT_PFHT350MinPFJet15_v9\r\n         100          50          +2           -           -  HLT_AK4PFJet80_v19\r\n         100          31          +2           -           -  HLT_AK4PFJet100_v19\r\n         100          24          +1           -           -  HLT_AK4PFJet120_v18\r\n         100          85           -          -1           -  MC_PFBTagDeepCSV_v10\r\n         100          10          +2          -1          ~2  HLT_PFMETNoMu100_PFMHTNoMu100_IDTight_PFHT60_v9\r\n         100           6          +1           -           -  HLT_QuadPFJet105_88_76_15_v5\r\n         100           4          +1           -           -  HLT_QuadPFJet111_90_80_15_v5\r\n         100          22          +1           -           -  HLT_Mu9_IP0_part0_v2\r\n         100          22          +1           -           -  HLT_TrkMu6NoFiltersNoVtx_v1\r\n         100          17          +1           -           -  HLT_TrkMu16NoFiltersNoVtx_v1\r\n         100         100           -        -100           -  Status_OnCPU\r\n         100           0        +100           -           -  Status_OnGPU\r\n```\r\n\r\nAfter:\r\n```\r\n      Events    Accepted      Gained        Lost       Other  Trigger\r\n         100          37          +1          -1           -  HLT_Mu3_PFJet40_v16\r\n         100          18           -          -1           -  HLT_Ele15_WPLoose_Gsf_v3\r\n         100          15           -          -1           -  HLT_Ele17_WPLoose_Gsf_v3\r\n         100          14           -          -1           -  HLT_Ele20_WPLoose_Gsf_v6\r\n         100          96           -          -1           -  HLT_DiPFJet15_FBEta3_NoCaloMatched_v17\r\n         100          20          +3          -1           -  HLT_DiPFJet25_FBEta3_NoCaloMatched_v17\r\n         100          98           -          -1           -  HLT_DiPFJetAve40_v14\r\n         100          70          +1          -2           -  HLT_DiPFJetAve60_v14\r\n         100          43          +1          -1           -  HLT_DiPFJetAve80_v13\r\n         100          94          +1           -           -  HLT_DiPFJetAve25_HFJEC_v17\r\n         100          13           -          -2           -  HLT_DiPFJetAve60_HFJEC_v15\r\n         100           4          +1          -1           -  HLT_DiPFJetAve80_HFJEC_v16\r\n         100         100           -          -1           -  HLT_AK8PFJet15_v3\r\n         100         100           -          -1           -  HLT_AK8PFJet40_v16\r\n         100          90          +1          -3           -  HLT_AK8PFJet60_v15\r\n         100          66          +1          -3           -  HLT_AK8PFJet80_v15\r\n         100          18          +1          -2           -  HLT_AK8PFJet140_v15\r\n         100          98          +1          -1           -  HLT_PFJet40_v21\r\n         100          78           -          -1           -  HLT_PFJet60_v21\r\n         100          51          +1           -           -  HLT_PFJet80_v20\r\n         100          17           -          -1           -  HLT_PFJet140_v19\r\n         100          79          +4          -2           -  HLT_PFJetFwd25_v3\r\n         100          29          +1          -2           -  HLT_PFJetFwd40_v19\r\n         100          87          +4          -3           -  HLT_AK8PFJetFwd40_v15\r\n         100          15           -          -1           -  HLT_PFHT370_v17\r\n         100           1           -          -1           -  HLT_PFHT890_v17\r\n         100           3          +1           -          ~1  HLT_PFMETNoMu120_PFMHTNoMu120_IDTight_PFHT60_v9\r\n         100           3           -          -1           -  HLT_PFMETTypeOne130_PFMHT130_IDTight_v12\r\n         100           2           -          -1           -  HLT_PFMETTypeOne140_PFMHT140_IDTight_v11\r\n         100           7          +1          -2           -  HLT_PFMETNoMu110_PFMHTNoMu110_IDTight_v20\r\n         100           3          +1           -          ~1  HLT_PFMETNoMu120_PFMHTNoMu120_IDTight_v20\r\n         100           7          +1          -2           -  HLT_MonoCentralPFJet80_PFMETNoMu110_PFMHTNoMu110_IDTight_v20\r\n         100           3          +1           -          ~1  HLT_MonoCentralPFJet80_PFMETNoMu120_PFMHTNoMu120_IDTight_v20\r\n         100           1           -          -1           -  HLT_PFMETTypeOne200_BeamHaloCleaned_v9\r\n         100           1           -          -1           -  HLT_DoubleMu3_DZ_PFMET90_PFMHT90_v10\r\n         100           3          +2           -           -  HLT_Mu3er1p5_PFJet100er2p5_PFMET70_PFMHT70_IDTight_v2\r\n         100           3          +1           -           -  HLT_Mu3er1p5_PFJet100er2p5_PFMET80_PFMHT80_IDTight_v2\r\n         100           2          +1          -1           -  HLT_Mu3er1p5_PFJet100er2p5_PFMET90_PFMHT90_IDTight_v2\r\n         100           4          +1           -           -  HLT_Mu3er1p5_PFJet100er2p5_PFMETNoMu70_PFMHTNoMu70_IDTight_v2\r\n         100           4          +1           -           -  HLT_Mu3er1p5_PFJet100er2p5_PFMETNoMu80_PFMHTNoMu80_IDTight_v2\r\n         100           4          +1          -1           -  HLT_Mu3er1p5_PFJet100er2p5_PFMETNoMu90_PFMHTNoMu90_IDTight_v2\r\n         100           4          +1          -1           -  HLT_Mu3er1p5_PFJet100er2p5_PFMETNoMu100_PFMHTNoMu100_IDTight_v2\r\n         100          21          +1           -           -  HLT_Ele8_CaloIdM_TrackIdM_PFJet30_v18\r\n         100           5           -          -1          ~1  HLT_PFHT330PT30_QuadPFJet_75_60_45_40_TriplePFBTagDeepCSV_4p5_v3\r\n         100           5           -          -1           -  HLT_PFHT400_SixPFJet32_DoublePFBTagDeepCSV_2p94_v8\r\n         100           5           -          -1           -  HLT_PFHT400_SixPFJet32_v8\r\n         100           4          +1          -1           -  HLT_PFHT400_FivePFJet_100_100_60_30_30_v8\r\n         100           3           -          -1          ~1  HLT_PFHT400_FivePFJet_100_100_60_30_30_DoublePFBTagDeepCSV_4p5_v8\r\n         100           3           -          -1           -  HLT_PFHT400_FivePFJet_120_120_60_30_30_DoublePFBTagDeepCSV_4p5_v8\r\n         100          22           -          -3           -  HLT_PFHT350MinPFJet15_v9\r\n         100          51          +1           -           -  HLT_AK4PFJet80_v19\r\n         100          31          +2           -           -  HLT_AK4PFJet100_v19\r\n         100          10          +2          -1          ~1  HLT_PFMETNoMu100_PFMHTNoMu100_IDTight_PFHT60_v9\r\n         100         100           -        -100           -  Status_OnCPU\r\n         100           0        +100           -           -  Status_OnGPU\r\n```\r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\n\r\nBackport to 12.1.x of of #35915.", "branch": "CMSSW_12_1_X", "changed_files": 1, "closed_at": "1635810195", "comments": 11, "commits": 1, "created_at": "1635518380", "deletions": 10, "labels": ["hlt-approved", "fully-signed", "tests-approved", "bug-fix", "orp-approved", "requires-external", "backport-ok"], "merge_commit_sha": "3f27c8beec40cb8ef83523596160977230304784", "merged_at": "1635810195", "merged_by": "cmsbuild", "milestone": "CMSSW_12_1_X", "number": 35916, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Fix the Patatrack pixel local reconstruction running on CPU", "updated_at": "1635810195", "user": "fwyzard"}