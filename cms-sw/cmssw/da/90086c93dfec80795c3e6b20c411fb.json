{"additions": 71, "auther_ref": "scouting_nano_dev_filter_15_1_X_IB", "auther_sha": "7b71cf50a70a875939bc808ecc58a018f6032c6b", "author": "patinkaew", "body": "#### PR description:\r\n\r\nThis PR supersedes [cms-sw/cmssw#47302](https://github.com/cms-sw/cmssw/pull/47302) on filter implementation (Another part on era modifier implemented in [cms-sw/cmssw#47302](https://github.com/cms-sw/cmssw/pull/47302) will be superseded by another PR).\r\n\r\nIn 2022-24, ScoutingPFMonitor dataset consists of logical-OR of scouting and standard HLT paths. However, only scouting objects are reconstructed on scouting paths. Events passing only standard HLT paths, but not scouting paths, will not contain scouting products. This gives a proper treatment to the issue with EDFilter instead of previous solution introduced in [cms-sw/cmssw#46516](https://github.com/cms-sw/cmssw/pull/46516).\r\n\r\nThis is not an issue in 2025 following [CMSHLT-3089](https://its.cern.ch/jira/browse/CMSHLT-3089).\r\n\r\nFor more technical details,\r\n- this PR adds customisation to add check and skip events without scouting which can be included in ```cmsDriver.py``` by adding```--customise PhysicsTools/NanoAOD/custom_run3scouting_cff.skipEventsWithoutScouting```.\r\n- this PR adds ```@ScoutMonitor``` flavour similar to ```@Scout``` with the above customisation added.\r\n- this PR also removes L1TRAWToDigi sequence (defined in [L1TRawToDigi_cff.py](https://github.com/cms-sw/cmssw/blob/master/L1Trigger/Configuration/python/L1TRawToDigi_cff.py)) as it contains additional modules not used by ScoutingNano.\r\n\r\n#### PR validation:\r\n\r\nPass all tests from ```scram b runtests use-ibeos```.\r\nPass all ScoutingNano-related relval_nano workflows from \r\n```\r\nrunTheMatrix.py --ibeos -l 2500.131,2500.227,2500.228,2500.237,2500.238\r\n```\r\n\r\nIn addition, several ```cmsDriver.py``` commands have been tested on data and MC samples documented in [1].\r\nIn brief, concerning data:\r\n\r\n- ```@Scout``` works for ScoutingPFRun3 2022-24\r\n- ```@ScoutMonitor``` works for ScoutingPFMonitor 2022-24\r\n- ```@ScoutFromMini``` works for ScoutingPFMonitor 2024 (Scouting objects are in MiniAOD starting in Prompt 2024)\r\n- ```@Prompt+@ScoutMonitor``` works for ScoutingPFMonitor 2023. Input 2022 fails because of Tau.\r\n- ```@Prompt+@ScoutFromMini```works for ScoutingPFMonitor 2024 (Scouting objects are in MiniAOD starting in Prompt 2024)\r\nPlease see commands in [1]. Relevant test results (python config, root, event content, size report, log) are included in [2]. Summary of size report is in [3].\r\n\r\nMoreover, since this might be used for prompt reconstruction, to simulate the prompt reconstruction workflow, we ran ```RunPromptReco.py``` (with modified ```n=1000```) with the following command:\r\n```\r\nRunPromptReco.py --scenario ppEra_Run3_2024 --reco --aod --miniaod --nanoaod --dqmio --global-tag 140X_dataRun3_Prompt_v4 --nanoFlavours=@PHYS+@L1+@ScoutMonitor --lfn=fileIn.root\r\n```\r\nThis step reconstructs ```fileIn.root``` in RAW tier to RECO, AOD, MINIAOD, NANOAOD, and DQMIO. The output files in RECO, AOD, and MINIAOD have 1000 events while NANOAOD (in NANOAODEDM) has 986 events. This is expected since the filter is applied for NANOAOD.\r\nFinally, merge step is run with\r\n```\r\nRunMerge.py --mergeNANO --input-files=output_inNANOAOD.root --output-file=output_inNANOAOD_merged.root\r\n```\r\nThe output file is now in final NANOAOD format (TTree with all primitives) and has 986 events. The event content contains standard, L1, and scouting objects as expected (```@PHYS+@L1+@ScoutMonitor```).\r\n\r\n#### If this PR is a backport please specify the original PR and why you need to backport that PR. If this PR will be backported please specify to which release cycle the backport is meant for:\r\n\r\nThis is not a backport.\r\n\r\n[1] https://codimd.web.cern.ch/PTeusxQURcmBaS7Ilfv9GQ?view\r\n[2] https://cernbox.cern.ch/s/J64vQTyn6J5FgRC\r\n[3] https://docs.google.com/spreadsheets/d/10UFlWqurxMTuXy0HeulFTjbx5lUca9ZeM4CAXkC12Wo/edit?usp=sharing", "branch": "master", "changed_files": 3, "comments": 3, "commits": 3, "created_at": "1743414771", "deletions": 11, "labels": ["pending-signatures", "tests-pending", "orp-pending", "pdmv-pending", "upgrade-pending", "code-checks-approved", "xpog-pending"], "milestone": "CMSSW_15_1_X", "number": 47739, "release-notes": [], "review_comments": 0, "state": "open", "title": "Add filter to skip events without scouting objects in ScoutingNano for ScoutingPFMonitor dataset", "updated_at": "1743414907", "user": "patinkaew"}