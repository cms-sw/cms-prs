{"additions": 7, "auther_ref": "activateIrradiationBiasCorrection_forRun3", "auther_sha": "9310ec18c0e52fd9c6ab9d3be6b139e8bfb8fcff", "author": "mmusich", "body": "#### PR description:\r\n\r\nIn this PR the `IrradiationBiasCorrection` parameter for the Pixel CPE Generic algorithm is activated for the Run 3 era. \r\nThe motivation for activating the correction is due to the expected comparatively large loss of resolution along the local y [global-z in barrel] direction for an heavily irradiated detector (as expected for the end of run3 and extended end or run3 simulation scenarios), in which carrier trapping significantly reduces Lorentz drift induced charge sharing.\r\nAs shown in [this presentation](https://indico.cern.ch/event/808415/contributions/3447906/attachments/1853234/3043117/Run3_Template_Update.pdf), without this correction most clusters are reconstructed at 100-200m from true y, caused by charge loss from the backplane side.\r\n\r\nAs pointed out in the review (see https://github.com/cms-sw/cmssw/pull/27183#issuecomment-502780836) the Pixel CPE conditions need to be updated to take into account the parameter is switched on. \r\nThe `phase1_2021_realistic` and `phase1_2021_cosmics` are updated accordingly.\r\nThe diff of the two Global Tags is the following:\r\n```bash\r\n$ conddb diff 106X_upgrade2021_realistic_Candidate_2019_06_17_18_50_50 106X_upgrade2021_realistic_v5\r\n[2019-06-17 21:26:38,571] INFO: Connecting to pro [frontier://PromptProd/CMS_CONDITIONS]\r\nRecord                        Label        pro::106X_upgrade2021_realistic_Candidate_2019_06_17_18_50_50 Tag  pro::106X_upgrade2021_realistic_v5 Tag                          \r\n----------------------------  -----------  -----------------------------------------------------------------  --------------------------------------------------------------  \r\nSiPixel2DTemplateDBObjectRcd  denominator  SiPixel2DTemplateDBObject_phase1_BoR3_HV350_Tr1300_den             SiPixel2DTemplateDBObject_phase1_38T_mc_v4_den_unirradiated     \r\nSiPixel2DTemplateDBObjectRcd  numerator    SiPixel2DTemplateDBObject_phase1_BoR3_HV350_Tr1300_num             SiPixel2DTemplateDBObject_phase1_38T_2018_ultralegacymc_v1_num  \r\nSiPixelGenErrorDBObjectRcd    -            SiPixelGenErrorDBObject_phase1_BoR3_HV350_Tr1300                   SiPixelGenErrorDBObject_phase1_38T_2018_ultralegacymc_v1        \r\nSiPixelLorentzAngleRcd        -            SiPixelLorentzAngle_phase1_BoR3_HV350_Tr1300                       SiPixelLorentzAngle_phase1_2018_ultralegacymc_v1                \r\nSiPixelLorentzAngleSimRcd     -            SiPixelLorentzAngleSim_phase1_BoR3_HV350_Tr1300                    SiPixelLorentzAngleSim_phase1_mc_v4                             \r\nSiPixelTemplateDBObjectRcd    -            SiPixelTemplateDBObject_phase1_BoR3_HV350_Tr1300                   SiPixelTemplateDBObject_phase1_38T_2018_ultralegacymc_v1      \r\n```\r\n```bash\r\n$ conddb diff 106X_upgrade2021cosmics_realistic_deco_Candidate_2019_06_17_19_08_59 106X_upgrade2021cosmics_realistic_deco_v2[2019-06-17 21:27:39,951] INFO: Connecting to pro [frontier://PromptProd/CMS_CONDITIONS]\r\nRecord                        Label        pro::106X_upgrade2021cosmics_realistic_deco_Candidate_2019_06_17_19_08_59 Tag  pro::106X_upgrade2021cosmics_realistic_deco_v2 Tag              \r\n----------------------------  -----------  -----------------------------------------------------------------------------  --------------------------------------------------------------  \r\nSiPixel2DTemplateDBObjectRcd  denominator  SiPixel2DTemplateDBObject_phase1_BoR3_HV350_Tr1300_den                         SiPixel2DTemplateDBObject_phase1_38T_mc_v4_den_unirradiated     \r\nSiPixel2DTemplateDBObjectRcd  numerator    SiPixel2DTemplateDBObject_phase1_BoR3_HV350_Tr1300_num                         SiPixel2DTemplateDBObject_phase1_38T_2018_ultralegacymc_v1_num  \r\nSiPixelGenErrorDBObjectRcd    -            SiPixelGenErrorDBObject_phase1_BoR3_HV350_Tr1300                               SiPixelGenErrorDBObject_phase1_38T_2018_ultralegacymc_v1        \r\nSiPixelLorentzAngleRcd        -            SiPixelLorentzAngle_phase1_BoR3_HV350_Tr1300                                   SiPixelLorentzAngle_phase1_2018_ultralegacymc_v1                \r\nSiPixelLorentzAngleSimRcd     -            SiPixelLorentzAngleSim_phase1_BoR3_HV350_Tr1300                                SiPixelLorentzAngleSim_phase1_mc_v4                             \r\nSiPixelTemplateDBObjectRcd    -            SiPixelTemplateDBObject_phase1_BoR3_HV350_Tr1300                               SiPixelTemplateDBObject_phase1_38T_2018_ultralegacymc_v1   \r\n```\r\n\r\n\r\n#### PR validation:\r\nCode compiles and the dumping of cmsDriver output configuration confirms the desired parameter value is assigned.\r\nThe activation of the parameter has been tested (together with the changes proposed in #27181) with:\r\n```\r\ncmsDriver.py -s GEN,SIM,DIGI,L1,DIGI2RAW,RAW2DIGI,RECO --evt_type SingleMuPt10_pythia8_cfi --fileout file:GENSIMRECO_MuPt10.root --python_filename=Run3_2023_generic_noIBC.py -n 10 --no_exec --era Run3 --beamspot Run3RoundOptics25ns13TeVHighSigmaZ --nThreads=4 customise_commands=\"process.mix.digitizers.pixel.ThresholdInElectrons_BPix_L1 = cms.double(1300.0);  process.mix.digitizers.pixel.ThresholdInElectrons_BPix_L2 = cms.double(1600.0);process.mix.digitizers.pixel.ThresholdInElectrons_BPix = cms.double(1600.0); process.mix.digitizers.pixel.ThresholdInElectrons_FPix = cms.double(1600.0);process.PixelCPEGenericESProducer.IrradiationBiasCorrection = True   --conditions 106X_mcRun3_2023_realistic_Candidate_2019_06_07_21_52_54 \r\n```\r\n~~There is not yet a physics output based validation (in progress), We will update the description once comparisons are available.~~\r\nPhysics validation has been shown in this presentation at the RECO / AT meeting of  14 Jun 2019 [link](https://indico.cern.ch/event/827369/contributions/3467663/attachments/1862678/3061762/tanjaReco_14062019.pdf).\r\n\r\n#### if this PR is a backport please specify the original PR:\r\n\r\nThis PR is not a backport\r\n\r\ncc: @tsusa @tvami @leaca @pmaksim1 @cmantill @OzAmram ", "branch": "master", "changed_files": 2, "closed_at": "1561444511", "comments": 89, "commits": 3, "created_at": "1560332511", "deletions": 3, "labels": ["alca-approved", "code-checks-approved", "comparison-available", "fully-signed", "orp-approved", "reconstruction-approved", "tests-approved"], "merge_commit_sha": "4e6be4d27795151dd0e7c9736420fca31086509c", "merged_at": "1561444510", "merged_by": "cmsbuild", "milestone": "CMSSW_11_0_X", "number": 27183, "release-notes": [], "review_comments": 4, "state": "closed", "title": "Activate IrradiationBiasCorrection in Pixel CPE generic for Run3", "updated_at": "1561444511", "user": "mmusich"}