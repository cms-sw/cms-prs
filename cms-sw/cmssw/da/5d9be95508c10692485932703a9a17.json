{"additions": 32, "auther_ref": "devel_l1tZDCEtSums2", "auther_sha": "8d8b14a860a7767d42697ffae935968a6ba2bd06", "author": "missirol", "body": "#### PR description:\r\n\r\nThis PR adds the computation of ZDC `EtSum`s to the sequence used for the emulation of the Stage-2 L1T results.\r\n\r\nThis addresses one of the issues discussed in #43214 (specifically, the L1T-ZDC not firing when using `L1REPACK:Full`).\r\n\r\nSee the validation section below for some additional details.\r\n\r\n#### PR validation:\r\n\r\nThe test in [1] outputs the L1T results (for a few events, using both real data and MC) in three cases: (a) before any re-emulation, (b) re-emulating only the L1-uGT, and (c) re-emulating L1T with `L1REPACK:Full` (data) or `L1REPACK:FullMC` (MC).\r\n - Regardless of this PR, the L1T results for ZDC seeds in (a) and (b) agree, as expected.\r\n - Without this PR, all L1T seeds using ZDC accept no events in case (c).\r\n - With this PR, the following happens.\r\n   - The trigger decisions of L1T-ZDC seeds are non-zero in (c) for data (`L1REPACK:Full`). In this case, the results of (c) are similar to (a/b), but not exactly the same. Solving this discrepancy is beyond the scope of this PR (it is left to L1T and ZDC experts).\r\n   - The trigger decisions of L1T-ZDC seeds are still zero in (c) for MC. I can only guess this is because more basic parts of the simulation of ZDC Trigger Primitives are missing in CMSSW. This too is beyond the scope of this PR, and it is left to domain experts.\r\n\r\n[1]\r\n```bash\r\n#!/bin/bash\r\n\r\n[ $# -ge 1 ] || exit 1\r\n\r\noutDir=\"${1}\"\r\n\r\n[ ! -d \"${outDir}\" ] || exit 1\r\n\r\nmkdir -p \"${outDir}\"\r\ncd \"${outDir}\"\r\n\r\nexecmd=\"hltGetConfiguration /dev/CMSSW_14_0_0/HIon --no-prescale --output minimal --max-events 100\"\r\nexecmd+=\" --paths HLTriggerFirstPath,HLTriggerFinalPath,HLTAnalyzerEndpath\"\r\n\r\nhltLabel=hltData_ref\r\n${execmd} \\\r\n  --customise HLTrigger/Configuration/CustomConfigs.customiseHLTforHIonRepackedRAWPrime \\\r\n  --input root://eoscms.cern.ch//eos/cms/store/user/cmsbuild/store/hidata/HIRun2023A/HIPhysicsRawPrime0/RAW/v1/000/375/491/00000/de963321-c0a0-49fb-b771-1a312a69db03.root \\\r\n  --globaltag 140X_dataRun3_HLT_v3 \\\r\n  --data \\\r\n  > \"${hltLabel}\".py && cmsRun \"${hltLabel}\".py &> \"${hltLabel}\".log && mv output.root \"${hltLabel}\".root\r\n\r\nhltLabel=hltData_L1uGT\r\n${execmd} \\\r\n  --customise HLTrigger/Configuration/CustomConfigs.customiseL1THLTforHIonRepackedRAWPrime \\\r\n  --input root://eoscms.cern.ch//eos/cms/store/user/cmsbuild/store/hidata/HIRun2023A/HIPhysicsRawPrime0/RAW/v1/000/375/491/00000/de963321-c0a0-49fb-b771-1a312a69db03.root \\\r\n  --globaltag 140X_dataRun3_HLT_v3 \\\r\n  --data \\\r\n  --eras Run3_2024 --l1-emulator uGT \\\r\n  > \"${hltLabel}\".py && cmsRun \"${hltLabel}\".py &> \"${hltLabel}\".log && mv output.root \"${hltLabel}\".root\r\n\r\nhltLabel=hltData_L1Full\r\n${execmd} \\\r\n  --customise HLTrigger/Configuration/CustomConfigs.customiseL1THLTforHIonRepackedRAWPrime \\\r\n  --input root://eoscms.cern.ch//eos/cms/store/user/cmsbuild/store/hidata/HIRun2023A/HIPhysicsRawPrime0/RAW/v1/000/375/491/00000/de963321-c0a0-49fb-b771-1a312a69db03.root \\\r\n  --globaltag 140X_dataRun3_HLT_v3 \\\r\n  --data \\\r\n  --eras Run3_2024 --l1-emulator Full \\\r\n  > \"${hltLabel}\".py && cmsRun \"${hltLabel}\".py &> \"${hltLabel}\".log && mv output.root \"${hltLabel}\".root\r\n\r\nhltLabel=hltMC_ref\r\n${execmd} \\\r\n  --input /store/relval/CMSSW_14_0_0/RelValPyquen_DiJet_pt80to120_5362GeV_2023/GEN-SIM-DIGI-RAW-HLTDEBUG/PU_140X_mcRun3_2023_realistic_HI_v3_STD_HIN_PU-v1/2580000/8dda8ff3-5f50-4698-8834-24f2a31a8bf3.root \\\r\n  --globaltag 140X_mcRun3_2023_realistic_HI_v3 \\\r\n  --mc \\\r\n  > \"${hltLabel}\".py && cmsRun \"${hltLabel}\".py &> \"${hltLabel}\".log && mv output.root \"${hltLabel}\".root\r\n\r\nhltLabel=hltMC_L1uGT\r\n${execmd} \\\r\n  --input /store/relval/CMSSW_14_0_0/RelValPyquen_DiJet_pt80to120_5362GeV_2023/GEN-SIM-DIGI-RAW-HLTDEBUG/PU_140X_mcRun3_2023_realistic_HI_v3_STD_HIN_PU-v1/2580000/8dda8ff3-5f50-4698-8834-24f2a31a8bf3.root \\\r\n  --globaltag 140X_mcRun3_2023_realistic_HI_v3 \\\r\n  --mc \\\r\n  --eras Run3_2024 --l1-emulator uGT \\\r\n  > \"${hltLabel}\".py && cmsRun \"${hltLabel}\".py &> \"${hltLabel}\".log && mv output.root \"${hltLabel}\".root\r\n\r\nhltLabel=hltMC_L1FullMC\r\n${execmd} \\\r\n  --input /store/relval/CMSSW_14_0_0/RelValPyquen_DiJet_pt80to120_5362GeV_2023/GEN-SIM-DIGI-RAW-HLTDEBUG/PU_140X_mcRun3_2023_realistic_HI_v3_STD_HIN_PU-v1/2580000/8dda8ff3-5f50-4698-8834-24f2a31a8bf3.root \\\r\n  --globaltag 140X_mcRun3_2023_realistic_HI_v3 \\\r\n  --mc \\\r\n  --eras Run3_2024 --l1-emulator FullMC \\\r\n  > \"${hltLabel}\".py && cmsRun \"${hltLabel}\".py &> \"${hltLabel}\".log && mv output.root \"${hltLabel}\".root\r\n```\r\n\r\n#### If this PR is a backport, please specify the original PR and why you need to backport that PR. If this PR will be backported, please specify to which release cycle the backport is meant for:\r\n\r\nN/A\r\n", "branch": "master", "changed_files": 14, "comments": 3, "commits": 1, "created_at": "1723789600", "deletions": 19, "labels": ["l1-pending", "operations-pending", "pending-signatures", "tests-pending", "orp-pending", "code-checks-approved"], "milestone": "CMSSW_14_1_X", "number": 45712, "release-notes": [], "review_comments": 4, "state": "open", "title": "Add ZDC `EtSum`s to Stage-2 L1T emulation", "updated_at": "1724073681", "user": "missirol"}