{"additions": 127, "auther_ref": "mm_improve_HLTObjectMonitor", "auther_sha": "b0f28a9c654e59aa24f76a786fd47b13ead2aacf", "author": "mmusich", "body": "#### PR description:\r\n\r\nSome improvements to `HLTObjectMonitor`:\r\n   * add a MonitorElement for the L3 muon candidates dz w.r.t BeamSpot\r\n   * add a `fillDescriptions` method\r\n   * modernize the code\r\n   \r\n#### PR validation:\r\n\r\nGenerated some streamer files with the following recipe:\r\n\r\n```bash\r\n#!/bin/bash -ex\r\n\r\n# cmsrel CMSSW_15_1_X_2025-02-19-2300 \r\n# cd CMSSW_15_1_X_2025-02-19-2300/src\r\n# git cms-addpkg HLTrigger/Configuration\r\n# git remote add mmusich git@github.com:mmusich/cmssw.git\r\n# git fetch mmusich\r\n# git cherry-pick c751843605c5e7bc2e9095276088bb9b721dcbe8\r\n# cmsenv\r\n# scram b\r\n\r\nRUNNUMBER=381594\r\nLUMISECTION=1000\r\n\r\nINPUTFILE=root://eoscms.cern.ch//store/express/Run2024E/ExpressPhysics/FEVT/Express-v1/000/381/594/00000/1e2c895f-a250-45be-a7ff-ee95e636a6e9.root\r\nrm -rf run${RUNNUMBER}*\r\n\r\n# run on 1000 events of LS 1000, with 1000 events per input file\r\nconvertToRaw -f 1000 -l 1000 -r ${RUNNUMBER}:${LUMISECTION} -o . -- \"${INPUTFILE}\"\r\n\r\ntmpfile=$(mktemp)\r\nhltConfigFromDB --runNumber \"${RUNNUMBER}\" > \"${tmpfile}\"\r\ncat <<@EOF >> \"${tmpfile}\"\r\nprocess.load(\"run${RUNNUMBER}_cff\")\r\nprocess.hltOnlineBeamSpotESProducer.timeThreshold = int(1e6)\r\n\r\n# to run without any HLT prescales\r\ndel process.PrescaleService\r\ndel process.MessageLogger\r\nprocess.load('FWCore.MessageLogger.MessageLogger_cfi')\r\n\r\nprocess.options.numberOfThreads = 32\r\nprocess.options.numberOfStreams = 32\r\n\r\nprocess.options.wantSummary = True\r\n# # to run using the same HLT prescales as used online in LS 1000\r\n# process.PrescaleService.forceDefault = True\r\n\r\n# apply extra customisations specific to the CMSSW release in use\r\nfrom HLTrigger.Configuration.customizeHLTforCMSSW import customizeHLTforCMSSW\r\nprocess = customizeHLTforCMSSW(process)\r\n\r\n@EOF\r\nedmConfigDump \"${tmpfile}\" > hlt.py\r\n\r\ncmsRun hlt.py &> hlt.log\r\n\r\n# remove input files to save space\r\nrm -f run381594/run381594_ls0*_index*.*\r\n\r\n#######################################################\r\n# After this, prepare the streamer files with the following recipe:\r\n#######################################################\r\n\r\nmv run381594 source\r\nmkdir -p run381594\r\ncp source/run381594_ls1000_streamDQM_*.jsn run381594\r\nfor file in source/run381594_ls0000_streamDQM_*.ini; do\r\n    # Extract the variable part in place of '*'\r\n    variable_part=$(basename \"$file\" | sed 's/^run381594_ls0000_streamDQM_//; s/\\.ini$//')\r\n\r\n    # Concatenate files with the same variable part\r\n    cat \"source/run381594_ls0000_streamDQM_${variable_part}.ini\" \\\r\n        \"source/run381594_ls1000_streamDQM_${variable_part}.dat\" \\\r\n        > \"run381594/run381594_ls1000_streamDQM_${variable_part}.dat\"\r\ndone\r\n```\r\n\r\nand then re-run the client (successfully) via:\r\n\r\n```\r\nmkdir upload\r\ncmsRun DQM/Integration/python/clients/hlt_dqm_sourceclient-live_cfg.py runInputDir=. outputBaseDir=./output runNumber=381594 runkey=pp_run scanOnce=True\r\n```\r\n\r\n#### If this PR is a backport please specify the original PR and why you need to backport that PR. If this PR will be backported please specify to which release cycle the backport is meant for:\r\n\r\nN/A", "branch": "master", "changed_files": 2, "comments": 5, "commits": 2, "created_at": "1740385495", "deletions": 40, "labels": ["dqm-pending", "hlt-pending", "pending-signatures", "tests-approved", "orp-pending", "code-checks-approved"], "milestone": "CMSSW_15_1_X", "number": 47429, "release-notes": [], "review_comments": 0, "state": "open", "title": "Improvements to `HLTObjectMonitor`", "updated_at": "1740393292", "user": "mmusich"}