{"additions": 11, "auther_ref": "FixElePhMass", "auther_sha": "8c391820f691b9d4c48e46e137e101d6173a4199", "author": "rgoldouz", "body": "Hello,\r\nThe electron and photon mass are not saved properly and nanoAOD users reported that many times. It is not related to nanoAOD. The problem is available in miniAOD too.\r\nYou can check the printout here\r\nroot [6] Events->Scan(\"Photon_mass:Electron_mass:Muon_mass:Tau_mass\")\r\n***********************************************************************\r\n*    Row   * Instance * Photon_ma * Electron_ * Muon_mass *  Tau_mass *\r\n***********************************************************************\r\n*        0 *        0 * 1.348e-06 *           *           * 0.9638671 *\r\n*        1 *        0 *         0 *           * 0.1057128 * 0.1395263 *\r\n*        2 *        0 * 4.768e-07 *           *           * 0.3725585 *\r\n*        2 *        1 * -2.23e-07 *           *           *           *\r\n*        3 *        0 * 1.192e-07 *           * 0.1057128 * 0.1395263 *\r\n*        3 *        1 * 2.919e-07 *           *           *           *\r\n*        4 *        0 * -2.69e-06 *           *           *           *\r\n*        4 *        1 *         0 *           *           *           *\r\n*        5 *        0 * 6.742e-07 * 0.0024929 *           *           *\r\n*        6 *        0 *           * -0.004924 * 0.1057128 * 0.1395263 *\r\n*        6 *        1 *           * 0.0061264 * 0.1057128 * 0.1395263 *\r\n*        7 *        0 * 6.421e-07 * 0.0085830 *           * 0.1395263 *\r\n*        7 *        1 * 1.907e-06 * -0.018432 *           *           *\r\n*        7 *        2 * 1.348e-06 *           *           *           *\r\n*        8 *        0 *         0 * -0.020462 *           * 1.0068359 *\r\n\r\nI checked and found that the problem is not from the EGamma code but from TLorentzVector root class. I found that the TLorentz vector is set via pxpypzE for all object candidates. It seems fine but when I tested locally for a particle with pxpypzE=(1,1,1,sqrt(3)) I did not get the mass==0. You can easily reproduce it\r\nroot -l\r\nroot [1] typedef ROOT::Math::LorentzVector<ROOT::Math::PxPyPzE4D > XYZTLorentzVectorD\r\nroot [2] XYZTLorentzVectorD newP4(1,1,1,sqrt(3));\r\nroot [3] newP4.M()\r\n(double) -2.1073424e-08\r\n\r\nIt is because of the precision problem in TLorentz vector and it is recommended to use PxPyPzM to have correct masses for low mass objects.\r\nhttps://root.cern.ch/doc/master/classROOT_1_1Math_1_1PxPyPzM4D.html\r\n\r\nSo I set the electron and photon masses by hand to 0 GeV , respectively.\r\n\r\nThanks,\r\nReza\r\n", "branch": "master", "changed_files": 3, "closed_at": "1646696303", "comments": 28, "commits": 3, "created_at": "1644832806", "deletions": 1, "labels": ["reconstruction-approved", "fully-signed", "tests-approved", "orp-approved", "code-checks-approved", "egamma"], "merge_commit_sha": "27a732f8df5e7db5765323bb52521c5e9c2b9d34", "merged_at": "1646696302", "merged_by": "cmsbuild", "milestone": "CMSSW_12_3_X", "number": 36954, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Electron and photon masses are set to zero", "updated_at": "1687327757", "user": "rgoldouz"}