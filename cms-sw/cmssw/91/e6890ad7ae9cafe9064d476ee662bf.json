{"additions": 5596, "auther_ref": "HLTdevelopment123X_for124X", "auther_sha": "d2c8e22728eaa6d9a0a29d092cddb2b1206c0e62", "author": "cms-tsg-storm", "body": "#### PR description:\r\n\r\nDevelopment of HLT menus for `CMSSW_12_3_X`.\r\n\r\nThis is the PR for the `master` branch, which will then be backported to `12_3_X` (which is currently the release used for HLT-menu development for Run 3).\r\n\r\n~~_The backport to `12_3_X` will be opened once #37755 is merged._~~ (done in #37793.)\r\n\r\nIncludes the integration of the following JIRA tickets.\r\n\r\n  - [CMSHLT-2288](https://its.cern.ch/jira/browse/CMSHLT-2288): [TSG] Introduction of Patatrack GPU modules in the HLT combined table.\r\n\r\nThis update introduces in the offline HLT menus the modules for GPU offloading developed so far as part of the Patatrack project (Pixel local reco, Pixel tracking/vertexing, ECAL and HCAL local recos). Effectively, it incorporates the customisation [`customizeHLTforPatatrackTriplets`](https://github.com/cms-sw/cmssw/blob/CMSSW_12_4_0_pre3/HLTrigger/Configuration/python/customizeHLTforPatatrack.py#L844) into the HLT menus maintained by TSG. This also coincides with the introduction of \"Tasks\" in the offline HLT menus. Following the discussion in #36938, it is expected that in the near future `cms.Task` will be replaced by `cms.ConditionalTask` in HLT configs (likely in `12_4_X`).\r\n\r\nThis PR also includes small changes to the TSG tests to ensure that those tests continue to work even when they are executed on a machine with a GPU.\r\n\r\n  - A customisation to HLT+RECO tests is added to remove GPU EventSetup modules from Tasks that are not included in the Schedule; this is needed to make said ES modules available to HLT producers when the test runs on a GPU machine. More details can be found [here (CMSHLT-2288)](https://its.cern.ch/jira/browse/CMSHLT-2288?focusedCommentId=4326483&page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-4326483).\r\n\r\n  - The HLT-integration tests are forced, for now, to run on CPU even if the machine has a GPU. This avoids tests failing due to the current limits in reproducibility of HLT outputs when using GPUs.\r\n\r\nBoth changes are workarounds in a way, and they could/should be improved in the future.\r\n\r\nA small fix in `customizeHLTforPatatrack.py` is also included.\r\n\r\n#### PR validation:\r\n\r\nTSG tests.\r\n\r\n#### If this PR is a backport, please specify the original PR and why you need to backport that PR:\r\n\r\nN/A", "branch": "master", "changed_files": 14, "closed_at": "1651679056", "comments": 24, "commits": 1, "created_at": "1651586055", "deletions": 1438, "labels": ["hlt-approved", "fully-signed", "tests-approved", "orp-approved", "code-checks-approved"], "merge_commit_sha": "3030f392865ece8d884bdb96f152256dba683d50", "merged_at": "1651679056", "merged_by": "cmsbuild", "milestone": "CMSSW_12_4_X", "number": 37783, "release-notes": [], "review_comments": 0, "state": "closed", "title": "HLT menu development for `12_3_X` (Patatrack GPU modules) [`12_4_X`]", "updated_at": "1651679056", "user": "missirol"}