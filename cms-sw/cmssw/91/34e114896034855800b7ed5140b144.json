{"additions": 32, "auther_ref": "devel_addOnTestLogFormat", "auther_sha": "463cc22f8ba10f80a9a4f9167803da646bbeb72c", "author": "missirol", "body": "#### PR description:\r\n\r\nThis PR is alternative to #36423.\r\n\r\nThe issue is that different \"addon\" tests can produce log files with the same basename. When one of these tests fails, the `cmsbuild` bot has trouble identifying which test failed (see https://github.com/cms-sw/cmssw/pull/40011#issuecomment-1306810543 for an example).\r\n\r\nThe (potential) fix in #36423 is minimal but fragile. This PR is more invasive, and changes the names of the `addOnTests` logs in order to make them unique by construction.\r\n\r\nWith this PR, a \"addon\" test `XYZ` with N steps creates log files named `XYZ/step{1,..,N}.log`. In addition, a text file named `cmdLog` with the list of steps is added to every addon sub-directory `XYZ`. Lines in the main log file of the `addOnTests` have the following format\r\n```\r\n[hlt_data_PRef:1] cmsDriver.py RelVal -s L1REPACK:Full --data --scenario=pp -n 10 --conditions auto:run3_hlt_PRef --relval 9000,50 --datatier \"RAW\" --customise=HLTrigger/Configuration/CustomConfigs.L1T --era Run3 --eventcontent RAW --fileout file:RelVal_Raw_PRef_DATA.root --filein root://eoscms.cern.ch//eos/cms/store/group/dpg_trigger/comm_trigger/TriggerStudiesGroup/STORM/RAW/Run2022B_HLTPhysics0_run355558/cd851cf4-0fca-4d76-b80e-1d33e1371929.root : PASSED - elapsed time: 26 sec (ended on Tue Nov  8 23:34:13 2022) - exit: 0\r\n\r\n[hlt_data_PRef:2] cmsRun /work/missiroli_m/test/tsg/storm/devel_addOnTestsLogFileName/CMSSW_12_6_0_pre4/src/HLTrigger/Configuration/test/OnLine_HLT_PRef.py realData=True globalTag=@ inputFiles=@ : PASSED - elapsed time: 56 sec (ended on Tue Nov  8 23:35:10 2022) - exit: 0\r\n\r\n[hlt_data_PRef:3] cmsDriver.py RelVal -s HLT:PRef,RAW2DIGI,L1Reco,RECO --data --scenario=pp -n 10 --conditions auto:run3_data_PRef --relval 9000,50 --datatier \"RAW-HLT-RECO\" --eventcontent FEVTDEBUGHLT --customise=HLTrigger/Configuration/CustomConfigs.L1THLT --customise=HLTrigger/Configuration/CustomConfigs.HLTRECO --customise=HLTrigger/Configuration/CustomConfigs.customiseGlobalTagForOnlineBeamSpot --era Run3 --processName=HLTRECO --filein file:RelVal_Raw_PRef_DATA.root --fileout file:RelVal_Raw_PRef_DATA_HLT_RECO.root : PASSED - elapsed time: 84 sec (ended on Tue Nov  8 23:36:35 2022) - exit: 0\r\n```\r\nThe first bit, i.e. `[test:N]`, is added for clarity, and to allow the bot to find the correct log file without ambiguities.\r\n\r\nThe way elapsed time is reported for every given addon test is also updated.\r\n\r\nThis PR requires https://github.com/cms-sw/cms-bot/pull/1879.\r\n\r\n#### PR validation:\r\n\r\n`addOnTests.py` passed.\r\n\r\n#### If this PR is a backport, please specify the original PR and why you need to backport that PR. If this PR will be backported, please specify to which release cycle the backport is meant for:\r\n\r\nN/A\r\n", "branch": "master", "changed_files": 1, "comments": 19, "commits": 1, "created_at": "1667945833", "deletions": 43, "labels": ["core-pending", "pending-signatures", "tests-approved", "orp-pending", "requires-external", "code-checks-approved"], "milestone": "CMSSW_12_6_X", "number": 40018, "release-notes": [], "review_comments": 0, "state": "open", "title": "improve logging of `addOnTests`", "updated_at": "1668764516", "user": "missirol"}