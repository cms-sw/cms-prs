{"additions": 106, "auther_ref": "dqm-force-per-lumi", "auther_sha": "765136dd46447d206379476227fd59a758010a8b", "author": "schneiml", "body": "#### PR description:\r\n\r\nThis PR enables per-lumisection saving of *all* DQM output for the UL rereco. This wish came up for machine learning studies targeting per-LS data certification or online monitoring.\r\n\r\nIn prompt reco, we have per-LS DQM output available due to how Tier0 processes only ~1 LS per job, and the per-job DQMIO output files are available. It would be very nice to have the same granularity of data preserved for the UL rereco, which in addition provides the full run2 dataset processed using the same software.\r\n\r\nThis is safe to do for most of DQM, since HARVESTING will re-generate per run/job statistics from the per-lumisection snapshots. It is not save for legacy modules that modify MEs at non-standard times or that do not support merging correctly; none of these should exist in RECO/DQM step since the threaded migration, but since there are still a few, I apply the change only to the non-legacy MEs.\r\n\r\n#### PR validation:\r\n\r\nWaiting for a detailed DQM output comparison, to see which types of MEs cause trouble when forced per-lumi. Will need some special attention during relval since the DQMIO output file size will increase.\r\n\r\nKnown problems:\r\n- The `METRate` plots from `METAnalyzer` turned empty, but the data in there was meaningless anyways, due to relying on unsupported behaviour.\r\n- Plugins explicitly declaring `edm::LuminosityBlockCache` do not produce any output, since declaring this cache inhibits the transitions that `DQMStore` relies on.", "branch": "master", "changed_files": 16, "comments": 148, "commits": 12, "created_at": "1553186370", "deletions": 102, "labels": ["code-checks-approved", "comparison-pending", "dqm-pending", "operations-pending", "orp-pending", "pending-signatures", "tests-rejected"], "milestone": "CMSSW_10_6_X", "number": 26232, "release-notes": [], "review_comments": 0, "state": "open", "title": "Save DQM output per lumisection for UL rereco", "updated_at": "1554896321", "user": "schneiml"}