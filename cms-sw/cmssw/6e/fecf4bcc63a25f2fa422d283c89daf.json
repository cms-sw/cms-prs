{"additions": 480, "auther_ref": "from-CMSSW_11_3_X_2021-04-13-1100-use-csc-constants", "auther_sha": "03c686eb46be9e35bb721865456a9eca0b385bad", "author": "dildick", "body": "#### PR description:\r\n\r\nThe CSC trigger, packer, unpacker and track-finders are loaded with magic numbers. This PR redefines (some of) them in `CSCConstants.h`. In particular, the following substitutions were made (where applicable):\r\n* 1 -> `CSCDetId::minLayerId()` or `CSCConstants::NUM_CFEBS_ME1A_GANGED`\r\n* 3 -> `CSCConstants::NUM_CFEBS_ME1A_UNGANGED`\r\n* 4 -> `CSCConstants::NUM_CFEBS_ME1B`\r\n* 5 -> `CSCConstants::MAX_CFEBS` or `CSCConstants::NUM_DDUS`\r\n* 6 -> `CSCDetId::maxLayerId()`\r\n* 7 -> `CSCConstants::MAX_CFEBS_RUN2`\r\n* 8 -> `CSCConstants::NUM_DISTRIPS_PER_CFEB`\r\n* 16 -> `CSCConstants::NUM_STRIPS_PER_CFEB` or `CSCConstants::NUM_STRIPS_ME1A_GANGED`\r\n* 32 -> `CSCConstants::NUM_HALF_STRIPS_PER_CFEB`\r\n* 48 -> `CSCConstants::NUM_STRIPS_ME1A_UNGANGED`\r\n* 64 -> `CSCConstants::NUM_STRIPS_ME1B`\r\n* 96 -> `CSCConstants::NUM_HALF_STRIPS_ME1A_UNGANGED`\r\n* 128 -> `CSCConstants::NUM_HALF_STRIPS_ME1B`\r\n* `MAX_NUM_WIRES` - > `MAX_NUM_WIREGROUPS` because the unit of \"theta\" in the muon endcap trigger is wiregroup, not wire. \r\n\r\nThe following statements in [CSCComparatorData.cc](https://github.com/cms-sw/cmssw/blob/master/EventFilter/CSCRawToDigi/src/CSCComparatorData.cc) were encapsulated in class functions: \r\n* `(strip - 1) * 2 + digi.getComparator()` -> `CSCComparatorDigi::getHalfStrip()`\r\n* `((strip_ - 1) % 16) / 2;` -> `CSCComparatorDigi::getDiStrip()`\r\n* `(strip_ - 1) / 16;` -> `CSCComparatorDigi::getCFEB()` or `CSCStripDigi::getCFEB()`\r\n\r\nA few constants related to the (maximum) number of half-strips were clarified, introduced or reconfigured in the CSCConstants file.\r\n* `MAX_NUM_STRIPS_RUN1`\r\n* `MAX_NUM_STRIPS_RUN2`\r\n* `MAX_NUM_HALF_STRIPS_RUN1`\r\n* `MAX_NUM_HALF_STRIPS_RUN2`\r\n* `MAX_NUM_HALF_STRIPS_RUN1_TRIGGER`\r\n* `MAX_NUM_HALF_STRIPS_RUN2_TRIGGER`\r\n \r\nSeveral assert statements were tightened in the packer as well.\r\n\r\nThe file `CSCConstants.h` was moved from `DataFormats/L1TMuon` to `DataFormats/CSCDigi` to minimize dependencies with the L1TMuon system.\r\n\r\nThis PR is done in preparation of re-enabling the CFEB packing based on CLCT pre-trigger digis for Run-3 Monte Carlo.\r\n\r\n#### PR validation:\r\n\r\nTested with WF 11634.0. There should be 0 changes with respect to the baseline anywhere.\r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\n\r\nN/A\r\n\r\nBefore submitting your pull requests, make sure you followed this checklist:\r\n- verify that the PR is really intended for the chosen branch\r\n- verify that changes follow [CMS Naming, Coding, And Style Rules](http://cms-sw.github.io/cms_coding_rules.html)\r\n- verify that the PR passes the basic test procedure suggested in the [CMSSW PR instructions](https://cms-sw.github.io/PRWorkflow.html)\r\n\r\n@ptcox @barvic ", "branch": "master", "changed_files": 53, "closed_at": "1618925492", "comments": 80, "commits": 14, "created_at": "1618366168", "deletions": 395, "labels": ["code-checks-approved", "dqm-approved", "fully-signed", "l1-approved", "orp-approved", "reconstruction-approved", "simulation-approved", "tests-approved"], "merge_commit_sha": "78c951b7d356ba5e3a8e65b4270082ffe216be66", "merged_at": "1618925492", "merged_by": "cmsbuild", "milestone": "CMSSW_12_0_X", "number": 33429, "release-notes": [], "review_comments": 24, "state": "closed", "title": "Use CSCConstants in CSC trigger, packer, unpacker and track-finders", "updated_at": "1618925492", "user": "dildick"}