{"additions": 281, "auther_ref": "dev-106X-externalLHEProducer", "auther_sha": "454f974fa24b05541156ba529091bfdd7c2ba297", "author": "colizz", "body": "#### PR description:\r\n\r\n<!-- Please replace this text with a description of the feature proposed or problem addressed, specifying:\r\n  - what changes are expected in the output if any, \r\n  - what other PRs or externals it depends upon if any,\r\n  - link to any additional material useful to provide a documentation for this PR (slides, JIRA tickets, related pull requestes, hypernews, TWiki or Indico pages)  -->\r\n\r\n**This PR is a backport of #28899 by @Dr15Jones.**\r\n\r\nIt adds the ability to use multiple TBB tasks to execute the script concurrently during the begin run phase.\r\n\r\n#### PR validation:\r\n\r\nThis PR passes the additional unit tests brought by #28899. \r\nIt is also validated on [`SMP-RunIISummer19UL17wmLHEGEN-00001`](https://cms-pdmv.cern.ch/mcm/requests?prepid=SMP-RunIISummer19UL17wmLHEGEN-00001&page=0&shown=127) for LHE/GEN-level physics results.\r\n\r\n(A quick test for this PR)\r\n```shell\r\ncmsrel CMSSW_10_6_X_2020-06-30-2300\r\ncd CMSSW_10_6_X_2020-06-30-2300/src/\r\ncmsenv\r\ngit cms-merge-topic colizz:dev-106X-externalLHEProducer\r\ncurl -s --insecure https://cms-pdmv.cern.ch/mcm/public/restapi/requests/get_fragment/B2G-RunIISummer19UL17wmLHEGEN-00001 --retry 2 --create-dirs -o Configuration/GenProduction/python/B2G-RunIISummer19UL17wmLHEGEN-00001-fragment.py \r\nscram b -j 8\r\ncd ../..\r\ncmsDriver.py Configuration/GenProduction/python/B2G-RunIISummer19UL17wmLHEGEN-00001-fragment.py --fileout file:B2G-RunIISummer19UL17wmLHEGEN-00001.root --mc --eventcontent RAWSIM,LHE --datatier GEN,LHE --conditions 106X_mc2017_realistic_v6 --beamspot Realistic25ns13TeVEarly2017Collision --step LHE,GEN --geometry DB:Extended --era Run2_2017 --python_filename B2G-RunIISummer19UL17wmLHEGEN-00001_1_cfg.py --no_exec --customise Configuration/DataProcessing/Utils.addMonitoring --customise_commands='process.externalLHEProducer.generateConcurrently=cms.untracked.bool(True)' -n 200 --nThreads 2\r\n\r\ncmsRun -e -j B2G-RunIISummer19UL17wmLHEGEN-00001_rt.xml B2G-RunIISummer19UL17wmLHEGEN-00001_1_cfg.py\r\n```\r\n", "branch": "CMSSW_10_6_X", "changed_files": 6, "closed_at": "1593796841", "comments": 11, "commits": 2, "created_at": "1593591588", "deletions": 116, "labels": ["comparison-available", "fully-signed", "generators-approved", "orp-approved", "tests-approved"], "merge_commit_sha": "73cc181b905d2e96dfae16d2387a393c2a644355", "merged_at": "1593796841", "merged_by": "cmsbuild", "milestone": "CMSSW_10_6_X", "number": 30481, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Concurrent ExternalLHEProducer (backport #28899)", "updated_at": "1593796841", "user": "colizz"}