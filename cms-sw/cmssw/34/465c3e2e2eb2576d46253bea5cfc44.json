{"additions": 60, "auther_ref": "activate_SiStripAPVsimulation_UL2016_106X", "auther_sha": "69acd15dd2a12545a8941dfb807a0368635dc7ed", "author": "CMSTrackerDPG", "body": "Backport of #28355 and #28454\r\n\r\n#### PR description:\r\nThis is a follow-up to https://github.com/cms-sw/cmssw/pull/28160. \r\nIn this PR the SiStrip APV saturation simulation is activated (**assuming the 2 MC samples solution is used**):\r\n  *  by switching on the `includeAPVSimulation` parameter using the `tracker_apv_vfp30_2016` era modifier, hooked to the `Era_Run2_2016_HIPM` era on  100% of the events (ratio of the 2016 luminosity affected by the APV saturation vs the total is 53%);\r\n   * providing the needed conditions of the APV baselines in the Global Tag (adding to the `run2_mc` & `run2_mc_cosmics` autoCond keys the appropriate tag: `SiStripApvSimulationParameters_2016preVFP_v1`). This corresponds to the APV baselines stored in https://patch-diff.githubusercontent.com/raw/cms-data/SimTracker-SiStripDigitizer/pull/2.patch.\r\n   * modifying the event content to introduce a boolean flag (treated on equal footing for standard mixing and premixing) `_simAPVsaturation_SimulatedAPVDynamicGain_` which propagates the notion if the Strip APV simulation has been run to the persisted event in all data-tiers, down to `MINIAOD`.\r\n      * this is done introducing an era modifier `strips_vfp30_2016`which is used in `Era_Run2_2016`  and excluded in `Era_Run2_2017`\r\n   * the parameter `includeAPVSimulation` is turned off in the premix stage-1 and in the signal digitization of premix step-2. \r\n\r\n#### PR validation:\r\nExtensive technical validation has been carried out by the DPG (see presentation e.g. [here](https://indico.cern.ch/event/841672/contributions/3541970/attachments/1898878/3133702/Emyr_28082019.pdf)) and through production of dedicated RelVals (see [PDMVRELVALS-59]( https://its.cern.ch/jira/projects/PDMVRELVALS/issues/PDMVRELVALS-59)).\r\nDedicated presentations have been given at:\r\n   * 7.11.2019: PPD general meeting [Tracker/tracking for UL16](https://indico.cern.ch/event/856064/contributions/3632500/)\r\n   * 15.11.2019: RECO/AT meeting [Tracker APV simulation in 2016](https://indico.cern.ch/event/863098/contributions/3637138/)\r\n   * 28.11.2019: PPD general meeting [UL-16 tracking: APV/HIP data/MC comparisons](https://indico.cern.ch/event/862282/contributions/3648302/)\r\n\r\nIn addition, this PR has been technically tested with:\r\n   * `runTheMatrix.py -l limited`\r\n   * `runTheMatrix.py -l 250400.0`\r\n   * `runTheMatrix.py --what upgrade -l 20634.99 --ibeos`\r\n\r\n#### if this PR is a backport please specify the original PR:\r\nThis is a combined backport of https://github.com/cms-sw/cmssw/pull/28355 and https://github.com/cms-sw/cmssw/pull/28454\r\n\r\n@pieterdavid @robervalwalsh @EmyrClement @mtosi @JanFSchulte @tsusa\r\n", "branch": "CMSSW_10_6_X", "changed_files": 10, "closed_at": "1575962934", "comments": 42, "commits": 19, "created_at": "1575041577", "deletions": 7, "labels": ["alca-approved", "analysis-approved", "comparison-available", "fully-signed", "operations-approved", "orp-approved", "reconstruction-approved", "simulation-approved", "tests-approved"], "merge_commit_sha": "6bba86c8183da4e756d76834f82e42bea75fe99f", "merged_at": "1575962934", "merged_by": "cmsbuild", "milestone": "CMSSW_10_6_X", "number": 28512, "release-notes": [], "review_comments": 4, "state": "closed", "title": "[10.6.X] Activate SiStrip Dynamical APV gain simulation for 2016 UL MC", "updated_at": "1575962934", "user": "mmusich"}