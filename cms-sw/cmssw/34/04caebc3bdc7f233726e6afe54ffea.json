{"additions": 19, "auther_ref": "gartung-RecoHGCal-TICL-HGCDoublet-areAlinged-opt", "auther_sha": "cc4483924d15af7843f759ee3231a37dab4222d9", "author": "gartung", "body": "By squaring cosTheta and multiplying by the squares of the magnitudes an equivalent comparison is made without the division and square root which are costly FP ops.\r\n\r\n```\r\nwithout PR\r\n\r\nRelarted modules:\r\n\r\nTimeReport   0.151110     0.151110     0.151110  ticlTrackstersEM\r\nTimeReport   0.244630     0.244630     0.244630  ticlTrackstersHAD\r\nTimeReport   5.448030     5.448030     5.448030  ticlTrackstersMIP\r\nTimeReport   0.489669     0.489669     0.489669  ticlTrackstersMerge\r\nTimeReport   5.136405     5.136405     5.136405  ticlTrackstersTrk\r\n\r\nUnrelated modules:\r\n\r\nTimeReport   2.788299     2.788299     2.788299  unsortedOfflinePrimaryVertices\r\nTimeReport   3.190056     3.190056     3.190056  unsortedOfflinePrimaryVertices4D\r\nTimeReport   2.398358     2.398358     2.398358  unsortedOfflinePrimaryVertices4DnoPID\r\n\r\n\r\nMemoryReport> Peak virtual size 16747.1 Mbytes\r\n Key events increasing vsize:\r\n[5] run: 1 lumi: 1 event: 6  vsize = 12483.1 deltaVsize = 680 rss = 7707.91 delta = 1096.84\r\n[6] run: 1 lumi: 1 event: 2  vsize = 13507.1 deltaVsize = 1024 rss = 7626.52 delta = -81.3906\r\n[11] run: 1 lumi: 1 event: 13  vsize = 15043.1 deltaVsize = 1536 rss = 7504.27 delta = -122.246\r\n[51] run: 1 lumi: 1 event: 54  vsize = 16107.1 deltaVsize = 320 rss = 7668.46 delta = 164.191\r\n[58] run: 1 lumi: 1 event: 59  vsize = 16427.1 deltaVsize = 320 rss = 8162.55 delta = 494.09\r\n[88] run: 1 lumi: 1 event: 90  vsize = 16747.1 deltaVsize = 0 rss = 7822.57 delta = 143.547\r\n[87] run: 1 lumi: 1 event: 91  vsize = 16747.1 deltaVsize = 0 rss = 7898.27 delta = 219.254\r\n[86] run: 1 lumi: 1 event: 87  vsize = 16747.1 deltaVsize = 320 rss = 7679.02 delta = -483.535\r\nTimeReport> Time report complete in 3095.72 seconds\r\n Time Summary:\r\n - Min event:   74.3302\r\n - Max event:   191.179\r\n - Avg event:   117.212\r\n - Total loop:  3024.91\r\n - Total init:  70.7418\r\n - Total job:   3095.72\r\n - EventSetup Lock:   0\r\n - EventSetup Get:   0\r\n Event Throughput: 0.0330588 ev/s\r\n CPU Summary:\r\n - Total loop:  11994.8\r\n - Total init:  44.139\r\n - Total extra: 0\r\n - Total job:   12039\r\n Processing Summary:\r\n - Number of Events:  100\r\n - Number of Global Begin Lumi Calls:  1\r\n - Number of Global Begin Run Calls: 1\r\n```\r\n\r\n```\r\nwith PR\r\n\r\nRelated modules\r\n\r\nTimeReport   0.137062     0.137062     0.137062  ticlTrackstersEM\r\nTimeReport   0.220417     0.220417     0.220417  ticlTrackstersHAD\r\nTimeReport   4.989291     4.989291     4.989291  ticlTrackstersMIP\r\nTimeReport   0.463667     0.463667     0.463667  ticlTrackstersMerge\r\nTimeReport   4.469128     4.469128     4.469128  ticlTrackstersTrk\r\n\r\nUnrelated modules\r\n\r\nTimeReport   2.601440     2.601440     2.601440  unsortedOfflinePrimaryVertices\r\nTimeReport   2.993901     2.993901     2.993901  unsortedOfflinePrimaryVertices4D\r\nTimeReport   2.244631     2.244631     2.244631  unsortedOfflinePrimaryVertices4DnoPID\r\n\r\n\r\nMemoryReport> Peak virtual size 17345.9 Mbytes\r\n Key events increasing vsize:\r\n[3] run: 1 lumi: 1 event: 7  vsize = 12805.9 deltaVsize = 288 rss = 6317.03 delta = -843.027\r\n[4] run: 1 lumi: 1 event: 1  vsize = 13229.9 deltaVsize = 424 rss = 6637.75 delta = 320.719\r\n[10] run: 1 lumi: 1 event: 10  vsize = 16045.9 deltaVsize = 2560 rss = 7548.33 delta = 910.582\r\n[61] run: 1 lumi: 1 event: 65  vsize = 17345.9 deltaVsize = 394 rss = 7922.04 delta = 373.711\r\n[27] run: 1 lumi: 1 event: 28  vsize = 16621.9 deltaVsize = 320 rss = 8049.02 delta = 500.691\r\n[63] run: 1 lumi: 1 event: 68  vsize = 17345.9 deltaVsize = 0 rss = 7725.5 delta = -196.539\r\n[62] run: 1 lumi: 1 event: 48  vsize = 17345.9 deltaVsize = 0 rss = 7909.17 delta = -12.8672\r\n[61] run: 1 lumi: 1 event: 65  vsize = 17345.9 deltaVsize = 394 rss = 7922.04 delta = -205.59\r\nTimeReport> Time report complete in 2889.58 seconds\r\n Time Summary:\r\n - Min event:   69.4932\r\n - Max event:   169.038\r\n - Avg event:   109.613\r\n - Total loop:  2820.21\r\n - Total init:  69.3035\r\n - Total job:   2889.58\r\n - EventSetup Lock:   0\r\n - EventSetup Get:   0\r\n Event Throughput: 0.0354584 ev/s\r\n CPU Summary:\r\n - Total loop:  11197.6\r\n - Total init:  36.5688\r\n - Total extra: 0\r\n - Total job:   11234.3\r\n Processing Summary:\r\n - Number of Events:  100\r\n - Number of Global Begin Lumi Calls:  1\r\n - Number of Global Begin Run Calls: 1\r\n\r\n```", "branch": "master", "changed_files": 1, "closed_at": "1595395755", "comments": 26, "commits": 2, "created_at": "1595008005", "deletions": 13, "labels": ["code-checks-approved", "comparison-available", "fully-signed", "orp-approved", "reconstruction-approved", "tests-approved", "upgrade-approved"], "merge_commit_sha": "e2bf1456c4f90fa18b43bb084899410a928789d0", "merged_at": "1595395755", "merged_by": "cmsbuild", "milestone": "CMSSW_11_2_X", "number": 30815, "release-notes": [], "review_comments": 0, "state": "closed", "title": "RecoHGCal/TICL: optimize calculation for comparison in HGCDoublet::areAligned", "updated_at": "1595395756", "user": "gartung"}