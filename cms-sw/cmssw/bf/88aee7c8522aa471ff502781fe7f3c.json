{"additions": 327, "auther_ref": "CMSSW_7_5_X_2015-08-18-2300/run2at25ns", "auther_sha": "d0b1b60dc7edc490ae1626d9c87613f4abcf8f89", "author": "slava77", "body": "Correcting the selection of 25ns vs 50ns for data processing, bringing the release in sync with 74X\n\nThis is a cherry pick of\n- https://github.com/cms-sw/cmssw/pull/10518    dc5da96 \n- to determine bunch spacing in data in PFClusterEMEnergyCorrector and  EcalUncalibRecHitWorkerMultiFit\n  - use run 253000 as a maximum with 50 ns if auto-selection is enabled\n  - fixup/add manual bunch spacing setting is the auto-selection is disabled\n  - in RecoTLR (still using local customs implementation for run2 data processing)\n    - add customise_DQM to the common customs (already in 75X/76X)\n    - add customiseL1RecoForStage1 for stage1 unpackers and l1extra to use calo stage1 \n    - add customiseDataRun2Common_25ns (since I couldn't figure out how to more transparently set a default to 25ns and then be able to customize that to 50ns); \n    - NB: the customiseDataRun2Common can still be used for Run2015B data processing as suggested in a few HN posts\n    - add customiseDataRun2Common_50nsRunsAfter253000 function (it's in the name!) to force 50ns settings for runs after 253000, if we need it\n    - remove outdated planBTracking\n  - add ppRun2at50ns scenario in T0 processing setup\n- https://github.com/cms-sw/cmssw/pull/10574    9510b4f\n  - move stage1 only to methods to be used in 2015C data (removed it from RecoTLR.customiseDataRun2Common, which is recommended for 2015A and 2015B reprocessing):\n    - customiseDataRun2Common_25ns\n    - customiseDataRun2Common_50nsRunsAfter253000\n  - added hasattr to modifiers in RecoTLR.customiseDataRun2Common so that it can be used directly at runTheMatrix level\n  - also, cleaned up import statements which begin to give warnings in 75X/76X\n- https://github.com/cms-sw/cmssw/pull/10509 7e0e8d9\n  - adds a new hook for customizing L1Reco to unpack stage 1 from RAW\n\nFrom 75X tests in CMSSW_7_5_X_2015-08-18-2300:\n- runtests pass (includes parsing of various scenarios in TestConfigDP)\n- compare ppRun2 results for run 251721 (DoubleMuon)   and 254231 (JetHT, 25ns fill with 3.8 T, 26 bunches colliding)\n  - run 251721 (no diffs expected, except for the L1 calo-related)\n    - ==> no changes in reco products\n    - L1 plots change (red becomes stage1 inputs; not a default in this run) \n      ![wfdoublemuon251721-l1central_et](https://cloud.githubusercontent.com/assets/4676718/9371027/d41fdcb2-469a-11e5-9e6b-9da2779aa044.png)\n  - run 254231 (diffs expected starting from ecal local reco: the baseline uses 50 ns setup in this case and the new version uses the correct 25 ns). The run is 25ns\n    -  less ecal rechits reconstructed with non-zero energy (as expected) [log(0) = 0 on this plot]\n      ![all_run2at25nsvsorig_jetht254231c_log10ecalrechitssorted_ecalrechit_ecalrechitsee_reco_obj_obj_energy](https://cloud.githubusercontent.com/assets/4676718/9369826/73ca1b6a-4691-11e5-9095-b73e3f8a3de3.png)\n    - hit timing shows reduced/no contribution from the next 25ns\n      ![wfjetht254231-ebtime](https://cloud.githubusercontent.com/assets/4676718/9370951/0f4a3c48-469a-11e5-9582-f083c885b004.png)\n      ![wfjetht254231-eetime](https://cloud.githubusercontent.com/assets/4676718/9370952/1227b06c-469a-11e5-8443-61aa4eef0af4.png)\n    - downstream, pf photons rate is smaller (charged hadrons are ~unchanged)\n      ![all_run2at25nsvsorig_jetht254231c_log10recopfcandidates_particleflow__reco_obj_pt40](https://cloud.githubusercontent.com/assets/4676718/9370667/8d8995ac-4697-11e5-99bf-08c8a063b3eb.png)\n    - L1 calo plots change (stage1 is now the default)\n      ![wfjetht254231-l1central_et](https://cloud.githubusercontent.com/assets/4676718/9370962/2da7d790-469a-11e5-8b96-9b6125de59d5.png)\n", "branch": "CMSSW_7_5_X", "changed_files": 8, "closed_at": "1440042742", "comments": 6, "commits": 11, "created_at": "1440017305", "deletions": 94, "labels": ["comparison-available", "l1-pending", "operations-pending", "orp-pending", "pending-signatures", "reconstruction-approved", "tests-approved"], "merge_commit_sha": "f62e7012ba3f7171c16cc2b69f7770595b64fdf3", "merged_at": "1440042742", "merged_by": "davidlange6", "milestone": "CMSSW_7_5_X", "number": 10865, "release-notes": [], "review_comments": 0, "state": "closed", "title": "forward port of dataProcessing changes for 25ns", "updated_at": "1440042742", "user": "slava77"}