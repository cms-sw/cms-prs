{"additions": 6, "auther_ref": "EF_L1NTuples_fixUGTProducer", "auther_sha": "5c6d5ee47a11987b697185037c4c70fbe5c3d75a", "author": "elfontan", "body": "#### PR description:\r\nIn the process of validating the [L1TNtuple recipe based on CMSSW_13_0_X](https://twiki.cern.ch/twiki/bin/view/CMSPublic/SWGuideL1TStage2Instructions#Environment_Setup_with_Integrati) and running on Run 3 MC samples, an error [1] related the inclusion of _l1uGTTestcrateTree_ in the L1NtupleRAW sequence equally for data and MC was occurring. In fact, the emulation for the uGT test crate does not exist and the _l1uGTTestcrateTree_ is not present in MC. \r\nThe changes to include the uGT test crate information in L1NTuples are part of [PR#39104](https://github.com/cms-sw/cmssw/commit/855bda3f1801bf870a40be01daceec10a6dac561) and were introduced in CMSSW_12_6_X_2023-01-09-1100 and CMSSW_13_0_0_pre3, so they did not create any issue with the previous L1TNtuple recipe based on CMSSW_12_6_0_pre1.\r\n\r\nThe _cmsDriver_ command used for the tests is reported as reference:\r\n`cmsDriver.py l1Ntuple -s RAW2DIGI --python_filename=mc_130X.py -n -1 --no_output --era=Run3 --mc --conditions=130X_mcRun3_2022_realistic_v2 --customise=L1Trigger/Configuration/customiseReEmul.L1TReEmulMCFromRAWSimHcalTP --customise=L1Trigger/L1TNtuples/customiseL1Ntuple.L1NtupleRAWEMU --customise=L1Trigger/Configuration/customiseSettings.L1TSettingsToCaloParams_2022_v0_6 --filein=/store/mc/Run3Winter22DR/SingleNeutrino_E-10-gun/GEN-SIM-DIGI-RAW/L1TPU0to99FEVT_SNB_122X_mcRun3_2021_realistic_v9-v2/70007/231dda73-3ef0-44ae-86b4-f6088c6a6018.root`\r\n\r\nThe current fix of the L1uGTTreeProducer allows to handle exceptions in case of a missing collection without breaking.\r\n[Tagging @eyigitba who helped with the issue.]\r\n\r\n[1]\r\n----- Begin Fatal Exception 16-Jan-2023 12:43:01 CET-----------------------\r\nAn exception of category 'StdException' occurred while\r\n   [0] Processing  Event run: 1 lumi: 40173 event: 4017203 stream: 0\r\n   [1] Running path 'l1ntupleraw'\r\n   [2] Calling method for module L1uGTTreeProducer/'l1uGTTestcrateTree'\r\nException Message:\r\nA std::exception was thrown.\r\nvector::_M_range_check: __n (which is 0) >= this->size() (which is 0)\r\n----- End Fatal Exception ------------------------------------------------- \r\n\r\n\r\n\r\n#### PR validation:\r\nBasic tests performed successfully starting from CMSSW_13_0_X_2023-01-23-1100.\r\n> cmsrel CMSSW_13_0_X_2023-01-23-1100\r\n> cd CMSSW_13_0_X_2023-01-23-1100/src\r\n> cmsenv\r\n> git cms-addpkg L1Trigger/L1TNtuples\r\n> scram b distclean \r\n> git cms-checkdeps -a -A\r\n> scram b -j 8\r\n> scram b runtests \r\n> scram build code-checks\r\n> scram build code-format", "branch": "master", "changed_files": 1, "comments": 0, "commits": 1, "created_at": "1674495466", "deletions": 1, "labels": ["l1-pending", "pending-signatures", "tests-pending", "orp-pending", "code-checks-pending"], "milestone": "CMSSW_13_0_X", "number": 40597, "release-notes": [], "review_comments": 0, "state": "open", "title": "Fix of the L1uGTTreeProducer to handle exceptions in case of a missing collection", "updated_at": "1674495487", "user": "elfontan"}