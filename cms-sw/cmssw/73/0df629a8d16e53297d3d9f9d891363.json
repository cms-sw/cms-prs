{"additions": 28, "auther_ref": "removeVertexCutForCosmicsResiduals", "auther_sha": "a3fdef3ac4a7305a82c8ad8e11303064027e7d2f", "author": "mmusich", "body": "#### PR description:\r\n\r\nI was casually looking at the Strip residuals in a CRAFT 2021 run but they don't make much sense e.g. the number of hits in TIB1 (https://tinyurl.com/yzwdcdc6) is less than BPIX1 (https://tinyurl.com/ygftohy4).\r\nAlso the Strip EndCap residuals plots are empty (https://tinyurl.com/ygxqol8b).\r\nI strongly suspect this is due to the Primary Vertex compatibility cut at: \r\n\r\nhttps://github.com/cms-sw/cmssw/blob/6d2f66057131baacc2fcbdd203588c41c885b42c/DQM/TrackerMonitorTrack/src/MonitorTrackResiduals.cc#L251\r\n\r\nthat makes no sense in cosmic data-taking and is severely limiting the phase-space from which the cosmic tracks are considered (https://tinyurl.com/yjzgap6c)\r\nThe correct behavior is implemented instead in the Pixel residuals code:\r\n\r\nhttps://github.com/cms-sw/cmssw/blob/c6d002524ebec48c82fa8f23dc99ad4fd4f0ac01/DQM/SiPixelPhase1Track/plugins/SiPixelPhase1TrackResiduals.cc#L80-L82\r\n\r\nin which the PV compatibility cut is put in OR with a switch that is set to false in cosmics (and indeed the pixel residuals in cosmic runs are filled).\r\nThis PR implements the same mechanism also for Strip residuals.\r\n#### No regression is expected for collision runs (pp or HI).\r\n\r\n#### PR validation:\r\n\r\nI've run workflow 138.2 (from 2021 cosmics commissioning, Run 343498) with 1000 events:\r\n```console\r\nrunTheMatrix.py -l 138.2 -j 8 --command='-n 1000'\r\n```\r\nin the vanilla release and with the modifications of this branch and obtained:\r\n\r\n| CMSSW_12_1_X_2021-10-24-0000 as-is | CMSSW_12_1_X_2021-10-24-0000 + this PR |\r\n| ------------- | ------------- |\r\n| ![image](https://user-images.githubusercontent.com/5082376/138601279-1cca69a5-8772-43f0-9352-a5f31895f2c1.png) | ![image](https://user-images.githubusercontent.com/5082376/138600813-35bd5c33-c4b6-436d-bf95-e4ab1e5b5bcc.png) |\r\n| ![image](https://user-images.githubusercontent.com/5082376/138601298-69d9368a-740d-48f5-b144-6a7951e8e34b.png) | ![image](https://user-images.githubusercontent.com/5082376/138600842-6264eef1-f5bd-4e23-b4c0-dd549509063c.png) |\r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\n\r\nNot a backport, but should probably be backported.", "branch": "master", "changed_files": 6, "closed_at": "1635097104", "comments": 10, "commits": 1, "created_at": "1635082958", "deletions": 13, "labels": ["dqm-approved", "fully-signed", "tests-approved", "bug-fix", "orp-approved", "urgent", "code-checks-approved"], "merge_commit_sha": "40c59a2fb3d77ca1c7facf4c946ba5afad91b722", "merged_at": "1635097104", "merged_by": "cmsbuild", "milestone": "CMSSW_12_1_X", "number": 35811, "release-notes": [], "review_comments": 0, "state": "closed", "title": "`MonitorTrackResiduals`: do not apply PV compatibility cut when running cosmics", "updated_at": "1635097104", "user": "mmusich"}