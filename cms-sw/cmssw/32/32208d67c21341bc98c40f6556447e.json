{"additions": 1, "auther_ref": "patch-6", "auther_sha": "fbe0e16e6f593aa858bf00272038774384960d53", "author": "makortel", "body": "#### PR description:\r\n\r\nErasing an element from `pfChs` using an iterator from `pfGammas` is undefined behavior. Based on the surrounding code, I _guess_ the intention was to erase the element from `pfGammas`.\r\n\r\nI came across this while investigating an UBSAN warning\r\n```\r\n/data/cmsbld/jenkins/workspace/build-any-ib/w/el8_amd64_gcc12/external/gcc/12.3.1-40d504be6370b5a30e3947a6e575ca28/include/c++/12.3.1/bits/stl_construct.h:151:22: runtime error: member call on null pointer of type 'struct Ptr'\r\n    #0 0x14e0b6a2131e in void std::_Destroy<edm::Ptr<reco::Candidate> >(edm::Ptr<reco::Candidate>*) /data/cmsbld/jenkins/workspace/build-any-ib/w/el8_amd64_gcc12/external/gcc/12.3.1-40d504be6370b5a30e3947a6e575ca28/include/c++/12.3.1/bits/stl_construct.h:151\r\n    #1 0x14e0b6a2131e in void std::_Destroy_aux<false>::__destroy<edm::Ptr<reco::Candidate>*>(edm::Ptr<reco::Candidate>*, edm::Ptr<reco::Candidate>*) /data/cmsbld/jenkins/workspace/build-any-ib/w/el8_amd64_gcc12/external/gcc/12.3.1-40d504be6370b5a30e3947a6e575ca28/include/c++/12.3.1/bits/stl_construct.h:163\r\n    #2 0x14e0b6a2131e in void std::_Destroy<edm::Ptr<reco::Candidate>*>(edm::Ptr<reco::Candidate>*, edm::Ptr<reco::Candidate>*) /data/cmsbld/jenkins/workspace/build-any-ib/w/el8_amd64_gcc12/external/gcc/12.3.1-40d504be6370b5a30e3947a6e575ca28/include/c++/12.3.1/bits/stl_construct.h:196\r\n    #3 0x14e0b6a2131e in void std::_Destroy<edm::Ptr<reco::Candidate>*, edm::Ptr<reco::Candidate> >(edm::Ptr<reco::Candidate>*, edm::Ptr<reco::Candidate>*, std::allocator<edm::Ptr<reco::Candidate> >&) /data/cmsbld/jenkins/workspace/build-any-ib/w/el8_amd64_gcc12/external/gcc/12.3.1-40d504be6370b5a30e3947a6e575ca28/include/c++/12.3.1/bits/alloc_traits.h:850\r\n    #4 0x14e0b6a2131e in std::vector<edm::Ptr<reco::Candidate>, std::allocator<edm::Ptr<reco::Candidate> > >::~vector() /data/cmsbld/jenkins/workspace/build-any-ib/w/el8_amd64_gcc12/external/gcc/12.3.1-40d504be6370b5a30e3947a6e575ca28/include/c++/12.3.1/bits/stl_vector.h:730\r\n    #5 0x14e0b6a2131e in PATTauHybridProducer::fillTauFromJet(reco::PFTau&, edm::RefToBase<reco::Jet> const&) src/PhysicsTools/PatAlgos/plugins/PATTauHybridProducer.cc:416\r\n    #6 0x14e0b6a2db7e in PATTauHybridProducer::produce(edm::Event&, edm::EventSetup const&) src/PhysicsTools/PatAlgos/plugins/PATTauHybridProducer.cc:269\r\n    #7 0x14e2588c290e in edm::stream::EDProducerAdaptorBase::doEvent(edm::EventTransitionInfo const&, edm::ActivityRegistry*, edm::ModuleCallingContext const*) src/FWCore/Framework/src/stream/EDProducerAdaptorBase.cc:82\r\n```\r\n(e.g. in https://cmssdt.cern.ch/SDT/cgi-bin/logreader/el8_amd64_gcc12/CMSSW_14_1_UBSAN_X_2024-02-21-2300/pyRelValMatrixLogs/run/11602.0_SingleElectronPt35+2021/step3_SingleElectronPt35+2021.log#/)\r\n\r\nI'm not fully certain if this PR would fix that warning, but this line should be fixed anyway.\r\n\r\n#### PR validation:\r\n\r\nNone\r\n\r\n#### If this PR is a backport please specify the original PR and why you need to backport that PR. If this PR will be backported please specify to which release cycle the backport is meant for:\r\n\r\nThe fix impacts physics, but I don't know by how much, nor if it should be backported. I can backport it if needed.", "branch": "master", "changed_files": 1, "comments": 1, "commits": 1, "created_at": "1708697118", "deletions": 1, "labels": ["reconstruction-pending", "pending-signatures", "tests-pending", "orp-pending", "code-checks-pending", "xpog-pending"], "milestone": "CMSSW_14_1_X", "number": 44067, "release-notes": [], "review_comments": 0, "state": "open", "title": "Erase from correct vector in PATTauHybridProducer", "updated_at": "1708697141", "user": "makortel"}