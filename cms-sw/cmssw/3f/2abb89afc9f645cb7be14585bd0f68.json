{"additions": 8, "auther_ref": "pixelClusterChargeReweightingBugfix", "auther_sha": "a8ba6e47de64a15df4910d2ff6b876df96d5605e", "author": "schuetzepaul", "body": "Following up on #22911 :\r\nA bug in the re-weighting algorithm of the pixel digitizer was discovered causing the removal of a significant number of clusters. \r\nTechnically spoken: If no matching 2D template was found for a cluster, it was removed (all charges set to 0) due to a missing return of the re-weighting function. This happens mainly for low pt tracks, since they have a higher possibility for very large incidence angles, not covered by the templates.\r\n\r\nSolution: The re-weighting function returns with an error in case no matching template was found. This pulls the flag `reweighted` to `false`, causing the signal to be digitized without re-weighting (see [here](https://github.com/schuetzepaul/cmssw/blob/pixelClusterChargeReweightingBugfix/SimTracker/SiPixelDigitizer/plugins/SiPixelDigitizerAlgorithm.cc#L1311)). Therefore the signal is not fully correct in terms of radiation damage, but it's not lost.\r\n\r\nAs noted in #22911 the feature of charge re-weighting is still turned of by default. It can be used with the following lines in the configuration (switching on the Re-weighting and loading the templates via the GT candidate):\r\n```\r\nfrom SimGeneral.MixingModule.pixelDigitizer_cfi import *\r\nprocess.mix.digitizers.pixel.UseReweighting = cms.bool(True)\r\n\r\nfrom Configuration.AlCa.GlobalTag import GlobalTag\r\nprocess.GlobalTag = GlobalTag(process.GlobalTag, '102X_upgrade2018_realistic_Candidate_2018_06_10_00_16_33', '')\r\n```\r\n\r\nThe validation of the simulated data with this fix is ongoing.\r\n\r\nInterested users: @tvami @tsusa @veszpv @pmaksim1 ", "branch": "master", "changed_files": 1, "closed_at": "1529041110", "comments": 14, "commits": 1, "created_at": "1528957870", "deletions": 2, "labels": ["code-checks-approved", "comparison-available", "fully-signed", "orp-approved", "simulation-approved", "tests-approved"], "merge_commit_sha": "c064038c5d0737cd41911f628b7d284a5ec69711", "merged_at": "1529041110", "merged_by": "cmsbuild", "milestone": "CMSSW_10_2_X", "number": 23583, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Bugfix in pixel detector's cluster charge re-weighting", "updated_at": "1529041110", "user": "schuetzepaul"}