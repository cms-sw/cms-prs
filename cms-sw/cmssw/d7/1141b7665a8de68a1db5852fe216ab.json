{"additions": 553, "auther_ref": "probQInMiniAODMaster", "auther_sha": "3a6be713b848c234b7461aeccbbc3a82a6ce06ad", "author": "tvami", "body": "#### PR description:\r\n\r\nSee request to ReRECO 2017/2018 SM and MET data in [1]. This assumed refitting tracks to get the required low-level pixel reco information. As an alternative (actually it's an improvement, so better than alternative) it was recommended to save the required information in the MiniAOD. This PR does that,  i.e. adds  SiPixel on track charge and shape probs to MiniAOD content. Since in 2017/2018 the Pixel layer 1 was very noisy, and alternative version that excludes L1 was added as well.\r\n\r\n * Adding it to RECO/AOD as a new object `siPixelTrackProbQXY`:\r\n```\r\nedm::ValueMap<reco::SiPixelTrackProbQXY>    \"siPixelTrackProbQXY\"       \"\"        \"RECO\"\r\nedm::ValueMap<reco::SiPixelTrackProbQXY>    \"siPixelTrackProbQXY\"       \"NoLayer1\"        \"RECO\"\r\n```\r\n\r\n * While adding it to MiniAOD as a member of the isolatedTracks collection.\r\n\r\nFurther details presented in the Tracking POG meeting on Monday [2]\r\n\r\n[1] https://its.cern.ch/jira/browse/PDMVRERECO-48\r\n[2] https://indico.cern.ch/event/1098365/#5-proposal-to-use-low-level-pi\r\n\r\n#### PR validation:\r\n * Running MiniAOD\r\n```\r\ncmsDriver.py ReRECO --conditions auto:run2_data --customise Configuration/DataProcessing/RecoTLR.customisePostEra_Run2_2018,Configuration/DataProcessing/Utils.addMonitoring --datatier MINIAOD --era Run2_2018,pf_badHcalMitigation --eventcontent MINIAOD --nThreads 8 --no_exec --number 100 --python_filename 4HLT2MiniAOD.py --scenario pp --step RAW2DIGI,L1Reco,RECO,EI,PAT --runUnscheduled --data  --filein root://cms-xrd-global.cern.ch//store/data/Run2018C/SingleMuon/RAW/v1/000/319/337/00000/004ED286-5582-E811-8895-FA163E126126.root --era Run2_2018\r\n```\r\nbefore the PR and after the PR the sizes change as follows:\r\n-rw-r--r-- 1 tvami cms 8177333 Nov 24 16:30 ReRECO_RAW2DIGI_L1Reco_RECO_EI_PAT.root\r\n--> \r\n-rw-r--r-- 1 tvami cms 8185759 Nov 24 16:26 ReRECO_RAW2DIGI_L1Reco_RECO_EI_PAT.root\r\ni.e an 1.00103041 increase in size is expected.\r\n\r\nA unit test has been implemented as well\r\n\r\n * Running AOD\r\n```\r\ncmsDriver.py ReRECO --conditions auto:run2_data --customise Configuration/DataProcessing/RecoTLR.customisePostEra_Run2_2018 --datatier AOD --eventcontent AOD --number 100 --python_filename 4HLT2AOD.py --scenario pp --step RAW2DIGI,L1Reco,RECO --data  --filein file:/eos/cms/store/user/cmsbuild/store/data/Run2018C/SingleMuon/RAW/v1/000/319/337/00000/004ED286-5582-E811-8895-FA163E126126.root --fileout file:MiniAOD.root --era Run2_2018\r\n```\r\nbefore the PR and after the PR the sizes of the AOD change as follows:\r\n-rw-r--r--. 1 tvami zh 46456023 Dec  6 22:24 MiniAOD.root\r\n--> \r\n-rw-r--r--. 1 tvami zh 47673431 Dec  6 22:23 MiniAOD.root\r\ni.e an 1.0262056 increase in size is expected.\r\n\r\nHere is the timing report for before the PR\r\n```\r\n Time Summary: \r\n - Min event:   3.1252\r\n - Max event:   42.8974\r\n - Avg event:   12.985\r\n - Total loop:  181.876\r\n - Total init:  67.6784\r\n - Total job:   249.563\r\n - EventSetup Lock: 0\r\n - EventSetup Get:  0\r\n Event Throughput: 0.549825 ev/s\r\n CPU Summary: \r\n - Total loop:     1176.02\r\n - Total init:     51.0267\r\n - Total extra:    0\r\n - Total children: 0.125992\r\n - Total job:      1227.06\r\n ```\r\n\r\nand after the PR\r\n```\r\n Time Summary: \r\n - Min event:   3.22021\r\n - Max event:   41.7722\r\n - Avg event:   13.0204\r\n - Total loop:  180.607\r\n - Total init:  66.0196\r\n - Total job:   246.629\r\n - EventSetup Lock: 0\r\n - EventSetup Get:  0\r\n Event Throughput: 0.55369 ev/s\r\n CPU Summary: \r\n - Total loop:     1183.12\r\n - Total init:     50.1868\r\n - Total extra:    0\r\n - Total children: 0.117669\r\n - Total job:      1233.31\r\n ```\r\n\r\nContent was validated on MC Signal samples, and on data as well, please see more plots in [2]\r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\n\r\nNeeds a backport in 10_6_X\r\n\r\ncc @mmusich ", "branch": "master", "changed_files": 17, "comments": 132, "commits": 10, "created_at": "1637806635", "deletions": 4, "labels": ["reconstruction-pending", "pending-signatures", "tests-pending", "orp-pending", "urgent", "code-checks-pending", "xpog-pending"], "milestone": "CMSSW_12_3_X", "number": 36247, "release-notes": [], "review_comments": 110, "state": "open", "title": "Adding SiPixel on track charge and shape probs to MiniAOD content", "updated_at": "1639079414", "user": "tvami"}