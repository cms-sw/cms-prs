{"additions": 530, "auther_ref": "devel_hltDumpStream", "auther_sha": "290d5691b4cf51c0a49228f475b1cd21fc3b3ee6", "author": "missirol", "body": "resolves #37762\r\n\r\n#### PR description:\r\n\r\nThis PR updates the `hltDumpStream` script, adapting it to the most recent versions of the HLT menus.\r\n\r\nTesting is still in progress, but the review could already start.\r\n\r\nFYI: @fwyzard \r\n\r\nShort summary of the updates below.\r\n\r\n - Take into account that stream OutputModules can be in `FinalPath`s (as opposed to `EndPath`s like in Run 2).\r\n - Take into account that, since the introduction of `DatasetPath`s, a dataset itself can be prescaled, and smart-prescales can be applied at dataset level.\r\n - Continue to take into account that smart-prescales could be applied at stream level, and streams could be prescaled (was the case in Run-2 menus, is not the case in 2022 menus partly due to the use of `FinalPath`s, might potentially be the case again in the future).\r\n - Add some basic support to take wildcards into account in the lookup of smart-prescales.\r\n - Try and reduce reliance on the \"datasets\" and \"streams\" PSets, to improve support for 'partial' configurations (e.g. `hltGetConfiguration --paths [..]`).\r\n - In addition, the definition of \"trigger seed\" is slightly changed:\r\n    - restricting to modules that precede the HLT prescaler (if any), and\r\n    - considering also `TriggerResultsFilter`, as opposed to only `HLTL1TSeed` (we currently have corner cases like `HLT_EphemeralPhysics`, where `TriggerResultsFilter` is used to select on L1T seeds, and `DST_HLTMuon_Run3_PFScoutingPixelTracking`, where `TriggerResultsFilter` is used to seed the HLT path with events selected by the Muon PD, i.e. `Dataset_Muon`).\r\n\r\nA few command-line options are added, see `hltDumpStream --help` below:\r\n```\r\nusage: ./hltDumpStream [-h] [-m MODE] [-p COLUMN [COLUMN ...] | --no-prescales] [--no-seeds] [MENU]\r\n\r\nhltDumpStream: print information on streams, primary datasets, triggers and (HLT) prescales of a HLT menu\r\n\r\nexamples:\r\n  # run hltDumpStream on HLT menu used in run 123456 (output in CSV format)\r\n  hltConfigFromDB --runNumber 123456 | hltDumpStream --mode csv\r\n  # run hltDumpStream on local cfg file hlt.py (output in text format)\r\n  hltDumpStream hlt.py --mode text\r\n\r\npositional arguments:\r\n  MENU                  path to local cmsRun cfg file (if not specified, stdin is used)\r\n\r\noptional arguments:\r\n  -h, --help            show this help message and exit\r\n  -m MODE, --mode MODE  format of output file (must be \"text\", or \"csv\") [default: \"text\"]\r\n  -p COLUMN [COLUMN ...], --prescale-columns COLUMN [COLUMN ...]\r\n                        list of patterns, passed to fnmatch, to select prescale columns [default: [\"*\"]]\r\n  --no-prescales        do not show information on prescales\r\n  --no-seeds            do not show the seed of a HLT path [default: False]\r\n```\r\n\r\n#### PR validation:\r\n\r\nPrivate tests.\r\n\r\n#### If this PR is a backport please specify the original PR and why you need to backport that PR. If this PR will be backported please specify to which release cycle the backport is meant for:\r\n\r\nN/A", "branch": "master", "changed_files": 1, "comments": 6, "commits": 2, "created_at": "1669977959", "deletions": 286, "labels": ["hlt-pending", "pending-signatures", "tests-pending", "orp-pending", "code-checks-approved"], "milestone": "CMSSW_13_0_X", "number": 40223, "release-notes": [], "review_comments": 0, "state": "open", "title": "update of `hltDumpStream` for Run-3 HLT menus", "updated_at": "1669986267", "user": "missirol"}