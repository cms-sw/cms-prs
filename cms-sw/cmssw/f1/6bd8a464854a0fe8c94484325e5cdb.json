{"additions": 25, "auther_ref": "fixAncestor", "auther_sha": "2dce981332ef568b72eec17b5ee87a0b18c6db47", "author": "AuroraPerego", "body": "#### PR description:\r\n\r\nCurrently the `idLastStoredAncestor()` in the track info stores:\r\n- the id of the G4 track itself if it is marked as to be saved in the `simTrack` collection\r\n- the id of the last parent saved in the `simTrack` collection if the track itself will not be saved\r\n\r\nThis led to a problem in the case of a particle which is saved in the collection but its parent is not, because `idLastStoredAncestor()` pointed to that track, but there was no way in the final simtrack collection to understand from which particle this track originated.\r\nWith this change the `idLastStoredAncestor()` will contain:\r\n- the id of the G4 track itself if it is marked as to be saved in the `simTrack` collection, and all its parents up to the first G4 track are saved\r\n- the id of the last parent saved in the `simTrack` collection otherwise\r\n\r\nAs an example, suppose we have track 1 `->` track 2 `->` track 3 `->` track 4 ( `a -> b` means that track `a` is the mother of track `b`) and track 3 is the only one not saved in the event. Before this PR track 4 was saved but there was no way to link it to track 1, now it stores the Geant4 Id of track 2.\r\n\r\nThis is a follow-up of #47883 that eventually will allow us to recover the `simCluster`s that are currently discarded.\r\n\r\n#### PR validation:\r\n\r\nLooked at the output files of the `SimGeneral/Debugging/python/caloParticleDebugger_cfg.py`, the only expected change is in the value returned by the method `getPrimaryOrLastStoredID()` of the simTrack. \r\n\r\nFYI @rovere @fabiocos \r\n", "branch": "master", "changed_files": 9, "comments": 8, "commits": 3, "created_at": "1758727501", "deletions": 17, "labels": ["simulation-pending", "pending-signatures", "orp-pending", "tests-started", "code-checks-approved"], "milestone": "CMSSW_16_0_X", "number": 48986, "release-notes": [], "review_comments": 0, "state": "open", "title": "Fix `idLastStoredAncestor` to point to a track parent when the full graph is not saved", "updated_at": "1758884047", "user": "AuroraPerego"}