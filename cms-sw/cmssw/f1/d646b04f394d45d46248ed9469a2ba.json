{"additions": 256, "auther_ref": "stripG2PCL_removeShallow", "auther_sha": "760741afea43f649166521f0f4927f30e7ccdc73", "author": "pieterdavid", "body": "#### PR description:\r\n\r\nTo minimise the risk of diverging during data-taking, the SiStrip gains PCL reused the flat tree maker (ShallowGainCalibration), and read the branches it produced. We are reorganising the calibration tree code for run 3 (moving to the NanoAOD framework / ALCANANO, see [this presentation](https://indico.cern.ch/event/992962/contributions/4293256/attachments/2218359/3756083/NANOAOD_like_Strip_calibration_trees.pdf), which will replace ShallowGainCalibration), so now it seems cleaner to remove the intermediate step (that brings the track and cluster selection logic together in the PCL worker, where most of it already was).\r\nIn the process, I found a bug in the [old code](https://github.com/cms-sw/cmssw/blob/master/CalibTracker/SiStripCommon/plugins/ShallowGainCalibration.cc#L138-L173) that checks if a cluster crosses or touches an APV boundary (group of 128 strips), and fixed that (the cut removed a bit too many clusters, so the only effect is a small increase, of about 1%, in the number of clusters considered - all distributions should be compatible).\r\n\r\n#### PR validation:\r\n\r\nCompared workflow 1001.2, which contains the SiStrip gain calibration PCL. No changes before the last commit; with that change included a small increase in cluster statistics.\r\n\r\nCC: @ataliercio @mdelcourt @robervalwalsh @mmusich ", "branch": "master", "changed_files": 5, "closed_at": "1620129224", "comments": 15, "commits": 5, "created_at": "1619422433", "deletions": 365, "labels": ["alca-approved", "code-checks-approved", "fully-signed", "orp-approved", "tests-approved"], "merge_commit_sha": "7a3999f7b6317bf61ec944651efbb561edc1a7b0", "merged_at": "1620129224", "merged_by": "cmsbuild", "milestone": "CMSSW_12_0_X", "number": 33523, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Merge ShallowGainCalibration logic in SiStripGainsPCLWorker and a minor bugfix", "updated_at": "1620129438", "user": "pieterdavid"}