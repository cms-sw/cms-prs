{"additions": 18, "auther_ref": "customiseBeamSpotESSource_12_0_X", "auther_sha": "338c01bede13b2cdf092749263d1fb6116f754b4", "author": "mmusich", "body": "backport of https://github.com/cms-sw/cmssw/pull/35896\r\n\r\n#### PR description:\r\n\r\nDuring the 2021 October LHC beam test run it was noticed that, while in the first run with reasonable placing of the LHC luminous region (346373) an online beamspot measurement was available at around LS=10 (see [online DQM GUI](https://cmsweb.cern.ch/dqm/online/start?runnr=346373;dataset=/Global/Online/ALL;sampletype=online_data;filter=all;referencepos=overlay;referenceshow=customise;referencenorm=True;referenceobj1=refobj;referenceobj2=none;referenceobj3=none;referenceobj4=none;search=;striptype=object;stripruns=;stripaxis=run;stripomit=none;workspace=Everything;size=M;root=onlineBeamMonitor/Debug;focus=onlineBeamMonitor/Debug/hxLumibased%20BeamSpotTransient;zoom=yes;) and log of the upload to the [Conditions Database](https://cms-conddb.cern.ch/cmsDbBrowser/logs/show_O2O_log/Prod/BeamSpotOnlineHLT/2021-10-28%2021:01:37.330229)), \r\n\r\n![image](https://user-images.githubusercontent.com/5082376/139413394-f2491741-2cf4-4544-8a9d-412eabfc3417.png)\r\n\r\nthe information about the change of condition was not propagated properly to the other clients (see e.g. this plot from the same run of the track distance w.r.t BeamSpot: [online DQM GUI](https://cmsweb.cern.ch/dqm/online/start?runnr=346373;dataset=/Global/Online/ALL;sampletype=online_data;filter=all;referencepos=overlay;referenceshow=customise;referencenorm=True;referenceobj1=refobj;referenceobj2=none;referenceobj3=none;referenceobj4=none;search=;striptype=object;stripruns=;stripaxis=run;stripomit=none;workspace=Everything;size=M;root=Tracking/TrackParameters/GeneralProperties;focus=Tracking/TrackParameters/GeneralProperties/DistanceOfClosestApproachToBS_GenTk;zoom=yes;)).\r\n\r\n![image](https://user-images.githubusercontent.com/5082376/139413049-35698382-7ab8-491f-ac5a-cfe7d4867ebb.png)\r\n\r\nThis likely means that at P5 the refresh of the conditions needed for the `OnlineBeamSposESProducer` arbitration was not enabled (as I think the frontier connection is configured as for the HLT).\r\nWe provide hear the same customization of the `GlobalTag` `ESSource` used in the HLT menu to recover from this issue.\r\nI notice *en passant* that the next run (346374) did pick up the right conditions in the online GUI ( [link](https://cmsweb.cern.ch/dqm/online/start?runnr=346373;dataset=/Global/Online/ALL;sampletype=online_data;filter=all;referencepos=overlay;referenceshow=all;referencenorm=True;referenceobj1=other%3A346374%3A%3A%3A;referenceobj2=none;referenceobj3=none;referenceobj4=none;search=;striptype=object;stripruns=;stripaxis=run;stripomit=none;workspace=Everything;size=M;root=Tracking/TrackParameters/GeneralProperties;focus=Tracking/TrackParameters/GeneralProperties/DistanceOfClosestApproachToBS_GenTk;zoom=yes;) ) and the [Express DQM](https://tinyurl.com/yzeul67a) instead picked up the right conditions in both cases, corroborating the case for a missing refresh of the input.\r\n\r\n#### PR validation:\r\n\r\n## This PR should be tested in the DQM online playback system using run 346373.\r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\n\r\nbackport of https://github.com/cms-sw/cmssw/pull/35896\r\ncc:\r\n@gennai @francescobrivio @mtosi @vmariani ", "branch": "CMSSW_12_0_X", "changed_files": 1, "closed_at": "1635551576", "comments": 13, "commits": 1, "created_at": "1635493799", "deletions": 0, "labels": ["dqm-approved", "fully-signed", "tests-approved", "bug-fix", "orp-approved", "urgent", "backport"], "merge_commit_sha": "57cd566979f8ec417566cf4d5648087a3234f9ea", "merged_at": "1635551576", "merged_by": "cmsbuild", "milestone": "CMSSW_12_0_X", "number": 35897, "release-notes": [], "review_comments": 0, "state": "closed", "title": "customize `OnlineBeamSpotESProducer` inputs to be refreshed at each LS in online DQM [12.0.X]", "updated_at": "1635551576", "user": "mmusich"}