{"additions": 144, "auther_ref": "iyusuff-wafervldn_dec2021fix", "auther_sha": "1735785ada19dbd04b10d6be92bb396e872d25ca", "author": "imranyusuff", "body": "#### PR description:\r\n\r\nChangelog Tue, 14 Dmr 2021 by Imran Yusuff:\r\n\r\n- Further tidying the code\r\n- Now uses the first line of the flat file to determine flat file type (single number means new format)\r\n- Separate out shape and rotation matching operation into functions\r\n- Fixed validation for D86 geometry (especially in rotation for type-3 layers)\r\n\r\n#### PR validation:\r\n\r\nNow correctly validates wafer with layerType = 3:\r\n\r\n```\r\n... snip ...\r\nROTATION ERROR: (33,12,3)  ( 0 != 5 (0) )  name=hgcalwafer:HGCalHEWafer0Coarse2\r\nROTATION ERROR: (33,12,9)  ( 0 != 5 (0) )  name=hgcalwafer:HGCalHEWafer0Coarse2\r\nROTATION ERROR: (33,-3,9)  ( 0 != 5 (0) )  name=hgcalwafer:HGCalHEWafer0Coarse2\r\nROTATION ERROR: (33,-9,3)  ( 0 != 5 (0) )  name=hgcalwafer:HGCalHEWafer0Coarse2\r\nROTATION ERROR: (33,-9,-12)  ( 0 != 5 (0) )  name=hgcalwafer:HGCalHEWafer0Coarse2\r\nROTATION ERROR: (33,-3,-12)  ( 0 != 5 (0) )  name=hgcalwafer:HGCalHEWafer0Coarse2\r\n\r\n*** ERROR COUNTS ***\r\nMissing         :  0\r\nThickness error :  0\r\nPos-x error     :  0\r\nPos-y error     :  0\r\nShape error     :  0\r\nRotation error  :  6\r\nUnaccounted     :  0\r\n\r\nTotal wafers processed from geotxtfile = 13545\r\n\r\nThere are at least one wafer error.\r\n%MSG-i DDCompactViewImpl:  AfterModEndJob 15-Dec-2021 04:28:58 CET EndJob\r\nDDD transient representation has been destructed.\r\n%MSG\r\n\r\n```\r\nHowever, there still remain 6 rotation errors, all on layer number 33.\r\n\r\nTesting with D77 and D83 geometries produced unchanged results.\r\n\r\nNo other bugs found during testing.\r\n\r\n (- Imran -)\r\n", "branch": "master", "changed_files": 1, "closed_at": "1639757248", "comments": 22, "commits": 3, "created_at": "1639536419", "deletions": 118, "labels": ["dqm-approved", "fully-signed", "tests-approved", "orp-approved", "code-checks-approved", "hgcal-dpg-approved"], "merge_commit_sha": "2b7e9b67863b1354716903d02efd96a89fc705cb", "merged_at": "1639757248", "merged_by": "cmsbuild", "milestone": "CMSSW_12_3_X", "number": 36502, "release-notes": [], "review_comments": 14, "state": "closed", "title": "HGCalWaferValidation: refinements and D86 geometry validation fix", "updated_at": "1639757248", "user": "imranyusuff"}