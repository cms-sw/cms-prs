{"additions": 99, "auther_ref": "LowPtElectrons_ULFastSimFix", "auther_sha": "0212d1d0fc668ccd9c6646ad41c1b118710876d1", "author": "bainbrid", "body": "#### PR description:\r\n\r\n- UL mini v2 workflows for FastSim are broken due to an exception thrown by the `LowPtGsfElectronIDProducer` when attempting to access an `edm::Ref` to the missing `generalTracksBeforeMixing` collection in AOD. \r\n- All details can be found in this issue: https://github.com/cms-sw/cmssw/issues/34774.\r\n- This PR provides an acceptable fix in the RECO chain by suppressing (i.e. removing) the FastSim switch to using tracks from the `generalTracksBeforeMixing` collection in the `GsfElectronCore` and `GsfElectron` objects.\r\n- For re-miniaod (and re-nanoaod) workflows, this PR also provides an acceptable workaround that allows the ID producer to evaluate the BDT model without throwing an exception, while maintaining the expected physics performance. This is achieved by extracting features from the KF track used in the `ElectronSeed` step (obtained from the available `generalTracks` collection in AOD), instead of from the KF track embedded in the `GsfElectronCore` object (which is chosen based on number of shared hits with the `GsfTrack` and obtained from the missing `generalTracksBeforeMixing` collection in AOD). \r\n- All development was performed in the 10_6_X cycle (see the compare [here](https://github.com/cms-sw/cmssw/compare/CMSSW_10_6_X...bainbrid:LowPtElectrons_ULFastSimFix_106X)), tested with the example recipes provided in the issue [#34774](#34774), and then ported to master (this PR). This work will be back ported to 10_6_X in a future PR.\r\n- Also tested is the behaviour for the nano v9 workflow, which is similarly affected.\r\n- This work was presented to RECO/AT here: https://indico.cern.ch/event/1071803/. The final slide compares physics performance b/w the 10_6_X and 12_1_X cycles (essentially identical).\r\n- Physics and computing performances are ~unaffected. \r\n\r\n#### PR validation:\r\n\r\nThis PR was validated using cmsDriver commands that performed the GEN->AOD and mini v2 steps, based on those provided [here](https://github.com/cms-sw/cmssw/issues/34774#issue-960576497), for tests with the 10_6_X cycle, and modified versions for tests with the 12_1_X release (this PR). \r\n\r\n@slava77 @jordan-martins @crovelli \r\n", "branch": "master", "changed_files": 6, "comments": 11, "commits": 4, "created_at": "1631023251", "deletions": 30, "labels": ["reconstruction-pending", "pending-signatures", "orp-pending", "tests-started", "code-checks-approved"], "milestone": "CMSSW_12_1_X", "number": 35181, "release-notes": [], "review_comments": 10, "state": "open", "title": "LowPtElectrons: fix for UL FastSim mini v2 and nano v9 workflows", "updated_at": "1631636978", "user": "bainbrid"}