{"additions": 262, "auther_ref": "PFRecHitNavigatorForHcalWithDenseId", "auther_sha": "29da1983f12cdaa67b912bc7f7f319d40e0d10b7", "author": "hatakeyamak", "body": "#### PR description:\r\n\r\nThis is an update for PFRecHit navigator for HCAL using a vector of neighbor information filled with HCAL dense index. This is expected to cut down the PFRecHitProducer for HCAL by 30-40%.\r\n\r\nUsing HLT's OnLine_HLT_GRun.py on:\r\n/eos/cms/store/data/Run2018D/EphemeralHLTPhysics5/RAW/v1/000/324/897/00000/F5F13777-D664-C747-88AA-0459C1E35254.root\r\n(1000 events)\r\n```\r\n[Before]\r\nFastReport   CPU time avg.      when run  Real time avg.      when run     Alloc. avg.      when run   Dealloc. avg.      when run  Modules\r\nFastReport         4.0 ms         4.0 ms         4.1 ms         4.1 ms        +607 kB        +607 kB        -512 kB        -512 kB    hltParticleFlowRecHitHBHE\r\nFastReport         3.9 ms         3.9 ms         4.0 ms         4.0 ms       +1154 kB       +1154 kB        -907 kB        -907 kB    hltParticleFlowRecHitHF\r\n\r\n[With this PR]\r\nFastReport         2.3 ms         2.3 ms         2.4 ms         2.4 ms        +608 kB        +608 kB        -513 kB        -513 kB    hltParticleFlowRecHitHBHE\r\nFastReport         2.7 ms         2.7 ms         2.9 ms         2.9 ms       +1148 kB       +1148 kB        -903 kB        -903 kB    hltParticleFlowRecHitHF\r\n```\r\nOffline setup\r\n```\r\n[Before]\r\nRun3_0PU\r\nFastReport   CPU time avg.      when run  Real time avg.      when run     Alloc. avg.      when run   Dealloc. avg.      when run  Modules\r\nFastReport         1.3 ms         1.3 ms         1.5 ms         1.5 ms        +130 kB        +130 kB         -57 kB         -57 kB    particleFlowRecHitHBHE\r\nFastReport         1.6 ms         1.6 ms         2.3 ms         2.3 ms        +266 kB        +266 kB        -233 kB        -233 kB    particleFlowRecHitHF\r\nFastReport         0.1 ms         0.1 ms         0.1 ms         0.1 ms         +60 kB         +60 kB         -59 kB         -59 kB    particleFlowRecHitHO\r\n\r\nRun3 PU\r\nFastReport        16.1 ms        16.1 ms        18.0 ms        18.0 ms       +1558 kB       +1558 kB        -604 kB        -604 kB    particleFlowRecHitHBHE\r\nFastReport         4.6 ms         4.6 ms         4.8 ms         4.8 ms       +1547 kB       +1547 kB       -1298 kB       -1298 kB    particleFlowRecHitHF\r\nFastReport         0.1 ms         0.1 ms         0.1 ms         0.1 ms        +662 kB        +662 kB        -660 kB        -660 kB    particleFlowRecHitHO\r\n\r\nPhase2 PU\r\nFastReport        36.7 ms        36.7 ms        36.9 ms        36.9 ms      +38833 kB      +38833 kB      -37100 kB      -37100 kB    particleFlowRecHitHBHE\r\nFastReport         7.0 ms         7.0 ms         7.0 ms         7.0 ms      +29003 kB      +29003 kB      -28734 kB      -28734 kB    particleFlowRecHitHF\r\nFastReport         0.9 ms         0.9 ms         0.9 ms         0.9 ms      +36056 kB      +36056 kB      -36052 kB      -36052 kB    particleFlowRecHitHO\r\n\r\n[With this PR]\r\nRun3_0PU\r\nFastReport         1.0 ms         1.0 ms         2.5 ms         2.5 ms        +128 kB        +128 kB         -52 kB         -52 kB    particleFlowRecHitHBHE\r\nFastReport         1.8 ms         1.8 ms         2.6 ms         2.6 ms        +260 kB        +260 kB        -225 kB        -225 kB    particleFlowRecHitHF\r\nFastReport         0.1 ms         0.1 ms         0.4 ms         0.4 ms         +57 kB         +57 kB         -56 kB         -56 kB    particleFlowRecHitHO\r\n\r\nRun3 PU\r\nFastReport         8.0 ms         8.0 ms         9.2 ms         9.2 ms       +1512 kB       +1512 kB        -553 kB        -553 kB    particleFlowRecHitHBHE\r\nFastReport         4.2 ms         4.2 ms         4.4 ms         4.4 ms       +1561 kB       +1561 kB       -1313 kB       -1313 kB    particleFlowRecHitHF\r\nFastReport         0.2 ms         0.2 ms         0.2 ms         0.2 ms        +683 kB        +683 kB        -682 kB        -682 kB    particleFlowRecHitHO\r\n\r\nPhase2 PU\r\nFastReport        19.3 ms        19.3 ms        21.1 ms        21.1 ms      +28332 kB      +28332 kB      -26446 kB      -26446 kB    particleFlowRecHitHBHE\r\nFastReport         4.4 ms         4.4 ms         4.8 ms         4.8 ms      +23704 kB      +23704 kB      -23432 kB      -23432 kB    particleFlowRecHitHF\r\nFastReport         0.3 ms         0.3 ms         0.3 ms         0.3 ms      +25473 kB      +25473 kB      -25469 kB      -25469 kB    particleFlowRecHitHO\r\n```\r\n\r\nAlso, we used this opportunity to clean up the unused module (PFCTRecHitProducer), clean up unused config parameters, and some of the initialization related to topology was moved from event-level to beginLuminosityBlock for efficiency.\r\n\r\n#### PR validation:\r\n\r\nRun validation based on a few matrix tests (ttbar for 2018 and 2021) and HLT test based on 2018 data (originally from):\r\nhttps://fwyzard.web.cern.ch/fwyzard/patatrack/hlt_paths/original.py\r\nand checked that PF candidate outputs are identical.\r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\n\r\nThis is not backport.\r\n\r\n@bendavid @jsalfeld @mariadalfonso @bsunanda @abdoulline", "branch": "master", "changed_files": 13, "closed_at": "1583738898", "comments": 39, "commits": 23, "created_at": "1582739120", "deletions": 951, "labels": ["code-checks-approved", "comparison-available", "fully-signed", "hlt-approved", "orp-approved", "reconstruction-approved", "tests-approved"], "merge_commit_sha": "761c1de15681b01f4c11abfaeee2f364b90979db", "merged_at": "1583738898", "merged_by": "cmsbuild", "milestone": "CMSSW_11_1_X", "number": 29049, "release-notes": [], "review_comments": 6, "state": "closed", "title": "PFRecHit navigator for HCAL with dense index", "updated_at": "1583738898", "user": "hatakeyamak"}