{"additions": 281, "auther_ref": "Phase2-WF30", "auther_sha": "14d758b203d88fb9b7701b403ae1451303609955", "author": "kpedro88", "body": "Changes in this PR:\r\n1. Add unit test to compare outputs of 2023 geometry generation script to current versions of the corresponding files. This should prevent inconsistencies of the type that have occurred recently.\r\n2. Add a few features to the script:\r\n  * `-D` is now used to specify an existing detector version (requested a while ago by @lgray) in lieu of specifying each subdet version. `-V` is now used for the previous functionality, to specify a new version number for an unknown setup to facilitate testing.\r\n  * A list of deprecated detector and subdetector version numbers is kept, to prevent any of them from being reused accidentally.\r\n3. Removed T1 and replaced with T3 in relevant detector versions. This was implemented as D1->D7, D5->D8, D6->D9. D3 was removed, as it would be redundant with D4 with this change. Importantly, all workflow numbers were kept the same, by designating what were previously the D3 numbers as \"conflicts\" to be skipped. This was requested by the tracking group because reco efforts are increasingly based on T3 and may not provide sensible performance for T1. The specific implementation of the change in this PR was agreed with upgrade management.\r\n\r\nIn the future, I also plan to remove C1 and reduce the number of detector versions. However, due to the intended use of 90X for TDR production, these further changes are tentatively delayed until 91X, in order to avoid confusion.\r\n\r\nFailing test result:\r\n```\r\nPackage Configuration/Geometry: Running test test2023Geometry\r\n \r\n===== Test \"test2023Geometry\" ====\r\nargument 0: test2023Geometry\r\nargument 1: /bin/bash\r\nargument 2: Configuration/Geometry/test\r\nargument 3: runtests.sh\r\nshell is: /bin/bash\r\nCurrent directory is: /uscms_data/d3/pedrok/phase2/wf/CMSSW_9_0_X_2016-12-07-1100\r\ntopdir is: /uscms_data/d3/pedrok/phase2/wf/CMSSW_9_0_X_2016-12-07-1100\r\ntestdir is: /uscms_data/d3/pedrok/phase2/wf/CMSSW_9_0_X_2016-12-07-1100/src/Configuration/Geometry/test\r\ntmpdir is: /uscms_data/d3/pedrok/phase2/wf/CMSSW_9_0_X_2016-12-07-1100/tmp/slc6_amd64_gcc530\r\ntestbin is: /uscms_data/d3/pedrok/phase2/wf/CMSSW_9_0_X_2016-12-07-1100/test/slc6_amd64_gcc530\r\nRunning script: /uscms_data/d3/pedrok/phase2/wf/CMSSW_9_0_X_2016-12-07-1100/src/Configuration/Geometry/test/runtests.sh\r\nGeometryExtended2023D6_cff.py differs\r\nGeometryExtended2023D5Reco_cff.py differs\r\nstatus = 256\r\n\r\n---> test test2023Geometry had ERRORS\r\n\r\n^^^^ End Test test2023Geometry ^^^^\r\n```\r\nPassing test result:\r\n```\r\nPackage Configuration/Geometry: Running test test2023Geometry\r\n \r\n===== Test \"test2023Geometry\" ====\r\nargument 0: test2023Geometry\r\nargument 1: /bin/bash\r\nargument 2: Configuration/Geometry/test\r\nargument 3: runtests.sh\r\nshell is: /bin/bash\r\nCurrent directory is: /uscms_data/d3/pedrok/phase2/wf/CMSSW_9_0_X_2016-12-07-1100\r\ntopdir is: /uscms_data/d3/pedrok/phase2/wf/CMSSW_9_0_X_2016-12-07-1100\r\ntestdir is: /uscms_data/d3/pedrok/phase2/wf/CMSSW_9_0_X_2016-12-07-1100/src/Configuration/Geometry/test\r\ntmpdir is: /uscms_data/d3/pedrok/phase2/wf/CMSSW_9_0_X_2016-12-07-1100/tmp/slc6_amd64_gcc530\r\ntestbin is: /uscms_data/d3/pedrok/phase2/wf/CMSSW_9_0_X_2016-12-07-1100/test/slc6_amd64_gcc530\r\nRunning script: /uscms_data/d3/pedrok/phase2/wf/CMSSW_9_0_X_2016-12-07-1100/src/Configuration/Geometry/test/runtests.sh\r\nstatus = 0\r\n\r\n---> test test2023Geometry succeeded\r\n\r\n^^^^ End Test test2023Geometry ^^^^\r\n```\r\n\r\nThis PR supersedes #16908.\r\n\r\n@slava77, this might cause some \"missing matrix map\" warnings...", "branch": "CMSSW_9_0_X", "changed_files": 24, "closed_at": "1481556111", "comments": 20, "commits": 5, "created_at": "1481410734", "deletions": 612, "labels": ["comparison-available", "geometry-approved", "operations-pending", "orp-pending", "pdmv-pending", "pending-signatures", "tests-approved"], "merge_commit_sha": "6f6136c077e571e0330e0934f27eea5968c80502", "merged_at": "1481556111", "merged_by": "davidlange6", "milestone": "CMSSW_9_0_X", "number": 16965, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Add 2023 geometry unit test, remove T1", "updated_at": "1481556111", "user": "kpedro88"}