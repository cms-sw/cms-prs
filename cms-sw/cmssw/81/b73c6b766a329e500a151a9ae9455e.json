{"additions": 291, "auther_ref": "121_runTheMatrixGPUWorkflow", "auther_sha": "de6a246d4b0e6a61d243677475da026f14cf3f9a", "author": "srimanob", "body": "#### PR description:\r\nThe original PR/discussion is https://github.com/cms-sw/cmssw/pull/33057 and https://github.com/dmwm/WMCore/issues/10388 from the WMCore side.\r\nInformation on GPU support from WMCore side: https://github.com/dmwm/WMCore/wiki/GPU-Support\r\n\r\nThis PR is to add GPU workflow to `runTheMatrix`. \r\nIn addition, this PR migrates from `optparse` to `argparse`, with code clean up.\r\n\r\nWhat to be done with this PR:\r\n(Done)\r\n- How can I get the `CUDARuntime` for each release, to be the default value? @makortel @fwyzard @smuzaffar (Done)\r\n- Is `GPUParams` as expected from WMCore? I just use `jsons.dump(the dictionary)` as suggested. @amaltaro (Confirmed)\r\n\r\n(Pending)\r\n- In this PR, I assume that the defined stepname in [relval_step](https://github.com/cms-sw/cmssw/blob/master/Configuration/PyReleaseValidation/python/relval_steps.py) or [upgradeWorkflowComponents](https://github.com/cms-sw/cmssw/blob/master/Configuration/PyReleaseValidation/python/upgradeWorkflowComponents.py) will contain GPU if that step uses GPU. OK?\r\n\r\nThanks.\r\n\r\nFYI @dpiparo @davidlange6 @justinasr \r\n\r\n#### PR validation:\r\nUsing \r\n`runTheMatrix.py --what upgrade -l 11650.502 -t 8 --requires-gpu required --wm init` \r\nor\r\n`runTheMatrix.py --what upgrade -l 11650.502 -t 8 --gpu --wm init` \r\nyou will get\r\n```\r\n'GPUParams': '{\"GPUMemoryMB\": 8000, \"CUDACapabilities\": [\"6.0\", '\r\n                        '\"6.1\", \"6.2\", \"7.0\", \"7.2\", \"7.5\"], \"CUDARuntime\": '\r\n                        '\"11.2\"}',\r\n'RequiresGPU': 'required',\r\n```\r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\nThis PR is not a backport.\r\n", "branch": "master", "changed_files": 2, "closed_at": "1632210057", "comments": 50, "commits": 12, "created_at": "1631609547", "deletions": 214, "labels": ["fully-signed", "tests-approved", "pdmv-approved", "orp-approved", "upgrade-approved", "code-checks-approved", "heterogeneous-approved"], "merge_commit_sha": "5d10e5e40aeadeaaf42b144704fc2ff0dafc9c87", "merged_at": "1632210057", "merged_by": "cmsbuild", "milestone": "CMSSW_12_1_X", "number": 35263, "release-notes": [], "review_comments": 33, "state": "closed", "title": "Add GPU workflow to runTheMatrix", "updated_at": "1632210057", "user": "srimanob"}