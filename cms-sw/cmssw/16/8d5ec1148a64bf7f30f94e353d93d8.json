{"additions": 1, "auther_ref": "112X-revert-clang-warningfix-jsonparser", "auther_sha": "f7d419a6ed33597ed4ad914335fe4827a21e7dc2", "author": "smorovic", "body": "#### PR description:\r\nReverts json_reader.cpp modification which was part of this commit:\r\nhttps://github.com/cms-sw/cmssw/commit/d030f663df51846c06f626488b8dfa2490d187bd\r\n\r\nAccording to description, this commit fixes CLANG-10 warnings, however it seems to change behavior as well. Running with it creates this error (see below for test script description):\r\n```\r\n%MSG-e EvFDaqDirector:  (NoModuleName) 19-Jun-2020 20:37:32 CEST pre-events\r\ngrabNextFile Failed to deserialize JSON file -: \"./data/run000100/run000100_ls0001_index000000_pid28154.jsn\"\r\nERROR:\r\n* Line 2, Column 20\r\n  Missing ',' or ']' in array declaration\r\nCONTENT:\r\n{\r\n   \"data\" : [ \"20\" ],\r\n   \"definition\" : \"./ramdisk//run000100/jsd/rawData.jsd\",\r\n   \"source\" : \"lxplus709.cern.ch_28075\"\r\n}\r\n.\r\n%MSG\r\n%MSG-e EvFDaqDirector:  (NoModuleName) 19-Jun-2020 20:37:32 CEST pre-events\r\ngrabNextFile runtime Exception -: Cannot deserialize input JSON file\r\n%MSG\r\ncmsRun: /tmp/smorovic/CMSSW_11_1_0_pre8/src/EventFilter/Utilities/src/FedRawDataInputSource.cc:1013: void FedRawDataInputSource::readSupervisor(): Assertion `eventsInNewFile >= 0' failed.\r\n```\r\nAssertion is consequence of the previous failure.\r\n\r\n#### PR validation:\r\nTested manually and traced to be introduced between CMSSW_11_1_0_pre7 and CMSSW_11_1_0_pre8.\r\nTest scripts in EventFilter/Utilities/test:\r\n - startBU.py (terminate manually after 10 seconds) and startFU.py, or\r\n - LocalRunBUFU.sh (with a log file in /tmp)\r\n\r\nFailure mode is currently not covered with any automatic unit tests, as there have been issues implementing and running those reliably with DAQ file locking mechanism (also, for Run3 use of JSON files at HLT input stage is being phased out).\r\n\r\nEquivalent PR will be created also for 11_1_X branch because currently this breaks release use in DAQ/HLT.", "branch": "master", "changed_files": 1, "closed_at": "1592852156", "comments": 26, "commits": 3, "created_at": "1592587247", "deletions": 1, "labels": ["code-checks-approved", "comparison-available", "daq-approved", "fully-signed", "orp-approved", "reconstruction-approved", "tests-approved"], "merge_commit_sha": "a35ffede08b9d1b3f829427d525866a7105067fa", "merged_at": "1592852156", "merged_by": "cmsbuild", "milestone": "CMSSW_11_2_X", "number": 30315, "release-notes": [], "review_comments": 3, "state": "closed", "title": "Revert change causing regression in DAQ/HLT JSON input parsing", "updated_at": "1592852156", "user": "smorovic"}