{"additions": 47, "auther_ref": "triton-fallback", "auther_sha": "5ac7b0b71081a7fa41b62ff38cda038fdaf18197", "author": "aandvalenzuela", "body": "This PR checks if singularity supports unprivileged user namespace before running `DRNTest` unit test (module `RecoEcal/EgammaClusterProducers`), that is required for running singularity in singularity. It is the same check as in https://github.com/cms-sw/cmssw/blob/master/HeterogeneousCore/SonicTriton/test/unittest.sh#L45-L59, so I have factored it out in `Utilities/ReleaseScripts/scripts/singularity-check.sh`.\r\n\r\nWe are getting `DRNTest` unit test errors in non-amd64 archs \r\n```\r\n----- Begin Fatal Exception 14-Dec-2022 05:29:48 CET-----------------------\r\nAn exception of category 'FallbackFailed' occurred while\r\n   [0] Calling beginJob\r\nException Message:\r\nTritonService: Starting the fallback server failed with exit code 256\r\n----- End Fatal Exception -------------------------------------------------\r\n14-Dec-2022 05:29:48 CET  Closed file root://eoscms.cern.ch//eos/cms/store/user/cmsbuild/store/mc/RunIISummer20UL18RECO/DoubleElectron_Pt-1To300-gun/AODSIM/FlatPU0to70EdalIdealGT_EdalIdealGT_106X_upgrade2018_realistic_v11_L1v1_EcalIdealIC-v2/270000/4CDD9457-E14C-D84A-9BD4-3140CB6AEEB6.root\r\nFailure using cmsRun: status 65\r\nstatus = 16640\r\n\r\n---> test DRNTest had ERRORS\r\n```\r\nbecause these require nested containers that are not supported yet. In addition, the container image to run inside singularity is also not available (See https://github.com/cms-sw/cmssw/issues/37767#issuecomment-1114959598).\r\n", "branch": "master", "changed_files": 3, "comments": 23, "commits": 2, "created_at": "1671110981", "deletions": 18, "labels": ["reconstruction-pending", "core-pending", "pending-signatures", "tests-approved", "orp-pending", "code-checks-approved", "heterogeneous-pending"], "milestone": "CMSSW_13_0_X", "number": 40329, "release-notes": [], "review_comments": 5, "state": "open", "title": "Avoid known Triton fallback server failure in DRNTest (RecoEcal/EgammaClusterProducers)", "updated_at": "1673594748", "user": "aandvalenzuela"}