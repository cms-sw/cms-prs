{"additions": 2, "auther_ref": "patch-94", "auther_sha": "17b12feda445182c079f5f1e2f7919fb8453c677", "author": "slava77", "body": "the transformation from `q/p, lambda, phi -> p{x,y,z}` depends significantly on precision for high momentum tracks. While most of the math in the `jacobianCurvilinearToCartesian` is in double, the initial step in the momentum space relied on float precision atan to get the polar and azimuth angles, which is extracted only to immediately call sincos.\r\nThe angle extraction is not necessary considering that the input momentum is in Cartesian coordinates.\r\n\r\nTested on 1000 muons generated in [0.5 ,1000] GeV range, comparing full double precision implementation with  other alternatives at the state conversion of tracking seeds: the number of converted covariances with a fractional change larger than 1e-3 in any of the cov matrix elements goes down by a factor of just over 100.\r\n\r\nA more precise alternative is to convert the input momentum from `GlobalVector` (float precision) to a double-precision version. This, however has a slightly larger computational cost.\r\n\r\n@mtosi @VinInn @vmariani @mmusich \r\n\r\n", "branch": "master", "changed_files": 1, "closed_at": "1623708152", "comments": 14, "commits": 2, "created_at": "1623544977", "deletions": 4, "labels": ["code-checks-approved", "fully-signed", "orp-approved", "simulation-approved", "tests-approved"], "merge_commit_sha": "3cfe754753f47ed9ca1b08f2cdb4da188418808b", "merged_at": "1623708152", "merged_by": "cmsbuild", "milestone": "CMSSW_12_0_X", "number": 34103, "release-notes": [], "review_comments": 1, "state": "closed", "title": "improve precision in jacobianCurvilinearToCartesian", "updated_at": "1623708152", "user": "slava77"}