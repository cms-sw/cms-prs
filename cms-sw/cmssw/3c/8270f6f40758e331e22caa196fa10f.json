{"additions": 1378, "auther_ref": "dirsim_dynamic_conditions", "auther_sha": "2afe7cdad306422012c3f224d11239dc99934b55", "author": "CTPPS", "body": "#### PR description:\r\n\r\nThis PR improves the [PPS direct simulation](https://twiki.cern.ch/twiki/bin/viewauth/CMS/TaggedProtonsDirectSimulation) by allowing for non-constant conditions during a single cmsRun execution. This is essential for PPS since the relevant conditions (often LHC related) change during each year (often at LHC Technical Stop, \"TS\").\r\n\r\nThe proposed solution was presented in [Proton POG meeting](https://indico.cern.ch/event/962678/contributions/4050007/attachments/2115486/3561622/dynamic_conditions.pdf). In short, there's a new ES setup module which randomly generates conditions relevant for PPS simulation (at configurable frequency). The random generation follows distributions extracted from data, in proportions following the integrated luminosity.\r\n\r\n#### PR validation:\r\n\r\nThe two PDF summaries below compare the results obtained with SW before (blue) and after (red dashed) this PR.\r\n * [reco_cmp.pdf](https://github.com/cms-sw/cmssw/files/5573982/reco_cmp.pdf) - no difference in data reconstruction (as expected)\r\n * [dirsim_cmp.pdf](https://github.com/cms-sw/cmssw/files/5573981/dirsim_cmp.pdf) - some differences in direct simulation (as expected)\r\n    * before this PR, the simulation could be performed only for a single period, thus the \"per year\" rows miss the blue curve\r\n    * row \"2016\", the two periods (pre- and post-TS2) are correctly represented in the xangle histogram (185 an 140 urad, resp) and with the correct weight (higher L_int in pre-TS2)\r\n    * row \"2016 postTS2\" - perfect agreement before vs. after as expected\r\n    * row \"2017\": both beta* values (0.4 for pre-TS2 and 0.3 for post-TS2) are correctly represented\r\n    * rows \"2017_postTS2\" and \"2018_postTS2\" - compatible shapes but not perfect overlap - expected since this PR changes the order or random values generations, thus the samples of xangles/beta* are a little different\r\n", "branch": "master", "changed_files": 40, "closed_at": "1607417502", "comments": 24, "commits": 30, "created_at": "1605878855", "deletions": 663, "labels": ["alca-approved", "code-checks-approved", "comparison-available", "db-approved", "dqm-approved", "fully-signed", "geometry-approved", "orp-approved", "tests-approved", "urgent"], "merge_commit_sha": "b4e0fd7159c008551a540965ceb0f91e1e4e41b9", "merged_at": "1607417502", "merged_by": "cmsbuild", "milestone": "CMSSW_11_3_X", "number": 32207, "release-notes": [], "review_comments": 0, "state": "closed", "title": "dynamic conditions for PPS direct simulation", "updated_at": "1607417502", "user": "jan-kaspar"}