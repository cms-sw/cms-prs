{"additions": 131, "auther_ref": "fix_Phase2TrackerAssociation", "auther_sha": "84e1a67e86eda936d7d06b0218cb11fa826bec14", "author": "abbiendi", "body": "This is a bugfix to the muon validation for Phase2 upgrade.\r\n\r\nThe standard muon validation was silently broken for Phase2 (since 81X, while it worked in 620_SLHCx), due to changes in the Tracker data formats. In particular the outer tracker hits were not associated at all in the TrackerHitAssociator, due to the missing format Phase2TrackerRecHit1D.\r\nThis bug was not spotted until now in the standard muon validation as no threshold was asked in the fraction of shared hits. By applying minimum thresholds as in the configuration of the New validation this became apparent. \r\nThe TrackerHitAssociator has been kindly updated by Bill Ford (@wmtford). It is also meant to be used for tracker hit validation.\r\n\r\nThis PR has been tested on SingleMuonPt100 RelVal (with Phase2 conditions 2023 D4T) generated in CMSSW_9_1_0_pre5. \r\nThe current validation (OldVal, soon to become obsolete) wrt to plain CMSSW_9_1_0_pre5 is at:\r\nhttps://cmsdoc.cern.ch/cms/Physics/muon/CMSSW/Performance/RecoMuon/Validation/val/test_NewValidation_fix_Phase2TrackerAssociation/RelValSingleMuPt100Extended_UP2023D4T_noPU/OldVal-fix_Phase2TrackerAssociation_Vs_910pre5/\r\n\r\nThe comparison of the New validation with respect to the current one is obtained by applying this PR on top of the PR#18290, and is visible here:\r\nhttps://cmsdoc.cern.ch/cms/Physics/muon/CMSSW/Performance/RecoMuon/Validation/val/test_NewValidation_fix_Phase2TrackerAssociation/RelValSingleMuPt100Extended_UP2023D4T_noPU/fix_Phase2TrackerAssociation-910pre5-NEWVal_Vs_OLDVal/\r\n\r\nComments:\r\n- In the current validation (OldVal) there is almost no difference for base Tracker tracks or Global muons, due to the zero thresholds (that's why this bug did not break anything before), see:\r\nhttps://cmsdoc.cern.ch/cms/Physics/muon/CMSSW/Performance/RecoMuon/Validation/val/test_NewValidation_fix_Phase2TrackerAssociation/RelValSingleMuPt100Extended_UP2023D4T_noPU/OldVal-fix_Phase2TrackerAssociation_Vs_910pre5/probeTrks.pdf\r\n\r\nor: https://cmsdoc.cern.ch/cms/Physics/muon/CMSSW/Performance/RecoMuon/Validation/val/test_NewValidation_fix_Phase2TrackerAssociation/RelValSingleMuPt100Extended_UP2023D4T_noPU/OldVal-fix_Phase2TrackerAssociation_Vs_910pre5/extractedGlobalMuons.pdf\r\n\r\n- however for Displaced tracks and displaced Global muons there are large effects, see:\r\nhttps://cmsdoc.cern.ch/cms/Physics/muon/CMSSW/Performance/RecoMuon/Validation/val/test_NewValidation_fix_Phase2TrackerAssociation/RelValSingleMuPt100Extended_UP2023D4T_noPU/OldVal-fix_Phase2TrackerAssociation_Vs_910pre5/displacedTrks.pdf\r\nand: https://cmsdoc.cern.ch/cms/Physics/muon/CMSSW/Performance/RecoMuon/Validation/val/test_NewValidation_fix_Phase2TrackerAssociation/RelValSingleMuPt100Extended_UP2023D4T_noPU/OldVal-fix_Phase2TrackerAssociation_Vs_910pre5/displacedGlobalMuons.pdf\r\n\r\n- Comparing the NEW vs OLD validation the observed features are all expected for base muon collections\r\n\r\n- For displaced tracks and global muons the comparison of NEW vs OLD validation demonstrates clearly the improvements of the NEW one, in terms of sharpness. In particular there is a reduced efficiency and increased fake rate in the New validation, as a consequence of the quality cuts. This shows that the recovery of efficiency obtained by this PR on the current (OLD) validation is just recovering low quality tracks. In other words there seems to be a real reconstruction problem with the reconstruction of displaced tracks and displaced global muons. (obviously this has to do with reconstruction, not with its validation)\r\n\r\nThis bugfix is needed (quite urgently) for muon performance studies for Phase2 TDRs.\r\n@calabria  @HuguesBrun @calderona\r\n\r\n", "branch": "master", "changed_files": 5, "closed_at": "1493300974", "comments": 31, "commits": 4, "created_at": "1492091856", "deletions": 70, "labels": ["comparison-available", "dqm-approved", "fully-signed", "orp-pending", "simulation-approved", "tests-approved", "upgrade-approved"], "merge_commit_sha": "8adaf872fc9d1c3f61a3688ecc073023e9ff700b", "merged_at": "1493300974", "merged_by": "davidlange6", "milestone": "CMSSW_9_1_X", "number": 18354, "release-notes": [], "review_comments": 6, "state": "closed", "title": "Fix phase2 tracker association", "updated_at": "1493300975", "user": "abbiendi"}