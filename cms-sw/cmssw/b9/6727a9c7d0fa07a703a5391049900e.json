{"additions": 1846, "auther_ref": "14_1-pr-HLT-compatible-LHCInfoPer-PopCon", "auther_sha": "38b493d5fb9a34aa155f2229b91f51acededbc94", "author": "JanChyczynski", "body": "#### PR description:\r\n\r\nUpdate of the duringFill mode of LHCInfoPer* O2Os to be able to write to HLT and express tags complying to the synchronization rules. It writes only one (or none) payload at execution and writes to an IOV corresponding to a lumisection not yet processed by HLT. It's achieved by using `OnlineDBOutputService::writeIOVForNextLumisection` instead of `PoolDBOutputService::writeMany`. The O2Os in duringFill now uses `OnlinePopCon` and `OnlinePopConAnalyzer` (implemented in #44927) instead of the original ones.\r\n\r\nDepends on the backport of #44927 which is https://github.com/cms-sw/cmssw/pull/46571 (has to be tested on top of it and merged after it)\r\n\r\nThere is a plan to add better unit tests (not necessarily in this PR).\r\n\r\n#### PR validation:\r\n\r\nTested by running the workflow in various states of LHC (stable beams, no stable beams etc.) for a few fills. Each time the logs procured and the uploaded payloads were examined.\r\nThe unit tests for the `duringFill` mode have been updated (although its extension is planned).\r\nExample commands for running the workflow:\r\n```\r\ncd CondTools/RunInfo/test/\r\ncmsRun ../python/LHCInfoPerLSPopConAnalyzer_cfg.py mode=duringFill destinationConnection=sqlite:test.db \\\r\nlastLumiFile='last_lumi.txt'  tag=perls_test_tag startTime='2022-06-26 15:43:20.000'\r\n\r\ncmsRun ../python/LHCInfoPerFillPopConAnalyzer_cfg.py mode=duringFill destinationConnection=sqlite:fill_during/test.db \\\r\nlastLumiFile='last_lumi.txt' tag=perfill_test_tag  startTime='2022-06-26 15:43:20.000'\r\n```\r\n\r\n#### Backport \r\nBackport of https://github.com/cms-sw/cmssw/pull/45395\r\n", "branch": "CMSSW_14_1_X", "changed_files": 17, "closed_at": "1742288176", "comments": 15, "commits": 1, "created_at": "1730391538", "deletions": 1395, "labels": ["db-pending", "pending-signatures", "tests-approved", "orp-pending", "hold", "requires-external", "backport-ok"], "milestone": "CMSSW_14_1_X", "number": 46572, "release-notes": [], "review_comments": 0, "state": "closed", "title": "[14_1] HLT-compatible LHCInfoPer* PopCon (duringFill mode)", "updated_at": "1742288177", "user": "JanChyczynski"}