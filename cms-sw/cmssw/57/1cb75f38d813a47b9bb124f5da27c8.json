{"additions": 74, "auther_ref": "addProtectionToL1TMonitorClient_12_4_X", "auther_sha": "48e423760114aad5b4284872afe7d8627d237425", "author": "mmusich", "body": "backport of https://github.com/cms-sw/cmssw/pull/38493\r\n\r\n#### PR description:\r\n\r\nWhen trying to setup the unit tests for PR https://github.com/cms-sw/cmssw/pull/38463 I noticed that no matter what `HARVESTING` flavor one chose, if the input histograms for the L1T harvesting are not available the process crashed as:\r\n\r\n```bash\r\nThread 1 (Thread 0x7f4b1bb6a540 (LWP 26954) \"cmsRun\"):\r\n#0  0x00007f4b1da0addd in poll () from /lib64/libc.so.6\r\n#1  0x00007f4b16f6773f in full_read.constprop () from /cvmfs/cms-ib.cern.ch/week0/slc7_amd64_gcc10/cms/cmssw/CMSSW_12_5_X_2022-06-23-2300/lib/slc7_amd64_gcc10/pluginFWCoreServicesPlugins.so\r\n#2  0x00007f4b16f680cc in edm::service::InitRootHandlers::stacktraceFromThread() () from /cvmfs/cms-ib.cern.ch/week0/slc7_amd64_gcc10/cms/cmssw/CMSSW_12_5_X_2022-06-23-2300/lib/slc7_amd64_gcc10/pluginFWCoreServicesPlugins.so\r\n#3  0x00007f4b16f6aa1b in sig_dostack_then_abort () from /cvmfs/cms-ib.cern.ch/week0/slc7_amd64_gcc10/cms/cmssw/CMSSW_12_5_X_2022-06-23-2300/lib/slc7_amd64_gcc10/pluginFWCoreServicesPlugins.so\r\n#4  <signal handler called>\r\n#5  0x00007f4ad3a7ade9 in L1TdeCSCTPGClient::processHistograms(dqm::implementation::IGetter&) () from /cvmfs/cms-ib.cern.ch/week0/slc7_amd64_gcc10/cms/cmssw/CMSSW_12_5_X_2022-06-23-2300/lib/slc7_amd64_gcc10/pluginDQML1TMonitorClient.so\r\n#6  0x00007f4ad3a17c6d in DQMEDHarvester::endLuminosityBlockProduce(edm::LuminosityBlock&, edm::EventSetup const&) () from /cvmfs/cms-ib.cern.ch/week0/slc7_amd64_gcc10/cms/cmssw/CMSSW_12_5_X_2022-06-23-2300/lib/slc7_amd64_gcc10/pluginDQML1TMonitorClient.so\r\n#7  0x00007f4b2047285d in edm::one::EDProducerBase::doEndLuminosityBlock(edm::LumiTransitionInfo const&, edm::ModuleCallingContext const*) () from /cvmfs/cms-ib.cern.ch/week0/slc7_amd64_gcc10/cms/cmssw/CMSSW_12_5_X_2022-06-23-2300/lib/slc7_amd64_gcc10/libFWCoreFramework.so\r\n```\r\n\r\nI propose to fix the issue by putting in place some protection to stop executing the harvesting if the input histograms are not available.\r\n\r\n#### PR validation:\r\n\r\nUsing the files at `/afs/cern.ch/user/m/musich/public/L1THarvFix/` the process doesn't crash.\r\n\r\n#### If this PR is a backport please specify the original PR and why you need to backport that PR. If this PR will be backported please specify to which release cycle the backport is meant for:\r\n\r\nbackport of https://github.com/cms-sw/cmssw/pull/38493, as requested at https://github.com/cms-sw/cmssw/pull/38493#issuecomment-1264124788", "branch": "CMSSW_12_4_X", "changed_files": 3, "closed_at": "1664689236", "comments": 7, "commits": 1, "created_at": "1664631045", "deletions": 0, "labels": ["dqm-approved", "fully-signed", "tests-approved", "bug-fix", "orp-approved", "backport-ok"], "merge_commit_sha": "05e4830e4b2507d1f15e3ecbff1c05c329ec1216", "merged_at": "1664689236", "merged_by": "cmsbuild", "milestone": "CMSSW_12_4_X", "number": 39561, "release-notes": [], "review_comments": 0, "state": "closed", "title": "[12.4.X] add protection against missing input histograms in L1Tde* clients", "updated_at": "1664689236", "user": "mmusich"}