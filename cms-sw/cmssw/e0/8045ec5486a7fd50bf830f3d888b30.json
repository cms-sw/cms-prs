{"additions": 18, "auther_ref": "tensorflow-disable-gpu-tests", "auther_sha": "fcc3e4fbb27693c684d5da32abb136b0be663edf", "author": "valsdav", "body": "#### PR description:\r\n\r\nThis PR improves the handling of CUDA unit tests for the TensorFlow package, using a new `tf_cuda_support` tool from scram , which checks if the GPU support is enabled in TensorFlow compilation. \r\n\r\nThe PR also makes the TF cuda tests more strict by checking explicitely if a CUDA device is visible to TF and not only to cmssw.  \r\n\r\nThe test `testTFVisibleDevicesCUDA` is in fact run by the framework as a CUDA device is registered, but then TF does not recognize the device and the test fails.   The other `testTF*CUDA` tests were passing silently using the CPU to run the test.  After this PR all the TF sessions using  `tf::backend::cuda` , but  not finding a GPU will fail explicitly. \r\n\r\n- This PR is needed to continue the integration of CUDA 12.4 in https://github.com/cms-sw/cmsdist/pull/9046. \r\n- This PR needs https://github.com/cms-sw/cmsdist/pull/9066 (thanks to @smuzaffar https://github.com/cms-sw/cmssw/pull/44376#issuecomment-1992693414)\r\n- This PR is a backport of https://github.com/cms-sw/cmssw/pull/44376", "branch": "CMSSW_14_0_X", "changed_files": 2, "comments": 17, "commits": 2, "created_at": "1710239027", "deletions": 7, "labels": ["fully-signed", "tests-approved", "orp-pending", "ml-approved"], "milestone": "CMSSW_14_0_X", "number": 44375, "release-notes": [], "review_comments": 0, "state": "open", "title": "[backport] Improve handling of TF CUDA tests for 14_0_X", "updated_at": "1719872209", "user": "valsdav"}