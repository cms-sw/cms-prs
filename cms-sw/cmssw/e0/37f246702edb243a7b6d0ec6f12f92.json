{"additions": 13, "auther_ref": "clusterTPAssociationSort", "auther_sha": "734f8c6348738c4e2e1bc7fc469ee22ca5c2a2c7", "author": "makortel", "body": "I noticed the `ClusterTPAssociation` can contain multiple associations from a cluster to a single TrackingParticle. This can happen despite of `ClusterTPAssociationProducer` already having already a logic for adding only one entry for each cluster-to-SimTrack association. But electron TrackingParticles can consist of multiple SimTracks, and therefore the existing logic is not enough. I decided to enhance the sort comparison function and use `std::unique` at the end as that's likely faster than doing any additional existence checks before the insertion, especially given that it does not happen very often.\r\n\r\nWhile e.g. the track-to-TrackingParticle association (i.e. `QuickTrackAssociatorByHits`) is not affected, some other analyses may be affected because of the duplicated entries. E.g. here is one affected piece from standard workflows (FYI @smoortga)\r\nhttps://github.com/cms-sw/cmssw/blob/master/Validation/RecoB/plugins/BDHadronTrackMonitoringAnalyzer.cc#L218-L246\r\n(this PR provides a bug fix and in all cases the number of clusters / TrackingParticle should decrease)\r\n\r\nTested in CMSSW_9_1_0_pre3, expecting changes in the BDHadron monitoring.\r\n\r\n@rovere @VinInn ", "branch": "master", "changed_files": 2, "closed_at": "1502255108", "comments": 16, "commits": 1, "created_at": "1499681970", "deletions": 2, "labels": ["bug-fix", "comparison-available", "fully-signed", "orp-approved", "simulation-approved", "tests-approved"], "merge_commit_sha": "1464f2f25a118a1ba73359236404b42b3ebbd284", "merged_at": "1502255108", "merged_by": "cmsbuild", "milestone": "CMSSW_9_3_X", "number": 19637, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Fix cluster-to-TrackingParticle associations for duplicate entries", "updated_at": "1502255108", "user": "makortel"}