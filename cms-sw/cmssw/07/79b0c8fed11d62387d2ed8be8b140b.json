{"additions": 1399, "auther_ref": "JetMatchingEWKFxFx_12412", "auther_sha": "e4139aa6c526523d0c38d9d45bc471f5f76d9518", "author": "Cvico", "body": "Backport of https://github.com/cms-sw/cmssw/pull/39996, intended for Run3 MC production. I've checked with the GEN conveners and since I'm interested in 2022 production, I would need the plugin in CMSSW_12_4_X. \r\n\r\n**PR description**:\r\n\r\nThis PR includes a plugin that allows to run an alternative Pythia8 FxFx jet matching prescription. The plugin has been implemented using the PluginFactory and the code has been directly taken from the new JetMaching.h file that can be found [here](http://amcatnlo.web.cern.ch/amcatnlo/FxFx_merging.htm). As stated in the link, this new jet matching algorithm only works in Pythia8.3 and beyond.\r\n\r\nNew versions of Madgraph5_aMC@NLO (v3.3.0 and beyond) introduce a new clustering procedure that distinguishes between jets that have been generated in a QCD or EWK vertex. This new jet matching prescription is required so the proper treatment of jets is also accounted for in the parton shower (PS) and matrix element matching step.\r\n\r\nAn example of its usage can be found in [this fragment example](https://github.com/Cvico/cmssw/blob/JetMatchingEWKFxFx/GeneratorInterface/Pythia8Interface/python/FxFxEWK.py). Basically, the user needs to apply two modifications to the common fragments used for FxFx merging:\r\n\r\n1) Turn off Pythia8 default matching so new matchings can be add applied UserHooks. This can be done by adding the following line into the process parameters of the fragment:\r\n```\r\n    'JetMatching:doVeto = off',  # Turn OFF Pythia JetMatching\r\n```\r\n\r\n2) Include the new matching as a UserHook via the UserCustmization method.\r\n```\r\n    UserCustomization = cms.VPSet(\r\n           cms.PSet(pluginName = cms.string(\"JetMatchingEWKFxFx\"))\r\n           ),\r\n```\r\n\r\n**PR validation**:\r\n\r\nTests using the [local config file](https://github.com/Cvico/cmssw/blob/JetMatchingEWKFxFx/GeneratorInterface/Pythia8Interface/python/FxFxEWK.py) show that the JetMatchingEWKFxFx plugin properly matches between Pythia8.3 and MG33X gridpacks.\r\n        A set of preliminary results for ttW production can be found [here](https://indico.cern.ch/event/1192555/contributions/5086026/attachments/2525008/4342613/ttWnewFxFxSample_CarlosVico_TMG10oct.pdf).\r\n", "branch": "CMSSW_12_4_X", "changed_files": 5, "closed_at": "1675760334", "comments": 6, "commits": 6, "created_at": "1675672788", "deletions": 0, "labels": ["generators-approved", "fully-signed", "tests-approved", "orp-approved"], "merge_commit_sha": "f6f505dedb56d39f13defb66ae5a5ca7ad8d554d", "merged_at": "1675760334", "merged_by": "cmsbuild", "milestone": "CMSSW_12_4_X", "number": 40702, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Backport of new FxFx JetMatching plugin for Run3", "updated_at": "1675760335", "user": "Cvico"}