{"additions": 1, "auther_ref": "hostname_correct", "auther_sha": "213b6843929792b82b548baaa5b82a8aef8c548f", "author": "4quarks", "body": "#### PR description:\r\n\r\nThe piece of code [1] does the following: get the position of the first colon \":\" and defines the hostname variable with anything that is before that colon. This supposition is based on the case that you have a hostname and a port i.e. `cms-xrd-global01.cern.ch:1094` --> hostname is `cms-xrd-global01.cern.ch`. However, the information is not always available and therefore, when a raw IPv6 gets there, the output is incorrect as the information before the first colon is just the first octet of the IP i.e.`[2001` from `[2001:760:4205:128::128:232]:1094`. \r\n\r\nWith the small change of using the cpp function `find_last_of` this problem is solved. Because it will try to find the last colon and get everything before it. This resolves both scenarios `cms-xrd-global01.cern.ch:1094` and `[2001:760:4205:128::128:232]:1094`.\r\n\r\nThanks in advance. \r\n\r\n[1] \r\n```\r\nbool Source::getHostname(const std::string &id, std::string &hostname) {\r\n  size_t pos = id.find_last_of(':');\r\n  hostname = id;\r\n  if ((pos != std::string::npos) && (pos > 0)) {\r\n    hostname = id.substr(0, pos);\r\n```\r\n\r\n#### PR validation:\r\nYou can run a manual HammerCloud test as explained on the Twiki  https://twiki.cern.ch/twiki/bin/view/CMSPublic/CMSHammerCloud#Manual_execution\r\nI've already done it and it works fine. \r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\nThis could be backported even to the CMSSW_9_2_6 version which is what is being used in production on HammerCloud.\r\n", "branch": "master", "changed_files": 1, "comments": 6, "commits": 4, "created_at": "1654784159", "deletions": 1, "labels": ["core-pending", "pending-signatures", "tests-pending", "orp-pending", "code-checks-pending"], "milestone": "CMSSW_12_5_X", "number": 38309, "release-notes": [], "review_comments": 3, "state": "open", "title": "Correct hostname retrieval from Source::getHostname", "updated_at": "1657864531", "user": "4quarks"}