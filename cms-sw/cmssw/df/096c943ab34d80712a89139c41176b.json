{"additions": 187, "auther_ref": "CMSSW_10_4_X_2018-11-09-1100/sign1055/eleSeedVector", "auther_sha": "2e345f43554f30ba3597c0fe56bd051f3f658e10", "author": "slava77", "body": "instead of making a trivial merge-by-copy done in newCombinedSeeds, pass the inputs directly to the ElectronSeedProducer.\r\nThis PR avoids extra work spent in copying and reduces the memory utilization.\r\n- ElectronSeedProducer and its utility methods are updated to be able to take a vector of seed collections as input\r\n- ```newCombinedSeeds``` remains in the sequence definitions as a placeholder (it is not running in unscheduled mode because it is not consumed). I did not completely remove ```newCombinedSeeds``` yet pending some better understanding if the concept of combining seeds is useful in general (perhaps it is): it will be very easy to introduce a non-trivial seed combiner (e.g. with hit filter or other manipulation).\r\n\r\nInspired by observations of large memory use in HIHardProbes processing\r\nhttps://slava77sk.web.cern.ch/slava77sk/reco/cgi-bin/igprof-navigator/CMSSW_10_3_1_patch1-orig.cmsRunGlibC.PromptReco_Run326383_HIHardProbes.IgProf.1.MEM_LIVE/20\r\nThis is on event 326383:1:51371 (at the end of the first event in the job).\r\n\r\nTested in CMSSW_10_3_1_patch1\r\n- Using the profile for one event as a reference of a bad case of memory use, as much as 5GB reduction in the peak can be expected. Given stochastic nature of getting a peak in multi-threaded execution, the reduction is probably smaller.\r\n- comparison of peaks in 8-thread execution shows 2.1GB reduction in the peak after 2h of running and 3.0 GiB after 21h (the job is still running as of submission time [numbers to be updated]).\r\n- short matrix tests pass and comparisons show no differences\r\n", "branch": "master", "changed_files": 7, "closed_at": "1542036279", "comments": 15, "commits": 4, "created_at": "1541969482", "deletions": 159, "labels": ["code-checks-approved", "comparison-available", "fully-signed", "orp-approved", "reconstruction-approved", "tests-approved"], "merge_commit_sha": "524e28755c5b8e1561a2dcbb7aa0dee96816a0c7", "merged_at": "1542036279", "merged_by": "cmsbuild", "milestone": "CMSSW_10_4_X", "number": 25199, "release-notes": [], "review_comments": 0, "state": "closed", "title": "elide newCombinedSeeds in electron seeding", "updated_at": "1542039630", "user": "slava77"}