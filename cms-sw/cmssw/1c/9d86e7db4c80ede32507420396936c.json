{"additions": 15, "auther_ref": "fixSiPixelCalCosmics_forRun3_12_0_X", "auther_sha": "a89a2b31473bd1c3441d738595eca600333c611d", "author": "mmusich", "body": "backport of https://github.com/cms-sw/cmssw/pull/35371\r\n\r\n#### PR description:\r\n\r\nIt has been found out that the `SiPixelCalCosmics` ALCARECO produced exactly zero events for the full CRUZET [link to DAS](https://cmsweb.cern.ch/das/request?input=dataset%3D%2FCosmics%2FCommissioning2021-SiPixelCalCosmics-PromptReco-v1%2FALCARECO&instance=prod/global).\r\nThe issue has been traced to the logical mistake when migrating the `DPGAnalysis/Skims/src/DetStatus.cc` class to not use the `DCSStatus` from scalers, but from `DCSRecord` from the software FED `#1022` to extract `DCSRecord` (see PR cms-sw/cmssw#29198).\r\nFrom Run3 we won't have scalers, so the new path in the code started to be exercised only during CRUZET'21. \r\nSince the final boolean `accept` was initialized to `false` the final result of the filter was always `false` leading to no events saved.\r\n\r\n#### PR validation:\r\n\r\nTested succesfully the following `cmsDriver` command:\r\n\r\n```\r\ncmsDriver.py -s RAW2DIGI,RECO,ALCA:SiPixelCalCosmics --data --scenario cosmics --conditions 121X_dataRun3_Prompt_v1 --eventcontent=ALCARECO --datatier ALCARECO -n 100000 --no_exec --era Run3 --python_filename=SiPixelCalCosmics_2021_v1.py --nThreads=8 --dasquery='file dataset=/Cosmics/Commissioning2021-v1/RAW run=344421'\r\n```\r\n\r\nwhich was giving 0 events before and gives now:\r\n\r\n```\r\nFile SiPixelCalCosmics.root Events 110\r\nBranch Name | Average Uncompressed Size (Bytes/Event) | Average Compressed Size (Bytes/Event) \r\nrecoMuons_muons__RECO. 5225.97 2831.74\r\nrecoTrackExtras_ALCARECOSiPixelCalCosmics__RECO. 595.264 465.6\r\nrecoTracks_ALCARECOSiPixelCalCosmics__RECO. 689.636 427.618\r\nSiStripClusteredmNewDetSetVector_ALCARECOSiPixelCalCosmics__RECO. 787.964 403.218\r\nSiPixelClusteredmNewDetSetVector_ALCARECOSiPixelCalCosmics__RECO. 492.236 365.427\r\nTrackingRecHitsOwned_ALCARECOSiPixelCalCosmics__RECO. 2010.9 306.336\r\nrecoCaloMuons_muons__RECO. 354 238.782\r\nEventAuxiliary 118.6 40.5727\r\nedmTriggerResults_TriggerResults__HLT. 172.436 28.9091\r\nEventProductProvenance 870.864 22.8182\r\nEventSelections 78.6455 4.81818\r\nBranchListIndexes 25.7364 3.01818\r\n```\r\nI profit of this PR to change the  `AndOr`  in the configuration to take the `OR` of the BPIx and FPix DCS bits, instead of the AND after consultation with the pixel offline group.\r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\n\r\nThis is combined backport of https://github.com/cms-sw/cmssw/pull/35371 and https://github.com/cms-sw/cmssw/pull/35378", "branch": "CMSSW_12_0_X", "changed_files": 2, "comments": 9, "commits": 2, "created_at": "1632383701", "deletions": 6, "labels": ["alca-approved", "fully-signed", "tests-approved", "orp-pending", "pdmv-approved", "bug-fix", "urgent", "backport-ok"], "milestone": "CMSSW_12_0_X", "number": 35379, "release-notes": [], "review_comments": 0, "state": "open", "title": "fix `SiPixelCalCosmics` for Run3: logical mistake in DetStatus [12_0_X]", "updated_at": "1632411635", "user": "mmusich"}