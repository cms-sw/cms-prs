{"additions": 6, "auther_ref": "tensorflow-nosign-warn", "auther_sha": "db6b06727293e33f6752ac033bc9e8c99247fb8f", "author": "dan131riley", "body": "#### PR description:\r\n\r\nPhysicsTools/TensorFlow doesn't compile with optimization off.  Compiling with\r\n```\r\nUSER_CXXFLAGS=\"-g -O0\" scram b\r\n```\r\nresults in many \"integer expressions of different signedness\" warnings that we promote to errors:\r\n```\r\n/cvmfs/cms.cern.ch/slc7_amd64_gcc900/external/tensorflow/2.3.1/include/tensorflow/core/platform/default/logging.h:370:29: error: comparison of integer expressions of different signedness: 'const size_t' {aka 'const long unsigned int'} and int' [-Werror=sign-compare]\r\n  370 |     if (TF_PREDICT_FALSE(v2 >= std::numeric_limits<int>::max())) {        \\\r\n      |                          ~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n/cvmfs/cms.cern.ch/slc7_amd64_gcc900/external/tensorflow/2.3.1/include/tensorflow/core/platform/macros.h:83:47: note: in definition of macro 'TF_PREDICT_FALSE'\r\n   83 | #define TF_PREDICT_FALSE(x) (__builtin_expect(x, 0))\r\n      |                                               ^\r\n/cvmfs/cms.cern.ch/slc7_amd64_gcc900/external/tensorflow/2.3.1/include/tensorflow/core/platform/default/logging.h:381:1: note: in expansion of macro 'TF_DEFINE_CHECK_OP_IMPL'\r\n  381 | TF_DEFINE_CHECK_OP_IMPL(Check_EQ,\r\n      | ^~~~~~~~~~~~~~~~~~~~~~~\r\n```\r\nApparently with the optimizer on these get optimized away and hence don't trigger the diagnostic.  This PR turns off the GCC sign-compare diagnostic for the TensorFlow include files.\r\n\r\n#### PR validation:\r\n\r\nChecked compilation following a \"git cms-checkdeps -a\".  Also checked that CLANG does not need any similar pragma (it doesn't issue a warning), and doesn't issue an error or warning for the GCC pragmas.  Since this is a purely technical change it shouldn't result in any performance changes.", "branch": "master", "changed_files": 2, "closed_at": "1612978702", "comments": 15, "commits": 2, "created_at": "1612873383", "deletions": 0, "labels": ["code-checks-approved", "orp-pending", "pending-signatures", "reconstruction-pending", "tests-pending"], "milestone": "CMSSW_11_3_X", "number": 32852, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Get PhysicsTools/TensorFlow to compile with optimization off", "updated_at": "1612978702", "user": "dan131riley"}