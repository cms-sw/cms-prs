{"additions": 7, "auther_ref": "HLTriggerJSONL1PreFix_1250pre3", "auther_sha": "b8fddbbc634c509997f63a5b9fe46bd6e6c94ff8", "author": "Sam-Harper", "body": "#### PR description:\r\n\r\nHLTriggerJSONMonitoring is how the HLT reports path rates to OMS.  It was updated in Jun (https://github.com/cms-sw/cmssw/pull/38418) to better support DatasetPaths.\r\n\r\nIn doing so a bug was introduced in that if a path is after a dataset path, the wrong L1 and prescale module will be identified. \r\n\r\nAdditionally the logic was improved to only consider the first seed module and also to disregard ignored modules. This fixes problems in some paths which have additional L1 seed modules which are ignored as they want to use this data later in the path.  \r\n\r\nCredit goes to Adelina Lintuluoto  (@alintulu) for spotting this issue  in the hilton tests. \r\n\r\n#### PR validation:\r\n\r\nTesting a menu which had the bug rates output with and without the patch (these paths are after a dataset path)\r\n\r\n\r\npre fix -> post fix \r\n```\r\n< HLT_SingleEle8_v1                                                      500           500              0 \r\n< HLT_SingleEle8_SingleEGL1_v1                                           500           500              9 \r\n---\r\n> HLT_SingleEle8_v1                                                       19             0              0 \r\n> HLT_SingleEle8_SingleEGL1_v1                                            17            17              9 \r\n```\r\nand for the second bug  with paths which have multiple L1 seed modules\r\n```\r\n< HLT_DoubleMediumDeepTauPFTauHPS30_L2NN_eta2p1_PFJet60_v2                19            59              2 \r\n< HLT_DoubleMediumDeepTauPFTauHPS30_L2NN_eta2p1_PFJet75_v2                16            48              1 \r\n< HLT_IsoMu24_eta2p1_MediumDeepTauPFTauHPS30_L2NN_eta2p1_CrossL1_v2             0             5              0 \r\n< HLT_IsoMu24_eta2p1_MediumDeepTauPFTauHPS30_L2NN_eta2p1_PFJet60_CrossL1_v2             0             5              0 \r\n< HLT_IsoMu24_eta2p1_MediumDeepTauPFTauHPS30_L2NN_eta2p1_PFJet75_CrossL1_v2             0             5              0 \r\n---\r\n> HLT_DoubleMediumDeepTauPFTauHPS30_L2NN_eta2p1_PFJet60_v2                59            59              2 \r\n> HLT_DoubleMediumDeepTauPFTauHPS30_L2NN_eta2p1_PFJet75_v2                48            48              1 \r\n> HLT_IsoMu24_eta2p1_MediumDeepTauPFTauHPS30_L2NN_eta2p1_CrossL1_v2             5             5              0 \r\n> HLT_IsoMu24_eta2p1_MediumDeepTauPFTauHPS30_L2NN_eta2p1_PFJet60_CrossL1_v2             5             5              0 \r\n> HLT_IsoMu24_eta2p1_MediumDeepTauPFTauHPS30_L2NN_eta2p1_PFJet75_CrossL1_v2             5             5              0 \r\n```\r\n\r\nyou can see how it goes from impossible values to the  correct values (cant have more objects passing prescaler than L1 seed module for a correctly designed path)\r\n\r\n\r\n", "branch": "master", "changed_files": 1, "comments": 4, "commits": 1, "created_at": "1666191016", "deletions": 4, "labels": ["hlt-pending", "pending-signatures", "orp-pending", "tests-started", "bug-fix", "code-checks-approved"], "milestone": "CMSSW_12_6_X", "number": 39779, "release-notes": [], "review_comments": 2, "state": "open", "title": "Fixing bug in HLTriggerJSONMonitoring L1 and prescale module idenfication", "updated_at": "1666194214", "user": "Sam-Harper"}