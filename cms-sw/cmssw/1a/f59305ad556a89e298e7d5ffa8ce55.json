{"additions": 54, "auther_ref": "LowPtElectronsFull_102X_update", "auther_sha": "71cfe2546449d28806e079e75cc2526746c23fd5", "author": "bainbrid", "body": "__This PR provides incremental changes on top of #25887.__\r\n\r\n__This PR includes fixes to the SuperCluster class included in #25960 and #25974.__\r\n\r\n__This PR requires the following external: cms-data/RecoEgamma-ElectronIdentification#13__\r\n\r\n---\r\n\r\nThis PR provide three changes:\r\n\r\n__1) It includes fixes to the SuperCluster class.__\r\n\r\nThe fixes are back ported from #25960 and #25974: \r\n- fix a memory use after free error caught by ASAN;\r\n- avoid creating and using unnecessary edm::Refs; \r\n- removes a single line of code that was responsible for duplicating edm::Refs to ECAL clusters. \r\n\r\nThe timing and footprint numbers below have been updated to reflect these fixes.\r\n\r\n__2) It provides the back port of #25915.__\r\n\r\nThe change is very small and concerns the only the `LowPtGsfElectronSeedValueMapsProducer` class, which produces ValueMaps that store the discriminator values from the BDT models used in the `LowPtGsfElectronSeedProducer`.\r\n\r\nThe ValueMaps originally stored the BDT outputs per GsfElectrons, but we need them per GsfTrack. There is a near (but not exact) 1-to-1 correspondence between GsfElectrons and GsfTracks, so the ValueMaps will increase moderately in size (at the few tens of % level, not orders of magnitude!) and they will use a different key. Quantitive numbers on timing and footprint can be found in the conversation of #25915.\r\n\r\n__3) It uses new BDT models and working points.__\r\n\r\nThe models are found in cms-data/RecoEgamma-ElectronIdentification#13.\r\n\r\nThe working points have been tuned to rate balance w.r.t. the old WPs. Updated numbers are provided below, based on 11024 TTbar (PU50).\r\n\r\n__Timing:__\r\n```\r\nThe same excluding the first 1 events\r\n  delta/mean delta/orJob     original                   new       module name\r\n  ---------- ------------     --------                  ----       ------------\r\n       added      +0.00%         0.00 ms/ev ->         0.15 ms/ev selectedPatLowPtElectrons\r\n       added      +8.21%         0.00 ms/ev ->      1222.58 ms/ev lowPtGsfElectronSeeds\r\n       added      +0.00%         0.00 ms/ev ->         0.57 ms/ev slimmedLowPtElectrons\r\n       added      +0.01%         0.00 ms/ev ->         0.85 ms/ev lowPtElectronMatch\r\n       added      +2.22%         0.00 ms/ev ->       330.50 ms/ev lowPtGsfEleGsfTracks\r\n       added      +0.01%         0.00 ms/ev ->         2.06 ms/ev patLowPtElectrons\r\n       added      +0.43%         0.00 ms/ev ->        63.31 ms/ev lowPtGsfEleCkfTrackCandidates\r\n       added      +0.07%         0.00 ms/ev ->        10.39 ms/ev lowPtGsfElePfTracks\r\n       added      +0.38%         0.00 ms/ev ->        56.14 ms/ev lowPtGsfElePfGsfTracks\r\n       added      +0.00%         0.00 ms/ev ->         0.05 ms/ev lowPtGsfElectronSeedValueMaps\r\n       added      +0.02%         0.00 ms/ev ->         2.77 ms/ev lowPtGsfElectronID\r\n       added      +0.13%         0.00 ms/ev ->        18.65 ms/ev lowPtGsfElectronCores\r\n       added      +0.89%         0.00 ms/ev ->       132.60 ms/ev lowPtGsfElectrons\r\n       added      +0.20%         0.00 ms/ev ->        29.43 ms/ev lowPtGsfElectronSuperClusters\r\n                 +12.57%                            1870.05 ms/ev\r\n  ---------- ------------     --------                  ----       ------------\r\nJob total:  14.8827 s/ev ==> 16.9203 s/ev\r\n```\r\n\r\n__RECO footprint:__\r\n```\r\n-----------------------------------------------------------------\r\n   or, B         new, B      delta, B   delta, %   deltaJ, %    branch\r\n-----------------------------------------------------------------\r\n      0.0 ->       312.3        312     NEWO   0.01     recoGsfElectronCores_lowPtGsfElectronCores__RECO\r\n      0.0 ->       252.9        253     NEWO   0.01     floatedmValueMap_lowPtGsfElectronID__RECO\r\n      0.0 ->     13477.6      13478     NEWO   0.38     recoCaloClusters_lowPtGsfElectronSuperClusters__RECO\r\n      0.0 ->      2198.6       2199     NEWO   0.06     recoSuperClusters_lowPtGsfElectronSuperClusters__RECO\r\n      0.0 ->      6474.3       6474     NEWO   0.18     recoGsfTracks_lowPtGsfEleGsfTracks__RECO\r\n      0.0 ->       264.5        264     NEWO   0.01     floatedmValueMap_lowPtGsfElectronSeedValueMaps_ptbiased_RECO\r\n      0.0 ->       262.8        263     NEWO   0.01     floatedmValueMap_lowPtGsfElectronSeedValueMaps_unbiased_RECO\r\n      0.0 ->     14082.6      14083     NEWO   0.40     recoGsfElectrons_lowPtGsfElectrons__RECO\r\n-------------------------------------------------------------\r\n  3541675 ->     3578709      37035             1.0     ALL BRANCHES\r\n```\r\n\r\n__MINIAOD footprint:__\r\n```\r\n-----------------------------------------------------------------\r\n   or, B         new, B      delta, B   delta, %   deltaJ, %    branch\r\n-----------------------------------------------------------------\r\n      0.0 ->     12017.7      12018     NEWO   15.22    recoCaloClusters_lowPtGsfElectronSuperClusters__RECO\r\n      0.0 ->     19327.0      19327     NEWO   24.48    patElectrons_slimmedLowPtElectrons__RECO\r\n      0.0 ->       345.5        346     NEWO   0.44     recoGsfElectronCores_lowPtGsfElectronCores__RECO\r\n      0.0 ->       200.8        201     NEWO   0.25     floatedmValueMap_lowPtGsfElectronSeedValueMaps_ptbiased_RECO\r\n      0.0 ->       195.3        195     NEWO   0.25     floatedmValueMap_lowPtGsfElectronID__RECO\r\n      0.0 ->       199.4        199     NEWO   0.25     floatedmValueMap_lowPtGsfElectronSeedValueMaps_unbiased_RECO\r\n      0.0 ->      6594.4       6594     NEWO   8.35     recoGsfTracks_lowPtGsfEleGsfTracks__RECO\r\n      0.0 ->      2125.1       2125     NEWO   2.69     recoSuperClusters_lowPtGsfElectronSuperClusters__RECO\r\n-------------------------------------------------------------\r\n    78956 ->      120018      41062            52.0     ALL BRANCHES\r\n```\r\n", "branch": "CMSSW_10_2_X", "changed_files": 6, "comments": 22, "commits": 6, "created_at": "1550162550", "deletions": 48, "labels": ["comparison-available", "orp-pending", "pending-signatures", "reconstruction-rejected", "requires-external", "tests-approved"], "milestone": "CMSSW_10_2_X", "number": 25936, "release-notes": [], "review_comments": 0, "state": "open", "title": "Final BDT models based on 10.2 MC samples", "updated_at": "1551103061", "user": "bainbrid"}