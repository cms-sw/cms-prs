{"additions": 54, "auther_ref": "LowPtElectronsFull_102X_update", "auther_sha": "71cfe2546449d28806e079e75cc2526746c23fd5", "author": "bainbrid", "body": "__This PR provides incremental changes on top of #25887.__\r\n\r\n__This PR includes fixes to the SuperCluster class included in #25960 and #25974.__\r\n\r\n__This PR requires the following external: cms-data/RecoEgamma-ElectronIdentification#13__\r\n\r\n---\r\n\r\nThis PR provide three changes:\r\n\r\n__1) It includes fixes to the SuperCluster class.__\r\n\r\nThe fixes are back ported from #25960 and #25974: \r\n- fix a memory use after free error caught by ASAN;\r\n- avoid creating and using unnecessary edm::Refs; \r\n- removes a single line of code that was responsible for duplicating edm::Refs to ECAL clusters. \r\n\r\n__2) It provides the back port of #25915.__\r\n\r\nThe change is very small and concerns the only the `LowPtGsfElectronSeedValueMapsProducer` class, which produces ValueMaps that store the discriminator values from the BDT models used in the `LowPtGsfElectronSeedProducer`.\r\n\r\nThe ValueMaps originally stored the BDT outputs per GsfElectrons, but we need them per GsfTrack. There is a near (but not exact) 1-to-1 correspondence between GsfElectrons and GsfTracks, so the ValueMaps will increase moderately in size (at the few tens of % level, not orders of magnitude!) and they will use a different key. Quantitive numbers on timing and footprint can be found in the conversation of #25915.\r\n\r\n__3) It uses new BDT models and working points.__\r\n\r\nThe models are found in cms-data/RecoEgamma-ElectronIdentification#13.\r\n\r\nThe working points have been tuned to rate balance w.r.t. the old WPs. Updated numbers are provided below, based on 11024 TTbar (PU50).\r\n\r\n__Timing:__\r\n```\r\nThe same excluding the first 1 events\r\n  delta/mean delta/orJob     original                   new       module name\r\n  ---------- ------------     --------                  ----       ------------\r\n       added      +0.00%         0.00 ms/ev ->         0.28 ms/ev selectedPatLowPtElectrons\r\n       added      +7.43%         0.00 ms/ev ->      1176.98 ms/ev lowPtGsfElectronSeeds\r\n       added      +0.00%         0.00 ms/ev ->         0.68 ms/ev slimmedLowPtElectrons\r\n       added      +0.01%         0.00 ms/ev ->         1.03 ms/ev lowPtElectronMatch\r\n       added      +2.19%         0.00 ms/ev ->       346.59 ms/ev lowPtGsfEleGsfTracks\r\n       added      +0.01%         0.00 ms/ev ->         2.23 ms/ev patLowPtElectrons\r\n       added      +0.44%         0.00 ms/ev ->        68.98 ms/ev lowPtGsfEleCkfTrackCandidates\r\n       added      +0.07%         0.00 ms/ev ->        11.07 ms/ev lowPtGsfElePfTracks\r\n       added      +0.37%         0.00 ms/ev ->        59.16 ms/ev lowPtGsfElePfGsfTracks\r\n       added      +0.00%         0.00 ms/ev ->         0.09 ms/ev lowPtGsfElectronSeedValueMaps\r\n       added      +0.04%         0.00 ms/ev ->         6.62 ms/ev lowPtGsfElectronID\r\n       added      +0.12%         0.00 ms/ev ->        18.79 ms/ev lowPtGsfElectronCores\r\n       added      +0.83%         0.00 ms/ev ->       132.21 ms/ev lowPtGsfElectrons\r\n       added      +0.18%         0.00 ms/ev ->        28.82 ms/ev lowPtGsfElectronSuperClusters\r\n                 +11.69%                           1,853.53 ms/ev\r\n  ---------- ------------     --------                  ----       ------------\r\nJob total:  15.8421 s/ev ==> 18.4928 s/ev\r\n```\r\n\r\n__RECO footprint:__\r\n```\r\n-----------------------------------------------------------------\r\n   or, B         new, B      delta, B   delta, %   deltaJ, %    branch\r\n-----------------------------------------------------------------\r\n      0.0 ->       305.1        305     NEWO   0.01     recoGsfElectronCores_lowPtGsfElectronCores__RECO.\r\n      0.0 ->       231.3        231     NEWO   0.01     floatedmValueMap_lowPtGsfElectronID__RECO.\r\n      0.0 ->      4997.1       4997     NEWO   0.14     recoCaloClusters_lowPtGsfElectronSuperClusters__RECO.\r\n      0.0 ->      1670.0       1670     NEWO   0.05     recoSuperClusters_lowPtGsfElectronSuperClusters__RECO.\r\n      0.0 ->      6348.5       6349     NEWO   0.18     recoGsfTracks_lowPtGsfEleGsfTracks__RECO.\r\n      0.0 ->       242.1        242     NEWO   0.01     floatedmValueMap_lowPtGsfElectronSeedValueMaps_ptbiased_RECO.\r\n      0.0 ->       238.6        239     NEWO   0.01     floatedmValueMap_lowPtGsfElectronSeedValueMaps_unbiased_RECO.\r\n      0.0 ->     12904.9      12905     NEWO   0.36     recoGsfElectrons_lowPtGsfElectrons__RECO.\r\n-------------------------------------------------------------\r\n  3536175 ->     3562951      26776             0.8     ALL BRANCHES\r\n```\r\n\r\n__MINIAOD footprint:__\r\n```\r\n-----------------------------------------------------------------\r\n   or, B         new, B      delta, B   delta, %   deltaJ, %    branch\r\n-----------------------------------------------------------------\r\n      0.0 ->      4792.7       4793     NEWO   6.06     recoCaloClusters_lowPtGsfElectronSuperClusters__RECO.\r\n      0.0 ->     17823.2      17823     NEWO   22.55    patElectrons_slimmedLowPtElectrons__RECO.\r\n      0.0 ->       353.5        353     NEWO   0.45     recoGsfElectronCores_lowPtGsfElectronCores__RECO.\r\n      0.0 ->       186.4        186     NEWO   0.24     floatedmValueMap_lowPtGsfElectronSeedValueMaps_ptbiased_RECO.\r\n      0.0 ->       180.8        181     NEWO   0.23     floatedmValueMap_lowPtGsfElectronID__RECO.\r\n      0.0 ->       182.5        183     NEWO   0.23     floatedmValueMap_lowPtGsfElectronSeedValueMaps_unbiased_RECO.\r\n      0.0 ->      6488.8       6489     NEWO   8.21     recoGsfTracks_lowPtGsfEleGsfTracks__RECO.\r\n      0.0 ->      1701.8       1702     NEWO   2.15     recoSuperClusters_lowPtGsfElectronSuperClusters__RECO.\r\n-------------------------------------------------------------\r\n    79028 ->      110634      31606            40.0     ALL BRANCHES\r\n\r\n", "branch": "CMSSW_10_2_X", "changed_files": 6, "comments": 6, "commits": 6, "created_at": "1550162550", "deletions": 48, "labels": ["analysis-pending", "comparison-pending", "orp-pending", "pending-signatures", "reconstruction-pending", "tests-pending"], "milestone": "CMSSW_10_2_X", "number": 25936, "release-notes": [], "review_comments": 0, "state": "open", "title": "Final BDT models based on 10.2 MC samples", "updated_at": "1550764968", "user": "bainbrid"}