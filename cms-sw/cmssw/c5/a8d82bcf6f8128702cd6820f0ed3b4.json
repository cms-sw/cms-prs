{"additions": 43, "auther_ref": "fixmonopole", "auther_sha": "a2f5f9dde7fcafc439725d10e042dbe04c235bd0", "author": "makortel", "body": "Two fixes for G4Monopole in multithreaded sim:\n- monopole-specific G4ChordFinder that is thread-local in ChordFinderSetter is now set in the worker threads instead of the master thread\n- In CMSMonopolePhysics, do not associate G4ProcessManager to G4Monopole instance but use the association done in G4VUserPhysicsList::InitializeProcessManager() (that is MT-aware)\n\nIn addition, redirect G4cout to LogVerbatim (in CustomUIsession) and trim the trailing newline. This way the verbose output from OscarProducer does not get garbled by the message context information. I decided to keep G4cerr to be redirected to LogWarning, because for by-default-visible messages it is probably better to keep the context information.\n\nTested in CMSSW_7_2_GEANT10_X_2014-09-16-1400 with 100 events of\n\n```\ngit clone git@github.com:cms-sw/GenProductions Configuration/GenProductions\n\ncmsDriver.py Configuration/GenProductions/python/EightTeV/monopoles_cff.py -s GEN,SIM --conditions auto:mc --datatier GEN-SIM  --eventcontent=FEVTDEBUGHLT --customise Configuration/GenProductions/monopoles_customise.monopoles_customise --fileout file:mp.root --mc -n 10 --no_exec \n```\n\nResults from serial OscarProducer are the identical before and after this PR, and after this PR the results from serial and 1-thread OscarMTProducer are identical.\n", "branch": "CMSSW_7_3_X", "changed_files": 5, "closed_at": "1411447574", "comments": 7, "commits": 2, "created_at": "1411375899", "deletions": 7, "labels": ["comparison-available", "fully-signed", "simulation-approved", "tests-approved"], "merge_commit_sha": "08722656fc0efc898ddfc88a2a0093766c0c7e8b", "merged_at": "1411447574", "merged_by": "nclopezo", "milestone": "Next CMSSW_7_3_X", "number": 5470, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Fix G4Monopole for MT", "updated_at": "1476951482", "user": "makortel"}