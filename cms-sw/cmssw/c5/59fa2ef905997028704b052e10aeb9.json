{"additions": 180, "auther_ref": "fixClusterTPPreSplitting", "auther_sha": "ec9462dd6e25371f00a5856e6a825f0b0d4186a0", "author": "makortel", "body": "There is a subtle bug in the current tracking validation setup in \"built tracks\" MultiTrackValidator variant for initialStepPreSplitting tracks. Because of the cluster splitting done in the initialStepPreSplitting iteration, it uses different pixel clusters (`siPixelClustersPreSplitting`) than the rest of the iterations (`siPixelClusters`). However, for the validation only a single the cluster->TrackingParticle mapping (`tpClusters` product) is created with the `siPixelClusters` as an input. When this mapping is queried in QuickTrackAssociatorByHits, there is no check for the `ProductID` of the (pixel) `OmniClusterRef`. In other words, for an `OmniClusterRef` from `siPixelClustersPreSplitting`, take the index of the `Ref` and check if an `OmniClusterRef` from `siPixelClusters` with the same index is matched to a TrackingParticle.\r\n\r\nThis PR fixes the problem in the following way\r\n* Store the key `ProductID`s in `ClusterTPAssociation`, and check it when querying for matching TrackingParticles\r\n   * This required adding dictionary for `edm::VecArray<ProductID, 2>`\r\n* Add a second instance of the cluster->TP mapping (`tpClustersPreSplitting`) for the PreSplitting clusters, and add an additional MTV instance only for the initialStepPreSplitting tracks.\r\n   * This means that the `initialStepPreSplitting` gets removed from the summary plots for seeds and built tracks\r\n   * I also moved all the producers to Tasks to make sure that they're always run unscheduled\r\n\r\n Tested in CMSSW_10_4_0_pre2, expecting changes in MTV seeding and built tracks summary and initialStepPreSplitting plots.\r\n\r\n@VinInn @mtosi @JanFSchulte @hajohajo", "branch": "master", "changed_files": 9, "closed_at": "1543680932", "comments": 14, "commits": 5, "created_at": "1543248452", "deletions": 113, "labels": ["code-checks-approved", "comparison-available", "core-approved", "dqm-approved", "fully-signed", "orp-approved", "simulation-approved", "tests-approved"], "merge_commit_sha": "51fc590a1aae572d8f29ce75a4cb6e5a37845351", "merged_at": "1543680932", "merged_by": "cmsbuild", "milestone": "CMSSW_10_4_X", "number": 25346, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Fix MTV validation of initialStepPreSplitting tracks", "updated_at": "1543680932", "user": "makortel"}