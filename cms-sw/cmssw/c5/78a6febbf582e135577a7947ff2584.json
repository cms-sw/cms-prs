{"additions": 223, "auther_ref": "speedup-cleaning-12_3_X", "auther_sha": "8cf58cdbffdefe26c71589dad08aa7332536b1df", "author": "leonardogiannini", "body": "#### PR description:\r\n\r\nThe seed cleaning algorithm (used in initial, high pT triplet, detached quad, and triplet) and the duplicate cleaning used in the pixelLess iteration are updated to reduce the processing time, while the physics is unchanged.\r\n\r\n- the seed cleaning is updated from an N^2 comparison of all the pairs to a comparison of the tracks that can be approximately \r\ncompatible for removal only. The tracks are binned in phi and eta and for each track, the comparison is made only inside compatible bins\r\n\r\n- the duplicate cleaning consisted of a nested loop comparing hits. The new algorithm uses 2 simple loops per track: 1 to map hits to tracks and the second to find all the tracks sharing hits with the one examined (similarly to [TrajectoryCleanerBySharedHits](https://github.com/cms-sw/cmssw/blob/master/TrackingTools/TrajectoryCleaning/src/TrajectoryCleanerBySharedHits.cc))\r\n\r\nThe seed cleaning update is described here:\r\n[Jan 31 update](https://indico.cern.ch/event/1117555/contributions/4701579/attachments/2381731/4069638/mkFit%20-%20update.pdf)\r\n\r\nThe duplicate cleaning is mentioned here (p.23):\r\n[Feb 14 update](https://indico.cern.ch/event/1128089/contributions/4735248/attachments/2390777/4086913/mkFit_TRKPOG_14February2022.pdf)\r\n\r\n\r\n#### PR validation:\r\n\r\nThe physics is validated with TTbar PU50, where blue is before PR and red is after PR\r\n\r\nhttp://uaf-10.t2.ucsd.edu/~legianni/PR-cmssw/plots-PR/\r\n\r\nCPU profiling with igprof can be found here  \r\n\r\n- old\r\n[global](https://legianni.web.cern.ch/legianni/cgi-bin/igprof-navigator/mkfit-update/igreport_perf_old)\r\n[seed cleaning](https://legianni.web.cern.ch/legianni/cgi-bin/igprof-navigator/mkfit-update/igreport_perf_old/636)\r\n[dup cleaning](https://legianni.web.cern.ch/legianni/cgi-bin/igprof-navigator/mkfit-update/igreport_perf_old/1002)\r\n- new\r\n[global](https://legianni.web.cern.ch/legianni/cgi-bin/igprof-navigator/mkfit-update/igreport_perf_new)\r\n[seed cleaning](https://legianni.web.cern.ch/legianni/cgi-bin/igprof-navigator/mkfit-update/igreport_perf_new/2139)\r\n[dup cleaning](https://legianni.web.cern.ch/legianni/cgi-bin/igprof-navigator/mkfit-update/igreport_perf_new/2048)\r\n", "branch": "master", "changed_files": 3, "comments": 11, "commits": 7, "created_at": "1646250904", "deletions": 433, "labels": ["reconstruction-pending", "pending-signatures", "tests-approved", "orp-pending", "urgent", "code-checks-approved"], "milestone": "CMSSW_12_3_X", "number": 37122, "release-notes": [], "review_comments": 0, "state": "open", "title": "Speed-up seed/dup. cleaning mkFit", "updated_at": "1646675240", "user": "leonardogiannini"}