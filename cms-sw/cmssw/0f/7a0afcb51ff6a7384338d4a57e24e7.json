{"additions": 404, "auther_ref": "devel_hltCustomPatatrackLimitOverrides2", "auther_sha": "29fdbadf087d60caea6898f7504de7712743df1a", "author": "missirol", "body": "#### PR description:\r\n\r\nThis PR updates `customizeHLTforPatatrack` to limit cases where the customisation overwrites modules that may already exist in the HLT menu (e.g. the `cpu` 'branch' of certain SwitchProducers).\r\n\r\n*Reminder* : currently, the HLT menu in `cmssw:master` contains the CPU part of the Patatrack developments (in other words, it contains SwitchProducers that only have a `cpu` branch, not a `cuda` one).\r\n\r\nWith this update, if a certain object exists already, it is not overwritten anymore, giving precedence to what is in the input configuration (usually, the HLT menu from `ConfDB`).\r\n\r\nIn particular, this resolves an action item from [CMSHLT-2187](https://its.cern.ch/jira/projects/CMSHLT/issues/CMSHLT-2187), regarding the value of the parameter `hltPixelTracksSoA.cpu.idealConditions`; the latter is set to `False` in `ConfDB`, but is currently changed to `True` in `customizeHLTforPatatrack`; with this PR, the parameter remains as in the HLT menu if it is already present (i.e. `False` with the latest menus).\r\n\r\nThe PR also includes\r\n - an addition to `customisePixelGainForRun2Input`, to ensure that the parameter `(SiPixelRawToClusterCUDA).isRun2` is set to `True` when Run-2 inputs are used (this would be needed once instances of `SiPixelRawToClusterCUDA` will come directly from the HLT config in `ConfDB`, with `isRun2` set to `False`);\r\n - a bugfix for the handling of `process.hltEcalRecHit.cuda` (the bug was introduced in #36536).\r\n\r\nChanges in outputs are expected for wfs where `customizeHLTforPatatrack` is applied to the `GRun` menu, e.g. wf `11634.{506,512,522}` (for example, because of `hltPixelTracksSoA.cpu.idealConditions` changing from `True` to `False`).\r\n\r\nProfited from suggestions by @fwyzard.\r\n\r\nFYI: @silviodonato\r\n\r\n#### PR validation:\r\n\r\n`runTheMatrix.py -w gpu -l 11634.506,11634.512,11634.522`, plus manual tests with `hltGetConfiguration [..] --customise [..]`.\r\n\r\n#### If this PR is a backport, please specify the original PR and why you need to backport that PR:\r\n\r\nN/A", "branch": "master", "changed_files": 2, "comments": 14, "commits": 5, "created_at": "1642413539", "deletions": 296, "labels": ["hlt-pending", "pending-signatures", "tests-pending", "orp-pending", "bug-fix", "code-checks-approved"], "milestone": "CMSSW_12_3_X", "number": 36721, "release-notes": [], "review_comments": 2, "state": "open", "title": "updates to `customizeHLTforPatatrack` to limit overwriting of HLT modules", "updated_at": "1643391451", "user": "missirol"}