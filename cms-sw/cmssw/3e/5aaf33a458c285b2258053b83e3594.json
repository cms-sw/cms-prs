{"additions": 69, "auther_ref": "fixNonInitializedHadronizerStat", "auther_sha": "7f52ce47a9b322e7385b60ce06b3fcc07ea6b41c", "author": "makortel", "body": "AddOn tests in #25577 showed a segfault in `Pythia8::Pythia::stat()` when an exception was thrown by another module in `beginRun()`\r\n```\r\n#4  <signal handler called>\r\n#5  0x00007f26e3093e01 in Pythia8::Pythia::stat() () from .../external/slc7_amd64_gcc700/lib/libpythia8.so\r\n#6  0x00007f26e5dbcca0 in Pythia8Hadronizer::statistics() () from .../lib/slc7_amd64_gcc700/pluginGeneratorInterfacePythia8Filters.so\r\n#7  0x00007f26e5df82ba in edm::GeneratorFilter<Pythia8Hadronizer, gen::ExternalDecayDriver>::endRunProduce(edm::Run&, edm::EventSetup const&) () from .../lib/slc7_amd64_gcc700/pluginGeneratorInterfacePythia8Filters.so\r\n#8  0x00007f27057736f3 in edm::one::EDFilterBase::doEndRun(edm::RunPrincipal const&, edm::EventSetup const&, edm::ModuleCallingContext const*) () from .../lib/slc7_amd64_gcc700/libFWCoreFramework.so\r\n#9  0x00007f2705728420 in edm::WorkerT<edm::one::EDFilterBase>::implDoEnd(edm::RunPrincipal const&, edm::EventSetup const&, edm::ModuleCallingContext const*) () from .../lib/slc7_amd64_gcc700/libFWCoreFramework.so\r\n```\r\nA unit test with `TestProcessor` (included) confirms the segfault in case the `Run` has no `LuminosityBlock`s (in which case the Pythia8's initialization has not been called). This PR suggests to add a boolean flag to `GeneratorFilter` template to avoid calling the `endRun` statistics printouts if the hadronizer+decayer have not been initialized (assuming the `endRun` printout is really needed).\r\n\r\nTested in 10_4_0_pre4, no changes expected.\r\n\r\n@Dr15Jones ", "branch": "master", "changed_files": 4, "comments": 11, "commits": 1, "created_at": "1546534393", "deletions": 3, "labels": ["code-checks-pending", "comparison-available", "generators-pending", "orp-pending", "pending-signatures", "tests-approved"], "milestone": "CMSSW_10_5_X", "number": 25579, "release-notes": [], "review_comments": 0, "state": "open", "title": "Avoid printing statistics if hadronizer has not been initialized properly", "updated_at": "1547540864", "user": "makortel"}