{"additions": 1, "auther_ref": "fc-fixD41-again", "auther_sha": "0c3767e058327404c667b6d4e484fc0f089e94c8", "author": "fabiocos", "body": "#### PR description:\r\n\r\nFollow-up of #26307 : the DetId for ETL negative size is correctly reconstructed in the geometry test, but within Geant4 the namespace of the volume is not present in the string list used to build the basename. This is now fixed. \r\n\r\n#### PR validation:\r\n\r\nThe residual issue was detected with the MTD validation package under preparation (PR to arrive independently). Enabling detailed verbosity within step1 of test workflows shows now that ETDetIds are correctly generated:\r\n\r\n```\r\n%MSG-d TimingSim:  OscarMTProducer:g4SimHits 03-Apr-2019 16:51:49 CEST  Run: 1 Event: 3 TimingSD.cc:139\r\nTimingSD:\r\n Global entry point: (-742.526,-533.83,-3031)\r\n Global exit  point: (-742.603,-533.88,-3031.3)\r\n Global step length: 0.313607\r\n Local  entry point: (20.7802,17.6108,0.15)\r\n Local  exit  point: (20.7776,17.5195,-0.15)\r\n Local  step length: 0.313607\r\n%MSG\r\n%MSG-i MtdSim:  OscarMTProducer:g4SimHits 03-Apr-2019 16:51:49 CEST  Run: 1 Event: 3\r\nMtdSD::getBaseNumber(): Adding level 0: EModule8Disc1Timingactive[1]\r\n%MSG\r\n%MSG-i MtdSim:  OscarMTProducer:g4SimHits 03-Apr-2019 16:51:49 CEST  Run: 1 Event: 3\r\nMtdSD::getBaseNumber(): Adding level 1: EModule8Disc1Timingwafer[1]\r\n%MSG\r\n%MSG-i MtdSim:  OscarMTProducer:g4SimHits 03-Apr-2019 16:51:49 CEST  Run: 1 Event: 3\r\nMtdSD::getBaseNumber(): Adding level 2: EModule8Disc1[124]\r\n%MSG\r\n%MSG-i MtdSim:  OscarMTProducer:g4SimHits 03-Apr-2019 16:51:49 CEST  Run: 1 Event: 3\r\nMtdSD::getBaseNumber(): Adding level 3: Ring8Disc1[1]\r\n%MSG\r\n%MSG-i MtdSim:  OscarMTProducer:g4SimHits 03-Apr-2019 16:51:49 CEST  Run: 1 Event: 3\r\nMtdSD::getBaseNumber(): Adding level 4: Disc1[1]\r\n%MSG\r\n%MSG-i MtdSim:  OscarMTProducer:g4SimHits 03-Apr-2019 16:51:49 CEST  Run: 1 Event: 3\r\nMtdSD::getBaseNumber(): Adding level 5: EndcapTimingLayer[1]\r\n%MSG\r\n%MSG-i MtdSim:  OscarMTProducer:g4SimHits 03-Apr-2019 16:51:49 CEST  Run: 1 Event: 3\r\nMtdSD::getBaseNumber(): Adding level 6: CALOECFront[1]\r\n%MSG\r\n%MSG-i MtdSim:  OscarMTProducer:g4SimHits 03-Apr-2019 16:51:49 CEST  Run: 1 Event: 3\r\nMtdSD::getBaseNumber(): Adding level 7: CALOECTSFront[1]\r\n%MSG\r\n%MSG-i MtdSim:  OscarMTProducer:g4SimHits 03-Apr-2019 16:51:49 CEST  Run: 1 Event: 3\r\nMtdSD::getBaseNumber(): Adding level 8: CALOEC[2]\r\n%MSG\r\n%MSG-i MtdSim:  OscarMTProducer:g4SimHits 03-Apr-2019 16:51:49 CEST  Run: 1 Event: 3\r\nMtdSD::getBaseNumber(): Adding level 9: CALO[1]\r\n%MSG\r\n%MSG-i MtdSim:  OscarMTProducer:g4SimHits 03-Apr-2019 16:51:49 CEST  Run: 1 Event: 3\r\nMtdSD::getBaseNumber(): Adding level 10: CMSE[1]\r\n%MSG\r\n%MSG-i MtdSim:  OscarMTProducer:g4SimHits 03-Apr-2019 16:51:49 CEST  Run: 1 Event: 3\r\nMtdSD::getBaseNumber(): Adding level 11: DDDWorld[0]\r\n%MSG\r\n%MSG-i MTDGeom:  OscarMTProducer:g4SimHits 03-Apr-2019 16:51:49 CEST  Run: 1 Event: 3\r\nETLNumberingScheme geometry levels = 12\r\n%MSG\r\n%MSG-i MTDGeom:  OscarMTProducer:g4SimHits 03-Apr-2019 16:51:49 CEST  Run: 1 Event: 3\r\nEModule8Disc1Timingactive, EModule8Disc1Timingwafer, EModule8Disc1, Ring8Disc1, Disc1, EndcapTimingLayer, CALOECFront, CALOECTSFront, CALOEC, CALO, CMSE, DDDWorld\r\n%MSG\r\n%MSG-i MTDGeom:  OscarMTProducer:g4SimHits 03-Apr-2019 16:51:49 CEST  Run: 1 Event: 3\r\nETL Numbering scheme:  ring = 8 zside = 0 module = 124 modtyp = 0 Raw Id = 1661484544[MTDDetId::print]  0110 0011 0000 1000 0011 1110 0000 0000\r\n rawId       : 0x63083e00\r\n bits[0:24]  : 01083e00\r\n Detector        : 6\r\n SubDetector     : 1\r\n MTD subdetector : 2\r\n ETL \r\n Side        : 0\r\n Ring        : 8\r\n Module      : 124\r\n Module type : 0\r\n\r\n%MSG\r\nTimingSD CreateNewHit for FastTimerHitsEndcap PV EModule8Disc1Timingactive PVid = 1 Unit 1661484544\r\n primary 1 Tof(ns)= 10.2171 time slice 1021 E(GeV)= 34070.9 trackID 1 mu+ parentID 0\r\n is primary particle\r\nupdateHit: FastTimerHitsEndcap add eloss(GeV) 8.66007e-05CurrentHit=0x7f7433b36140, PostStepPoint= (-742.603,-533.88,-3031.3)\r\n%MSG-d TimingSim:  OscarMTProducer:g4SimHits 03-Apr-2019 16:51:49 CEST  Run: 1 Event: 3 TimingSD.cc:139\r\nTimingSD:\r\n Global entry point: (-743.986,-534.771,-3036.7)\r\n Global exit  point: (-744.063,-534.82,-3037)\r\n Global step length: 0.313626\r\n Local  entry point: (21.5955,15.8952,-0.15)\r\n Local  exit  point: (21.6023,15.804,0.15)\r\n Local  step length: 0.313626\r\n%MSG\r\n%MSG-i MTDGeom:  OscarMTProducer:g4SimHits 03-Apr-2019 16:51:49 CEST  Run: 1 Event: 3\r\nETLNumberingScheme geometry levels = 12\r\n%MSG\r\n%MSG-i MTDGeom:  OscarMTProducer:g4SimHits 03-Apr-2019 16:51:49 CEST  Run: 1 Event: 3\r\nEModule8Disc1Timingactive, EModule8Disc1Timingwafer, EModule8Disc1, Ring8Disc1, Disc1, EndcapTimingLayer, CALOECFront, CALOECTSFront, CALOEC, CALO, CMSE, DDDWorld\r\n%MSG\r\n%MSG-i MTDGeom:  OscarMTProducer:g4SimHits 03-Apr-2019 16:51:49 CEST  Run: 1 Event: 3\r\nETL Numbering scheme:  ring = 8 zside = 0 module = 123 modtyp = 0 Raw Id = 1661484416[MTDDetId::print]  0110 0011 0000 1000 0011 1101 1000 0000\r\n rawId       : 0x63083d80\r\n bits[0:24]  : 01083d80\r\n Detector        : 6\r\n SubDetector     : 1\r\n MTD subdetector : 2\r\n ETL \r\n Side        : 0\r\n Ring        : 8\r\n Module      : 123\r\n Module type : 0\r\n\r\n%MSG\r\nTimingSD CreateNewHit for FastTimerHitsEndcap PV EModule8Disc1Timingactive PVid = 1 Unit 1661484416\r\n primary 1 Tof(ns)= 10.237 time slice 1023 E(GeV)= 34069.1 trackID 1 mu+ parentID 0\r\n is primary particle\r\n```\r\n\r\nSimHits are now visible in the test https://github.com/casarsa/cmssw/blob/mc-valMTD-devel-new/Validation/MtdValidation/plugins/EtlSimHitsValidation.cc as can be seen by the produced plots:\r\n\r\n[SimHitNeg.pdf](https://github.com/cms-sw/cmssw/files/3039609/SimHitNeg.pdf)\r\n[SimHitPos.pdf](https://github.com/cms-sw/cmssw/files/3039610/SimHitPos.pdf)\r\n", "branch": "master", "changed_files": 1, "closed_at": "1554385679", "comments": 13, "commits": 1, "created_at": "1554300207", "deletions": 1, "labels": ["bug-fix", "code-checks-approved", "comparison-available", "fully-signed", "geometry-approved", "orp-approved", "tests-approved", "upgrade-approved"], "merge_commit_sha": "d341f7bde333aaaacc4d15628970fda8f0f5d4a5", "merged_at": "1554385678", "merged_by": "cmsbuild", "milestone": "CMSSW_10_6_X", "number": 26344, "release-notes": [], "review_comments": 0, "state": "closed", "title": "MTD Geometry: avoid dependence on namespace in volume name string ", "updated_at": "1554385679", "user": "fabiocos"}