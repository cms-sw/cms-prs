{"additions": 230, "auther_ref": "FixPixelPerMix", "auther_sha": "9f0fe688339ebeff230284690e8546880622e59a", "author": "VinInn", "body": "PreMIx workflow was affected by a huge \"memmove\" storm during initialization (first event).\r\nIt was easy to locate it in SiPixelTemplate2D::pushfile.\r\nIn this purely technical PR all copies of vectors (of vectors (eventually of vectors)) have been removed.\r\n\r\nrunning just initialization using\r\n```\r\ncmsDriver tt_digi --no_exec --datamix PreMix --conditions auto:phase1_2022_realistic --pileup_input file:pu.root -n 16 --era Run3 --eventcontent RAWSIM --procModifiers premix_stage2 --filein file:gensim.root -s DIGI,DATAMIX,L1,DIGI2RAW,HLT:@relval2022 --datatier GEN-SIM-DIGI-RAW --geometry DB:Extended --nThreads 8 --suffix -j JobReport.xml --customise Validation/Performance/TimeMemorySummary.customiseWithTimeMemorySummary\r\n```\r\n\r\nmemory allocation is reduced\r\nfrom \r\n         5017054      kmem:mm_page_alloc\r\n          5835471      kmem:mm_page_free\r\nto\r\n          1341162      kmem:mm_page_alloc\r\n          2126517      kmem:mm_page_free\r\n\r\nwhile the system time goes down from\r\n61.298107000 seconds\r\nto\r\n21.264676000 seconds\r\n\r\n\r\nI made minimal changes preserving previous behavior.\r\nI leave to code owners any eventual further cleanup.\r\n\r\nNo change expected.\r\n\r\n", "branch": "master", "changed_files": 3, "comments": 0, "commits": 1, "created_at": "1673878810", "deletions": 175, "labels": ["reconstruction-pending", "alca-pending", "db-pending", "pending-signatures", "tests-pending", "orp-pending", "code-checks-pending"], "milestone": "CMSSW_13_0_X", "number": 40537, "release-notes": [], "review_comments": 1, "state": "open", "title": "remove memory-churn in SiPixelTemplate2D::pushfile", "updated_at": "1673878869", "user": "VinInn"}