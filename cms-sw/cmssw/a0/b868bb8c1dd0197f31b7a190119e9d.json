{"additions": 9, "auther_ref": "fixTTUTrackingAlg", "auther_sha": "a2912d56c7ab5989e0a3b194ac9f2d77902d9ee4", "author": "makortel", "body": "#### PR description:\r\n\r\nThis PR fixes a bug in the sorting comparison functions in `TTUTrackingAlg` that cause crashes reported in https://github.com/cms-sw/cmssw/issues/31258 and https://github.com/cms-sw/cmssw/issues/31410. The `std::sort` requires the comparison functor to meet the requirements of [`Compare`](https://en.cppreference.com/w/cpp/named_req/Compare) (loosely needs \"less than\"), which the current \"less or equal than\" does not meet, leading to undefined behavior. This PR changes the functors to use \"less than\" comparison.\r\n\r\nFurthermore, as pointed out in https://github.com/cms-sw/cmssw/issues/31258#issuecomment-683773504, this PR proposes to fix a logic bug in the code that assumes `std::sort()`  to be stable (it is not) by combining the two comparison operations into one, and replacing the function structs with lambdas.\r\n\r\nFor consistency this PR also changes the subsequent call to `std::unique()` to use a lambda instead of function object.\r\n\r\nResolves #31258.\r\n\r\n#### PR validation:\r\n\r\nThe crash reported in #31410 disappears, limited matrix runs.", "branch": "master", "changed_files": 2, "closed_at": "1599719127", "comments": 10, "commits": 3, "created_at": "1599688262", "deletions": 19, "labels": ["bug-fix", "code-checks-approved", "comparison-available", "l1-pending", "orp-approved", "pending-signatures", "tests-approved"], "merge_commit_sha": "57b5d0380fb8fd94cc6999f0deeaf6bb3b4e278a", "merged_at": "1599719127", "merged_by": "cmsbuild", "milestone": "CMSSW_11_2_X", "number": 31415, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Fix sorting in TTUTrackingAlg", "updated_at": "1599719128", "user": "makortel"}