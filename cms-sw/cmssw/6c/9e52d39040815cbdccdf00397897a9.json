{"additions": 274, "auther_ref": "jp_mm_scoutingMonitor_follow-up", "auther_sha": "cefc85015e7a47865c0f12b723cbf114e01f6e7a", "author": "cms-ngt-hlt", "body": "#### PR description:\r\n\r\nThis is a follow up from the PR made for the new DQMEDAnalyzer module ScoutingCollectionMonitor.cc [here](https://github.com/cms-sw/cmssw/pull/47922). This PR includes minor changes to that offline scouting DQM and we are changing its location to DQM/HLTEvF from HLTriggerOffline/Scouting, to enable online monitoring. The suggestions made from the Scouting community from the [meeting](https://indico.cern.ch/event/1538269/#14-dqm-developments-to-monitor) were implemented as well.\r\nAdditionally, we are introducing an online DQM client based on aforementioned module. This serves the HLT scouting community for online DQM but also for the Run 3 demonstrator of the Next Generation Trigger project, task 3.4. \r\n\r\nMain changes to ScoutingCollectionMonitor.cc itself:\r\n- adding plots of tracker dz and dxy calculated w.r.t. the closest primary vertex (closest in terms of choosing the track that minimizes dz)\r\n- adding plot of the tracker chi2 probability\r\n- adding plot of the tracker normalized chi2\r\n- removing empty plot (such as csv_pfj_hist)\r\n- adapting code s.t. it works for both online and offline monitoring\r\n- average PU and rho profile plot (offline only)\r\n- average PU and number of primary vertex profile plot (offline only)\r\n- other minor fixes that do not change the output\r\n\r\nThe new online monitor will put out the plots of ScoutingCollectionMonitor.cc, without the two plots involving average PU.\r\n\r\n\r\n\r\n#### PR validation:\r\n\r\nThe PR has been prepared starting from CMSSW_15_1_X_2025-05-07-2300:\r\n```\r\ncmsrel CMSSW_15_1_X_2025-05-07-2300\r\ncd CMSSW_15_1_X_2025-05-07-2300/src\r\ncmsenv\r\ngit cms-init\r\ngit cms-addpkg DQM/HLTEvF\r\ngit cms-addpkg DQM/Integrationgit cms-addpkg DQMOffline/HLTScouting\r\n```\r\nRunning `git cms-checkdeps -a -A` showed me that there are further dependencies to `DQMOffline/Configuration` . For validation, I ran:\r\n```\r\nscram b\r\nscram b code-checks\r\nscram b code-format\r\nscram b\r\n```\r\n\r\nTo validate the offline DQM, we run:\r\n```\r\nrunTheMatrix.py -l 145.415 -t 4 -j 8\r\n```\r\nwhich yields output files at step 3, called `DQM_V0001_R000382686__Global__CMSSW_X_Y_Z__RECO.root`.\r\n\r\nTo validate the online DQM, we run:\r\n```\r\nhltGetConfiguration /users/musich/tests/dev/CMSSW_15_0_0/NGT_DEMONSTRATOR/TestData/online/HLT/V1 \\\r\n            --globaltag 150X_dataRun3_Prompt_v1 \\\r\n            --data \\\r\n            --unprescale \\\r\n            --output all \\\r\n            --max-events 100 \\\r\n            --eras Run3_2024 --l1-emulator uGT --l1 L1Menu_Collisions2025_v1_0_0_xml \\\r\n            --input /store/data/Run2024I/EphemeralHLTPhysics0/RAW/v1/000/386/593/00000/91a08676-199e-404c-9957-f72772ef1354.root \\\r\n            > hltData.py\r\n\r\ncmsRun hltData.py \r\nmkdir output\r\ncmsRun DQM/Integration/python/clients/ngt_dqm_sourceclient-live_cfg.py inputFiles=outputLocalTestDataScouting.root\r\n```\r\nwhich yields in an output file of: `DQM_V0001_NGT_R000386593.root` .\r\n\r\n\r\nWe also ran the unit test as:\r\n```\r\nvoms-proxy-init --voms cms --valid 168:00\r\nexport CMS_PATH=\"/cvmfs/cms-ib.cern.ch\"\r\nexport SITECONFIG_PATH=\"/cvmfs/cms-ib.cern.ch/SITECONF/local\"\r\nscram b runtests_TestDQMOnlineClient-ngt_dqm_sourceclient\r\n```\r\nwhich did not result in an error.\r\n\r\n\r\nThis is not backport but it will be backported to 15.0.X for 2025 data taking operations.", "branch": "master", "changed_files": 6, "comments": 6, "commits": 8, "created_at": "1747307132", "deletions": 208, "labels": ["dqm-pending", "hlt-pending", "pending-signatures", "tests-pending", "orp-pending", "code-checks-approved"], "milestone": "CMSSW_15_1_X", "number": 48087, "release-notes": [], "review_comments": 0, "state": "open", "title": "Updates to the NGT DQM Scouting instance and introducing new NGT DQM scouting online client", "updated_at": "1747308384", "user": "jprendi"}