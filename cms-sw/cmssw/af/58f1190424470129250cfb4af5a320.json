{"additions": 4857, "auther_ref": "dev-106X-externalGeneratorFilter", "auther_sha": "c8f40842e935b7561fa3e6430ea625f1517745af", "author": "colizz", "body": "#### PR description:\r\n\r\nThis PR is a backport of `ExternalGeneratorFilter` module and the core implementations it depends on. It includes a collection of eight orginal PRs authored by @Dr15Jones.\r\n\r\n- Commit 1-3: [backport #28721 & #28759]: enable `TestProcessor` to support Run and Lumi product testing and to support external services. (commit cherry picking)\r\n- Commit 4: [backport #28792]: create `FWCore/SharedMemory` infrastructure to allow cmsRun to control an external process. Depends on commit 1-3.\r\n- Commit 5: [backport #28729]: add ability to set RandomEngineStates in Service.\r\n- Commit 6: [backport #29384]: test inter process random state transfers. Depends on commit 5.\r\n- Commit 7: [backport #29445]: **the main PR** that adds `ExternalGeneratorFilter` module to run `GeneratorFilter` in an external process controlled by cmsRun. Depends on commit 4, 5, 6.\r\n- Commit 8: [backport #30346]: allow `ExternalGeneratorFilter` to be pickled. Depends on commit 7.\r\n- Commit 9 (newly added): [backport #29611]: extend `ConfigBuilder` to properly handle special import handling. (commit cherry picking)\r\n\r\nFor compatibility purposes, small additional changes are made compared to original commits. Please see the details in each commit below.\r\n\r\n#### PR validation:\r\n\r\nThis PR passes the new unit tests that are introduced in the original backported PRs.\r\nIt is also tested on [`BPH-RunIIFall18GS-00222`](https://cms-pdmv.cern.ch/mcm/requests?page=0&prepid=BPH-RunIIFall18GS-00222) requested by Jordan. More validation to come.\r\n\r\n(a quick test for this PR)\r\n```shell\r\ncmsrel CMSSW_10_6_X_2020-07-07-2300\r\ncd CMSSW_10_6_X_2020-07-07-2300/src/\r\ncmsenv\r\ngit cms-merge-topic colizz:dev-106X-externalGeneratorFilter\r\ncurl -s --insecure https://cms-pdmv.cern.ch/mcm/public/restapi/requests/get_fragment/BPH-RunIIFall18GS-00222 --retry 2 --create-dirs -o Configuration/GenProduction/python/BPH-RunIIFall18GS-00222-fragment.py \r\nscram b -j 8\r\ncd ../..\r\ncmsDriver.py Configuration/GenProduction/python/BPH-RunIIFall18GS-00222-fragment.py --fileout file:BPH-RunIIFall18GS-00222.root --mc --eventcontent RAWSIM --datatier GEN-SIM --conditions 102X_upgrade2018_realistic_v11 --beamspot Realistic25ns13TeVEarly2018Collision --step GEN,SIM --nThreads 8 --geometry DB:Extended --era Run2_2018 --python_filename BPH-RunIIFall18GS-00222_1_cfg.py --no_exec --customise Configuration/DataProcessing/Utils.addMonitoring --customise_commands='from GeneratorInterface.Core.ExternalGeneratorFilter import ExternalGeneratorFilter; process.generator = ExternalGeneratorFilter(process.generator)' -n 1000\r\n\r\ncmsRun -e -j BPH-RunIIFall18GS-00222_rt.xml BPH-RunIIFall18GS-00222_1_cfg.py\r\n```", "branch": "CMSSW_10_6_X", "changed_files": 74, "closed_at": "1596530045", "comments": 25, "commits": 9, "created_at": "1594529703", "deletions": 32, "labels": ["comparison-available", "core-approved", "fully-signed", "generators-approved", "operations-approved", "orp-approved", "tests-approved"], "merge_commit_sha": "4797b8bc37e22e23393d7b5d4e1896d88a69f00f", "merged_at": "1596530045", "merged_by": "cmsbuild", "milestone": "CMSSW_10_6_X", "number": 30649, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Backport ExternalGeneratorFilter and core functions it depends on to 10_6_X", "updated_at": "1596530046", "user": "colizz"}