{"additions": 779, "auther_ref": "TritonShm", "auther_sha": "d92c6b4d003ba6acd85af751b51cfbe2b4c5d83f", "author": "kpedro88", "body": "#### PR description:\r\n\r\n* Added `allocate()` function to streamline creation of input vectors\r\n* Expanded unit testing: now two tests, one for CPU and one for GPU (each tests both gRPC and shared memory)\r\n* Shared memory used automatically (by default) for local fallback server (either CPU or GPU)\r\n* `useSharedMemory` client config parameter to disable this for a specific algorithm/producer\r\n* Shared memory regions are reused from one event to the next, and only reallocated if the existing region is too small; this is necessary to achieve performance improvements (otherwise the high cost of reallocating e.g. every event dwarfs any improvement)\r\n* Documentation updated accordingly\r\n\r\n#### PR validation:\r\n\r\nConfirmed that the same outputs are achieved whether using gRPC or shared memory, and unit tests pass as expected.\r\n\r\nTested performance of the two example models (ResNet50 and Graph Attention Network):\r\n* CPU shared memory: 3-12% faster (client-side), 3-4% faster (server-side)\r\n* GPU shared memory: 15-20% faster (client-side), 10-45% faster (server-side)\r\n\r\nThe performance improvements depend on the amount of data being transferred, as well as the size of the model (which controls how long the inference takes).\r\n\r\nThe impact of these latency decreases on throughput will be tested in the near future, once realistic workflows are prepared.\r\n\r\nTechnical details: this branch is squashed from several previous development branches.\r\n\r\nRequires: https://github.com/cms-sw/cmsdist/pull/6929", "branch": "master", "changed_files": 22, "closed_at": "1623969729", "comments": 48, "commits": 10, "created_at": "1621544180", "deletions": 204, "labels": ["code-checks-approved", "fully-signed", "heterogeneous-approved", "orp-approved", "requires-external", "tests-approved"], "merge_commit_sha": "55d652ba4cc5366b5b07b1584fa586a9cef880f1", "merged_at": "1623969729", "merged_by": "cmsbuild", "milestone": "CMSSW_12_0_X", "number": 33801, "release-notes": [], "review_comments": 58, "state": "closed", "title": "shared memory support for SonicTriton", "updated_at": "1623969729", "user": "kpedro88"}