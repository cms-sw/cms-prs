{"additions": 19, "auther_ref": "from-CMSSW_16_0_0_pre2", "auther_sha": "3509cacf00d495cd68b62a0e1be129af3bc06e1a", "author": "lviliani", "body": "This PR aims at making optional the container-in-container feature previously included.\r\n\r\nThe logic behind this implementation is:\r\n- keep the `run_generic_tarball_cvmfs.sh` back-compatible and include only minimal changes, e.g. without adding new optional positional parameters and altering the order of the existing ones.\r\n- change only the `run_generic_tarball_cvmfs.sh` script without touching the `ExternalLHEProducer`.\r\n\r\nThe solution I came up with is adding the `use_singularity` keyword as an optional argument. If this keyword is found, it will switch the corresponding flag and the event generation will be run through singularity, but all the additional optional parameters will be kept as they were previously (using the `set`  builtin).\r\n\r\nThere are for sure alternative solutions, so I would like to hear other experts opinion and I'm happy to adapt the script if needed.\r\n\r\nUsing this implementation, the singularity run will be triggered using the following ExternalLHEProducer snippet:\r\n```python\r\nexternalLHEProducer = cms.EDProducer(\"ExternalLHEProducer\",\r\n    args = cms.vstring('/cvmfs/cms.cern.ch/phys_generator/gridpacks/PATH_TO_GRIDPACK','use_singularity'),\r\n    nEvents = cms.untracked.uint32(5000),\r\n    numberOfParameters = cms.uint32(2),\r\n    outputFile = cms.string('cmsgrid_final.lhe'),\r\n    generateConcurrently = cms.untracked.bool(False),\r\n    scriptName = cms.FileInPath('GeneratorInterface/LHEInterface/data/run_generic_tarball_cvmfs.sh')\r\n)\r\n```\r\nWhich contains the additional `'use_singularity'` string in `args` and `numberOfParameters = cms.uint32(2)` instead of `1`.\r\n\r\nFYI: @DickyChant @vlimant @stlammel @srimanob @ckoraka ", "branch": "master", "changed_files": 1, "comments": 3, "commits": 1, "created_at": "1764607394", "deletions": 1, "labels": ["generators-pending", "pending-signatures", "tests-pending", "orp-pending", "code-checks-approved"], "milestone": "CMSSW_16_0_X", "number": 49527, "release-notes": [], "review_comments": 0, "state": "open", "title": "Make the container-in-container feature optional", "updated_at": "1764607520", "user": "lviliani"}