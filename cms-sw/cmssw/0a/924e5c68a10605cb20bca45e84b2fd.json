{"additions": 11, "auther_ref": "CMSSW-15-0-X-fix-repack-rawSkim-logic", "auther_sha": "368459bf0f95e6f0d5de883328b89756b66f2220", "author": "LinaresToine", "body": "#### PR description:\r\n\r\nAfter validating the output of the new feature developed in https://github.com/cms-sw/cmssw/pull/47525, we identified a bug in the logic in which the raw skim outputs are overwritten in the PSet file. I will provide details now:\r\n\r\n* When a stream is mapped to multiple PDs, it has different HLT paths in each output, one for each PD.\r\n* To make sure that we were selecting events based on the HLT path concerning one of the possible PDs, we create the process attribute in : https://github.com/cms-sw/cmssw/blob/master/Configuration/DataProcessing/python/Repack.py#L84\r\n* The issue is that this is in a loop for each output, so such `process.baseSelection` object gets overwritten.\r\n* The consequence is that when we enable `ReserveDMu` raw skim for `ParkingDoubleMuonLowMass0` and `ParkingDoubleMuonLowMass1`, we get identical outputs for each raw skim dataset.\r\n\r\nThe previous behavior can be seen in the PSet section:\r\n```\r\nprocess.baseSelection = cms.EDFilter(\"HLTHighLevel\",\r\n    HLTPaths = cms.vstring('Dataset_ParkingDoubleMuonLowMass1'),\r\n    TriggerResultsTag = cms.InputTag(\"TriggerResults\",\"\",\"HLT\"),\r\n    andOr = cms.bool(True),\r\n    eventSetupPathsKey = cms.string(''),\r\n    eventSetupPathsLabel = cms.string(''),\r\n    mightGet = cms.optional.untracked.vstring,\r\n    throw = cms.bool(True)\r\n)\r\n```\r\n\r\nI have placed the bugged PSet and corresponding output in:\r\n```\r\n/eos/home-c/cmst0/public/RawSkim/bugged\r\n```\r\n#### PR validation:\r\n\r\nWe tested the changes in this PR locally, and now we get relevant outputs. In summary, we see the following:\r\n* Input file: `/eos/cms/store/t0streamer/Data/ParkingDoubleMuonLowMass0/000/391/950/run391950_ls0003_streamParkingDoubleMuonLowMass0_StorageManager.dat` --> 321 events\r\n* `ParkingDoubleMuonLowMass0_ReserveDMu_RAW` --> 56 events\r\n* `ParkingDoubleMuonLowMass1_ReserveDMu_RAW` --> 32 events\r\n\r\nI have placed the new PSet and corresponding output in:\r\n```\r\n/eos/home-c/cmst0/public/RawSkim/fixed\r\n```\r\n\r\nThis PR is a backport to CMSSW_15_0_X for current datataking", "branch": "CMSSW_15_0_X", "changed_files": 1, "comments": 4, "commits": 1, "created_at": "1747149547", "deletions": 5, "labels": ["operations-pending", "pending-signatures", "orp-pending", "tests-started", "backport"], "milestone": "CMSSW_15_0_X", "number": 48070, "release-notes": [], "review_comments": 0, "state": "open", "title": "Backport-CMSSW_15_0_X-fix-Repack-RawSkim-Logic", "updated_at": "1747160994", "user": "LinaresToine"}