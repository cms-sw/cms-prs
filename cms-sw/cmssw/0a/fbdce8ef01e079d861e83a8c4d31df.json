{"additions": 216, "auther_ref": "devel_hltTriggerResultsFilterThrow", "auther_sha": "e355f21d36c73b01e3e1a286c7da202048600602", "author": "missirol", "body": "#### PR description:\r\n\r\nThis PR updates the `TriggerResultsFilter` plugin to spot patterns without any valid matches when `HLTPathStatus` collections are used (i.e. when `usePathStatus=True`).\r\n\r\nUp to now `throw=True` had no effect if `usePathStatus=True`, even if `triggerConditions` contained patterns with no valid matches amongst the Paths in the job.\r\n\r\nAll `TriggerResultsFilter` instances in the central HLT menus use `throw=True`, and since many use `usePathStatus=True`, those could in principle silently return `False` due to invalid patterns (in practise, those patterns are often controlled by the `ConfDB` GUI, so should be correct).\r\n\r\nAfter this PR, invalid patterns for `HLTPathStatus` collections will lead to an exception if `throw=True`.\r\n\r\nWhile testing these changes, small updates were applied to the unit-tests for `TriggerResultsFilter`. In particular, `TriggerResultsFilter` modules with valid patterns now use `throw=True`, while those with invalid patterns are those with `throw=False`.\r\n\r\n_Edit_ : in addition, if `throw=True`, the plugin `TriggerResultsFilter` will now throw an exception if the parsing of the trigger-results expression fails (query with invalid syntax); up to now, this was leading only to a warning.\r\n\r\nThanks to @fwyzard for much help with the implementation; I tag him to review these changes.\r\n\r\n#### PR validation:\r\n\r\nPrivate tests with the relevant unit-tests.\r\n\r\n#### If this PR is a backport, please specify the original PR and why you need to backport that PR. If this PR will be backported please specify to which release cycle the backport is meant for:\r\n\r\n~~A backport to `12_4_X` is not necessary, but might be useful.~~ (see https://github.com/cms-sw/cmssw/pull/39044#issuecomment-1224969438)\r\n\r\n`CMSSW_12_4_X`", "branch": "master", "changed_files": 6, "closed_at": "1661325364", "comments": 10, "commits": 1, "created_at": "1660309730", "deletions": 243, "labels": ["hlt-approved", "fully-signed", "tests-approved", "bug-fix", "orp-approved", "code-checks-approved"], "merge_commit_sha": "6b34888e31af4483bd939da66cb5cc50447b20dd", "merged_at": "1661325364", "merged_by": "cmsbuild", "milestone": "CMSSW_12_5_X", "number": 39044, "release-notes": [], "review_comments": 9, "state": "closed", "title": "allow `TriggerResultsFilter` to throw for invalid `HLTPathStatus` patterns", "updated_at": "1661325364", "user": "missirol"}