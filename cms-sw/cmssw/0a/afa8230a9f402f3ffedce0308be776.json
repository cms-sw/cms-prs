{"additions": 182, "auther_ref": "devel_hltCustomHIon", "auther_sha": "8aa51f437b4258ec37601d1e28587e71da72f9c3", "author": "cms-tsg-storm", "body": "#### PR description:\r\n\r\nThis PR removes the customisations used for HLT menus of type `HIon` in `confdb.py` and `customiseHLTforAll` (the latter was effectively undoing the former, with the net effect of a few incorrect substitutions, see https://github.com/cms-sw/cmssw/pull/40339#issuecomment-1354606056).\r\n\r\nIt also adds new customisation functions for running the `L1REPACK` and/or `HLT` steps on HIon data with repacked RAW (i.e. `rawDataRepacker`), or RAWPrime (i.e. `rawPrimeDataRepacker` + `hltSiStripClusters2ApproxClusters`), listed below.\r\n  - `customiseL1TforHIonRepackedRAW(Prime)`: to be used when running the `L1REPACK` step alone on HIon repacked RAW(Prime) data.\r\n  - `customiseHLTforHIonRepackedRAW(Prime)`: to be used when running the `HLT` step alone on HIon repacked RAW(Prime) data.\r\n  - `customiseL1THLTforHIonRepackedRAW(Prime)`: to be used when running the `L1REPACK` and `HLT` steps together on HIon repacked RAW(Prime) data.\r\n\r\nThe customisation to re-run the HLT on RAW-Prime data will likely need to be improved in the future with help from the relevant experts (specifically, the part involving SiStrip approximate clusters).\r\n\r\nCurrent behaviour of all wfs is unchanged, modulo fixing the edge case described in https://github.com/cms-sw/cmssw/pull/40339#issuecomment-1354606056 (two customisations opposite to each other are removed, an existing customisation is encoded in a function, new customisations are added but not used anywhere yet).\r\n\r\nMerely technical. No changes expected.\r\n\r\n#### PR validation:\r\n\r\nPrivate tests, e.g. [*].\r\n\r\n#### If this PR is a backport, please specify the original PR and why you need to backport that PR. If this PR will be backported, please specify to which release cycle the backport is meant for:\r\n\r\n`CMSSW_12_6_X`\r\n\r\n[*]\r\n```bash\r\n#!/bin/bash\r\n\r\n# HLT: HIon RAW\r\nhltGetConfiguration /dev/CMSSW_12_6_0/HIon \\\r\n  --globaltag 124X_dataRun3_HLT_v7 \\\r\n  --data --type HIon \\\r\n  --unprescale \\\r\n  --output all \\\r\n  --max-events 100 \\\r\n  --customise HLTrigger/Configuration/CustomConfigs.customiseHLTforHIonRepackedRAW \\\r\n  --input file:/eos/cms/store/group/dpg_trigger/comm_trigger/TriggerStudiesGroup/STORM/RAW/HIRun2022A_HITestRaw0_run362321/f467ee64-fc64-47a6-9d8a-7ca73ebca2bd.root \\\r\n  > hltHIonRAW.py\r\nedmConfigDump hltHIonRAW.py > hltHIonRAW_d.py\r\ncmsRun hltHIonRAW_d.py &> hltHIonRAW_d.log\r\n\r\n# HLT: HIon RAWPrime\r\nhltGetConfiguration /dev/CMSSW_12_6_0/HIon \\\r\n  --globaltag 124X_dataRun3_HLT_v7 \\\r\n  --data --type HIon \\\r\n  --unprescale \\\r\n  --output all \\\r\n  --max-events 100 \\\r\n  --customise HLTrigger/Configuration/CustomConfigs.customiseHLTforHIonRepackedRAWPrime \\\r\n  --input file:/eos/cms/store/group/dpg_trigger/comm_trigger/TriggerStudiesGroup/STORM/RAW/HIRun2022A_HITestRawPrime0_run362321/5c26a8fa-3c2f-4f87-98ec-3c708b116b0b.root \\\r\n  > hltHIonRAWPrime.py\r\nedmConfigDump hltHIonRAWPrime.py > hltHIonRAWPrime_d.py\r\ncmsRun hltHIonRAWPrime_d.py &> hltHIonRAWPrime_d.log\r\n\r\n# L1T+HLT: HIon RAW\r\ncmsDriver.py step2 --process reHLT -s L1REPACK:Full,HLT:HIon --python_filename l1tPlusHLT_HIonRAW.py --dump_python \\\r\n  --conditions 124X_dataRun3_HLT_v7 --data --eventcontent FEVTDEBUGHLT --datatier FEVTDEBUGHLT --era Run3_pp_on_PbPb -n 100 \\\r\n  --filein file:/eos/cms/store/group/dpg_trigger/comm_trigger/TriggerStudiesGroup/STORM/RAW/HIRun2022A_HITestRaw0_run362321/f467ee64-fc64-47a6-9d8a-7ca73ebca2bd.root \\\r\n  --fileout file:l1tPlusHLT_HIonRAW.root \\\r\n  --customise HLTrigger/Configuration/CustomConfigs.customiseL1THLTforHIonRepackedRAW\r\ncmsRun l1tPlusHLT_HIonRAW.py &> l1tPlusHLT_HIonRAW.log\r\n\r\n# L1T+HLT: HIon RAWPrime\r\ncmsDriver.py step2 --process reHLT -s L1REPACK:Full,HLT:HIon --python_filename l1tPlusHLT_HIonRAWPrime.py --dump_python \\\r\n  --conditions 124X_dataRun3_HLT_v7 --data --eventcontent FEVTDEBUGHLT --datatier FEVTDEBUGHLT --era Run3_pp_on_PbPb_approxSiStripClusters -n 100 \\\r\n  --filein file:/eos/cms/store/group/dpg_trigger/comm_trigger/TriggerStudiesGroup/STORM/RAW/HIRun2022A_HITestRawPrime0_run362321/5c26a8fa-3c2f-4f87-98ec-3c708b116b0b.root \\\r\n  --fileout file:l1tPlusHLT_HIonRAWPrime.root \\\r\n  --customise HLTrigger/Configuration/CustomConfigs.customiseL1THLTforHIonRepackedRAWPrime\r\ncmsRun l1tPlusHLT_HIonRAWPrime.py &> l1tPlusHLT_HIonRAWPrime.log\r\n```\r\n", "branch": "master", "changed_files": 6, "comments": 6, "commits": 1, "created_at": "1671603369", "deletions": 73, "labels": ["hlt-approved", "fully-signed", "tests-approved", "orp-pending", "code-checks-approved"], "milestone": "CMSSW_13_0_X", "number": 40385, "release-notes": [], "review_comments": 0, "state": "open", "title": "update/add customisations for HIon HLT menus", "updated_at": "1671622073", "user": "missirol"}