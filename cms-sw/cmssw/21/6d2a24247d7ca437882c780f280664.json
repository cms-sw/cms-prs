{"additions": 1516, "auther_ref": "updatePixelAlCaRecos_v4", "auther_sha": "3e850549308a326549898670e18b1aaac7b6a22e", "author": "mmusich", "body": "#### PR description:\r\n\r\nSeveral times, an excessive disk resource usage from ALCARECOs has been pointed out, especially when it comes to pixel clusters, since the information is replicated many times over many datasets (Alignment, Strips, Pixel & Lumi ALCA flavours).\r\nFor what concerns the `SiPixelCalSingleMuon`, introduced in PR https://github.com/cms-sw/cmssw/pull/28535:\r\n   * we dont really need 100% of the tracks in the event to produce performance measurements: \r\n      * e.g. for Lorentz Angle monitoring, a prescale factor 100 seems to still yield reasonable results (see earlier results from Wei Wei  [ here](https://indico.cern.ch/event/1000803/contributions/4246064/), [here](https://indico.cern.ch/event/1000804/contributions/4266277/) and [here](https://indico.cern.ch/event/1000806/contributions/4301830/))\r\n   * as we are not saving the off-track pixel clusters, it is not possible to perform e.g. hit efficiency measurement in an unbiased way directly with the ALCARECO.\r\n      * though it is possible to re-create them on-the-fly from RAW by using the two-file solution  cumbersome!\r\n      \r\nProposal for reduction:\r\n   * the `SiPixelCalSingleMuon` is to be split and two new producers created:\r\n      * one called `SiPixelCalSingleMuonLoose` (with same event and track selection as presently implemented), but running prescaled of a factor 100. This is targeted to the cluster properties measurements + Pixel LA measurement @ PCL;\r\n      * one called `SiPixelCalSingleMuonTight` which runs on all events without prescales, but with tighter cuts, targeted to hit efficiency measurement. Saving:\r\n         * Only the muon tracks (+ on-track pixel & strip clusters), to be able to refit them\r\n         * The off-track clusters closer to the muon trajectory crossings with the pixel layers (disks).  \r\n\r\nThe last point is implemented by introducing a new producer `NearbyPixelClustersProducer` which saves in the event a new Pixel Cluster collection, made up of all the pixel clusters which are either:\r\n   * the single closest ones to the muon track trajectory crossings\r\n   * the whole set of clusters on the same `DetId` of the trajectory crossing;\r\n\r\nThe new collection is called `closebyPixelClusters`.\r\nThis proposal has been presented at the [Pixel DPG meeting of Apr 7th, 2021](https://indico.cern.ch/event/1000806/contributions/4300150/) and endorsed there.\r\n\r\n#### PR validation:\r\n\r\nTested to be technically running on 2018 data with:\r\n\r\n```bash\r\ncmsDriver.py -s RAW2DIGI,RECO,ALCA:SiPixelCalSingleMuonLoose+SiPixelCalSingleMuonTight \\\r\n--conditions auto:run2_data \\\r\n--eventcontent=ALCARECO \\\r\n--datatier ALCARECO \\\r\n-n -1 \\\r\n--no_exec --era Run2_2018 \\\r\n--python_filename=SingleMuonCombined_2018.py \\\r\n--nThreads=8 \\\r\n--filein=root://cms-xrd-global.cern.ch//store/data/Run2018C/SingleMuon/RAW/v1/000/320/065/00000/F43017EB-328E-E811-B679-FA163E6314D2.root\r\n```\r\n\r\nThe average event size evaluated on ~3500 of 2018C data (for run [320065](https://cmswbm.cern.ch/cmsdb/servlet/RunSummary?RUN=320065&SUBMIT=Submit)) is:\r\n\r\n| ALCARECO  | < evt size > [kB] |\r\n| ------------- | ------------- |\r\n| `SiPixelCalSingleMuon` | 14.12  |\r\n| `SiPixelCalSingleMuonLoose`  | 14.12 (prescale x 100) |\r\n| `SiPixelCalSingleMuonTight`  | 8.35 |\r\n\r\n:heavy_check_mark: We can foresee a reduction of ~ 1/2 of the data size with these changes.\r\n\r\n#### if this PR is a backport please specify the original PR and why you need to backport that PR:\r\n\r\nThis PR is not a backport, no backport is needed.\r\n\r\ncc:\r\n@tvami \r\n", "branch": "master", "changed_files": 19, "closed_at": "1618816574", "comments": 39, "commits": 6, "created_at": "1618152493", "deletions": 20, "labels": ["alca-approved", "code-checks-approved", "fully-signed", "operations-approved", "orp-approved", "pdmv-approved", "tests-approved", "upgrade-approved"], "merge_commit_sha": "07a5e6a5f93599b26e93b3cbc77a7855cb1a56f6", "merged_at": "1618816574", "merged_by": "cmsbuild", "milestone": "CMSSW_12_0_X", "number": 33399, "release-notes": [], "review_comments": 5, "state": "closed", "title": "Split SiPixelCalSingleMuon into two separate ALCARECO producers", "updated_at": "1618816575", "user": "mmusich"}