{"additions": 139, "auther_ref": "CMSSW_15_0_X_2025-04-06-0000/revert-47061", "auther_sha": "5e79aee49db89ab5796ed2e1afa004a3490ab48e", "author": "slava77", "body": "Reverts cms-sw/cmssw#47061\r\n15_0_X variant of #47803\r\n\r\nThis reverts commit d288c81b480435b414132de7ccc4fe5bb958785e, reversing changes made to 6eea5fa05e2eeb002918482c8ee4611c7349f861.\r\n\r\ncopy-paste from #47803\r\n\r\n------\r\nhttps://github.com/cms-sw/cmssw/pull/47061#issuecomment-2784812601\r\n\r\nFollowing the TSG timing checks of the full unpacking/clustering showing possible slow down (initially reported late Jan/early Feb), I rechecked the impact and (unfortunately) confirm on data inputs (full menu based on /dev/CMSSW_14_2_0/GRun/V12 data from run 386593, 10K events, single thread test, in a configuration with mkFit and full strip unpacking and max cluster size set to 8):\r\n\r\n- valgrind callgrind still shows a speed up of around 25%\r\n- FastTimerService shows around 10% slowdown in `hltSiStripRawToClustersFacility`\r\n\r\nI can speculate that callgrind is so slow that the underlying hardware memory access costs are mis-represented\r\n\r\nI tried to measure the impact of individual contributions\r\n- changes in template/inline of ThreeThresholdAlgorithm have almost negligible impact on timing \r\n- precomputed qualityBits and rawNoises lead to most of the slowdown based on `FastTimerService`\r\n\r\nThe timing tests were done in CMSSW_14_2_1\r\n\r\n@mmasciov \r\n@elusian \r\n\r\n-------\r\n\r\n@mmusich  this should address https://github.com/cms-sw/cmssw/pull/47803#issuecomment-2785471670\r\n", "branch": "CMSSW_15_0_X", "changed_files": 4, "comments": 3, "commits": 1, "created_at": "1744108371", "deletions": 184, "labels": ["reconstruction-pending", "alca-pending", "pending-signatures", "orp-pending", "tests-started", "trk"], "milestone": "CMSSW_15_0_X", "number": 47810, "release-notes": [], "review_comments": 0, "state": "open", "title": "revert \"speedup SiStripClusterizer(FromRaw) using ThreeThresholdAlgorithm\"", "updated_at": "1744110681", "user": "slava77"}