{"additions": 3639, "auther_ref": "EF_dqm_CMSSW1502", "auther_sha": "37cd45cb68636d6f5acd40c4ef5b40e364f1bd08", "author": "elfontan", "body": "#### PR description:\r\nA skeleton for a Scouting Offline DQM for the 2025 pp data-taking is here implemented.\r\n\r\nThe goal is to monitor the distributions of the scouting objects (allowing an easier comparison with offline objects) and the efficiency of the scouting triggers. The targeted data set for the monitoring is ScoutingPFMonitor, which includes both scouting and offline objects. This PR handles the code developed for EGM and MUO (given the similar structure newly implemented) while the developments for JME are currently discussed separately in https://github.com/cms-sw/cmssw/pull/47116 (given the strong dependence on the central JME DQM existing code).\r\n\r\nCredits to:\r\n- @tihsu99 for the EGM code (https://github.com/elfontan/cmssw/pull/5 + https://github.com/elfontan/cmssw/pull/7)\r\n- @JavierGarciadeCastro and @CeliaFernandez for the MUO code (https://github.com/elfontan/cmssw/pull/6)\r\n\r\nUpdates to the autoDQM workflows to be able to centrally run these new analysers only for the ScoutingPFMonitor data set have also been included (`DQMOffline/HLTScouting`). The goal is to update the T0 configuration (https://github.com/dmwm/T0/blob/master/etc/ProdOfflineConfiguration.py) to run a dedicated @commonWithScouting sequence for ScoutingPFMonitor as this PR will be integrated. [cc: @rseidita]\r\n\r\n**Description of the current changes**:\r\n* MUO DQM: The current code features two plugins in `HLTriggerOffline/Scouting/plugins`: one to perform a tag and probe (T&P) method to monitor scouting muon and vertex distributions and efficiencies, one to monitor distributions and efficiencies of muon L1 seeds. Corresponding configuration files (called from the central @hltScouting workflow) are placed in `HLTriggerOffline/Scouting/python`. Configuration files to run the MUO DQM workflow standalone for testing purposes are available in `HLTriggerOffline/Scouting/test`. Output histograms in the DQM files are currently placed in `HLT/ScoutingOffline/Muons`.\r\n* EGM DQM: The current code features two plugins in `HLTriggerOffline/Scouting/plugins` to perform a tag and probe (T&P) method on electrons and to monitor both scouting and offline Gamma objects, allowing for direct comparison. Corresponding configuration files (also used in the central @hltScouting workflow) are placed in `HLTriggerOffline/Scouting/python`. Output histograms in the DQM files are currently placed in ``HLT/ScoutingOffline/EGamma`.\r\n\r\nRelevant presentations about the development and validation of the current code can be found in:\r\n* [Scouting meeting on October 3, 2024](https://indico.cern.ch/event/1459519/#b-583919-scouting-dqm-developm)\r\n* [Scouting meeting on January 16, 2024](https://indico.cern.ch/event/1492373/#9-dqm-developments-discussion)\r\n\r\n#### PR validation:\r\nThe PR has been prepared starting from CMSSW_15_0_0_pre2:\r\n```\r\ncmsrel CMSSW_15_0_0_pre2\r\ncd CMSSW_15_0_0_pre2/src\r\ncmsenv\r\ngit cms-init\r\ngit cms-addpkg DQMOffline\r\ngit cms-addpkg HLTriggerOffline\r\nscram b && scram b code-checks && scram b code-format && scram b\r\n```\r\n\r\nThe usual runTheMatrix test workflows were run by the developers. However, none of the central workflows is currently running the new plugins. A dedicated testing workflow has been designed taking inspiration from the central workflows:\r\n```\r\n[1]: input: RAW file from ScoutingPFMonitor dataset (Run2024F, [Fill9852](https://cmsoms.cern.ch/cms/fills/report?cms_fill=9852), run382686)\r\n\r\n[2]: cmsDriver.py step2  --process reHLT -s L1REPACK:Full,HLT:@relval2025 --conditions auto:run3_hlt_relval --data  --eventcontent FEVTDEBUGHLT --datatier FEVTDEBUGHLT --era Run3_2024 -n 500 --filein  file:/eos/cms/store/group/dpg_trigger/comm_trigger/TriggerStudiesGroup/Scouting/Run3/ScoutingPFMonitor/300684ed-1a51-474f-8c4f-b3bf1e1f5044_skimmed.root\r\n\r\n[3]: cmsDriver.py step3  --conditions auto:run3_data_prompt_relval -s RAW2DIGI,L1Reco,RECO,PAT,NANO,DQM:@hltScouting --datatier RECO,MINIAOD,NANOAOD,DQMIO --eventcontent RECO,MINIAOD,NANOEDMAOD,DQM --data  --process reRECO --scenario pp --era Run3_2024 --customise Configuration/DataProcessing/RecoTLR.customisePostEra_Run3_2024 -n 500 --filein file:step2_L1REPACK_HLT.root\r\n\r\n[4]: cmsDriver.py step4 -s HARVESTING:@hltScouting --conditions auto:run3_data --data  --filetype DQM --scenario pp --era Run3_2024 -n 500 --filein file:step3_RAW2DIGI_L1Reco_RECO_PAT_NANO_DQM_inDQM.root\r\n```\r\nNOTE that all tests have been performed with a private file from ScoutingPFMonitor skimmed to remove all events without scouting, also because **most of the RAW data from ScoutingPFMonitor are on tape.** If a central dataset-file is needed for implementing the central tests, we found some accessible files from 2024G (site _T1_RU_JINR_Disk_) e.g.   `/store/data/Run2024G/ScoutingPFMonitor/RAW/v1/000/385/178/00000/b7e5f884-95f6-4369-a040-48643ed65cde.root`\r\n\r\n**Please, let us know how to proceed for the integration of this (or a similar) testing workflow in the list of central ones.**\r\n\r\n#### Additional notes:\r\nA PR to cms-bot to assign the content of the new repositories to the dqm area for review has been prepared: https://github.com/cms-sw/cms-bot/pull/2432.\r\n\r\n[cc: @silviodonato @missirol @mtosi]\r\n", "branch": "master", "changed_files": 32, "comments": 25, "commits": 29, "created_at": "1738362419", "deletions": 4, "labels": ["dqm-approved", "pending-signatures", "tests-approved", "orp-pending", "new-package-pending", "code-checks-approved", "allow-elfontan"], "milestone": "CMSSW_15_0_X", "number": 47235, "release-notes": [], "review_comments": 44, "state": "open", "title": "Scouting Offline DQM for 2025 data-taking (EGM+MUO+autoDQM)", "updated_at": "1738767653", "user": "elfontan"}