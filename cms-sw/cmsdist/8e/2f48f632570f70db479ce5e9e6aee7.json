{"additions": 4, "auther_ref": "scram3-el7", "auther_sha": "ada117a8a3ceda475db89ccde9b360fdb9bb46b6", "author": "cms-sw", "body": "By default `scram` wrapper uses SCRAM V2 (PERL based). This was done to avoid failures on `slc6` where we do not have system `python3` ( needed by SCRAM V3). This change proposes to use [SCRAM V3](https://github.com/cms-sw/cmssw-osenv/commit/cc61d5356f60a5a3a56a32a738fb1958f7836db7) for containers where python3 is installed in the container (e.g. el7 and above). \r\n\r\nThis change should allow CMS Connect jobs to use `cmssw-el7/el8` for CMSSW projects which use SCRAM V3. Note that currently CMS Connect sources some el9 based script ( /cvmfs/oasis.opensciencegrid.org/mis/osg-wn-client/23-main/23.240627-1/el9-x86_64/setup.sh ) before starting `cmssw-el7/el8`. This adds some extra binary Perl modules in PERL5LIB which breaks PERL [a] within the container. As SCRAM V2 is perl based, so scram commands fail in such an environment. \r\n\r\nCorrect fix for CMS Connect jobs should be to unset the `PERL5LIB` env before starting  `cmssw-elX` (where X is not 9)\r\n\r\n[a]\r\n```\r\n> source /cvmfs/oasis.opensciencegrid.org/mis/osg-wn-client/23-main/23.240805-1/el9-x86_64/setup.sh\r\n> cmssw-el8 -- perl -e 'use Cwd'\r\nCan't load '/cvmfs/oasis.opensciencegrid.org/mis/osg-wn-client/23-main/23.240805-1/el9-x86_64/usr/lib64/perl5/vendor_perl/auto/Cwd/Cwd.so' for module Cwd: libperl.so.5.32: cannot open shared object file: No such file or directory at /cvmfs/oasis.opensciencegrid.org/mis/osg-wn-client/23-main/23.240805-1/el9-x86_64/usr/share/perl5/XSLoader.pm line 93.\r\n at /cvmfs/oasis.opensciencegrid.org/mis/osg-wn-client/23-main/23.240805-1/el9-x86_64/usr/lib64/perl5/vendor_perl/Cwd.pm line 82.\r\n```", "branch": "IB/CMSSW_14_1_X/master", "changed_files": 2, "comments": 10, "commits": 3, "created_at": "1723640000", "deletions": 4, "labels": ["tests-pending", "hold", "externals-pending", "pending-signatures", "orp-pending"], "number": 9361, "release-notes": [], "review_comments": 0, "state": "open", "title": "Updating cmssw-osenv: Use SCRAM V3 for containers with python3", "updated_at": "1723709680", "user": "smuzaffar"}