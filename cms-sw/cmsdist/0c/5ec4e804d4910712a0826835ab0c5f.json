{"additions": 6, "auther_ref": "IB/CMSSW_14_0_X/master_alpaka_gpu_only_mode", "auther_sha": "efea939ee11008b084864bf295bcbfeb7789f9f0", "author": "fwyzard", "body": "Build alpaka device code for the CUDA and ROCm back-ends in \"GPU only\" mode. In this mode, functions marked as ALPAKA_FN_ACC are marked as `__device__` functions, and are compiled only for the corresponding GPU device back-ends.\r\n\r\nCurrently, functions marked as ALPAKA_FN_ACC are marked as `__host__ __device__` functions, and may be compiled for both device and host back-ends. The latter leads to linker errors in kernels that use device symbols like `threadIdx`, `blockIdx`, _etc_. that are compiled for the ROCm back-end.\r\n\r\nNo impact on the HLT performance, as expected.\r\n`CMSSW_14_0_4`:\r\n```\r\nRunning 4 times over all events with 8 jobs, each with 32 threads, 24 streams and 1 GPUs\r\n   525.9    0.6 ev/s (11800 events, 99.8% overlap)\r\n   522.7    0.5 ev/s (11800 events, 99.9% overlap)\r\n   534.2    0.8 ev/s (11800 events, 99.8% overlap)\r\n   541.6    0.6 ev/s (11800 events, 99.9% overlap)\r\n --------------------\r\n   531.1    8.5 ev/s\r\n```\r\n\r\n`CMSSW_14_0_4` with https://github.com/cms-sw/cmssw/pull/44650 and https://github.com/cms-sw/cmsdist/pull/9125:\r\n```\r\nRunning 4 times over all events with 8 jobs, each with 32 threads, 24 streams and 1 GPUs\r\n   536.3    0.6 ev/s (11800 events, 99.8% overlap)\r\n   531.2    0.5 ev/s (11800 events, 99.7% overlap)\r\n   558.7    0.4 ev/s (11800 events, 99.5% overlap)\r\n   520.9    0.8 ev/s (11800 events, 99.8% overlap)\r\n --------------------\r\n   536.8   16.0 ev/s\r\n```\r\n\r\nBackport #9121 to CMSSW 14.0.x for data taking.", "branch": "IB/CMSSW_14_0_X/master", "changed_files": 2, "comments": 8, "commits": 1, "created_at": "1712478672", "deletions": 6, "labels": ["tests-approved", "externals-approved", "fully-signed", "orp-pending", "requires-external", "backport-ok"], "number": 9125, "release-notes": [], "review_comments": 0, "state": "open", "title": "Build alpaka code in GPU-only mode [14.0.x]", "updated_at": "1712605025", "user": "fwyzard"}