{"additions": 2, "auther_ref": "gartung-libunwind-debug", "auther_sha": "501efd0a5060543375b3853c68d17cf9d7d40410", "author": "gartung", "body": "Testing with ASAN build showed heap buffer overflow in libunwind.  Fixed by libunwind master commit\r\nhttps://github.com/libunwind/libunwind/commit/e63e024b72d35d4404018fde1a546fde976da5c5\r\n```=================================================================\r\n==3053803==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x63200dc35bdf at pc 0x7fea9fc73a71 bp 0x63200dc35bb0 sp 0x63200dc35370\r\nWRITE of size 1 at 0x63200dc35bdf thread T0\r\n    #0 0x7fea9fc73a70 in __interceptor_read ../../../../libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:1025\r\n    #1 0x7fea9d3b38b7 in _write_validate mi/Gaddress_validator.c:118\r\n    #2 0x7fea9d3b38b7 in _UIx86_64_address_is_valid mi/Gaddress_validator.c:291\r\n    #3 0x7fea9d3b45f1 in access_mem x86_64/Ginit.c:90\r\n    #4 0x7fea9d3b576a in is_plt_entry x86_64/Gstep.c:44\r\n    #5 0x7fea9d3b576a in _ULx86_64_step x86_64/Gstep.c:142\r\n    #6 0x7fea9d3b6344 in trace_init_addr x86_64/Gtrace.c:249\r\n    #7 0x7fea9d3b6344 in trace_lookup x86_64/Gtrace.c:331\r\n    #8 0x7fea9d3b6344 in _ULx86_64_tdep_trace x86_64/Gtrace.c:449\r\n    #9 0x7fea9d3b350b in unw_backtrace mi/backtrace.c:70\r\n    #10 0x7feaa04de6c7 in profileSignalHandler /data/cmsbld/jenkins/workspace/ib-run-pr-tests/testBuildDir/BUILD/el8_amd64_gcc12/external/igprof/5.9.16-885cac9f391726eb03a40073a814536b/igprof-16da627e12a806cd8ab072e7288223c91086ea25/src/profile-perf.cc:66\r\n    #11 0x7fea9ddc85af  (/lib64/libc.so.6+0x4e5af)\r\n    #12 0x7fe98e88e9f4  (<unknown module>)\r\n\r\n0x63200dc35bdf is located 2531 bytes to the right of 84476-byte region [0x63200dc20800,0x63200dc351fc)\r\nallocated by thread T0 here:\r\n    #0 0x7fea9fce0838 in operator new[](unsigned long) ../../../../libsanitizer/asan/asan_new_delete.cpp:98\r\n    #1 0x7fea9e625257 in TStorage::ReAllocChar(char*, unsigned long, unsigned long) (/cvmfs/cms-ib.cern.ch/sw/x86_64/week0/el8_amd64_gcc12/cms/cmssw/CMSSW_15_0_ASAN_X_2025-01-27-2300/external/el8_amd64_gcc12/lib/libCore.so+0x266257)\r\n\r\nSUMMARY: AddressSanitizer: heap-buffer-overflow ../../../../libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:1025 in __interceptor_read\r\nShadow bytes around the buggy address:\r\n  0x0c6481b7eb20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n  0x0c6481b7eb30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n  0x0c6481b7eb40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n  0x0c6481b7eb50: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n  0x0c6481b7eb60: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n=>0x0c6481b7eb70: fa fa fa fa fa fa fa fa fa fa fa[fa]fa fa fa fa\r\n  0x0c6481b7eb80: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n  0x0c6481b7eb90: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n  0x0c6481b7eba0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n  0x0c6481b7ebb0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n  0x0c6481b7ebc0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\nShadow byte legend (one shadow byte represents 8 application bytes):\r\n  Addressable:           00\r\n  Partially addressable: 01 02 03 04 05 06 07 \r\n  Heap left redzone:       fa\r\n  Freed heap region:       fd\r\n  Stack left redzone:      f1\r\n  Stack mid redzone:       f2\r\n  Stack right redzone:     f3\r\n  Stack after return:      f5\r\n  Stack use after scope:   f8\r\n  Global redzone:          f9\r\n  Global init order:       f6\r\n  Poisoned by user:        f7\r\n  Container overflow:      fc\r\n  Array cookie:            ac\r\n  Intra object redzone:    bb\r\n  ASan internal:           fe\r\n  Left alloca redzone:     ca\r\n  Right alloca redzone:    cb\r\n==3053803==ABORTING\r\n```\r\n\r\nresolves https://github.com/cms-sw/framework-team/issues/1204", "branch": "IB/CMSSW_15_0_X/master", "changed_files": 1, "comments": 23, "commits": 1, "created_at": "1738076101", "deletions": 2, "labels": ["tests-pending", "externals-pending", "pending-signatures", "orp-pending"], "number": 9639, "release-notes": [], "review_comments": 0, "state": "open", "title": "libunwind master with fix for uninitialized access", "updated_at": "1738688182", "user": "gartung"}