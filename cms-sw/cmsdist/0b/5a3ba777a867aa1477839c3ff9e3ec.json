{"additions": 1, "auther_ref": "smuzaffar-patch-15", "auther_sha": "3fd814b8857c0327f306e4929a7330e93f15d27e", "author": "cms-sw", "body": "ONNXRuntime most of the time failed to build (out of memroy error) on aarch64 nodes ( 40 cores, 120GB) as `onnxruntime_NVCC_THREADS=0` starts `nvcc` with `--thread $(nproc)` causes `nproc x nproc` process running in parallel. As we already run `make -j $(nproc)` so it is better to run single `nvcc` process to avoid overloading build nodes. `onnxruntime_NVCC_THREADS=1` will slow down the build phase but it should not crash the node.\r\n\r\n[a] https://docs.nvidia.com/cuda/cuda-compiler-driver-nvcc/index.html#options-for-guiding-compiler-driver-threads\r\n```\r\n4.2.5.8. --threads number (-t)[](https://docs.nvidia.com/cuda/cuda-compiler-driver-nvcc/index.html#threads-number-t)\r\nSpecify the maximum number of threads to be used to execute the compilation steps in parallel.\r\n\r\nThis option can be used to improve the compilation speed when compiling for multiple architectures. The compiler creates number threads to execute the compilation steps in parallel. If number is 1, this option is ignored. If number is 0, the number of threads used is the number of CPUs on the machine.\r\n```", "branch": "IB/CMSSW_15_0_X/master", "changed_files": 1, "closed_at": "1738210912", "comments": 4, "commits": 1, "created_at": "1738187857", "deletions": 1, "labels": ["externals-pending", "pending-signatures", "tests-started", "orp-pending"], "merge_commit_sha": "91890056fc38324e80e7337fb9f5a2248614cbab", "merged_at": "1738210912", "merged_by": "smuzaffar", "number": 9653, "release-notes": [], "review_comments": 0, "state": "closed", "title": "onnxruntime: Use single thread to compile with nvcc", "updated_at": "1738210917", "user": "smuzaffar"}