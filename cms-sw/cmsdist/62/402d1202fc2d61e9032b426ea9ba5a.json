{"additions": 3, "auther_ref": "IB/CMSSW_13_0_X/master_use_ld_bfd", "auther_sha": "b6c4a2667683e00dcd33b2587fd3e2c4e55d758c", "author": "fwyzard", "body": "As we configure them, gcc and clang already use the GNU bfd linker by default (`ld` or `ld.bfd`, they are the same in our externals).\r\n\r\nInstead `hipcc` uses its version of `ld.lld` by default.\r\n\r\nThis can cause inker problems in some corner cases, for example when linking objects with weak `V` symbols with objects with unique `u` symbols: `ld.bfd` and `ld.gold` seem to handle that, while `ld.lld` fails with a duplicate symbol error.\r\n\r\nRather than changing how gcc and clang generate symbols, it looks like the problem can be fixed instructing `hipcc` to use the GNU bfd linker.\r\nThis improves consistency with the rest of our build system, possibly avoiding other corner cases.\r\n\r\nSetting the flag for gcc should propagate automatically to clang and hipcc, making sure all compilers consistently use the same linker.\r\n\r\n---\r\n\r\nBackport of #8382 to CMSSW_13_0_X to fix compilation problems with the ROCm backend for Alpaka.", "branch": "IB/CMSSW_13_0_X/master", "changed_files": 1, "closed_at": "1679405156", "comments": 7, "commits": 1, "created_at": "1678991362", "deletions": 0, "labels": ["tests-approved", "externals-approved", "orp-approved", "fully-signed", "backport-ok"], "merge_commit_sha": "0520c9b317d44844c8742bf8fc3856cf706c5eb1", "merged_at": "1679405156", "merged_by": "cmsbuild", "number": 8391, "release-notes": [], "review_comments": 0, "state": "closed", "title": "Explicitly use the GNU binutils ld.bfd linker [13.0.x]", "updated_at": "1679405156", "user": "fwyzard"}